"use strict";var $h=Object.create;var Ls=Object.defineProperty;var qh=Object.getOwnPropertyDescriptor;var jh=Object.getOwnPropertyNames;var Fh=Object.getPrototypeOf,Uh=Object.prototype.hasOwnProperty;var Ie=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Qh=(r,e)=>{for(var t in e)Ls(r,t,{get:e[t],enumerable:!0})},Pa=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of jh(e))!Uh.call(r,n)&&n!==t&&Ls(r,n,{get:()=>e[n],enumerable:!(s=qh(e,n))||s.enumerable});return r};var Vr=(r,e,t)=>(t=r!=null?$h(Fh(r)):{},Pa(e||!r||!r.__esModule?Ls(t,"default",{value:r,enumerable:!0}):t,r)),Vh=r=>Pa(Ls({},"__esModule",{value:!0}),r);var uc=Ie((WS,lc)=>{"use strict";var{Duplex:bp}=require("stream");function oc(r){r.emit("close")}function vp(){!this.destroyed&&this._writableState.finished&&this.destroy()}function ac(r){this.removeListener("error",ac),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function _p(r,e){let t=!0,s=new bp({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return r.on("message",function(i,o){let a=!o&&s._readableState.objectMode?i.toString():i;s.push(a)||r.pause()}),r.once("error",function(i){s.destroyed||(t=!1,s.destroy(i))}),r.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(n,i){if(r.readyState===r.CLOSED){i(n),process.nextTick(oc,s);return}let o=!1;r.once("error",function(c){o=!0,i(c)}),r.once("close",function(){o||i(n),process.nextTick(oc,s)}),t&&r.terminate()},s._final=function(n){if(r.readyState===r.CONNECTING){r.once("open",function(){s._final(n)});return}r._socket!==null&&(r._socket._writableState.finished?(n(),s._readableState.endEmitted&&s.destroy()):(r._socket.once("finish",function(){n()}),r.close()))},s._read=function(){r.isPaused&&r.resume()},s._write=function(n,i,o){if(r.readyState===r.CONNECTING){r.once("open",function(){s._write(n,i,o)});return}r.send(n,o)},s.on("end",vp),s.on("error",ac),s}lc.exports=_p});var Tt=Ie((KS,fc)=>{"use strict";var cc=["nodebuffer","arraybuffer","fragments"],hc=typeof Blob<"u";hc&&cc.push("blob");fc.exports={BINARY_TYPES:cc,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:hc,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Ac=Ie((GS,Nc)=>{var gc=require("fs"),Ct=require("path"),yc=require("os"),bc=typeof __webpack_require__=="function"?__non_webpack_require__:require,wp=process.config&&process.config.variables||{},Sp=!!process.env.PREBUILDS_ONLY,dc=process.versions.modules,Wo=Tp()?"electron":Ep()?"node-webkit":"node",Ko=process.env.npm_config_arch||yc.arch(),Go=process.env.npm_config_platform||yc.platform(),vc=process.env.LIBC||(Cp(Go)?"musl":"glibc"),Zo=process.env.ARM_VERSION||(Ko==="arm64"?"8":wp.arm_version)||"",_c=(process.versions.uv||"").split(".")[0];Nc.exports=ft;function ft(r){return bc(ft.resolve(r))}ft.resolve=ft.path=function(r){r=Ct.resolve(r||".");try{var e=bc(Ct.join(r,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[e+"_PREBUILD"]&&(r=process.env[e+"_PREBUILD"])}catch{}if(!Sp){var t=pc(Ct.join(r,"build/Release"),mc);if(t)return t;var s=pc(Ct.join(r,"build/Debug"),mc);if(s)return s}var n=a(r);if(n)return n;var i=a(Ct.dirname(process.execPath));if(i)return i;var o=["platform="+Go,"arch="+Ko,"runtime="+Wo,"abi="+dc,"uv="+_c,Zo?"armv="+Zo:"","libc="+vc,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+o+`
    loaded from: `+r+`
`);function a(c){var d=Ho(Ct.join(c,"prebuilds")).map(wc),h=d.filter(Sc(Go,Ko)).sort(xc)[0];if(h){var p=Ct.join(c,"prebuilds",h.name),b=Ho(p).map(Ec),_=b.filter(Tc(Wo,dc)),g=_.sort(Cc(Wo))[0];if(g)return Ct.join(p,g.file)}}};function Ho(r){try{return gc.readdirSync(r)}catch{return[]}}function pc(r,e){var t=Ho(r).filter(e);return t[0]&&Ct.join(r,t[0])}function mc(r){return/\.node$/.test(r)}function wc(r){var e=r.split("-");if(e.length===2){var t=e[0],s=e[1].split("+");if(t&&s.length&&s.every(Boolean))return{name:r,platform:t,architectures:s}}}function Sc(r,e){return function(t){return t==null||t.platform!==r?!1:t.architectures.includes(e)}}function xc(r,e){return r.architectures.length-e.architectures.length}function Ec(r){var e=r.split("."),t=e.pop(),s={file:r,specificity:0};if(t==="node"){for(var n=0;n<e.length;n++){var i=e[n];if(i==="node"||i==="electron"||i==="node-webkit")s.runtime=i;else if(i==="napi")s.napi=!0;else if(i.slice(0,3)==="abi")s.abi=i.slice(3);else if(i.slice(0,2)==="uv")s.uv=i.slice(2);else if(i.slice(0,4)==="armv")s.armv=i.slice(4);else if(i==="glibc"||i==="musl")s.libc=i;else continue;s.specificity++}return s}}function Tc(r,e){return function(t){return!(t==null||t.runtime&&t.runtime!==r&&!xp(t)||t.abi&&t.abi!==e&&!t.napi||t.uv&&t.uv!==_c||t.armv&&t.armv!==Zo||t.libc&&t.libc!==vc)}}function xp(r){return r.runtime==="node"&&r.napi}function Cc(r){return function(e,t){return e.runtime!==t.runtime?e.runtime===r?-1:1:e.abi!==t.abi?e.abi?-1:1:e.specificity!==t.specificity?e.specificity>t.specificity?-1:1:0}}function Ep(){return!!(process.versions&&process.versions.nw)}function Tp(){return process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function Cp(r){return r==="linux"&&gc.existsSync("/etc/alpine-release")}ft.parseTags=Ec;ft.matchTags=Tc;ft.compareTags=Cc;ft.parseTuple=wc;ft.matchTuple=Sc;ft.compareTuples=xc});var Xo=Ie((ZS,Yo)=>{var Jo=typeof __webpack_require__=="function"?__non_webpack_require__:require;typeof Jo.addon=="function"?Yo.exports=Jo.addon.bind(Jo):Yo.exports=Ac()});var kc=Ie((HS,Pc)=>{"use strict";var Np=(r,e,t,s,n)=>{for(var i=0;i<n;i++)t[s+i]=r[i]^e[i&3]},Ap=(r,e)=>{let t=r.length;for(var s=0;s<t;s++)r[s]^=e[s&3]};Pc.exports={mask:Np,unmask:Ap}});var Ic=Ie((JS,ea)=>{"use strict";try{ea.exports=Xo()(__dirname)}catch{ea.exports=kc()}});var ws=Ie((YS,_n)=>{"use strict";var{EMPTY_BUFFER:Pp}=Tt(),ta=Buffer[Symbol.species];function kp(r,e){if(r.length===0)return Pp;if(r.length===1)return r[0];let t=Buffer.allocUnsafe(e),s=0;for(let n=0;n<r.length;n++){let i=r[n];t.set(i,s),s+=i.length}return s<e?new ta(t.buffer,t.byteOffset,s):t}function Oc(r,e,t,s,n){for(let i=0;i<n;i++)t[s+i]=r[i]^e[i&3]}function Lc(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t&3]}function Ip(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function ra(r){if(ra.readOnly=!0,Buffer.isBuffer(r))return r;let e;return r instanceof ArrayBuffer?e=new ta(r):ArrayBuffer.isView(r)?e=new ta(r.buffer,r.byteOffset,r.byteLength):(e=Buffer.from(r),ra.readOnly=!1),e}_n.exports={concat:kp,mask:Oc,toArrayBuffer:Ip,toBuffer:ra,unmask:Lc};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=Ic();_n.exports.mask=function(e,t,s,n,i){i<48?Oc(e,t,s,n,i):r.mask(e,t,s,n,i)},_n.exports.unmask=function(e,t){e.length<32?Lc(e,t):r.unmask(e,t)}}catch{}});var Bc=Ie((XS,Mc)=>{"use strict";var Rc=Symbol("kDone"),sa=Symbol("kRun"),na=class{constructor(e){this[Rc]=()=>{this.pending--,this[sa]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[sa]()}[sa](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[Rc])}}};Mc.exports=na});var Es=Ie((e1,jc)=>{"use strict";var Ss=require("zlib"),Dc=ws(),Op=Bc(),{kStatusCode:$c}=Tt(),Lp=Buffer[Symbol.species],Rp=Buffer.from([0,0,255,255]),xn=Symbol("permessage-deflate"),Nt=Symbol("total-length"),xs=Symbol("callback"),Dt=Symbol("buffers"),Sn=Symbol("error"),wn,ia=class{constructor(e,t,s){if(this._maxPayload=s|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!wn){let n=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;wn=new Op(n)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[xs];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,s=e.find(n=>!(t.serverNoContextTakeover===!1&&n.server_no_context_takeover||n.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>n.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!n.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(s.server_no_context_takeover=!0),t.clientNoContextTakeover&&(s.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(s.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?s.client_max_window_bits=t.clientMaxWindowBits:(s.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete s.client_max_window_bits,s}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(s=>{let n=t[s];if(n.length>1)throw new Error(`Parameter "${s}" must have only a single value`);if(n=n[0],s==="client_max_window_bits"){if(n!==!0){let i=+n;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${s}": ${n}`);n=i}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${s}": ${n}`)}else if(s==="server_max_window_bits"){let i=+n;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${s}": ${n}`);n=i}else if(s==="client_no_context_takeover"||s==="server_no_context_takeover"){if(n!==!0)throw new TypeError(`Invalid value for parameter "${s}": ${n}`)}else throw new Error(`Unknown parameter "${s}"`);t[s]=n})}),e}decompress(e,t,s){wn.add(n=>{this._decompress(e,t,(i,o)=>{n(),s(i,o)})})}compress(e,t,s){wn.add(n=>{this._compress(e,t,(i,o)=>{n(),s(i,o)})})}_decompress(e,t,s){let n=this._isServer?"client":"server";if(!this._inflate){let i=`${n}_max_window_bits`,o=typeof this.params[i]!="number"?Ss.Z_DEFAULT_WINDOWBITS:this.params[i];this._inflate=Ss.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[xn]=this,this._inflate[Nt]=0,this._inflate[Dt]=[],this._inflate.on("error",Bp),this._inflate.on("data",qc)}this._inflate[xs]=s,this._inflate.write(e),t&&this._inflate.write(Rp),this._inflate.flush(()=>{let i=this._inflate[Sn];if(i){this._inflate.close(),this._inflate=null,s(i);return}let o=Dc.concat(this._inflate[Dt],this._inflate[Nt]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Nt]=0,this._inflate[Dt]=[],t&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),s(null,o)})}_compress(e,t,s){let n=this._isServer?"server":"client";if(!this._deflate){let i=`${n}_max_window_bits`,o=typeof this.params[i]!="number"?Ss.Z_DEFAULT_WINDOWBITS:this.params[i];this._deflate=Ss.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[Nt]=0,this._deflate[Dt]=[],this._deflate.on("data",Mp)}this._deflate[xs]=s,this._deflate.write(e),this._deflate.flush(Ss.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let i=Dc.concat(this._deflate[Dt],this._deflate[Nt]);t&&(i=new Lp(i.buffer,i.byteOffset,i.length-4)),this._deflate[xs]=null,this._deflate[Nt]=0,this._deflate[Dt]=[],t&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),s(null,i)})}};jc.exports=ia;function Mp(r){this[Dt].push(r),this[Nt]+=r.length}function qc(r){if(this[Nt]+=r.length,this[xn]._maxPayload<1||this[Nt]<=this[xn]._maxPayload){this[Dt].push(r);return}this[Sn]=new RangeError("Max payload size exceeded"),this[Sn].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Sn][$c]=1009,this.removeListener("data",qc),this.reset()}function Bp(r){this[xn]._inflate=null,r[$c]=1007,this[xs](r)}});var Uc=Ie((t1,Fc)=>{"use strict";function Dp(r){let e=r.length,t=0;for(;t<e;)if((r[t]&128)===0)t++;else if((r[t]&224)===192){if(t+1===e||(r[t+1]&192)!==128||(r[t]&254)===192)return!1;t+=2}else if((r[t]&240)===224){if(t+2>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||r[t]===224&&(r[t+1]&224)===128||r[t]===237&&(r[t+1]&224)===160)return!1;t+=3}else if((r[t]&248)===240){if(t+3>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||(r[t+3]&192)!==128||r[t]===240&&(r[t+1]&240)===128||r[t]===244&&r[t+1]>143||r[t]>244)return!1;t+=4}else return!1;return!0}Fc.exports=Dp});var Qc=Ie((r1,oa)=>{"use strict";try{oa.exports=Xo()(__dirname)}catch{oa.exports=Uc()}});var Br=Ie((s1,En)=>{"use strict";var{isUtf8:Vc}=require("buffer"),{hasBlob:$p}=Tt(),qp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function jp(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function aa(r){let e=r.length,t=0;for(;t<e;)if((r[t]&128)===0)t++;else if((r[t]&224)===192){if(t+1===e||(r[t+1]&192)!==128||(r[t]&254)===192)return!1;t+=2}else if((r[t]&240)===224){if(t+2>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||r[t]===224&&(r[t+1]&224)===128||r[t]===237&&(r[t+1]&224)===160)return!1;t+=3}else if((r[t]&248)===240){if(t+3>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||(r[t+3]&192)!==128||r[t]===240&&(r[t+1]&240)===128||r[t]===244&&r[t+1]>143||r[t]>244)return!1;t+=4}else return!1;return!0}function Fp(r){return $p&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&(r[Symbol.toStringTag]==="Blob"||r[Symbol.toStringTag]==="File")}En.exports={isBlob:Fp,isValidStatusCode:jp,isValidUTF8:aa,tokenChars:qp};if(Vc)En.exports.isValidUTF8=function(r){return r.length<24?aa(r):Vc(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=Qc();En.exports.isValidUTF8=function(e){return e.length<32?aa(e):r(e)}}catch{}});var fa=Ie((n1,Jc)=>{"use strict";var{Writable:Up}=require("stream"),zc=Es(),{BINARY_TYPES:Qp,EMPTY_BUFFER:Wc,kStatusCode:Vp,kWebSocket:zp}=Tt(),{concat:la,toArrayBuffer:Wp,unmask:Kp}=ws(),{isValidStatusCode:Gp,isValidUTF8:Kc}=Br(),Tn=Buffer[Symbol.species],et=0,Gc=1,Zc=2,Hc=3,ua=4,ca=5,Cn=6,ha=class extends Up{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||Qp[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[zp]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=et}_write(e,t,s){if(this._opcode===8&&this._state==et)return s();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(s)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let s=this._buffers[0];return this._buffers[0]=new Tn(s.buffer,s.byteOffset+e,s.length-e),new Tn(s.buffer,s.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let s=this._buffers[0],n=t.length-e;e>=s.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(s.buffer,s.byteOffset,e),n),this._buffers[0]=new Tn(s.buffer,s.byteOffset+e,s.length-e)),e-=s.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case et:this.getInfo(e);break;case Gc:this.getPayloadLength16(e);break;case Zc:this.getPayloadLength64(e);break;case Hc:this.getMask();break;case ua:this.getData(e);break;case ca:case Cn:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0){let n=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(n);return}let s=(t[0]&64)===64;if(s&&!this._extensions[zc.extensionName]){let n=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(n);return}if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(s){let n=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(n);return}if(!this._fragmented){let n=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(n);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let n=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(n);return}this._compressed=s}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let n=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(n);return}if(s){let n=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(n);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let n=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(n);return}}else{let n=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(n);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked){let n=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(n);return}}else if(this._masked){let n=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(n);return}this._payloadLength===126?this._state=Gc:this._payloadLength===127?this._state=Zc:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),s=t.readUInt32BE(0);if(s>Math.pow(2,21)-1){let n=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(n);return}this._payloadLength=s*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let t=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(t);return}this._masked?this._state=Hc:this._state=ua}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=ua}getData(e){let t=Wc;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&Kp(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=ca,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[zc.extensionName].decompress(e,this._fin,(n,i)=>{if(n)return t(n);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");t(o);return}this._fragments.push(i)}this.dataMessage(t),this._state===et&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=et;return}let t=this._messageLength,s=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let n;this._binaryType==="nodebuffer"?n=la(s,t):this._binaryType==="arraybuffer"?n=Wp(la(s,t)):this._binaryType==="blob"?n=new Blob(s):n=s,this._allowSynchronousEvents?(this.emit("message",n,!0),this._state=et):(this._state=Cn,setImmediate(()=>{this.emit("message",n,!0),this._state=et,this.startLoop(e)}))}else{let n=la(s,t);if(!this._skipUTF8Validation&&!Kc(n)){let i=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(i);return}this._state===ca||this._allowSynchronousEvents?(this.emit("message",n,!1),this._state=et):(this._state=Cn,setImmediate(()=>{this.emit("message",n,!1),this._state=et,this.startLoop(e)}))}}controlMessage(e,t){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,Wc),this.end();else{let s=e.readUInt16BE(0);if(!Gp(s)){let i=this.createError(RangeError,`invalid status code ${s}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");t(i);return}let n=new Tn(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Kc(n)){let i=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");t(i);return}this._loop=!1,this.emit("conclude",s,n),this.end()}this._state=et;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=et):(this._state=Cn,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=et,this.startLoop(t)}))}createError(e,t,s,n,i){this._loop=!1,this._errored=!0;let o=new e(s?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,this.createError),o.code=i,o[Vp]=n,o}};Jc.exports=ha});var ma=Ie((o1,eh)=>{"use strict";var{Duplex:i1}=require("stream"),{randomFillSync:Zp}=require("crypto"),Yc=Es(),{EMPTY_BUFFER:Hp,kWebSocket:Jp,NOOP:Yp}=Tt(),{isBlob:Dr,isValidStatusCode:Xp}=Br(),{mask:Xc,toBuffer:ar}=ws(),tt=Symbol("kByteLength"),em=Buffer.alloc(4),Nn=8*1024,lr,$r=Nn,at=0,tm=1,rm=2,da=class r{constructor(e,t,s){this._extensions=t||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=at,this.onerror=Yp,this[Jp]=void 0}static frame(e,t){let s,n=!1,i=2,o=!1;t.mask&&(s=t.maskBuffer||em,t.generateMask?t.generateMask(s):($r===Nn&&(lr===void 0&&(lr=Buffer.alloc(Nn)),Zp(lr,0,Nn),$r=0),s[0]=lr[$r++],s[1]=lr[$r++],s[2]=lr[$r++],s[3]=lr[$r++]),o=(s[0]|s[1]|s[2]|s[3])===0,i=6);let a;typeof e=="string"?(!t.mask||o)&&t[tt]!==void 0?a=t[tt]:(e=Buffer.from(e),a=e.length):(a=e.length,n=t.mask&&t.readOnly&&!o);let c=a;a>=65536?(i+=8,c=127):a>125&&(i+=2,c=126);let d=Buffer.allocUnsafe(n?a+i:i);return d[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(d[0]|=64),d[1]=c,c===126?d.writeUInt16BE(a,2):c===127&&(d[2]=d[3]=0,d.writeUIntBE(a,4,6)),t.mask?(d[1]|=128,d[i-4]=s[0],d[i-3]=s[1],d[i-2]=s[2],d[i-1]=s[3],o?[d,e]:n?(Xc(e,s,d,i,a),[d]):(Xc(e,s,e,0,a),[d,e])):[d,e]}close(e,t,s,n){let i;if(e===void 0)i=Hp;else{if(typeof e!="number"||!Xp(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||!t.length)i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0);else{let a=Buffer.byteLength(t);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+a),i.writeUInt16BE(e,0),typeof t=="string"?i.write(t,2):i.set(t,2)}}let o={[tt]:i.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==at?this.enqueue([this.dispatch,i,!1,o,n]):this.sendFrame(r.frame(i,o),n)}ping(e,t,s){let n,i;if(typeof e=="string"?(n=Buffer.byteLength(e),i=!1):Dr(e)?(n=e.size,i=!1):(e=ar(e),n=e.length,i=ar.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[tt]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};Dr(e)?this._state!==at?this.enqueue([this.getBlobData,e,!1,o,s]):this.getBlobData(e,!1,o,s):this._state!==at?this.enqueue([this.dispatch,e,!1,o,s]):this.sendFrame(r.frame(e,o),s)}pong(e,t,s){let n,i;if(typeof e=="string"?(n=Buffer.byteLength(e),i=!1):Dr(e)?(n=e.size,i=!1):(e=ar(e),n=e.length,i=ar.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[tt]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};Dr(e)?this._state!==at?this.enqueue([this.getBlobData,e,!1,o,s]):this.getBlobData(e,!1,o,s):this._state!==at?this.enqueue([this.dispatch,e,!1,o,s]):this.sendFrame(r.frame(e,o),s)}send(e,t,s){let n=this._extensions[Yc.extensionName],i=t.binary?2:1,o=t.compress,a,c;typeof e=="string"?(a=Buffer.byteLength(e),c=!1):Dr(e)?(a=e.size,c=!1):(e=ar(e),a=e.length,c=ar.readOnly),this._firstFragment?(this._firstFragment=!1,o&&n&&n.params[n._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=a>=n._threshold),this._compress=o):(o=!1,i=0),t.fin&&(this._firstFragment=!0);let d={[tt]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:i,readOnly:c,rsv1:o};Dr(e)?this._state!==at?this.enqueue([this.getBlobData,e,this._compress,d,s]):this.getBlobData(e,this._compress,d,s):this._state!==at?this.enqueue([this.dispatch,e,this._compress,d,s]):this.dispatch(e,this._compress,d,s)}getBlobData(e,t,s,n){this._bufferedBytes+=s[tt],this._state=rm,e.arrayBuffer().then(i=>{if(this._socket.destroyed){let a=new Error("The socket was closed while the blob was being read");process.nextTick(pa,this,a,n);return}this._bufferedBytes-=s[tt];let o=ar(i);t?this.dispatch(o,t,s,n):(this._state=at,this.sendFrame(r.frame(o,s),n),this.dequeue())}).catch(i=>{process.nextTick(sm,this,i,n)})}dispatch(e,t,s,n){if(!t){this.sendFrame(r.frame(e,s),n);return}let i=this._extensions[Yc.extensionName];this._bufferedBytes+=s[tt],this._state=tm,i.compress(e,s.fin,(o,a)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");pa(this,c,n);return}this._bufferedBytes-=s[tt],this._state=at,s.readOnly=!1,this.sendFrame(r.frame(a,s),n),this.dequeue()})}dequeue(){for(;this._state===at&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][tt],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][tt],this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};eh.exports=da;function pa(r,e,t){typeof t=="function"&&t(e);for(let s=0;s<r._queue.length;s++){let n=r._queue[s],i=n[n.length-1];typeof i=="function"&&i(e)}}function sm(r,e,t){pa(r,e,t),r.onerror(e)}});var uh=Ie((a1,lh)=>{"use strict";var{kForOnEventAttribute:Ts,kListener:ga}=Tt(),th=Symbol("kCode"),rh=Symbol("kData"),sh=Symbol("kError"),nh=Symbol("kMessage"),ih=Symbol("kReason"),qr=Symbol("kTarget"),oh=Symbol("kType"),ah=Symbol("kWasClean"),At=class{constructor(e){this[qr]=null,this[oh]=e}get target(){return this[qr]}get type(){return this[oh]}};Object.defineProperty(At.prototype,"target",{enumerable:!0});Object.defineProperty(At.prototype,"type",{enumerable:!0});var ur=class extends At{constructor(e,t={}){super(e),this[th]=t.code===void 0?0:t.code,this[ih]=t.reason===void 0?"":t.reason,this[ah]=t.wasClean===void 0?!1:t.wasClean}get code(){return this[th]}get reason(){return this[ih]}get wasClean(){return this[ah]}};Object.defineProperty(ur.prototype,"code",{enumerable:!0});Object.defineProperty(ur.prototype,"reason",{enumerable:!0});Object.defineProperty(ur.prototype,"wasClean",{enumerable:!0});var jr=class extends At{constructor(e,t={}){super(e),this[sh]=t.error===void 0?null:t.error,this[nh]=t.message===void 0?"":t.message}get error(){return this[sh]}get message(){return this[nh]}};Object.defineProperty(jr.prototype,"error",{enumerable:!0});Object.defineProperty(jr.prototype,"message",{enumerable:!0});var Cs=class extends At{constructor(e,t={}){super(e),this[rh]=t.data===void 0?null:t.data}get data(){return this[rh]}};Object.defineProperty(Cs.prototype,"data",{enumerable:!0});var nm={addEventListener(r,e,t={}){for(let n of this.listeners(r))if(!t[Ts]&&n[ga]===e&&!n[Ts])return;let s;if(r==="message")s=function(i,o){let a=new Cs("message",{data:o?i:i.toString()});a[qr]=this,An(e,this,a)};else if(r==="close")s=function(i,o){let a=new ur("close",{code:i,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[qr]=this,An(e,this,a)};else if(r==="error")s=function(i){let o=new jr("error",{error:i,message:i.message});o[qr]=this,An(e,this,o)};else if(r==="open")s=function(){let i=new At("open");i[qr]=this,An(e,this,i)};else return;s[Ts]=!!t[Ts],s[ga]=e,t.once?this.once(r,s):this.on(r,s)},removeEventListener(r,e){for(let t of this.listeners(r))if(t[ga]===e&&!t[Ts]){this.removeListener(r,t);break}}};lh.exports={CloseEvent:ur,ErrorEvent:jr,Event:At,EventTarget:nm,MessageEvent:Cs};function An(r,e,t){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,t):r.call(e,t)}});var ya=Ie((l1,ch)=>{"use strict";var{tokenChars:Ns}=Br();function dt(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}function im(r){let e=Object.create(null),t=Object.create(null),s=!1,n=!1,i=!1,o,a,c=-1,d=-1,h=-1,p=0;for(;p<r.length;p++)if(d=r.charCodeAt(p),o===void 0)if(h===-1&&Ns[d]===1)c===-1&&(c=p);else if(p!==0&&(d===32||d===9))h===-1&&c!==-1&&(h=p);else if(d===59||d===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${p}`);h===-1&&(h=p);let _=r.slice(c,h);d===44?(dt(e,_,t),t=Object.create(null)):o=_,c=h=-1}else throw new SyntaxError(`Unexpected character at index ${p}`);else if(a===void 0)if(h===-1&&Ns[d]===1)c===-1&&(c=p);else if(d===32||d===9)h===-1&&c!==-1&&(h=p);else if(d===59||d===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${p}`);h===-1&&(h=p),dt(t,r.slice(c,h),!0),d===44&&(dt(e,o,t),t=Object.create(null),o=void 0),c=h=-1}else if(d===61&&c!==-1&&h===-1)a=r.slice(c,p),c=h=-1;else throw new SyntaxError(`Unexpected character at index ${p}`);else if(n){if(Ns[d]!==1)throw new SyntaxError(`Unexpected character at index ${p}`);c===-1?c=p:s||(s=!0),n=!1}else if(i)if(Ns[d]===1)c===-1&&(c=p);else if(d===34&&c!==-1)i=!1,h=p;else if(d===92)n=!0;else throw new SyntaxError(`Unexpected character at index ${p}`);else if(d===34&&r.charCodeAt(p-1)===61)i=!0;else if(h===-1&&Ns[d]===1)c===-1&&(c=p);else if(c!==-1&&(d===32||d===9))h===-1&&(h=p);else if(d===59||d===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${p}`);h===-1&&(h=p);let _=r.slice(c,h);s&&(_=_.replace(/\\/g,""),s=!1),dt(t,a,_),d===44&&(dt(e,o,t),t=Object.create(null),o=void 0),a=void 0,c=h=-1}else throw new SyntaxError(`Unexpected character at index ${p}`);if(c===-1||i||d===32||d===9)throw new SyntaxError("Unexpected end of input");h===-1&&(h=p);let b=r.slice(c,h);return o===void 0?dt(e,b,t):(a===void 0?dt(t,b,!0):s?dt(t,a,b.replace(/\\/g,"")):dt(t,a,b),dt(e,o,t)),e}function om(r){return Object.keys(r).map(e=>{let t=r[e];return Array.isArray(t)||(t=[t]),t.map(s=>[e].concat(Object.keys(s).map(n=>{let i=s[n];return Array.isArray(i)||(i=[i]),i.map(o=>o===!0?n:`${n}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}ch.exports={format:om,parse:im}});var Sa=Ie((h1,Sh)=>{"use strict";var am=require("events"),lm=require("https"),um=require("http"),dh=require("net"),cm=require("tls"),{randomBytes:hm,createHash:fm}=require("crypto"),{Duplex:u1,Readable:c1}=require("stream"),{URL:ba}=require("url"),$t=Es(),dm=fa(),pm=ma(),{isBlob:mm}=Br(),{BINARY_TYPES:hh,EMPTY_BUFFER:Pn,GUID:gm,kForOnEventAttribute:va,kListener:ym,kStatusCode:bm,kWebSocket:Me,NOOP:ph}=Tt(),{EventTarget:{addEventListener:vm,removeEventListener:_m}}=uh(),{format:wm,parse:Sm}=ya(),{toBuffer:xm}=ws(),Em=30*1e3,mh=Symbol("kAborted"),_a=[8,13],Pt=["CONNECTING","OPEN","CLOSING","CLOSED"],Tm=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,_e=class r extends am{constructor(e,t,s){super(),this._binaryType=hh[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Pn,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=r.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,t===void 0?t=[]:Array.isArray(t)||(typeof t=="object"&&t!==null?(s=t,t=[]):t=[t]),gh(this,e,t,s)):(this._autoPong=s.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){hh.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,s){let n=new dm({allowSynchronousEvents:s.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation}),i=new pm(e,this._extensions,s.generateMask);this._receiver=n,this._sender=i,this._socket=e,n[Me]=this,i[Me]=this,e[Me]=this,n.on("conclude",Am),n.on("drain",Pm),n.on("error",km),n.on("message",Im),n.on("ping",Om),n.on("pong",Lm),i.onerror=Rm,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",vh),e.on("data",In),e.on("end",_h),e.on("error",wh),this._readyState=r.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[$t.extensionName]&&this._extensions[$t.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){Ze(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===r.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=r.CLOSING,this._sender.close(e,t,!this._isServer,s=>{s||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),bh(this)}}pause(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,t,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(s=e,e=t=void 0):typeof t=="function"&&(s=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){wa(this,e,s);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||Pn,t,s)}pong(e,t,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(s=e,e=t=void 0):typeof t=="function"&&(s=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){wa(this,e,s);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||Pn,t,s)}resume(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(s=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){wa(this,e,s);return}let n={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[$t.extensionName]||(n.compress=!1),this._sender.send(e||Pn,n,s)}terminate(){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){Ze(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=r.CLOSING,this._socket.destroy())}}};Object.defineProperty(_e,"CONNECTING",{enumerable:!0,value:Pt.indexOf("CONNECTING")});Object.defineProperty(_e.prototype,"CONNECTING",{enumerable:!0,value:Pt.indexOf("CONNECTING")});Object.defineProperty(_e,"OPEN",{enumerable:!0,value:Pt.indexOf("OPEN")});Object.defineProperty(_e.prototype,"OPEN",{enumerable:!0,value:Pt.indexOf("OPEN")});Object.defineProperty(_e,"CLOSING",{enumerable:!0,value:Pt.indexOf("CLOSING")});Object.defineProperty(_e.prototype,"CLOSING",{enumerable:!0,value:Pt.indexOf("CLOSING")});Object.defineProperty(_e,"CLOSED",{enumerable:!0,value:Pt.indexOf("CLOSED")});Object.defineProperty(_e.prototype,"CLOSED",{enumerable:!0,value:Pt.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(_e.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(_e.prototype,`on${r}`,{enumerable:!0,get(){for(let e of this.listeners(r))if(e[va])return e[ym];return null},set(e){for(let t of this.listeners(r))if(t[va]){this.removeListener(r,t);break}typeof e=="function"&&this.addEventListener(r,e,{[va]:!0})}})});_e.prototype.addEventListener=vm;_e.prototype.removeEventListener=_m;Sh.exports=_e;function gh(r,e,t,s){let n={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:_a[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(r._autoPong=n.autoPong,!_a.includes(n.protocolVersion))throw new RangeError(`Unsupported protocol version: ${n.protocolVersion} (supported versions: ${_a.join(", ")})`);let i;if(e instanceof ba)i=e;else try{i=new ba(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}i.protocol==="http:"?i.protocol="ws:":i.protocol==="https:"&&(i.protocol="wss:"),r._url=i.href;let o=i.protocol==="wss:",a=i.protocol==="ws+unix:",c;if(i.protocol!=="ws:"&&!o&&!a?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:a&&!i.pathname?c="The URL's pathname is empty":i.hash&&(c="The URL contains a fragment identifier"),c){let u=new SyntaxError(c);if(r._redirects===0)throw u;kn(r,u);return}let d=o?443:80,h=hm(16).toString("base64"),p=o?lm.request:um.request,b=new Set,_;if(n.createConnection=n.createConnection||(o?Nm:Cm),n.defaultPort=n.defaultPort||d,n.port=i.port||d,n.host=i.hostname.startsWith("[")?i.hostname.slice(1,-1):i.hostname,n.headers={...n.headers,"Sec-WebSocket-Version":n.protocolVersion,"Sec-WebSocket-Key":h,Connection:"Upgrade",Upgrade:"websocket"},n.path=i.pathname+i.search,n.timeout=n.handshakeTimeout,n.perMessageDeflate&&(_=new $t(n.perMessageDeflate!==!0?n.perMessageDeflate:{},!1,n.maxPayload),n.headers["Sec-WebSocket-Extensions"]=wm({[$t.extensionName]:_.offer()})),t.length){for(let u of t){if(typeof u!="string"||!Tm.test(u)||b.has(u))throw new SyntaxError("An invalid or duplicated subprotocol was specified");b.add(u)}n.headers["Sec-WebSocket-Protocol"]=t.join(",")}if(n.origin&&(n.protocolVersion<13?n.headers["Sec-WebSocket-Origin"]=n.origin:n.headers.Origin=n.origin),(i.username||i.password)&&(n.auth=`${i.username}:${i.password}`),a){let u=n.path.split(":");n.socketPath=u[0],n.path=u[1]}let g;if(n.followRedirects){if(r._redirects===0){r._originalIpc=a,r._originalSecure=o,r._originalHostOrSocketPath=a?n.socketPath:i.host;let u=s&&s.headers;if(s={...s,headers:{}},u)for(let[v,w]of Object.entries(u))s.headers[v.toLowerCase()]=w}else if(r.listenerCount("redirect")===0){let u=a?r._originalIpc?n.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:i.host===r._originalHostOrSocketPath;(!u||r._originalSecure&&!o)&&(delete n.headers.authorization,delete n.headers.cookie,u||delete n.headers.host,n.auth=void 0)}n.auth&&!s.headers.authorization&&(s.headers.authorization="Basic "+Buffer.from(n.auth).toString("base64")),g=r._req=p(n),r._redirects&&r.emit("redirect",r.url,g)}else g=r._req=p(n);n.timeout&&g.on("timeout",()=>{Ze(r,g,"Opening handshake has timed out")}),g.on("error",u=>{g===null||g[mh]||(g=r._req=null,kn(r,u))}),g.on("response",u=>{let v=u.headers.location,w=u.statusCode;if(v&&n.followRedirects&&w>=300&&w<400){if(++r._redirects>n.maxRedirects){Ze(r,g,"Maximum redirects exceeded");return}g.abort();let S;try{S=new ba(v,e)}catch{let O=new SyntaxError(`Invalid URL: ${v}`);kn(r,O);return}gh(r,S,t,s)}else r.emit("unexpected-response",g,u)||Ze(r,g,`Unexpected server response: ${u.statusCode}`)}),g.on("upgrade",(u,v,w)=>{if(r.emit("upgrade",u),r.readyState!==_e.CONNECTING)return;g=r._req=null;let S=u.headers.upgrade;if(S===void 0||S.toLowerCase()!=="websocket"){Ze(r,v,"Invalid Upgrade header");return}let E=fm("sha1").update(h+gm).digest("base64");if(u.headers["sec-websocket-accept"]!==E){Ze(r,v,"Invalid Sec-WebSocket-Accept header");return}let O=u.headers["sec-websocket-protocol"],L;if(O!==void 0?b.size?b.has(O)||(L="Server sent an invalid subprotocol"):L="Server sent a subprotocol but none was requested":b.size&&(L="Server sent no subprotocol"),L){Ze(r,v,L);return}O&&(r._protocol=O);let x=u.headers["sec-websocket-extensions"];if(x!==void 0){if(!_){Ze(r,v,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let k;try{k=Sm(x)}catch{Ze(r,v,"Invalid Sec-WebSocket-Extensions header");return}let P=Object.keys(k);if(P.length!==1||P[0]!==$t.extensionName){Ze(r,v,"Server indicated an extension that was not requested");return}try{_.accept(k[$t.extensionName])}catch{Ze(r,v,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[$t.extensionName]=_}r.setSocket(v,w,{allowSynchronousEvents:n.allowSynchronousEvents,generateMask:n.generateMask,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation})}),n.finishRequest?n.finishRequest(g,r):g.end()}function kn(r,e){r._readyState=_e.CLOSING,r._errorEmitted=!0,r.emit("error",e),r.emitClose()}function Cm(r){return r.path=r.socketPath,dh.connect(r)}function Nm(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=dh.isIP(r.host)?"":r.host),cm.connect(r)}function Ze(r,e,t){r._readyState=_e.CLOSING;let s=new Error(t);Error.captureStackTrace(s,Ze),e.setHeader?(e[mh]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(kn,r,s)):(e.destroy(s),e.once("error",r.emit.bind(r,"error")),e.once("close",r.emitClose.bind(r)))}function wa(r,e,t){if(e){let s=mm(e)?e.size:xm(e).length;r._socket?r._sender._bufferedBytes+=s:r._bufferedAmount+=s}if(t){let s=new Error(`WebSocket is not open: readyState ${r.readyState} (${Pt[r.readyState]})`);process.nextTick(t,s)}}function Am(r,e){let t=this[Me];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=r,t._socket[Me]!==void 0&&(t._socket.removeListener("data",In),process.nextTick(yh,t._socket),r===1005?t.close():t.close(r,e))}function Pm(){let r=this[Me];r.isPaused||r._socket.resume()}function km(r){let e=this[Me];e._socket[Me]!==void 0&&(e._socket.removeListener("data",In),process.nextTick(yh,e._socket),e.close(r[bm])),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",r))}function fh(){this[Me].emitClose()}function Im(r,e){this[Me].emit("message",r,e)}function Om(r){let e=this[Me];e._autoPong&&e.pong(r,!this._isServer,ph),e.emit("ping",r)}function Lm(r){this[Me].emit("pong",r)}function yh(r){r.resume()}function Rm(r){let e=this[Me];e.readyState!==_e.CLOSED&&(e.readyState===_e.OPEN&&(e._readyState=_e.CLOSING,bh(e)),this._socket.end(),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",r)))}function bh(r){r._closeTimer=setTimeout(r._socket.destroy.bind(r._socket),Em)}function vh(){let r=this[Me];this.removeListener("close",vh),this.removeListener("data",In),this.removeListener("end",_h),r._readyState=_e.CLOSING;let e;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(e=r._socket.read())!==null&&r._receiver.write(e),r._receiver.end(),this[Me]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",fh),r._receiver.on("finish",fh))}function In(r){this[Me]._receiver.write(r)||this.pause()}function _h(){let r=this[Me];r._readyState=_e.CLOSING,r._receiver.end(),this.end()}function wh(){let r=this[Me];this.removeListener("error",wh),this.on("error",ph),r&&(r._readyState=_e.CLOSING,this.destroy())}});var Eh=Ie((f1,xh)=>{"use strict";var{tokenChars:Mm}=Br();function Bm(r){let e=new Set,t=-1,s=-1,n=0;for(n;n<r.length;n++){let o=r.charCodeAt(n);if(s===-1&&Mm[o]===1)t===-1&&(t=n);else if(n!==0&&(o===32||o===9))s===-1&&t!==-1&&(s=n);else if(o===44){if(t===-1)throw new SyntaxError(`Unexpected character at index ${n}`);s===-1&&(s=n);let a=r.slice(t,s);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),t=s=-1}else throw new SyntaxError(`Unexpected character at index ${n}`)}if(t===-1||s!==-1)throw new SyntaxError("Unexpected end of input");let i=r.slice(t,n);if(e.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);return e.add(i),e}xh.exports={parse:Bm}});var Ih=Ie((p1,kh)=>{"use strict";var Dm=require("events"),On=require("http"),{Duplex:d1}=require("stream"),{createHash:$m}=require("crypto"),Th=ya(),cr=Es(),qm=Eh(),jm=Sa(),{GUID:Fm,kWebSocket:Um}=Tt(),Qm=/^[+/0-9A-Za-z]{22}==$/,Ch=0,Nh=1,Ph=2,xa=class extends Dm{constructor(e,t){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:jm,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=On.createServer((s,n)=>{let i=On.STATUS_CODES[426];n.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),n.end(i)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=Vm(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(n,i,o)=>{this.handleUpgrade(n,i,o,s)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=Ch}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===Ph){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(As,this);return}if(e&&this.once("close",e),this._state!==Nh)if(this._state=Nh,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(As,this):process.nextTick(As,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{As(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,s,n){t.on("error",Ah);let i=e.headers["sec-websocket-key"],o=e.headers.upgrade,a=+e.headers["sec-websocket-version"];if(e.method!=="GET"){hr(this,e,t,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){hr(this,e,t,400,"Invalid Upgrade header");return}if(i===void 0||!Qm.test(i)){hr(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(a!==8&&a!==13){hr(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Ps(t,400);return}let c=e.headers["sec-websocket-protocol"],d=new Set;if(c!==void 0)try{d=qm.parse(c)}catch{hr(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let h=e.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&h!==void 0){let b=new cr(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let _=Th.parse(h);_[cr.extensionName]&&(b.accept(_[cr.extensionName]),p[cr.extensionName]=b)}catch{hr(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let b={origin:e.headers[`${a===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(b,(_,g,u,v)=>{if(!_)return Ps(t,g||401,u,v);this.completeUpgrade(p,i,d,e,t,s,n)});return}if(!this.options.verifyClient(b))return Ps(t,401)}this.completeUpgrade(p,i,d,e,t,s,n)}completeUpgrade(e,t,s,n,i,o,a){if(!i.readable||!i.writable)return i.destroy();if(i[Um])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>Ch)return Ps(i,503);let d=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${$m("sha1").update(t+Fm).digest("base64")}`],h=new this.options.WebSocket(null,void 0,this.options);if(s.size){let p=this.options.handleProtocols?this.options.handleProtocols(s,n):s.values().next().value;p&&(d.push(`Sec-WebSocket-Protocol: ${p}`),h._protocol=p)}if(e[cr.extensionName]){let p=e[cr.extensionName].params,b=Th.format({[cr.extensionName]:[p]});d.push(`Sec-WebSocket-Extensions: ${b}`),h._extensions=e}this.emit("headers",d,n),i.write(d.concat(`\r
`).join(`\r
`)),i.removeListener("error",Ah),h.setSocket(i,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(h),h.on("close",()=>{this.clients.delete(h),this._shouldEmitClose&&!this.clients.size&&process.nextTick(As,this)})),a(h,n)}};kh.exports=xa;function Vm(r,e){for(let t of Object.keys(e))r.on(t,e[t]);return function(){for(let s of Object.keys(e))r.removeListener(s,e[s])}}function As(r){r._state=Ph,r.emit("close")}function Ah(){this.destroy()}function Ps(r,e,t,s){t=t||On.STATUS_CODES[e],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...s},r.once("finish",r.destroy),r.end(`HTTP/1.1 ${e} ${On.STATUS_CODES[e]}\r
`+Object.keys(s).map(n=>`${n}: ${s[n]}`).join(`\r
`)+`\r
\r
`+t)}function hr(r,e,t,s,n){if(r.listenerCount("wsClientError")){let i=new Error(n);Error.captureStackTrace(i,hr),r.emit("wsClientError",i,t,e)}else Ps(t,s,n)}});var Hm={};Qh(Hm,{handler:()=>Zm});module.exports=Vh(Hm);var zh=Object.create,mr=Object.defineProperty,Wh=Object.getOwnPropertyDescriptor,Kh=Object.getOwnPropertyNames,Gh=Object.getPrototypeOf,Zh=Object.prototype.hasOwnProperty,Hh=(r,e,t)=>e in r?mr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,y=(r,e)=>mr(r,"name",{value:e,configurable:!0}),Ue=(r,e)=>()=>(r&&(e=r(r=0)),e),ue=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),st=(r,e)=>{for(var t in e)mr(r,t,{get:e[t],enumerable:!0})},La=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Kh(e))!Zh.call(r,n)&&n!==t&&mr(r,n,{get:()=>e[n],enumerable:!(s=Wh(e,n))||s.enumerable});return r},gr=(r,e,t)=>(t=r!=null?zh(Gh(r)):{},La(e||!r||!r.__esModule?mr(t,"default",{value:r,enumerable:!0}):t,r)),Le=r=>La(mr({},"__esModule",{value:!0}),r),se=(r,e,t)=>Hh(r,typeof e!="symbol"?e+"":e,t),Jh=ue(r=>{"use strict";Y(),r.byteLength=c,r.toByteArray=h,r.fromByteArray=_;var e=[],t=[],s=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(i=0,o=n.length;i<o;++i)e[i]=n[i],t[n.charCodeAt(i)]=i;var i,o;t[45]=62,t[95]=63;function a(g){var u=g.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=g.indexOf("=");v===-1&&(v=u);var w=v===u?0:4-v%4;return[v,w]}y(a,"getLens");function c(g){var u=a(g),v=u[0],w=u[1];return(v+w)*3/4-w}y(c,"byteLength");function d(g,u,v){return(u+v)*3/4-v}y(d,"_byteLength");function h(g){var u,v=a(g),w=v[0],S=v[1],E=new s(d(g,w,S)),O=0,L=S>0?w-4:w,x;for(x=0;x<L;x+=4)u=t[g.charCodeAt(x)]<<18|t[g.charCodeAt(x+1)]<<12|t[g.charCodeAt(x+2)]<<6|t[g.charCodeAt(x+3)],E[O++]=u>>16&255,E[O++]=u>>8&255,E[O++]=u&255;return S===2&&(u=t[g.charCodeAt(x)]<<2|t[g.charCodeAt(x+1)]>>4,E[O++]=u&255),S===1&&(u=t[g.charCodeAt(x)]<<10|t[g.charCodeAt(x+1)]<<4|t[g.charCodeAt(x+2)]>>2,E[O++]=u>>8&255,E[O++]=u&255),E}y(h,"toByteArray");function p(g){return e[g>>18&63]+e[g>>12&63]+e[g>>6&63]+e[g&63]}y(p,"tripletToBase64");function b(g,u,v){for(var w,S=[],E=u;E<v;E+=3)w=(g[E]<<16&16711680)+(g[E+1]<<8&65280)+(g[E+2]&255),S.push(p(w));return S.join("")}y(b,"encodeChunk");function _(g){for(var u,v=g.length,w=v%3,S=[],E=16383,O=0,L=v-w;O<L;O+=E)S.push(b(g,O,O+E>L?L:O+E));return w===1?(u=g[v-1],S.push(e[u>>2]+e[u<<4&63]+"==")):w===2&&(u=(g[v-2]<<8)+g[v-1],S.push(e[u>>10]+e[u>>4&63]+e[u<<2&63]+"=")),S.join("")}y(_,"fromByteArray")}),Yh=ue(r=>{Y(),r.read=function(e,t,s,n,i){var o,a,c=i*8-n-1,d=(1<<c)-1,h=d>>1,p=-7,b=s?i-1:0,_=s?-1:1,g=e[t+b];for(b+=_,o=g&(1<<-p)-1,g>>=-p,p+=c;p>0;o=o*256+e[t+b],b+=_,p-=8);for(a=o&(1<<-p)-1,o>>=-p,p+=n;p>0;a=a*256+e[t+b],b+=_,p-=8);if(o===0)o=1-h;else{if(o===d)return a?NaN:(g?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-h}return(g?-1:1)*a*Math.pow(2,o-n)},r.write=function(e,t,s,n,i,o){var a,c,d,h=o*8-i-1,p=(1<<h)-1,b=p>>1,_=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:o-1,u=n?1:-1,v=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,a=p):(a=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-a))<1&&(a--,d*=2),a+b>=1?t+=_/d:t+=_*Math.pow(2,1-b),t*d>=2&&(a++,d/=2),a+b>=p?(c=0,a=p):a+b>=1?(c=(t*d-1)*Math.pow(2,i),a=a+b):(c=t*Math.pow(2,b-1)*Math.pow(2,i),a=0));i>=8;e[s+g]=c&255,g+=u,c/=256,i-=8);for(a=a<<i|c,h+=i;h>0;e[s+g]=a&255,g+=u,a/=256,h-=8);e[s+g-u]|=v*128}}),Xh=ue(r=>{"use strict";Y();var e=Jh(),t=Yh(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=a,r.SlowBuffer=S,r.INSPECT_MAX_BYTES=50;var n=2147483647;r.kMaxLength=n,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{let l=new Uint8Array(1),f={foo:y(function(){return 42},"foo")};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(l,f),l.foo()===42}catch{return!1}}y(i,"typedArraySupport"),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:y(function(){if(a.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:y(function(){if(a.isBuffer(this))return this.byteOffset},"get")});function o(l){if(l>n)throw new RangeError('The value "'+l+'" is invalid for option "size"');let f=new Uint8Array(l);return Object.setPrototypeOf(f,a.prototype),f}y(o,"createBuffer");function a(l,f,m){if(typeof l=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(l)}return c(l,f,m)}y(a,"Buffer"),a.poolSize=8192;function c(l,f,m){if(typeof l=="string")return b(l,f);if(ArrayBuffer.isView(l))return g(l);if(l==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l);if(rt(l,ArrayBuffer)||l&&rt(l.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(rt(l,SharedArrayBuffer)||l&&rt(l.buffer,SharedArrayBuffer)))return u(l,f,m);if(typeof l=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let N=l.valueOf&&l.valueOf();if(N!=null&&N!==l)return a.from(N,f,m);let I=v(l);if(I)return I;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof l[Symbol.toPrimitive]=="function")return a.from(l[Symbol.toPrimitive]("string"),f,m);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l)}y(c,"from"),a.from=function(l,f,m){return c(l,f,m)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function d(l){if(typeof l!="number")throw new TypeError('"size" argument must be of type number');if(l<0)throw new RangeError('The value "'+l+'" is invalid for option "size"')}y(d,"assertSize");function h(l,f,m){return d(l),l<=0?o(l):f!==void 0?typeof m=="string"?o(l).fill(f,m):o(l).fill(f):o(l)}y(h,"alloc"),a.alloc=function(l,f,m){return h(l,f,m)};function p(l){return d(l),o(l<0?0:w(l)|0)}y(p,"allocUnsafe"),a.allocUnsafe=function(l){return p(l)},a.allocUnsafeSlow=function(l){return p(l)};function b(l,f){if((typeof f!="string"||f==="")&&(f="utf8"),!a.isEncoding(f))throw new TypeError("Unknown encoding: "+f);let m=E(l,f)|0,N=o(m),I=N.write(l,f);return I!==m&&(N=N.slice(0,I)),N}y(b,"fromString");function _(l){let f=l.length<0?0:w(l.length)|0,m=o(f);for(let N=0;N<f;N+=1)m[N]=l[N]&255;return m}y(_,"fromArrayLike");function g(l){if(rt(l,Uint8Array)){let f=new Uint8Array(l);return u(f.buffer,f.byteOffset,f.byteLength)}return _(l)}y(g,"fromArrayView");function u(l,f,m){if(f<0||l.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(l.byteLength<f+(m||0))throw new RangeError('"length" is outside of buffer bounds');let N;return f===void 0&&m===void 0?N=new Uint8Array(l):m===void 0?N=new Uint8Array(l,f):N=new Uint8Array(l,f,m),Object.setPrototypeOf(N,a.prototype),N}y(u,"fromArrayBuffer");function v(l){if(a.isBuffer(l)){let f=w(l.length)|0,m=o(f);return m.length===0||l.copy(m,0,0,f),m}if(l.length!==void 0)return typeof l.length!="number"||Os(l.length)?o(0):_(l);if(l.type==="Buffer"&&Array.isArray(l.data))return _(l.data)}y(v,"fromObject");function w(l){if(l>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return l|0}y(w,"checked");function S(l){return+l!=l&&(l=0),a.alloc(+l)}y(S,"SlowBuffer"),a.isBuffer=y(function(l){return l!=null&&l._isBuffer===!0&&l!==a.prototype},"isBuffer"),a.compare=y(function(l,f){if(rt(l,Uint8Array)&&(l=a.from(l,l.offset,l.byteLength)),rt(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),!a.isBuffer(l)||!a.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(l===f)return 0;let m=l.length,N=f.length;for(let I=0,$=Math.min(m,N);I<$;++I)if(l[I]!==f[I]){m=l[I],N=f[I];break}return m<N?-1:N<m?1:0},"compare"),a.isEncoding=y(function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),a.concat=y(function(l,f){if(!Array.isArray(l))throw new TypeError('"list" argument must be an Array of Buffers');if(l.length===0)return a.alloc(0);let m;if(f===void 0)for(f=0,m=0;m<l.length;++m)f+=l[m].length;let N=a.allocUnsafe(f),I=0;for(m=0;m<l.length;++m){let $=l[m];if(rt($,Uint8Array))I+$.length>N.length?(a.isBuffer($)||($=a.from($)),$.copy(N,I)):Uint8Array.prototype.set.call(N,$,I);else if(a.isBuffer($))$.copy(N,I);else throw new TypeError('"list" argument must be an Array of Buffers');I+=$.length}return N},"concat");function E(l,f){if(a.isBuffer(l))return l.length;if(ArrayBuffer.isView(l)||rt(l,ArrayBuffer))return l.byteLength;if(typeof l!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof l);let m=l.length,N=arguments.length>2&&arguments[2]===!0;if(!N&&m===0)return 0;let I=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return m;case"utf8":case"utf-8":return Is(l).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m*2;case"hex":return m>>>1;case"base64":return Dn(l).length;default:if(I)return N?-1:Is(l).length;f=(""+f).toLowerCase(),I=!0}}y(E,"byteLength"),a.byteLength=E;function O(l,f,m){let N=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((m===void 0||m>this.length)&&(m=this.length),m<=0)||(m>>>=0,f>>>=0,m<=f))return"";for(l||(l="utf8");;)switch(l){case"hex":return pe(this,f,m);case"utf8":case"utf-8":return R(this,f,m);case"ascii":return ne(this,f,m);case"latin1":case"binary":return fe(this,f,m);case"base64":return K(this,f,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ke(this,f,m);default:if(N)throw new TypeError("Unknown encoding: "+l);l=(l+"").toLowerCase(),N=!0}}y(O,"slowToString"),a.prototype._isBuffer=!0;function L(l,f,m){let N=l[f];l[f]=l[m],l[m]=N}y(L,"swap"),a.prototype.swap16=y(function(){let l=this.length;if(l%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<l;f+=2)L(this,f,f+1);return this},"swap16"),a.prototype.swap32=y(function(){let l=this.length;if(l%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<l;f+=4)L(this,f,f+3),L(this,f+1,f+2);return this},"swap32"),a.prototype.swap64=y(function(){let l=this.length;if(l%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<l;f+=8)L(this,f,f+7),L(this,f+1,f+6),L(this,f+2,f+5),L(this,f+3,f+4);return this},"swap64"),a.prototype.toString=y(function(){let l=this.length;return l===0?"":arguments.length===0?R(this,0,l):O.apply(this,arguments)},"toString"),a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=y(function(l){if(!a.isBuffer(l))throw new TypeError("Argument must be a Buffer");return this===l?!0:a.compare(this,l)===0},"equals"),a.prototype.inspect=y(function(){let l="",f=r.INSPECT_MAX_BYTES;return l=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(l+=" ... "),"<Buffer "+l+">"},"inspect"),s&&(a.prototype[s]=a.prototype.inspect),a.prototype.compare=y(function(l,f,m,N,I){if(rt(l,Uint8Array)&&(l=a.from(l,l.offset,l.byteLength)),!a.isBuffer(l))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof l);if(f===void 0&&(f=0),m===void 0&&(m=l?l.length:0),N===void 0&&(N=0),I===void 0&&(I=this.length),f<0||m>l.length||N<0||I>this.length)throw new RangeError("out of range index");if(N>=I&&f>=m)return 0;if(N>=I)return-1;if(f>=m)return 1;if(f>>>=0,m>>>=0,N>>>=0,I>>>=0,this===l)return 0;let $=I-N,j=m-f,ye=Math.min($,j),Oe=this.slice(N,I),ve=l.slice(f,m);for(let be=0;be<ye;++be)if(Oe[be]!==ve[be]){$=Oe[be],j=ve[be];break}return $<j?-1:j<$?1:0},"compare");function x(l,f,m,N,I){if(l.length===0)return-1;if(typeof m=="string"?(N=m,m=0):m>2147483647?m=2147483647:m<-2147483648&&(m=-2147483648),m=+m,Os(m)&&(m=I?0:l.length-1),m<0&&(m=l.length+m),m>=l.length){if(I)return-1;m=l.length-1}else if(m<0)if(I)m=0;else return-1;if(typeof f=="string"&&(f=a.from(f,N)),a.isBuffer(f))return f.length===0?-1:k(l,f,m,N,I);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?I?Uint8Array.prototype.indexOf.call(l,f,m):Uint8Array.prototype.lastIndexOf.call(l,f,m):k(l,[f],m,N,I);throw new TypeError("val must be string, number or Buffer")}y(x,"bidirectionalIndexOf");function k(l,f,m,N,I){let $=1,j=l.length,ye=f.length;if(N!==void 0&&(N=String(N).toLowerCase(),N==="ucs2"||N==="ucs-2"||N==="utf16le"||N==="utf-16le")){if(l.length<2||f.length<2)return-1;$=2,j/=2,ye/=2,m/=2}function Oe(be,Ce){return $===1?be[Ce]:be.readUInt16BE(Ce*$)}y(Oe,"read");let ve;if(I){let be=-1;for(ve=m;ve<j;ve++)if(Oe(l,ve)===Oe(f,be===-1?0:ve-be)){if(be===-1&&(be=ve),ve-be+1===ye)return be*$}else be!==-1&&(ve-=ve-be),be=-1}else for(m+ye>j&&(m=j-ye),ve=m;ve>=0;ve--){let be=!0;for(let Ce=0;Ce<ye;Ce++)if(Oe(l,ve+Ce)!==Oe(f,Ce)){be=!1;break}if(be)return ve}return-1}y(k,"arrayIndexOf"),a.prototype.includes=y(function(l,f,m){return this.indexOf(l,f,m)!==-1},"includes"),a.prototype.indexOf=y(function(l,f,m){return x(this,l,f,m,!0)},"indexOf"),a.prototype.lastIndexOf=y(function(l,f,m){return x(this,l,f,m,!1)},"lastIndexOf");function P(l,f,m,N){m=Number(m)||0;let I=l.length-m;N?(N=Number(N),N>I&&(N=I)):N=I;let $=f.length;N>$/2&&(N=$/2);let j;for(j=0;j<N;++j){let ye=parseInt(f.substr(j*2,2),16);if(Os(ye))return j;l[m+j]=ye}return j}y(P,"hexWrite");function C(l,f,m,N){return Qr(Is(f,l.length-m),l,m,N)}y(C,"utf8Write");function B(l,f,m,N){return Qr(Ca(f),l,m,N)}y(B,"asciiWrite");function M(l,f,m,N){return Qr(Dn(f),l,m,N)}y(M,"base64Write");function W(l,f,m,N){return Qr(Na(f,l.length-m),l,m,N)}y(W,"ucs2Write"),a.prototype.write=y(function(l,f,m,N){if(f===void 0)N="utf8",m=this.length,f=0;else if(m===void 0&&typeof f=="string")N=f,m=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(m)?(m=m>>>0,N===void 0&&(N="utf8")):(N=m,m=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let I=this.length-f;if((m===void 0||m>I)&&(m=I),l.length>0&&(m<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");N||(N="utf8");let $=!1;for(;;)switch(N){case"hex":return P(this,l,f,m);case"utf8":case"utf-8":return C(this,l,f,m);case"ascii":case"latin1":case"binary":return B(this,l,f,m);case"base64":return M(this,l,f,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,l,f,m);default:if($)throw new TypeError("Unknown encoding: "+N);N=(""+N).toLowerCase(),$=!0}},"write"),a.prototype.toJSON=y(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function K(l,f,m){return f===0&&m===l.length?e.fromByteArray(l):e.fromByteArray(l.slice(f,m))}y(K,"base64Slice");function R(l,f,m){m=Math.min(l.length,m);let N=[],I=f;for(;I<m;){let $=l[I],j=null,ye=$>239?4:$>223?3:$>191?2:1;if(I+ye<=m){let Oe,ve,be,Ce;switch(ye){case 1:$<128&&(j=$);break;case 2:Oe=l[I+1],(Oe&192)===128&&(Ce=($&31)<<6|Oe&63,Ce>127&&(j=Ce));break;case 3:Oe=l[I+1],ve=l[I+2],(Oe&192)===128&&(ve&192)===128&&(Ce=($&15)<<12|(Oe&63)<<6|ve&63,Ce>2047&&(Ce<55296||Ce>57343)&&(j=Ce));break;case 4:Oe=l[I+1],ve=l[I+2],be=l[I+3],(Oe&192)===128&&(ve&192)===128&&(be&192)===128&&(Ce=($&15)<<18|(Oe&63)<<12|(ve&63)<<6|be&63,Ce>65535&&Ce<1114112&&(j=Ce))}}j===null?(j=65533,ye=1):j>65535&&(j-=65536,N.push(j>>>10&1023|55296),j=56320|j&1023),N.push(j),I+=ye}return J(N)}y(R,"utf8Slice");var U=4096;function J(l){let f=l.length;if(f<=U)return String.fromCharCode.apply(String,l);let m="",N=0;for(;N<f;)m+=String.fromCharCode.apply(String,l.slice(N,N+=U));return m}y(J,"decodeCodePointsArray");function ne(l,f,m){let N="";m=Math.min(l.length,m);for(let I=f;I<m;++I)N+=String.fromCharCode(l[I]&127);return N}y(ne,"asciiSlice");function fe(l,f,m){let N="";m=Math.min(l.length,m);for(let I=f;I<m;++I)N+=String.fromCharCode(l[I]);return N}y(fe,"latin1Slice");function pe(l,f,m){let N=l.length;(!f||f<0)&&(f=0),(!m||m<0||m>N)&&(m=N);let I="";for(let $=f;$<m;++$)I+=Dh[l[$]];return I}y(pe,"hexSlice");function ke(l,f,m){let N=l.slice(f,m),I="";for(let $=0;$<N.length-1;$+=2)I+=String.fromCharCode(N[$]+N[$+1]*256);return I}y(ke,"utf16leSlice"),a.prototype.slice=y(function(l,f){let m=this.length;l=~~l,f=f===void 0?m:~~f,l<0?(l+=m,l<0&&(l=0)):l>m&&(l=m),f<0?(f+=m,f<0&&(f=0)):f>m&&(f=m),f<l&&(f=l);let N=this.subarray(l,f);return Object.setPrototypeOf(N,a.prototype),N},"slice");function ge(l,f,m){if(l%1!==0||l<0)throw new RangeError("offset is not uint");if(l+f>m)throw new RangeError("Trying to access beyond buffer length")}y(ge,"checkOffset"),a.prototype.readUintLE=a.prototype.readUIntLE=y(function(l,f,m){l=l>>>0,f=f>>>0,m||ge(l,f,this.length);let N=this[l],I=1,$=0;for(;++$<f&&(I*=256);)N+=this[l+$]*I;return N},"readUIntLE"),a.prototype.readUintBE=a.prototype.readUIntBE=y(function(l,f,m){l=l>>>0,f=f>>>0,m||ge(l,f,this.length);let N=this[l+--f],I=1;for(;f>0&&(I*=256);)N+=this[l+--f]*I;return N},"readUIntBE"),a.prototype.readUint8=a.prototype.readUInt8=y(function(l,f){return l=l>>>0,f||ge(l,1,this.length),this[l]},"readUInt8"),a.prototype.readUint16LE=a.prototype.readUInt16LE=y(function(l,f){return l=l>>>0,f||ge(l,2,this.length),this[l]|this[l+1]<<8},"readUInt16LE"),a.prototype.readUint16BE=a.prototype.readUInt16BE=y(function(l,f){return l=l>>>0,f||ge(l,2,this.length),this[l]<<8|this[l+1]},"readUInt16BE"),a.prototype.readUint32LE=a.prototype.readUInt32LE=y(function(l,f){return l=l>>>0,f||ge(l,4,this.length),(this[l]|this[l+1]<<8|this[l+2]<<16)+this[l+3]*16777216},"readUInt32LE"),a.prototype.readUint32BE=a.prototype.readUInt32BE=y(function(l,f){return l=l>>>0,f||ge(l,4,this.length),this[l]*16777216+(this[l+1]<<16|this[l+2]<<8|this[l+3])},"readUInt32BE"),a.prototype.readBigUInt64LE=pt(y(function(l){l=l>>>0,jt(l,"offset");let f=this[l],m=this[l+7];(f===void 0||m===void 0)&&dr(l,this.length-8);let N=f+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24,I=this[++l]+this[++l]*2**8+this[++l]*2**16+m*2**24;return BigInt(N)+(BigInt(I)<<BigInt(32))},"readBigUInt64LE")),a.prototype.readBigUInt64BE=pt(y(function(l){l=l>>>0,jt(l,"offset");let f=this[l],m=this[l+7];(f===void 0||m===void 0)&&dr(l,this.length-8);let N=f*2**24+this[++l]*2**16+this[++l]*2**8+this[++l],I=this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+m;return(BigInt(N)<<BigInt(32))+BigInt(I)},"readBigUInt64BE")),a.prototype.readIntLE=y(function(l,f,m){l=l>>>0,f=f>>>0,m||ge(l,f,this.length);let N=this[l],I=1,$=0;for(;++$<f&&(I*=256);)N+=this[l+$]*I;return I*=128,N>=I&&(N-=Math.pow(2,8*f)),N},"readIntLE"),a.prototype.readIntBE=y(function(l,f,m){l=l>>>0,f=f>>>0,m||ge(l,f,this.length);let N=f,I=1,$=this[l+--N];for(;N>0&&(I*=256);)$+=this[l+--N]*I;return I*=128,$>=I&&($-=Math.pow(2,8*f)),$},"readIntBE"),a.prototype.readInt8=y(function(l,f){return l=l>>>0,f||ge(l,1,this.length),this[l]&128?(255-this[l]+1)*-1:this[l]},"readInt8"),a.prototype.readInt16LE=y(function(l,f){l=l>>>0,f||ge(l,2,this.length);let m=this[l]|this[l+1]<<8;return m&32768?m|4294901760:m},"readInt16LE"),a.prototype.readInt16BE=y(function(l,f){l=l>>>0,f||ge(l,2,this.length);let m=this[l+1]|this[l]<<8;return m&32768?m|4294901760:m},"readInt16BE"),a.prototype.readInt32LE=y(function(l,f){return l=l>>>0,f||ge(l,4,this.length),this[l]|this[l+1]<<8|this[l+2]<<16|this[l+3]<<24},"readInt32LE"),a.prototype.readInt32BE=y(function(l,f){return l=l>>>0,f||ge(l,4,this.length),this[l]<<24|this[l+1]<<16|this[l+2]<<8|this[l+3]},"readInt32BE"),a.prototype.readBigInt64LE=pt(y(function(l){l=l>>>0,jt(l,"offset");let f=this[l],m=this[l+7];(f===void 0||m===void 0)&&dr(l,this.length-8);let N=this[l+4]+this[l+5]*2**8+this[l+6]*2**16+(m<<24);return(BigInt(N)<<BigInt(32))+BigInt(f+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24)},"readBigInt64LE")),a.prototype.readBigInt64BE=pt(y(function(l){l=l>>>0,jt(l,"offset");let f=this[l],m=this[l+7];(f===void 0||m===void 0)&&dr(l,this.length-8);let N=(f<<24)+this[++l]*2**16+this[++l]*2**8+this[++l];return(BigInt(N)<<BigInt(32))+BigInt(this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+m)},"readBigInt64BE")),a.prototype.readFloatLE=y(function(l,f){return l=l>>>0,f||ge(l,4,this.length),t.read(this,l,!0,23,4)},"readFloatLE"),a.prototype.readFloatBE=y(function(l,f){return l=l>>>0,f||ge(l,4,this.length),t.read(this,l,!1,23,4)},"readFloatBE"),a.prototype.readDoubleLE=y(function(l,f){return l=l>>>0,f||ge(l,8,this.length),t.read(this,l,!0,52,8)},"readDoubleLE"),a.prototype.readDoubleBE=y(function(l,f){return l=l>>>0,f||ge(l,8,this.length),t.read(this,l,!1,52,8)},"readDoubleBE");function we(l,f,m,N,I,$){if(!a.isBuffer(l))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>I||f<$)throw new RangeError('"value" argument is out of bounds');if(m+N>l.length)throw new RangeError("Index out of range")}y(we,"checkInt"),a.prototype.writeUintLE=a.prototype.writeUIntLE=y(function(l,f,m,N){if(l=+l,f=f>>>0,m=m>>>0,!N){let j=Math.pow(2,8*m)-1;we(this,l,f,m,j,0)}let I=1,$=0;for(this[f]=l&255;++$<m&&(I*=256);)this[f+$]=l/I&255;return f+m},"writeUIntLE"),a.prototype.writeUintBE=a.prototype.writeUIntBE=y(function(l,f,m,N){if(l=+l,f=f>>>0,m=m>>>0,!N){let j=Math.pow(2,8*m)-1;we(this,l,f,m,j,0)}let I=m-1,$=1;for(this[f+I]=l&255;--I>=0&&($*=256);)this[f+I]=l/$&255;return f+m},"writeUIntBE"),a.prototype.writeUint8=a.prototype.writeUInt8=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,1,255,0),this[f]=l&255,f+1},"writeUInt8"),a.prototype.writeUint16LE=a.prototype.writeUInt16LE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,2,65535,0),this[f]=l&255,this[f+1]=l>>>8,f+2},"writeUInt16LE"),a.prototype.writeUint16BE=a.prototype.writeUInt16BE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,2,65535,0),this[f]=l>>>8,this[f+1]=l&255,f+2},"writeUInt16BE"),a.prototype.writeUint32LE=a.prototype.writeUInt32LE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,4,4294967295,0),this[f+3]=l>>>24,this[f+2]=l>>>16,this[f+1]=l>>>8,this[f]=l&255,f+4},"writeUInt32LE"),a.prototype.writeUint32BE=a.prototype.writeUInt32BE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,4,4294967295,0),this[f]=l>>>24,this[f+1]=l>>>16,this[f+2]=l>>>8,this[f+3]=l&255,f+4},"writeUInt32BE");function qt(l,f,m,N,I){Bn(f,N,I,l,m,7);let $=Number(f&BigInt(4294967295));l[m++]=$,$=$>>8,l[m++]=$,$=$>>8,l[m++]=$,$=$>>8,l[m++]=$;let j=Number(f>>BigInt(32)&BigInt(4294967295));return l[m++]=j,j=j>>8,l[m++]=j,j=j>>8,l[m++]=j,j=j>>8,l[m++]=j,m}y(qt,"wrtBigUInt64LE");function Fr(l,f,m,N,I){Bn(f,N,I,l,m,7);let $=Number(f&BigInt(4294967295));l[m+7]=$,$=$>>8,l[m+6]=$,$=$>>8,l[m+5]=$,$=$>>8,l[m+4]=$;let j=Number(f>>BigInt(32)&BigInt(4294967295));return l[m+3]=j,j=j>>8,l[m+2]=j,j=j>>8,l[m+1]=j,j=j>>8,l[m]=j,m+8}y(Fr,"wrtBigUInt64BE"),a.prototype.writeBigUInt64LE=pt(y(function(l,f=0){return qt(this,l,f,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),a.prototype.writeBigUInt64BE=pt(y(function(l,f=0){return Fr(this,l,f,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),a.prototype.writeIntLE=y(function(l,f,m,N){if(l=+l,f=f>>>0,!N){let ye=Math.pow(2,8*m-1);we(this,l,f,m,ye-1,-ye)}let I=0,$=1,j=0;for(this[f]=l&255;++I<m&&($*=256);)l<0&&j===0&&this[f+I-1]!==0&&(j=1),this[f+I]=(l/$>>0)-j&255;return f+m},"writeIntLE"),a.prototype.writeIntBE=y(function(l,f,m,N){if(l=+l,f=f>>>0,!N){let ye=Math.pow(2,8*m-1);we(this,l,f,m,ye-1,-ye)}let I=m-1,$=1,j=0;for(this[f+I]=l&255;--I>=0&&($*=256);)l<0&&j===0&&this[f+I+1]!==0&&(j=1),this[f+I]=(l/$>>0)-j&255;return f+m},"writeIntBE"),a.prototype.writeInt8=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,1,127,-128),l<0&&(l=255+l+1),this[f]=l&255,f+1},"writeInt8"),a.prototype.writeInt16LE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,2,32767,-32768),this[f]=l&255,this[f+1]=l>>>8,f+2},"writeInt16LE"),a.prototype.writeInt16BE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,2,32767,-32768),this[f]=l>>>8,this[f+1]=l&255,f+2},"writeInt16BE"),a.prototype.writeInt32LE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,4,2147483647,-2147483648),this[f]=l&255,this[f+1]=l>>>8,this[f+2]=l>>>16,this[f+3]=l>>>24,f+4},"writeInt32LE"),a.prototype.writeInt32BE=y(function(l,f,m){return l=+l,f=f>>>0,m||we(this,l,f,4,2147483647,-2147483648),l<0&&(l=4294967295+l+1),this[f]=l>>>24,this[f+1]=l>>>16,this[f+2]=l>>>8,this[f+3]=l&255,f+4},"writeInt32BE"),a.prototype.writeBigInt64LE=pt(y(function(l,f=0){return qt(this,l,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),a.prototype.writeBigInt64BE=pt(y(function(l,f=0){return Fr(this,l,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function Ur(l,f,m,N,I,$){if(m+N>l.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("Index out of range")}y(Ur,"checkIEEE754");function Ln(l,f,m,N,I){return f=+f,m=m>>>0,I||Ur(l,f,m,4,34028234663852886e22,-34028234663852886e22),t.write(l,f,m,N,23,4),m+4}y(Ln,"writeFloat"),a.prototype.writeFloatLE=y(function(l,f,m){return Ln(this,l,f,!0,m)},"writeFloatLE"),a.prototype.writeFloatBE=y(function(l,f,m){return Ln(this,l,f,!1,m)},"writeFloatBE");function Rn(l,f,m,N,I){return f=+f,m=m>>>0,I||Ur(l,f,m,8,17976931348623157e292,-17976931348623157e292),t.write(l,f,m,N,52,8),m+8}y(Rn,"writeDouble"),a.prototype.writeDoubleLE=y(function(l,f,m){return Rn(this,l,f,!0,m)},"writeDoubleLE"),a.prototype.writeDoubleBE=y(function(l,f,m){return Rn(this,l,f,!1,m)},"writeDoubleBE"),a.prototype.copy=y(function(l,f,m,N){if(!a.isBuffer(l))throw new TypeError("argument should be a Buffer");if(m||(m=0),!N&&N!==0&&(N=this.length),f>=l.length&&(f=l.length),f||(f=0),N>0&&N<m&&(N=m),N===m||l.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(m<0||m>=this.length)throw new RangeError("Index out of range");if(N<0)throw new RangeError("sourceEnd out of bounds");N>this.length&&(N=this.length),l.length-f<N-m&&(N=l.length-f+m);let I=N-m;return this===l&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,m,N):Uint8Array.prototype.set.call(l,this.subarray(m,N),f),I},"copy"),a.prototype.fill=y(function(l,f,m,N){if(typeof l=="string"){if(typeof f=="string"?(N=f,f=0,m=this.length):typeof m=="string"&&(N=m,m=this.length),N!==void 0&&typeof N!="string")throw new TypeError("encoding must be a string");if(typeof N=="string"&&!a.isEncoding(N))throw new TypeError("Unknown encoding: "+N);if(l.length===1){let $=l.charCodeAt(0);(N==="utf8"&&$<128||N==="latin1")&&(l=$)}}else typeof l=="number"?l=l&255:typeof l=="boolean"&&(l=Number(l));if(f<0||this.length<f||this.length<m)throw new RangeError("Out of range index");if(m<=f)return this;f=f>>>0,m=m===void 0?this.length:m>>>0,l||(l=0);let I;if(typeof l=="number")for(I=f;I<m;++I)this[I]=l;else{let $=a.isBuffer(l)?l:a.from(l,N),j=$.length;if(j===0)throw new TypeError('The value "'+l+'" is invalid for argument "value"');for(I=0;I<m-f;++I)this[I+f]=$[I%j]}return this},"fill");var fr={};function ks(l,f,m){var N;fr[l]=(N=class extends m{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${l}]`,this.stack,delete this.name}get code(){return l}set code(I){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:I,writable:!0})}toString(){return`${this.name} [${l}]: ${this.message}`}},y(N,"NodeError"),N)}y(ks,"E"),ks("ERR_BUFFER_OUT_OF_BOUNDS",function(l){return l?`${l} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ks("ERR_INVALID_ARG_TYPE",function(l,f){return`The "${l}" argument must be of type number. Received type ${typeof f}`},TypeError),ks("ERR_OUT_OF_RANGE",function(l,f,m){let N=`The value of "${l}" is out of range.`,I=m;return Number.isInteger(m)&&Math.abs(m)>2**32?I=Mn(String(m)):typeof m=="bigint"&&(I=String(m),(m>BigInt(2)**BigInt(32)||m<-(BigInt(2)**BigInt(32)))&&(I=Mn(I)),I+="n"),N+=` It must be ${f}. Received ${I}`,N},RangeError);function Mn(l){let f="",m=l.length,N=l[0]==="-"?1:0;for(;m>=N+4;m-=3)f=`_${l.slice(m-3,m)}${f}`;return`${l.slice(0,m)}${f}`}y(Mn,"addNumericalSeparator");function Ea(l,f,m){jt(f,"offset"),(l[f]===void 0||l[f+m]===void 0)&&dr(f,l.length-(m+1))}y(Ea,"checkBounds");function Bn(l,f,m,N,I,$){if(l>m||l<f){let j=typeof f=="bigint"?"n":"",ye;throw $>3?f===0||f===BigInt(0)?ye=`>= 0${j} and < 2${j} ** ${($+1)*8}${j}`:ye=`>= -(2${j} ** ${($+1)*8-1}${j}) and < 2 ** ${($+1)*8-1}${j}`:ye=`>= ${f}${j} and <= ${m}${j}`,new fr.ERR_OUT_OF_RANGE("value",ye,l)}Ea(N,I,$)}y(Bn,"checkIntBI");function jt(l,f){if(typeof l!="number")throw new fr.ERR_INVALID_ARG_TYPE(f,"number",l)}y(jt,"validateNumber");function dr(l,f,m){throw Math.floor(l)!==l?(jt(l,m),new fr.ERR_OUT_OF_RANGE(m||"offset","an integer",l)):f<0?new fr.ERR_BUFFER_OUT_OF_BOUNDS:new fr.ERR_OUT_OF_RANGE(m||"offset",`>= ${m?1:0} and <= ${f}`,l)}y(dr,"boundsError");var Bh=/[^+/0-9A-Za-z-_]/g;function Ta(l){if(l=l.split("=")[0],l=l.trim().replace(Bh,""),l.length<2)return"";for(;l.length%4!==0;)l=l+"=";return l}y(Ta,"base64clean");function Is(l,f){f=f||1/0;let m,N=l.length,I=null,$=[];for(let j=0;j<N;++j){if(m=l.charCodeAt(j),m>55295&&m<57344){if(!I){if(m>56319){(f-=3)>-1&&$.push(239,191,189);continue}else if(j+1===N){(f-=3)>-1&&$.push(239,191,189);continue}I=m;continue}if(m<56320){(f-=3)>-1&&$.push(239,191,189),I=m;continue}m=(I-55296<<10|m-56320)+65536}else I&&(f-=3)>-1&&$.push(239,191,189);if(I=null,m<128){if((f-=1)<0)break;$.push(m)}else if(m<2048){if((f-=2)<0)break;$.push(m>>6|192,m&63|128)}else if(m<65536){if((f-=3)<0)break;$.push(m>>12|224,m>>6&63|128,m&63|128)}else if(m<1114112){if((f-=4)<0)break;$.push(m>>18|240,m>>12&63|128,m>>6&63|128,m&63|128)}else throw new Error("Invalid code point")}return $}y(Is,"utf8ToBytes");function Ca(l){let f=[];for(let m=0;m<l.length;++m)f.push(l.charCodeAt(m)&255);return f}y(Ca,"asciiToBytes");function Na(l,f){let m,N,I,$=[];for(let j=0;j<l.length&&!((f-=2)<0);++j)m=l.charCodeAt(j),N=m>>8,I=m%256,$.push(I),$.push(N);return $}y(Na,"utf16leToBytes");function Dn(l){return e.toByteArray(Ta(l))}y(Dn,"base64ToBytes");function Qr(l,f,m,N){let I;for(I=0;I<N&&!(I+m>=f.length||I>=l.length);++I)f[I+m]=l[I];return I}y(Qr,"blitBuffer");function rt(l,f){return l instanceof f||l!=null&&l.constructor!=null&&l.constructor.name!=null&&l.constructor.name===f.name}y(rt,"isInstance");function Os(l){return l!==l}y(Os,"numberIsNaN");var Dh=function(){let l="0123456789abcdef",f=new Array(256);for(let m=0;m<16;++m){let N=m*16;for(let I=0;I<16;++I)f[N+I]=l[m]+l[I]}return f}();function pt(l){return typeof BigInt>"u"?Aa:l}y(pt,"defineBigIntMethod");function Aa(){throw new Error("BigInt not supported")}y(Aa,"BufferBigIntNotDefined")}),Rs,Un,ef,Be,re,le,Y=Ue(()=>{"use strict";Rs=globalThis,Un=globalThis.setImmediate??(r=>setTimeout(r,0)),ef=globalThis.clearImmediate??(r=>clearTimeout(r)),Be=globalThis.crypto??{},Be.subtle??(Be.subtle={}),re=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:Xh().Buffer,le=globalThis.process??{},le.env??(le.env={});try{le.nextTick(()=>{})}catch{let r=Promise.resolve();le.nextTick=r.then.bind(r)}}),Ft=ue((r,e)=>{"use strict";Y();var t=typeof Reflect=="object"?Reflect:null,s=t&&typeof t.apply=="function"?t.apply:y(function(x,k,P){return Function.prototype.apply.call(x,k,P)},"ReflectApply"),n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=y(function(x){return Object.getOwnPropertyNames(x).concat(Object.getOwnPropertySymbols(x))},"ReflectOwnKeys"):n=y(function(x){return Object.getOwnPropertyNames(x)},"ReflectOwnKeys");function i(x){console&&console.warn&&console.warn(x)}y(i,"ProcessEmitWarning");var o=Number.isNaN||y(function(x){return x!==x},"NumberIsNaN");function a(){a.init.call(this)}y(a,"EventEmitter"),e.exports=a,e.exports.once=E,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function d(x){if(typeof x!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}y(d,"checkListener"),Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:y(function(){return c},"get"),set:y(function(x){if(typeof x!="number"||x<0||o(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");c=x},"set")}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=y(function(x){if(typeof x!="number"||x<0||o(x))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+x+".");return this._maxListeners=x,this},"setMaxListeners");function h(x){return x._maxListeners===void 0?a.defaultMaxListeners:x._maxListeners}y(h,"_getMaxListeners"),a.prototype.getMaxListeners=y(function(){return h(this)},"getMaxListeners"),a.prototype.emit=y(function(x){for(var k=[],P=1;P<arguments.length;P++)k.push(arguments[P]);var C=x==="error",B=this._events;if(B!==void 0)C=C&&B.error===void 0;else if(!C)return!1;if(C){var M;if(k.length>0&&(M=k[0]),M instanceof Error)throw M;var W=new Error("Unhandled error."+(M?" ("+M.message+")":""));throw W.context=M,W}var K=B[x];if(K===void 0)return!1;if(typeof K=="function")s(K,this,k);else for(var R=K.length,U=v(K,R),P=0;P<R;++P)s(U[P],this,k);return!0},"emit");function p(x,k,P,C){var B,M,W;if(d(P),M=x._events,M===void 0?(M=x._events=Object.create(null),x._eventsCount=0):(M.newListener!==void 0&&(x.emit("newListener",k,P.listener?P.listener:P),M=x._events),W=M[k]),W===void 0)W=M[k]=P,++x._eventsCount;else if(typeof W=="function"?W=M[k]=C?[P,W]:[W,P]:C?W.unshift(P):W.push(P),B=h(x),B>0&&W.length>B&&!W.warned){W.warned=!0;var K=new Error("Possible EventEmitter memory leak detected. "+W.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");K.name="MaxListenersExceededWarning",K.emitter=x,K.type=k,K.count=W.length,i(K)}return x}y(p,"_addListener"),a.prototype.addListener=y(function(x,k){return p(this,x,k,!1)},"addListener"),a.prototype.on=a.prototype.addListener,a.prototype.prependListener=y(function(x,k){return p(this,x,k,!0)},"prependListener");function b(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}y(b,"onceWrapper");function _(x,k,P){var C={fired:!1,wrapFn:void 0,target:x,type:k,listener:P},B=b.bind(C);return B.listener=P,C.wrapFn=B,B}y(_,"_onceWrap"),a.prototype.once=y(function(x,k){return d(k),this.on(x,_(this,x,k)),this},"once"),a.prototype.prependOnceListener=y(function(x,k){return d(k),this.prependListener(x,_(this,x,k)),this},"prependOnceListener"),a.prototype.removeListener=y(function(x,k){var P,C,B,M,W;if(d(k),C=this._events,C===void 0)return this;if(P=C[x],P===void 0)return this;if(P===k||P.listener===k)--this._eventsCount===0?this._events=Object.create(null):(delete C[x],C.removeListener&&this.emit("removeListener",x,P.listener||k));else if(typeof P!="function"){for(B=-1,M=P.length-1;M>=0;M--)if(P[M]===k||P[M].listener===k){W=P[M].listener,B=M;break}if(B<0)return this;B===0?P.shift():w(P,B),P.length===1&&(C[x]=P[0]),C.removeListener!==void 0&&this.emit("removeListener",x,W||k)}return this},"removeListener"),a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=y(function(x){var k,P,C;if(P=this._events,P===void 0)return this;if(P.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):P[x]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete P[x]),this;if(arguments.length===0){var B=Object.keys(P),M;for(C=0;C<B.length;++C)M=B[C],M!=="removeListener"&&this.removeAllListeners(M);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(k=P[x],typeof k=="function")this.removeListener(x,k);else if(k!==void 0)for(C=k.length-1;C>=0;C--)this.removeListener(x,k[C]);return this},"removeAllListeners");function g(x,k,P){var C=x._events;if(C===void 0)return[];var B=C[k];return B===void 0?[]:typeof B=="function"?P?[B.listener||B]:[B]:P?S(B):v(B,B.length)}y(g,"_listeners"),a.prototype.listeners=y(function(x){return g(this,x,!0)},"listeners"),a.prototype.rawListeners=y(function(x){return g(this,x,!1)},"rawListeners"),a.listenerCount=function(x,k){return typeof x.listenerCount=="function"?x.listenerCount(k):u.call(x,k)},a.prototype.listenerCount=u;function u(x){var k=this._events;if(k!==void 0){var P=k[x];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}y(u,"listenerCount"),a.prototype.eventNames=y(function(){return this._eventsCount>0?n(this._events):[]},"eventNames");function v(x,k){for(var P=new Array(k),C=0;C<k;++C)P[C]=x[C];return P}y(v,"arrayClone");function w(x,k){for(;k+1<x.length;k++)x[k]=x[k+1];x.pop()}y(w,"spliceOne");function S(x){for(var k=new Array(x.length),P=0;P<k.length;++P)k[P]=x[P].listener||x[P];return k}y(S,"unwrapListeners");function E(x,k){return new Promise(function(P,C){function B(W){x.removeListener(k,M),C(W)}y(B,"errorListener");function M(){typeof x.removeListener=="function"&&x.removeListener("error",B),P([].slice.call(arguments))}y(M,"resolver"),L(x,k,M,{once:!0}),k!=="error"&&O(x,B,{once:!0})})}y(E,"once");function O(x,k,P){typeof x.on=="function"&&L(x,"error",k,P)}y(O,"addErrorHandlerIfEventEmitter");function L(x,k,P,C){if(typeof x.on=="function")C.once?x.once(k,P):x.on(k,P);else if(typeof x.addEventListener=="function")x.addEventListener(k,y(function B(M){C.once&&x.removeEventListener(k,B),P(M)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof x)}y(L,"eventTargetAgnosticAddListener")}),Kr={};st(Kr,{default:()=>Ra});var Ra,Ms=Ue(()=>{"use strict";Y(),Ra={}});function Wr(r){let e=1779033703,t=3144134277,s=1013904242,n=2773480762,i=1359893119,o=2600822924,a=528734635,c=1541459225,d=0,h=0,p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],b=y((S,E)=>S>>>E|S<<32-E,"rrot"),_=new Uint32Array(64),g=new Uint8Array(64),u=y(()=>{for(let B=0,M=0;B<16;B++,M+=4)_[B]=g[M]<<24|g[M+1]<<16|g[M+2]<<8|g[M+3];for(let B=16;B<64;B++){let M=b(_[B-15],7)^b(_[B-15],18)^_[B-15]>>>3,W=b(_[B-2],17)^b(_[B-2],19)^_[B-2]>>>10;_[B]=_[B-16]+M+_[B-7]+W|0}let S=e,E=t,O=s,L=n,x=i,k=o,P=a,C=c;for(let B=0;B<64;B++){let M=b(x,6)^b(x,11)^b(x,25),W=x&k^~x&P,K=C+M+W+p[B]+_[B]|0,R=b(S,2)^b(S,13)^b(S,22),U=S&E^S&O^E&O,J=R+U|0;C=P,P=k,k=x,x=L+K|0,L=O,O=E,E=S,S=K+J|0}e=e+S|0,t=t+E|0,s=s+O|0,n=n+L|0,i=i+x|0,o=o+k|0,a=a+P|0,c=c+C|0,h=0},"process"),v=y(S=>{typeof S=="string"&&(S=new TextEncoder().encode(S));for(let E=0;E<S.length;E++)g[h++]=S[E],h===64&&u();d+=S.length},"add"),w=y(()=>{if(g[h++]=128,h==64&&u(),h+8>64){for(;h<64;)g[h++]=0;u()}for(;h<58;)g[h++]=0;let S=d*8;g[h++]=S/1099511627776&255,g[h++]=S/4294967296&255,g[h++]=S>>>24,g[h++]=S>>>16&255,g[h++]=S>>>8&255,g[h++]=S&255,u();let E=new Uint8Array(32);return E[0]=e>>>24,E[1]=e>>>16&255,E[2]=e>>>8&255,E[3]=e&255,E[4]=t>>>24,E[5]=t>>>16&255,E[6]=t>>>8&255,E[7]=t&255,E[8]=s>>>24,E[9]=s>>>16&255,E[10]=s>>>8&255,E[11]=s&255,E[12]=n>>>24,E[13]=n>>>16&255,E[14]=n>>>8&255,E[15]=n&255,E[16]=i>>>24,E[17]=i>>>16&255,E[18]=i>>>8&255,E[19]=i&255,E[20]=o>>>24,E[21]=o>>>16&255,E[22]=o>>>8&255,E[23]=o&255,E[24]=a>>>24,E[25]=a>>>16&255,E[26]=a>>>8&255,E[27]=a&255,E[28]=c>>>24,E[29]=c>>>16&255,E[30]=c>>>8&255,E[31]=c&255,E},"digest");return r===void 0?{add:v,digest:w}:(v(r),w())}var tf=Ue(()=>{"use strict";Y(),y(Wr,"sha256")}),mt,jn,rf=Ue(()=>{"use strict";Y(),mt=class He{constructor(){se(this,"_dataLength",0),se(this,"_bufferLength",0),se(this,"_state",new Int32Array(4)),se(this,"_buffer",new ArrayBuffer(68)),se(this,"_buffer8"),se(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){let t=He.hexChars,s=He.hexOut,n,i,o,a;for(a=0;a<4;a+=1)for(i=a*8,n=e[a],o=0;o<8;o+=2)s[i+1+o]=t.charAt(n&15),n>>>=4,s[i+0+o]=t.charAt(n&15),n>>>=4;return s.join("")}static _md5cycle(e,t){let s=e[0],n=e[1],i=e[2],o=e[3];s+=(n&i|~n&o)+t[0]-680876936|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+t[1]-389564586|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+t[2]+606105819|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+t[3]-1044525330|0,n=(n<<22|n>>>10)+i|0,s+=(n&i|~n&o)+t[4]-176418897|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+t[5]+1200080426|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+t[6]-1473231341|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+t[7]-45705983|0,n=(n<<22|n>>>10)+i|0,s+=(n&i|~n&o)+t[8]+1770035416|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+t[9]-1958414417|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+t[10]-42063|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+t[11]-1990404162|0,n=(n<<22|n>>>10)+i|0,s+=(n&i|~n&o)+t[12]+1804603682|0,s=(s<<7|s>>>25)+n|0,o+=(s&n|~s&i)+t[13]-40341101|0,o=(o<<12|o>>>20)+s|0,i+=(o&s|~o&n)+t[14]-1502002290|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&s)+t[15]+1236535329|0,n=(n<<22|n>>>10)+i|0,s+=(n&o|i&~o)+t[1]-165796510|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+t[6]-1069501632|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+t[11]+643717713|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+t[0]-373897302|0,n=(n<<20|n>>>12)+i|0,s+=(n&o|i&~o)+t[5]-701558691|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+t[10]+38016083|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+t[15]-660478335|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+t[4]-405537848|0,n=(n<<20|n>>>12)+i|0,s+=(n&o|i&~o)+t[9]+568446438|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+t[14]-1019803690|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+t[3]-187363961|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+t[8]+1163531501|0,n=(n<<20|n>>>12)+i|0,s+=(n&o|i&~o)+t[13]-1444681467|0,s=(s<<5|s>>>27)+n|0,o+=(s&i|n&~i)+t[2]-51403784|0,o=(o<<9|o>>>23)+s|0,i+=(o&n|s&~n)+t[7]+1735328473|0,i=(i<<14|i>>>18)+o|0,n+=(i&s|o&~s)+t[12]-1926607734|0,n=(n<<20|n>>>12)+i|0,s+=(n^i^o)+t[5]-378558|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+t[8]-2022574463|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+t[11]+1839030562|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+t[14]-35309556|0,n=(n<<23|n>>>9)+i|0,s+=(n^i^o)+t[1]-1530992060|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+t[4]+1272893353|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+t[7]-155497632|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+t[10]-1094730640|0,n=(n<<23|n>>>9)+i|0,s+=(n^i^o)+t[13]+681279174|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+t[0]-358537222|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+t[3]-722521979|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+t[6]+76029189|0,n=(n<<23|n>>>9)+i|0,s+=(n^i^o)+t[9]-640364487|0,s=(s<<4|s>>>28)+n|0,o+=(s^n^i)+t[12]-421815835|0,o=(o<<11|o>>>21)+s|0,i+=(o^s^n)+t[15]+530742520|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^s)+t[2]-995338651|0,n=(n<<23|n>>>9)+i|0,s+=(i^(n|~o))+t[0]-198630844|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+t[7]+1126891415|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+t[14]-1416354905|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+t[5]-57434055|0,n=(n<<21|n>>>11)+i|0,s+=(i^(n|~o))+t[12]+1700485571|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+t[3]-1894986606|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+t[10]-1051523|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+t[1]-2054922799|0,n=(n<<21|n>>>11)+i|0,s+=(i^(n|~o))+t[8]+1873313359|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+t[15]-30611744|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+t[6]-1560198380|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+t[13]+1309151649|0,n=(n<<21|n>>>11)+i|0,s+=(i^(n|~o))+t[4]-145523070|0,s=(s<<6|s>>>26)+n|0,o+=(n^(s|~i))+t[11]-1120210379|0,o=(o<<10|o>>>22)+s|0,i+=(s^(o|~n))+t[2]+718787259|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~s))+t[9]-343485551|0,n=(n<<21|n>>>11)+i|0,e[0]=s+e[0]|0,e[1]=n+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(He.stateIdentity),this}appendStr(e){let t=this._buffer8,s=this._buffer32,n=this._bufferLength,i,o;for(o=0;o<e.length;o+=1){if(i=e.charCodeAt(o),i<128)t[n++]=i;else if(i<2048)t[n++]=(i>>>6)+192,t[n++]=i&63|128;else if(i<55296||i>56319)t[n++]=(i>>>12)+224,t[n++]=i>>>6&63|128,t[n++]=i&63|128;else{if(i=(i-55296)*1024+(e.charCodeAt(++o)-56320)+65536,i>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[n++]=(i>>>18)+240,t[n++]=i>>>12&63|128,t[n++]=i>>>6&63|128,t[n++]=i&63|128}n>=64&&(this._dataLength+=64,He._md5cycle(this._state,s),n-=64,s[0]=s[16])}return this._bufferLength=n,this}appendAsciiStr(e){let t=this._buffer8,s=this._buffer32,n=this._bufferLength,i,o=0;for(;;){for(i=Math.min(e.length-o,64-n);i--;)t[n++]=e.charCodeAt(o++);if(n<64)break;this._dataLength+=64,He._md5cycle(this._state,s),n=0}return this._bufferLength=n,this}appendByteArray(e){let t=this._buffer8,s=this._buffer32,n=this._bufferLength,i,o=0;for(;;){for(i=Math.min(e.length-o,64-n);i--;)t[n++]=e[o++];if(n<64)break;this._dataLength+=64,He._md5cycle(this._state,s),n=0}return this._bufferLength=n,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,s=e.state,n=this._state,i;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],i=0;i<t.length;i+=1)this._buffer8[i]=t.charCodeAt(i)}end(e=!1){let t=this._bufferLength,s=this._buffer8,n=this._buffer32,i=(t>>2)+1;this._dataLength+=t;let o=this._dataLength*8;if(s[t]=128,s[t+1]=s[t+2]=s[t+3]=0,n.set(He.buffer32Identity.subarray(i),i),t>55&&(He._md5cycle(this._state,n),n.set(He.buffer32Identity)),o<=4294967295)n[14]=o;else{let a=o.toString(16).match(/(.*?)(.{0,8})$/);if(a===null)return;let c=parseInt(a[2],16),d=parseInt(a[1],16)||0;n[14]=c,n[15]=d}return He._md5cycle(this._state,n),e?this._state:He._hex(this._state)}},y(mt,"Md5"),se(mt,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),se(mt,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),se(mt,"hexChars","0123456789abcdef"),se(mt,"hexOut",[]),se(mt,"onePassHasher",new mt),jn=mt}),Qn={};st(Qn,{createHash:()=>Ba,createHmac:()=>Da,randomBytes:()=>Ma});function Ma(r){return Be.getRandomValues(re.alloc(r))}function Ba(r){if(r==="sha256")return{update:y(function(e){return{digest:y(function(){return re.from(Wr(e))},"digest")}},"update")};if(r==="md5")return{update:y(function(e){return{digest:y(function(){return typeof e=="string"?jn.hashStr(e):jn.hashByteArray(e)},"digest")}},"update")};throw new Error(`Hash type '${r}' not supported`)}function Da(r,e){if(r!=="sha256")throw new Error(`Only sha256 is supported (requested: '${r}')`);return{update:y(function(t){return{digest:y(function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));let s=e.length;if(s>64)e=Wr(e);else if(s<64){let c=new Uint8Array(64);c.set(e),e=c}let n=new Uint8Array(64),i=new Uint8Array(64);for(let c=0;c<64;c++)n[c]=54^e[c],i[c]=92^e[c];let o=new Uint8Array(t.length+64);o.set(n,0),o.set(t,64);let a=new Uint8Array(96);return a.set(i,0),a.set(Wr(o),64),re.from(Wr(a))},"digest")}},"update")}}var $a=Ue(()=>{"use strict";Y(),tf(),rf(),y(Ma,"randomBytes"),y(Ba,"createHash"),y(Da,"createHmac")}),qa=ue(r=>{"use strict";Y(),r.parse=function(n,i){return new t(n,i).parse()};var e=class ja{constructor(i,o){this.source=i,this.transform=o||s,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var i=this.source[this.position++];return i==="\\"?{value:this.source[this.position++],escaped:!0}:{value:i,escaped:!1}}record(i){this.recorded.push(i)}newEntry(i){var o;(this.recorded.length>0||i)&&(o=this.recorded.join(""),o==="NULL"&&!i&&(o=null),o!==null&&(o=this.transform(o)),this.entries.push(o),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var i=this.nextCharacter();if(i.value==="=")break}}parse(i){var o,a,c;for(this.consumeDimensions();!this.isEof();)if(o=this.nextCharacter(),o.value==="{"&&!c)this.dimension++,this.dimension>1&&(a=new ja(this.source.substr(this.position-1),this.transform),this.entries.push(a.parse(!0)),this.position+=a.position-2);else if(o.value==="}"&&!c){if(this.dimension--,!this.dimension&&(this.newEntry(),i))return this.entries}else o.value==='"'&&!o.escaped?(c&&this.newEntry(!0),c=!c):o.value===","&&!c?this.newEntry():this.record(o.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};y(e,"ArrayParser");var t=e;function s(n){return n}y(s,"identity")}),Fa=ue((r,e)=>{Y();var t=qa();e.exports={create:y(function(s,n){return{parse:y(function(){return t.parse(s,n)},"parse")}},"create")}}),sf=ue((r,e)=>{"use strict";Y();var t=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,s=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,n=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,i=/^-?infinity$/;e.exports=y(function(h){if(i.test(h))return Number(h.replace("i","I"));var p=t.exec(h);if(!p)return o(h)||null;var b=!!p[8],_=parseInt(p[1],10);b&&(_=c(_));var g=parseInt(p[2],10)-1,u=p[3],v=parseInt(p[4],10),w=parseInt(p[5],10),S=parseInt(p[6],10),E=p[7];E=E?1e3*parseFloat(E):0;var O,L=a(h);return L!=null?(O=new Date(Date.UTC(_,g,u,v,w,S,E)),d(_)&&O.setUTCFullYear(_),L!==0&&O.setTime(O.getTime()-L)):(O=new Date(_,g,u,v,w,S,E),d(_)&&O.setFullYear(_)),O},"parseDate");function o(h){var p=s.exec(h);if(p){var b=parseInt(p[1],10),_=!!p[4];_&&(b=c(b));var g=parseInt(p[2],10)-1,u=p[3],v=new Date(b,g,u);return d(b)&&v.setFullYear(b),v}}y(o,"getDate");function a(h){if(h.endsWith("+00"))return 0;var p=n.exec(h.split(" ")[1]);if(p){var b=p[1];if(b==="Z")return 0;var _=b==="-"?-1:1,g=parseInt(p[2],10)*3600+parseInt(p[3]||0,10)*60+parseInt(p[4]||0,10);return g*_*1e3}}y(a,"timeZoneOffset");function c(h){return-(h-1)}y(c,"bcYearToNegativeYear");function d(h){return h>=0&&h<100}y(d,"is0To99")}),nf=ue((r,e)=>{Y(),e.exports=s;var t=Object.prototype.hasOwnProperty;function s(n){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var a in o)t.call(o,a)&&(n[a]=o[a])}return n}y(s,"extend")}),of=ue((r,e)=>{"use strict";Y();var t=nf();e.exports=s;function s(S){if(!(this instanceof s))return new s(S);t(this,w(S))}y(s,"PostgresInterval");var n=["seconds","minutes","hours","days","months","years"];s.prototype.toPostgres=function(){var S=n.filter(this.hasOwnProperty,this);return this.milliseconds&&S.indexOf("seconds")<0&&S.push("seconds"),S.length===0?"0":S.map(function(E){var O=this[E]||0;return E==="seconds"&&this.milliseconds&&(O=(O+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),O+" "+E},this).join(" ")};var i={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},o=["years","months","days"],a=["hours","minutes","seconds"];s.prototype.toISOString=s.prototype.toISO=function(){var S=o.map(O,this).join(""),E=a.map(O,this).join("");return"P"+S+"T"+E;function O(L){var x=this[L]||0;return L==="seconds"&&this.milliseconds&&(x=(x+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),x+i[L]}};var c="([+-]?\\d+)",d=c+"\\s+years?",h=c+"\\s+mons?",p=c+"\\s+days?",b="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",_=new RegExp([d,h,p,b].map(function(S){return"("+S+")?"}).join("\\s*")),g={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},u=["hours","minutes","seconds","milliseconds"];function v(S){var E=S+"000000".slice(S.length);return parseInt(E,10)/1e3}y(v,"parseMilliseconds");function w(S){if(!S)return{};var E=_.exec(S),O=E[8]==="-";return Object.keys(g).reduce(function(L,x){var k=g[x],P=E[k];return!P||(P=x==="milliseconds"?v(P):parseInt(P,10),!P)||(O&&~u.indexOf(x)&&(P*=-1),L[x]=P),L},{})}y(w,"parse")}),af=ue((r,e)=>{"use strict";Y(),e.exports=y(function(t){if(/^\\x/.test(t))return new re(t.substr(2),"hex");for(var s="",n=0;n<t.length;)if(t[n]!=="\\")s+=t[n],++n;else if(/[0-7]{3}/.test(t.substr(n+1,3)))s+=String.fromCharCode(parseInt(t.substr(n+1,3),8)),n+=4;else{for(var i=1;n+i<t.length&&t[n+i]==="\\";)i++;for(var o=0;o<Math.floor(i/2);++o)s+="\\";n+=Math.floor(i/2)*2}return new re(s,"binary")},"parseBytea")}),lf=ue((r,e)=>{Y();var t=qa(),s=Fa(),n=sf(),i=of(),o=af();function a(C){return y(function(B){return B===null?B:C(B)},"nullAllowed")}y(a,"allowNull");function c(C){return C===null?C:C==="TRUE"||C==="t"||C==="true"||C==="y"||C==="yes"||C==="on"||C==="1"}y(c,"parseBool");function d(C){return C?t.parse(C,c):null}y(d,"parseBoolArray");function h(C){return parseInt(C,10)}y(h,"parseBaseTenInt");function p(C){return C?t.parse(C,a(h)):null}y(p,"parseIntegerArray");function b(C){return C?t.parse(C,a(function(B){return O(B).trim()})):null}y(b,"parseBigIntegerArray");var _=y(function(C){if(!C)return null;var B=s.create(C,function(M){return M!==null&&(M=x(M)),M});return B.parse()},"parsePointArray"),g=y(function(C){if(!C)return null;var B=s.create(C,function(M){return M!==null&&(M=parseFloat(M)),M});return B.parse()},"parseFloatArray"),u=y(function(C){if(!C)return null;var B=s.create(C);return B.parse()},"parseStringArray"),v=y(function(C){if(!C)return null;var B=s.create(C,function(M){return M!==null&&(M=n(M)),M});return B.parse()},"parseDateArray"),w=y(function(C){if(!C)return null;var B=s.create(C,function(M){return M!==null&&(M=i(M)),M});return B.parse()},"parseIntervalArray"),S=y(function(C){return C?t.parse(C,a(o)):null},"parseByteAArray"),E=y(function(C){return parseInt(C,10)},"parseInteger"),O=y(function(C){var B=String(C);return/^\d+$/.test(B)?B:C},"parseBigInteger"),L=y(function(C){return C?t.parse(C,a(JSON.parse)):null},"parseJsonArray"),x=y(function(C){return C[0]!=="("?null:(C=C.substring(1,C.length-1).split(","),{x:parseFloat(C[0]),y:parseFloat(C[1])})},"parsePoint"),k=y(function(C){if(C[0]!=="<"&&C[1]!=="(")return null;for(var B="(",M="",W=!1,K=2;K<C.length-1;K++){if(W||(B+=C[K]),C[K]===")"){W=!0;continue}else if(!W)continue;C[K]!==","&&(M+=C[K])}var R=x(B);return R.radius=parseFloat(M),R},"parseCircle"),P=y(function(C){C(20,O),C(21,E),C(23,E),C(26,E),C(700,parseFloat),C(701,parseFloat),C(16,c),C(1082,n),C(1114,n),C(1184,n),C(600,x),C(651,u),C(718,k),C(1e3,d),C(1001,S),C(1005,p),C(1007,p),C(1028,p),C(1016,b),C(1017,_),C(1021,g),C(1022,g),C(1231,g),C(1014,u),C(1015,u),C(1008,u),C(1009,u),C(1040,u),C(1041,u),C(1115,v),C(1182,v),C(1185,v),C(1186,i),C(1187,w),C(17,o),C(114,JSON.parse.bind(JSON)),C(3802,JSON.parse.bind(JSON)),C(199,L),C(3807,L),C(3907,u),C(2951,u),C(791,u),C(1183,u),C(1270,u)},"init");e.exports={init:P}}),uf=ue((r,e)=>{"use strict";Y();var t=1e6;function s(n){var i=n.readInt32BE(0),o=n.readUInt32BE(4),a="";i<0&&(i=~i+(o===0),o=~o+1>>>0,a="-");var c="",d,h,p,b,_,g;{if(d=i%t,i=i/t>>>0,h=4294967296*d+o,o=h/t>>>0,p=""+(h-t*o),o===0&&i===0)return a+p+c;for(b="",_=6-p.length,g=0;g<_;g++)b+="0";c=b+p+c}{if(d=i%t,i=i/t>>>0,h=4294967296*d+o,o=h/t>>>0,p=""+(h-t*o),o===0&&i===0)return a+p+c;for(b="",_=6-p.length,g=0;g<_;g++)b+="0";c=b+p+c}{if(d=i%t,i=i/t>>>0,h=4294967296*d+o,o=h/t>>>0,p=""+(h-t*o),o===0&&i===0)return a+p+c;for(b="",_=6-p.length,g=0;g<_;g++)b+="0";c=b+p+c}return d=i%t,h=4294967296*d+o,p=""+h%t,a+p+c}y(s,"readInt8"),e.exports=s}),cf=ue((r,e)=>{Y();var t=uf(),s=y(function(u,v,w,S,E){w=w||0,S=S||!1,E=E||function(W,K,R){return W*Math.pow(2,R)+K};var O=w>>3,L=y(function(W){return S?~W&255:W},"inv"),x=255,k=8-w%8;v<k&&(x=255<<8-v&255,k=v),w&&(x=x>>w%8);var P=0;w%8+v>=8&&(P=E(0,L(u[O])&x,k));for(var C=v+w>>3,B=O+1;B<C;B++)P=E(P,L(u[B]),8);var M=(v+w)%8;return M>0&&(P=E(P,L(u[C])>>8-M,M)),P},"parseBits"),n=y(function(u,v,w){var S=Math.pow(2,w-1)-1,E=s(u,1),O=s(u,w,1);if(O===0)return 0;var L=1,x=y(function(P,C,B){P===0&&(P=1);for(var M=1;M<=B;M++)L/=2,(C&1<<B-M)>0&&(P+=L);return P},"parsePrecisionBits"),k=s(u,v,w+1,!1,x);return O==Math.pow(2,w+1)-1?k===0?E===0?1/0:-1/0:NaN:(E===0?1:-1)*Math.pow(2,O-S)*k},"parseFloatFromBits"),i=y(function(u){return s(u,1)==1?-1*(s(u,15,1,!0)+1):s(u,15,1)},"parseInt16"),o=y(function(u){return s(u,1)==1?-1*(s(u,31,1,!0)+1):s(u,31,1)},"parseInt32"),a=y(function(u){return n(u,23,8)},"parseFloat32"),c=y(function(u){return n(u,52,11)},"parseFloat64"),d=y(function(u){var v=s(u,16,32);if(v==49152)return NaN;for(var w=Math.pow(1e4,s(u,16,16)),S=0,E=[],O=s(u,16),L=0;L<O;L++)S+=s(u,16,64+16*L)*w,w/=1e4;var x=Math.pow(10,s(u,16,48));return(v===0?1:-1)*Math.round(S*x)/x},"parseNumeric"),h=y(function(u,v){var w=s(v,1),S=s(v,63,1),E=new Date((w===0?1:-1)*S/1e3+9466848e5);return u||E.setTime(E.getTime()+E.getTimezoneOffset()*6e4),E.usec=S%1e3,E.getMicroSeconds=function(){return this.usec},E.setMicroSeconds=function(O){this.usec=O},E.getUTCMicroSeconds=function(){return this.usec},E},"parseDate"),p=y(function(u){for(var v=s(u,32),w=s(u,32,32),S=s(u,32,64),E=96,O=[],L=0;L<v;L++)O[L]=s(u,32,E),E+=32,E+=32;var x=y(function(P){var C=s(u,32,E);if(E+=32,C==4294967295)return null;var B;if(P==23||P==20)return B=s(u,C*8,E),E+=C*8,B;if(P==25)return B=u.toString(this.encoding,E>>3,(E+=C<<3)>>3),B;console.log("ERROR: ElementType not implemented: "+P)},"parseElement"),k=y(function(P,C){var B=[],M;if(P.length>1){var W=P.shift();for(M=0;M<W;M++)B[M]=k(P,C);P.unshift(W)}else for(M=0;M<P[0];M++)B[M]=x(C);return B},"parse");return k(O,S)},"parseArray"),b=y(function(u){return u.toString("utf8")},"parseText"),_=y(function(u){return u===null?null:s(u,8)>0},"parseBool"),g=y(function(u){u(20,t),u(21,i),u(23,o),u(26,o),u(1700,d),u(700,a),u(701,c),u(16,_),u(1114,h.bind(null,!1)),u(1184,h.bind(null,!0)),u(1e3,p),u(1007,p),u(1016,p),u(1008,p),u(1009,p),u(25,b)},"init");e.exports={init:g}}),hf=ue((r,e)=>{Y(),e.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),Bs=ue(r=>{Y();var e=lf(),t=cf(),s=Fa(),n=hf();r.getTypeParser=a,r.setTypeParser=c,r.arrayParser=s,r.builtins=n;var i={text:{},binary:{}};function o(d){return String(d)}y(o,"noParse");function a(d,h){return h=h||"text",i[h]&&i[h][d]||o}y(a,"getTypeParser");function c(d,h,p){typeof h=="function"&&(p=h,h="text"),i[h][d]=p}y(c,"setTypeParser"),e.init(function(d,h){i.text[d]=h}),t.init(function(d,h){i.binary[d]=h})}),Ds=ue((r,e)=>{"use strict";Y(),e.exports={host:"localhost",user:le.platform==="win32"?le.env.USERNAME:le.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var t=Bs(),s=t.getTypeParser(20,"text"),n=t.getTypeParser(1016,"text");e.exports.__defineSetter__("parseInt8",function(i){t.setTypeParser(20,"text",i?t.getTypeParser(23,"text"):s),t.setTypeParser(1016,"text",i?t.getTypeParser(1007,"text"):n)})}),$s=ue((r,e)=>{"use strict";Y();var t=($a(),Le(Qn)),s=Ds();function n(g){var u=g.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+u+'"'}y(n,"escapeElement");function i(g){for(var u="{",v=0;v<g.length;v++)v>0&&(u=u+","),g[v]===null||typeof g[v]>"u"?u=u+"NULL":Array.isArray(g[v])?u=u+i(g[v]):g[v]instanceof re?u+="\\\\x"+g[v].toString("hex"):u+=n(o(g[v]));return u=u+"}",u}y(i,"arrayString");var o=y(function(g,u){if(g==null)return null;if(g instanceof re)return g;if(ArrayBuffer.isView(g)){var v=re.from(g.buffer,g.byteOffset,g.byteLength);return v.length===g.byteLength?v:v.slice(g.byteOffset,g.byteOffset+g.byteLength)}return g instanceof Date?s.parseInputDatesAsUTC?h(g):d(g):Array.isArray(g)?i(g):typeof g=="object"?a(g,u):g.toString()},"prepareValue");function a(g,u){if(g&&typeof g.toPostgres=="function"){if(u=u||[],u.indexOf(g)!==-1)throw new Error('circular reference detected while preparing "'+g+'" for query');return u.push(g),o(g.toPostgres(o),u)}return JSON.stringify(g)}y(a,"prepareObject");function c(g,u){for(g=""+g;g.length<u;)g="0"+g;return g}y(c,"pad");function d(g){var u=-g.getTimezoneOffset(),v=g.getFullYear(),w=v<1;w&&(v=Math.abs(v)+1);var S=c(v,4)+"-"+c(g.getMonth()+1,2)+"-"+c(g.getDate(),2)+"T"+c(g.getHours(),2)+":"+c(g.getMinutes(),2)+":"+c(g.getSeconds(),2)+"."+c(g.getMilliseconds(),3);return u<0?(S+="-",u*=-1):S+="+",S+=c(Math.floor(u/60),2)+":"+c(u%60,2),w&&(S+=" BC"),S}y(d,"dateToString");function h(g){var u=g.getUTCFullYear(),v=u<1;v&&(u=Math.abs(u)+1);var w=c(u,4)+"-"+c(g.getUTCMonth()+1,2)+"-"+c(g.getUTCDate(),2)+"T"+c(g.getUTCHours(),2)+":"+c(g.getUTCMinutes(),2)+":"+c(g.getUTCSeconds(),2)+"."+c(g.getUTCMilliseconds(),3);return w+="+00:00",v&&(w+=" BC"),w}y(h,"dateToStringUTC");function p(g,u,v){return g=typeof g=="string"?{text:g}:g,u&&(typeof u=="function"?g.callback=u:g.values=u),v&&(g.callback=v),g}y(p,"normalizeQueryConfig");var b=y(function(g){return t.createHash("md5").update(g,"utf-8").digest("hex")},"md5"),_=y(function(g,u,v){var w=b(u+g),S=b(re.concat([re.from(w),v]));return"md5"+S},"postgresMd5PasswordHash");e.exports={prepareValue:y(function(g){return o(g)},"prepareValueWrapper"),normalizeQueryConfig:p,postgresMd5PasswordHash:_,md5:b}}),ff=ue((r,e)=>{"use strict";Y();var t=($a(),Le(Qn));function s(u){if(u.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let v=t.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:v,response:"n,,n=*,r="+v,message:"SASLInitialResponse"}}y(s,"startSession");function n(u,v,w){if(u.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof v!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof w!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let S=d(w);if(S.nonce.startsWith(u.clientNonce)){if(S.nonce.length===u.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var E=re.from(S.salt,"base64"),O=g(v,E,S.iteration),L=_(O,"Client Key"),x=b(L),k="n=*,r="+u.clientNonce,P="r="+S.nonce+",s="+S.salt+",i="+S.iteration,C="c=biws,r="+S.nonce,B=k+","+P+","+C,M=_(x,B),W=p(L,M),K=W.toString("base64"),R=_(O,"Server Key"),U=_(R,B);u.message="SASLResponse",u.serverSignature=U.toString("base64"),u.response=C+",p="+K}y(n,"continueSession");function i(u,v){if(u.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof v!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:w}=h(v);if(w!==u.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}y(i,"finalizeSession");function o(u){if(typeof u!="string")throw new TypeError("SASL: text must be a string");return u.split("").map((v,w)=>u.charCodeAt(w)).every(v=>v>=33&&v<=43||v>=45&&v<=126)}y(o,"isPrintableChars");function a(u){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(u)}y(a,"isBase64");function c(u){if(typeof u!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(u.split(",").map(v=>{if(!/^.=/.test(v))throw new Error("SASL: Invalid attribute pair entry");let w=v[0],S=v.substring(2);return[w,S]}))}y(c,"parseAttributePairs");function d(u){let v=c(u),w=v.get("r");if(w){if(!o(w))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let S=v.get("s");if(S){if(!a(S))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let E=v.get("i");if(E){if(!/^[1-9][0-9]*$/.test(E))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let O=parseInt(E,10);return{nonce:w,salt:S,iteration:O}}y(d,"parseServerFirstMessage");function h(u){let v=c(u).get("v");if(v){if(!a(v))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:v}}y(h,"parseServerFinalMessage");function p(u,v){if(!re.isBuffer(u))throw new TypeError("first argument must be a Buffer");if(!re.isBuffer(v))throw new TypeError("second argument must be a Buffer");if(u.length!==v.length)throw new Error("Buffer lengths must match");if(u.length===0)throw new Error("Buffers cannot be empty");return re.from(u.map((w,S)=>u[S]^v[S]))}y(p,"xorBuffers");function b(u){return t.createHash("sha256").update(u).digest()}y(b,"sha256");function _(u,v){return t.createHmac("sha256",u).update(v).digest()}y(_,"hmacSha256");function g(u,v,w){for(var S=_(u,re.concat([v,re.from([0,0,0,1])])),E=S,O=0;O<w-1;O++)S=_(u,S),E=p(E,S);return E}y(g,"Hi"),e.exports={startSession:s,continueSession:n,finalizeSession:i}}),Vn={};st(Vn,{join:()=>Ua});function Ua(...r){return r.join("/")}var Qa=Ue(()=>{"use strict";Y(),y(Ua,"join")}),zn={};st(zn,{stat:()=>Va});function Va(r,e){e(new Error("No filesystem"))}var za=Ue(()=>{"use strict";Y(),y(Va,"stat")}),Wn={};st(Wn,{default:()=>Wa});var Wa,Ka=Ue(()=>{"use strict";Y(),Wa={}}),Ga={};st(Ga,{StringDecoder:()=>Za});var $n,Za,df=Ue(()=>{"use strict";Y(),$n=class{constructor(e){se(this,"td"),this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}},y($n,"StringDecoder"),Za=$n}),pf=ue((r,e)=>{"use strict";Y();var{Transform:t}=(Ka(),Le(Wn)),{StringDecoder:s}=(df(),Le(Ga)),n=Symbol("last"),i=Symbol("decoder");function o(p,b,_){let g;if(this.overflow){if(g=this[i].write(p).split(this.matcher),g.length===1)return _();g.shift(),this.overflow=!1}else this[n]+=this[i].write(p),g=this[n].split(this.matcher);this[n]=g.pop();for(let u=0;u<g.length;u++)try{c(this,this.mapper(g[u]))}catch(v){return _(v)}if(this.overflow=this[n].length>this.maxLength,this.overflow&&!this.skipOverflow){_(new Error("maximum buffer reached"));return}_()}y(o,"transform");function a(p){if(this[n]+=this[i].end(),this[n])try{c(this,this.mapper(this[n]))}catch(b){return p(b)}p()}y(a,"flush");function c(p,b){b!==void 0&&p.push(b)}y(c,"push");function d(p){return p}y(d,"noop");function h(p,b,_){switch(p=p||/\r?\n/,b=b||d,_=_||{},arguments.length){case 1:typeof p=="function"?(b=p,p=/\r?\n/):typeof p=="object"&&!(p instanceof RegExp)&&!p[Symbol.split]&&(_=p,p=/\r?\n/);break;case 2:typeof p=="function"?(_=b,b=p,p=/\r?\n/):typeof b=="object"&&(_=b,b=d)}_=Object.assign({},_),_.autoDestroy=!0,_.transform=o,_.flush=a,_.readableObjectMode=!0;let g=new t(_);return g[n]="",g[i]=new s("utf8"),g.matcher=p,g.mapper=b,g.maxLength=_.maxLength,g.skipOverflow=_.skipOverflow||!1,g.overflow=!1,g._destroy=function(u,v){this._writableState.errorEmitted=!1,v(u)},g}y(h,"split"),e.exports=h}),mf=ue((r,e)=>{"use strict";Y();var t=(Qa(),Le(Vn)),s=(Ka(),Le(Wn)).Stream,n=pf(),i=(Ms(),Le(Kr)),o=5432,a=le.platform==="win32",c=le.stderr,d=56,h=7,p=61440,b=32768;function _(L){return(L&p)==b}y(_,"isRegFile");var g=["host","port","database","user","password"],u=g.length,v=g[u-1];function w(){var L=c instanceof s&&c.writable===!0;if(L){var x=Array.prototype.slice.call(arguments).concat(`
`);c.write(i.format.apply(i,x))}}y(w,"warn"),Object.defineProperty(e.exports,"isWin",{get:y(function(){return a},"get"),set:y(function(L){a=L},"set")}),e.exports.warnTo=function(L){var x=c;return c=L,x},e.exports.getFileName=function(L){var x=L||le.env,k=x.PGPASSFILE||(a?t.join(x.APPDATA||"./","postgresql","pgpass.conf"):t.join(x.HOME||"./",".pgpass"));return k},e.exports.usePgPass=function(L,x){return Object.prototype.hasOwnProperty.call(le.env,"PGPASSWORD")?!1:a?!0:(x=x||"<unkn>",_(L.mode)?L.mode&(d|h)?(w('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',x),!1):!0:(w('WARNING: password file "%s" is not a plain file',x),!1))};var S=e.exports.match=function(L,x){return g.slice(0,-1).reduce(function(k,P,C){return C==1&&Number(L[P]||o)===Number(x[P])?k&&!0:k&&(x[P]==="*"||x[P]===L[P])},!0)};e.exports.getPassword=function(L,x,k){var P,C=x.pipe(n());function B(K){var R=E(K);R&&O(R)&&S(L,R)&&(P=R[v],C.end())}y(B,"onLine");var M=y(function(){x.destroy(),k(P)},"onEnd"),W=y(function(K){x.destroy(),w("WARNING: error on reading file: %s",K),k(void 0)},"onErr");x.on("error",W),C.on("data",B).on("end",M).on("error",W)};var E=e.exports.parseLine=function(L){if(L.length<11||L.match(/^\s+#/))return null;for(var x="",k="",P=0,C=0,B=0,M={},W=!1,K=y(function(U,J,ne){var fe=L.substring(J,ne);Object.hasOwnProperty.call(le.env,"PGPASS_NO_DEESCAPE")||(fe=fe.replace(/\\([:\\])/g,"$1")),M[g[U]]=fe},"addToObj"),R=0;R<L.length-1;R+=1){if(x=L.charAt(R+1),k=L.charAt(R),W=P==u-1,W){K(P,C);break}R>=0&&x==":"&&k!=="\\"&&(K(P,C,R+1),C=R+2,P+=1)}return M=Object.keys(M).length===u?M:null,M},O=e.exports.isValidEntry=function(L){for(var x={0:function(M){return M.length>0},1:function(M){return M==="*"?!0:(M=Number(M),isFinite(M)&&M>0&&M<9007199254740992&&Math.floor(M)===M)},2:function(M){return M.length>0},3:function(M){return M.length>0},4:function(M){return M.length>0}},k=0;k<g.length;k+=1){var P=x[k],C=L[g[k]]||"",B=P(C);if(!B)return!1}return!0}}),gf=ue((r,e)=>{"use strict";Y();var t=(Qa(),Le(Vn)),s=(za(),Le(zn)),n=mf();e.exports=function(i,o){var a=n.getFileName();s.stat(a,function(c,d){if(c||!n.usePgPass(d,a))return o(void 0);var h=s.createReadStream(a);n.getPassword(i,h,o)})},e.exports.warnTo=n.warnTo}),Kn=ue((r,e)=>{"use strict";Y();var t=Bs();function s(n){this._types=n||t,this.text={},this.binary={}}y(s,"TypeOverrides"),s.prototype.getOverrides=function(n){switch(n){case"text":return this.text;case"binary":return this.binary;default:return{}}},s.prototype.setTypeParser=function(n,i,o){typeof i=="function"&&(o=i,i="text"),this.getOverrides(i)[n]=o},s.prototype.getTypeParser=function(n,i){return i=i||"text",this.getOverrides(i)[n]||this._types.getTypeParser(n,i)},e.exports=s}),Ha={};st(Ha,{default:()=>Ja});var Ja,yf=Ue(()=>{"use strict";Y(),Ja={}}),Ya={};st(Ya,{parse:()=>Gn});function Gn(r,e=!1){let{protocol:t}=new URL(r),s="http:"+r.substring(t.length),{username:n,password:i,host:o,hostname:a,port:c,pathname:d,search:h,searchParams:p,hash:b}=new URL(s);i=decodeURIComponent(i),n=decodeURIComponent(n),d=decodeURIComponent(d);let _=n+":"+i,g=e?Object.fromEntries(p.entries()):h;return{href:r,protocol:t,auth:_,username:n,password:i,host:o,hostname:a,port:c,pathname:d,search:h,query:g,hash:b}}var Xa=Ue(()=>{"use strict";Y(),y(Gn,"parse")}),bf=ue((r,e)=>{"use strict";Y();var t=(Xa(),Le(Ya)),s=(za(),Le(zn));function n(i){if(i.charAt(0)==="/"){var a=i.split(" ");return{host:a[0],database:a[1]}}var o=t.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(i)?encodeURI(i).replace(/\%25(\d\d)/g,"%$1"):i,!0),a=o.query;for(var c in a)Array.isArray(a[c])&&(a[c]=a[c][a[c].length-1]);var d=(o.auth||":").split(":");if(a.user=d[0],a.password=d.splice(1).join(":"),a.port=o.port,o.protocol=="socket:")return a.host=decodeURI(o.pathname),a.database=o.query.db,a.client_encoding=o.query.encoding,a;a.host||(a.host=o.hostname);var h=o.pathname;if(!a.host&&h&&/^%2f/i.test(h)){var p=h.split("/");a.host=decodeURIComponent(p[0]),h=p.splice(1).join("/")}switch(h&&h.charAt(0)==="/"&&(h=h.slice(1)||null),a.database=h&&decodeURI(h),(a.ssl==="true"||a.ssl==="1")&&(a.ssl=!0),a.ssl==="0"&&(a.ssl=!1),(a.sslcert||a.sslkey||a.sslrootcert||a.sslmode)&&(a.ssl={}),a.sslcert&&(a.ssl.cert=s.readFileSync(a.sslcert).toString()),a.sslkey&&(a.ssl.key=s.readFileSync(a.sslkey).toString()),a.sslrootcert&&(a.ssl.ca=s.readFileSync(a.sslrootcert).toString()),a.sslmode){case"disable":{a.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{a.ssl.rejectUnauthorized=!1;break}}return a}y(n,"parse"),e.exports=n,n.parse=n}),Zn=ue((r,e)=>{"use strict";Y();var t=(yf(),Le(Ha)),s=Ds(),n=bf().parse,i=y(function(p,b,_){return _===void 0?_=le.env["PG"+p.toUpperCase()]:_===!1||(_=le.env[_]),b[p]||_||s[p]},"val"),o=y(function(){switch(le.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return s.ssl},"readSSLConfigFromEnvironment"),a=y(function(p){return"'"+(""+p).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),c=y(function(p,b,_){var g=b[_];g!=null&&p.push(_+"="+a(g))},"add"),d=class{constructor(b){b=typeof b=="string"?n(b):b||{},b.connectionString&&(b=Object.assign({},b,n(b.connectionString))),this.user=i("user",b),this.database=i("database",b),this.database===void 0&&(this.database=this.user),this.port=parseInt(i("port",b),10),this.host=i("host",b),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:i("password",b)}),this.binary=i("binary",b),this.options=i("options",b),this.ssl=typeof b.ssl>"u"?o():b.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=i("client_encoding",b),this.replication=i("replication",b),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=i("application_name",b,"PGAPPNAME"),this.fallback_application_name=i("fallback_application_name",b,!1),this.statement_timeout=i("statement_timeout",b,!1),this.lock_timeout=i("lock_timeout",b,!1),this.idle_in_transaction_session_timeout=i("idle_in_transaction_session_timeout",b,!1),this.query_timeout=i("query_timeout",b,!1),b.connectionTimeoutMillis===void 0?this.connect_timeout=le.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(b.connectionTimeoutMillis/1e3),b.keepAlive===!1?this.keepalives=0:b.keepAlive===!0&&(this.keepalives=1),typeof b.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(b.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(b){var _=[];c(_,this,"user"),c(_,this,"password"),c(_,this,"port"),c(_,this,"application_name"),c(_,this,"fallback_application_name"),c(_,this,"connect_timeout"),c(_,this,"options");var g=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(c(_,g,"sslmode"),c(_,g,"sslca"),c(_,g,"sslkey"),c(_,g,"sslcert"),c(_,g,"sslrootcert"),this.database&&_.push("dbname="+a(this.database)),this.replication&&_.push("replication="+a(this.replication)),this.host&&_.push("host="+a(this.host)),this.isDomainSocket)return b(null,_.join(" "));this.client_encoding&&_.push("client_encoding="+a(this.client_encoding)),t.lookup(this.host,function(u,v){return u?b(u,null):(_.push("hostaddr="+a(v)),b(null,_.join(" ")))})}};y(d,"ConnectionParameters");var h=d;e.exports=h}),vf=ue((r,e)=>{"use strict";Y();var t=Bs(),s=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,n=class{constructor(a,c){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=c,this.RowCtor=null,this.rowAsArray=a==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(a){var c;a.text?c=s.exec(a.text):c=s.exec(a.command),c&&(this.command=c[1],c[3]?(this.oid=parseInt(c[2],10),this.rowCount=parseInt(c[3],10)):c[2]&&(this.rowCount=parseInt(c[2],10)))}_parseRowAsArray(a){for(var c=new Array(a.length),d=0,h=a.length;d<h;d++){var p=a[d];p!==null?c[d]=this._parsers[d](p):c[d]=null}return c}parseRow(a){for(var c={},d=0,h=a.length;d<h;d++){var p=a[d],b=this.fields[d].name;p!==null?c[b]=this._parsers[d](p):c[b]=null}return c}addRow(a){this.rows.push(a)}addFields(a){this.fields=a,this.fields.length&&(this._parsers=new Array(a.length));for(var c=0;c<a.length;c++){var d=a[c];this._types?this._parsers[c]=this._types.getTypeParser(d.dataTypeID,d.format||"text"):this._parsers[c]=t.getTypeParser(d.dataTypeID,d.format||"text")}}};y(n,"Result");var i=n;e.exports=i}),_f=ue((r,e)=>{"use strict";Y();var{EventEmitter:t}=Ft(),s=vf(),n=$s(),i=class extends t{constructor(c,d,h){super(),c=n.normalizeQueryConfig(c,d,h),this.text=c.text,this.values=c.values,this.rows=c.rows,this.types=c.types,this.name=c.name,this.binary=c.binary,this.portal=c.portal||"",this.callback=c.callback,this._rowMode=c.rowMode,le.domain&&c.callback&&(this.callback=le.domain.bind(c.callback)),this._result=new s(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new s(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(c){this._checkForMultirow(),this._result.addFields(c.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(c){let d;if(!this._canceledDueToError){try{d=this._result.parseRow(c.fields)}catch(h){this._canceledDueToError=h;return}this.emit("row",d,this._result),this._accumulateRows&&this._result.addRow(d)}}handleCommandComplete(c,d){this._checkForMultirow(),this._result.addCommandComplete(c),this.rows&&d.sync()}handleEmptyQuery(c){this.rows&&c.sync()}handleError(c,d){if(this._canceledDueToError&&(c=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(c);this.emit("error",c)}handleReadyForQuery(c){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,c);if(this.callback)try{this.callback(null,this._results)}catch(d){le.nextTick(()=>{throw d})}this.emit("end",this._results)}submit(c){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let d=c.parsedStatements[this.name];return this.text&&d&&this.text!==d?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(c):c.query(this.text),null)}hasBeenParsed(c){return this.name&&c.parsedStatements[this.name]}handlePortalSuspended(c){this._getRows(c,this.rows)}_getRows(c,d){c.execute({portal:this.portal,rows:d}),d?c.flush():c.sync()}prepare(c){this.isPreparedStatement=!0,this.hasBeenParsed(c)||c.parse({text:this.text,name:this.name,types:this.types});try{c.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:n.prepareValue})}catch(d){this.handleError(d,c);return}c.describe({type:"P",name:this.portal||""}),this._getRows(c,this.rows)}handleCopyInResponse(c){c.sendCopyFail("No source stream defined")}handleCopyData(c,d){}};y(i,"Query");var o=i;e.exports=o}),el={};st(el,{Socket:()=>gt,isIP:()=>tl});function tl(r){return 0}var ka,qn,zr,gt,Hn=Ue(()=>{"use strict";Y(),ka=gr(Ft(),1),y(tl,"isIP"),qn=/^[^.]+\./,zr=class X extends ka.EventEmitter{constructor(){super(...arguments),se(this,"opts",{}),se(this,"connecting",!1),se(this,"pending",!0),se(this,"writable",!0),se(this,"encrypted",!1),se(this,"authorized",!1),se(this,"destroyed",!1),se(this,"ws",null),se(this,"writeBuffer"),se(this,"tlsState",0),se(this,"tlsRead"),se(this,"tlsWrite")}static get poolQueryViaFetch(){return X.opts.poolQueryViaFetch??X.defaults.poolQueryViaFetch}static set poolQueryViaFetch(e){X.opts.poolQueryViaFetch=e}static get fetchEndpoint(){return X.opts.fetchEndpoint??X.defaults.fetchEndpoint}static set fetchEndpoint(e){X.opts.fetchEndpoint=e}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return X.opts.fetchFunction??X.defaults.fetchFunction}static set fetchFunction(e){X.opts.fetchFunction=e}static get webSocketConstructor(){return X.opts.webSocketConstructor??X.defaults.webSocketConstructor}static set webSocketConstructor(e){X.opts.webSocketConstructor=e}get webSocketConstructor(){return this.opts.webSocketConstructor??X.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return X.opts.wsProxy??X.defaults.wsProxy}static set wsProxy(e){X.opts.wsProxy=e}get wsProxy(){return this.opts.wsProxy??X.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return X.opts.coalesceWrites??X.defaults.coalesceWrites}static set coalesceWrites(e){X.opts.coalesceWrites=e}get coalesceWrites(){return this.opts.coalesceWrites??X.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return X.opts.useSecureWebSocket??X.defaults.useSecureWebSocket}static set useSecureWebSocket(e){X.opts.useSecureWebSocket=e}get useSecureWebSocket(){return this.opts.useSecureWebSocket??X.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return X.opts.forceDisablePgSSL??X.defaults.forceDisablePgSSL}static set forceDisablePgSSL(e){X.opts.forceDisablePgSSL=e}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??X.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return X.opts.disableSNI??X.defaults.disableSNI}static set disableSNI(e){X.opts.disableSNI=e}get disableSNI(){return this.opts.disableSNI??X.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get pipelineConnect(){return X.opts.pipelineConnect??X.defaults.pipelineConnect}static set pipelineConnect(e){X.opts.pipelineConnect=e}get pipelineConnect(){return this.opts.pipelineConnect??X.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return X.opts.subtls??X.defaults.subtls}static set subtls(e){X.opts.subtls=e}get subtls(){return this.opts.subtls??X.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return X.opts.pipelineTLS??X.defaults.pipelineTLS}static set pipelineTLS(e){X.opts.pipelineTLS=e}get pipelineTLS(){return this.opts.pipelineTLS??X.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return X.opts.rootCerts??X.defaults.rootCerts}static set rootCerts(e){X.opts.rootCerts=e}get rootCerts(){return this.opts.rootCerts??X.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,t){let s=this.wsProxy;if(s===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof s=="function"?s(e,t):`${s}?address=${e}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,t,s){this.connecting=!0,s&&this.once("connect",s);let n=y(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),i=y((a,c=!1)=>{a.binaryType="arraybuffer",a.addEventListener("error",d=>{this.emit("error",d),this.emit("close")}),a.addEventListener("message",d=>{if(this.tlsState===0){let h=re.from(d.data);this.emit("data",h)}}),a.addEventListener("close",()=>{this.emit("close")}),c?n():a.addEventListener("open",n)},"configureWebSocket"),o;try{o=this.wsProxyAddrForHost(t,typeof e=="string"?parseInt(e,10):e)}catch(a){this.emit("error",a),this.emit("close");return}try{let a=(this.useSecureWebSocket?"wss:":"ws:")+"//"+o;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(a),i(this.ws);else try{this.ws=new WebSocket(a),i(this.ws)}catch{this.ws=new __unstable_WebSocket(a),i(this.ws)}}catch(a){let c=(this.useSecureWebSocket?"https:":"http:")+"//"+o;fetch(c,{headers:{Upgrade:"websocket"}}).then(d=>{if(this.ws=d.webSocket,this.ws==null)throw a;this.ws.accept(),i(this.ws,!0)}).catch(d=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${d.message}`)),this.emit("close")})}}async startTls(e){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let t=this.subtls.TrustedCert.fromPEM(this.rootCerts),s=new this.subtls.WebSocketReadQueue(this.ws),n=s.read.bind(s),i=this.rawWrite.bind(this),[o,a]=await this.subtls.startTls(e,t,n,i,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=o,this.tlsWrite=a,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(e===void 0)break;{let t=re.from(e);this.emit("data",t)}}}rawWrite(e){if(!this.coalesceWrites){this.ws.send(e);return}if(this.writeBuffer===void 0)this.writeBuffer=e,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+e.length);t.set(this.writeBuffer),t.set(e,this.writeBuffer.length),this.writeBuffer=t}}write(e,t="utf8",s=n=>{}){return e.length===0?(s(),!0):(typeof e=="string"&&(e=re.from(e,t)),this.tlsState===0?(this.rawWrite(e),s()):this.tlsState===1?this.once("secureConnection",()=>{this.write(e,t,s)}):(this.tlsWrite(e),s()),!0)}end(e=re.alloc(0),t="utf8",s=()=>{}){return this.write(e,t,()=>{this.ws.close(),s()}),this}destroy(){return this.destroyed=!0,this.end()}},y(zr,"Socket"),se(zr,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:y((r,e,t)=>{let s;return t?.jwtAuth?s=r.replace(qn,"apiauth."):s=r.replace(qn,"api."),"https://"+s+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:y(r=>r+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),se(zr,"opts",{}),gt=zr}),rl=ue(r=>{"use strict";Y(),Object.defineProperty(r,"__esModule",{value:!0}),r.NoticeMessage=r.DataRowMessage=r.CommandCompleteMessage=r.ReadyForQueryMessage=r.NotificationResponseMessage=r.BackendKeyDataMessage=r.AuthenticationMD5Password=r.ParameterStatusMessage=r.ParameterDescriptionMessage=r.RowDescriptionMessage=r.Field=r.CopyResponse=r.CopyDataMessage=r.DatabaseError=r.copyDone=r.emptyQuery=r.replicationStart=r.portalSuspended=r.noData=r.closeComplete=r.bindComplete=r.parseComplete=void 0,r.parseComplete={name:"parseComplete",length:5},r.bindComplete={name:"bindComplete",length:5},r.closeComplete={name:"closeComplete",length:5},r.noData={name:"noData",length:5},r.portalSuspended={name:"portalSuspended",length:5},r.replicationStart={name:"replicationStart",length:4},r.emptyQuery={name:"emptyQuery",length:4},r.copyDone={name:"copyDone",length:4};var e=class extends Error{constructor(R,U,J){super(R),this.length=U,this.name=J}};y(e,"DatabaseError");var t=e;r.DatabaseError=t;var s=class{constructor(R,U){this.length=R,this.chunk=U,this.name="copyData"}};y(s,"CopyDataMessage");var n=s;r.CopyDataMessage=n;var i=class{constructor(R,U,J,ne){this.length=R,this.name=U,this.binary=J,this.columnTypes=new Array(ne)}};y(i,"CopyResponse");var o=i;r.CopyResponse=o;var a=class{constructor(R,U,J,ne,fe,pe,ke){this.name=R,this.tableID=U,this.columnID=J,this.dataTypeID=ne,this.dataTypeSize=fe,this.dataTypeModifier=pe,this.format=ke}};y(a,"Field");var c=a;r.Field=c;var d=class{constructor(R,U){this.length=R,this.fieldCount=U,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};y(d,"RowDescriptionMessage");var h=d;r.RowDescriptionMessage=h;var p=class{constructor(R,U){this.length=R,this.parameterCount=U,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};y(p,"ParameterDescriptionMessage");var b=p;r.ParameterDescriptionMessage=b;var _=class{constructor(R,U,J){this.length=R,this.parameterName=U,this.parameterValue=J,this.name="parameterStatus"}};y(_,"ParameterStatusMessage");var g=_;r.ParameterStatusMessage=g;var u=class{constructor(R,U){this.length=R,this.salt=U,this.name="authenticationMD5Password"}};y(u,"AuthenticationMD5Password");var v=u;r.AuthenticationMD5Password=v;var w=class{constructor(R,U,J){this.length=R,this.processID=U,this.secretKey=J,this.name="backendKeyData"}};y(w,"BackendKeyDataMessage");var S=w;r.BackendKeyDataMessage=S;var E=class{constructor(R,U,J,ne){this.length=R,this.processId=U,this.channel=J,this.payload=ne,this.name="notification"}};y(E,"NotificationResponseMessage");var O=E;r.NotificationResponseMessage=O;var L=class{constructor(R,U){this.length=R,this.status=U,this.name="readyForQuery"}};y(L,"ReadyForQueryMessage");var x=L;r.ReadyForQueryMessage=x;var k=class{constructor(R,U){this.length=R,this.text=U,this.name="commandComplete"}};y(k,"CommandCompleteMessage");var P=k;r.CommandCompleteMessage=P;var C=class{constructor(R,U){this.length=R,this.fields=U,this.name="dataRow",this.fieldCount=U.length}};y(C,"DataRowMessage");var B=C;r.DataRowMessage=B;var M=class{constructor(R,U){this.length=R,this.message=U,this.name="notice"}};y(M,"NoticeMessage");var W=M;r.NoticeMessage=W}),wf=ue(r=>{"use strict";Y(),Object.defineProperty(r,"__esModule",{value:!0}),r.Writer=void 0;var e=class{constructor(n=256){this.size=n,this.offset=5,this.headerPosition=0,this.buffer=re.allocUnsafe(n)}ensure(n){var i=this.buffer.length-this.offset;if(i<n){var o=this.buffer,a=o.length+(o.length>>1)+n;this.buffer=re.allocUnsafe(a),o.copy(this.buffer)}}addInt32(n){return this.ensure(4),this.buffer[this.offset++]=n>>>24&255,this.buffer[this.offset++]=n>>>16&255,this.buffer[this.offset++]=n>>>8&255,this.buffer[this.offset++]=n>>>0&255,this}addInt16(n){return this.ensure(2),this.buffer[this.offset++]=n>>>8&255,this.buffer[this.offset++]=n>>>0&255,this}addCString(n){if(!n)this.ensure(1);else{var i=re.byteLength(n);this.ensure(i+1),this.buffer.write(n,this.offset,"utf-8"),this.offset+=i}return this.buffer[this.offset++]=0,this}addString(n=""){var i=re.byteLength(n);return this.ensure(i),this.buffer.write(n,this.offset),this.offset+=i,this}add(n){return this.ensure(n.length),n.copy(this.buffer,this.offset),this.offset+=n.length,this}join(n){if(n){this.buffer[this.headerPosition]=n;let i=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(i,this.headerPosition+1)}return this.buffer.slice(n?0:5,this.offset)}flush(n){var i=this.join(n);return this.offset=5,this.headerPosition=0,this.buffer=re.allocUnsafe(this.size),i}};y(e,"Writer");var t=e;r.Writer=t}),Sf=ue(r=>{"use strict";Y(),Object.defineProperty(r,"__esModule",{value:!0}),r.serialize=void 0;var e=wf(),t=new e.Writer,s=y(R=>{t.addInt16(3).addInt16(0);for(let ne of Object.keys(R))t.addCString(ne).addCString(R[ne]);t.addCString("client_encoding").addCString("UTF8");var U=t.addCString("").flush(),J=U.length+4;return new e.Writer().addInt32(J).add(U).flush()},"startup"),n=y(()=>{let R=re.allocUnsafe(8);return R.writeInt32BE(8,0),R.writeInt32BE(80877103,4),R},"requestSsl"),i=y(R=>t.addCString(R).flush(112),"password"),o=y(function(R,U){return t.addCString(R).addInt32(re.byteLength(U)).addString(U),t.flush(112)},"sendSASLInitialResponseMessage"),a=y(function(R){return t.addString(R).flush(112)},"sendSCRAMClientFinalMessage"),c=y(R=>t.addCString(R).flush(81),"query"),d=[],h=y(R=>{let U=R.name||"";U.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",U,U.length),console.error("This can cause conflicts and silent errors executing queries"));let J=R.types||d;for(var ne=J.length,fe=t.addCString(U).addCString(R.text).addInt16(ne),pe=0;pe<ne;pe++)fe.addInt32(J[pe]);return t.flush(80)},"parse"),p=new e.Writer,b=y(function(R,U){for(let J=0;J<R.length;J++){let ne=U?U(R[J],J):R[J];ne==null?(t.addInt16(0),p.addInt32(-1)):ne instanceof re?(t.addInt16(1),p.addInt32(ne.length),p.add(ne)):(t.addInt16(0),p.addInt32(re.byteLength(ne)),p.addString(ne))}},"writeValues"),_=y((R={})=>{let U=R.portal||"",J=R.statement||"",ne=R.binary||!1,fe=R.values||d,pe=fe.length;return t.addCString(U).addCString(J),t.addInt16(pe),b(fe,R.valueMapper),t.addInt16(pe),t.add(p.flush()),t.addInt16(ne?1:0),t.flush(66)},"bind"),g=re.from([69,0,0,0,9,0,0,0,0,0]),u=y(R=>{if(!R||!R.portal&&!R.rows)return g;let U=R.portal||"",J=R.rows||0,ne=re.byteLength(U),fe=4+ne+1+4,pe=re.allocUnsafe(1+fe);return pe[0]=69,pe.writeInt32BE(fe,1),pe.write(U,5,"utf-8"),pe[ne+5]=0,pe.writeUInt32BE(J,pe.length-4),pe},"execute"),v=y((R,U)=>{let J=re.allocUnsafe(16);return J.writeInt32BE(16,0),J.writeInt16BE(1234,4),J.writeInt16BE(5678,6),J.writeInt32BE(R,8),J.writeInt32BE(U,12),J},"cancel"),w=y((R,U)=>{let J=4+re.byteLength(U)+1,ne=re.allocUnsafe(1+J);return ne[0]=R,ne.writeInt32BE(J,1),ne.write(U,5,"utf-8"),ne[J]=0,ne},"cstringMessage"),S=t.addCString("P").flush(68),E=t.addCString("S").flush(68),O=y(R=>R.name?w(68,`${R.type}${R.name||""}`):R.type==="P"?S:E,"describe"),L=y(R=>{let U=`${R.type}${R.name||""}`;return w(67,U)},"close"),x=y(R=>t.add(R).flush(100),"copyData"),k=y(R=>w(102,R),"copyFail"),P=y(R=>re.from([R,0,0,0,4]),"codeOnlyBuffer"),C=P(72),B=P(83),M=P(88),W=P(99),K={startup:s,password:i,requestSsl:n,sendSASLInitialResponseMessage:o,sendSCRAMClientFinalMessage:a,query:c,parse:h,bind:_,execute:u,describe:O,close:L,flush:y(()=>C,"flush"),sync:y(()=>B,"sync"),end:y(()=>M,"end"),copyData:x,copyDone:y(()=>W,"copyDone"),copyFail:k,cancel:v};r.serialize=K}),xf=ue(r=>{"use strict";Y(),Object.defineProperty(r,"__esModule",{value:!0}),r.BufferReader=void 0;var e=re.allocUnsafe(0),t=class{constructor(i=0){this.offset=i,this.buffer=e,this.encoding="utf-8"}setBuffer(i,o){this.offset=i,this.buffer=o}int16(){let i=this.buffer.readInt16BE(this.offset);return this.offset+=2,i}byte(){let i=this.buffer[this.offset];return this.offset++,i}int32(){let i=this.buffer.readInt32BE(this.offset);return this.offset+=4,i}string(i){let o=this.buffer.toString(this.encoding,this.offset,this.offset+i);return this.offset+=i,o}cstring(){let i=this.offset,o=i;for(;this.buffer[o++]!==0;);return this.offset=o,this.buffer.toString(this.encoding,i,o-1)}bytes(i){let o=this.buffer.slice(this.offset,this.offset+i);return this.offset+=i,o}};y(t,"BufferReader");var s=t;r.BufferReader=s}),Ef=ue(r=>{"use strict";Y(),Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var e=rl(),t=xf(),s=1,n=4,i=s+n,o=re.allocUnsafe(0),a=class{constructor(h){if(this.buffer=o,this.bufferLength=0,this.bufferOffset=0,this.reader=new t.BufferReader,h?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=h?.mode||"text"}parse(h,p){this.mergeBuffer(h);let b=this.bufferOffset+this.bufferLength,_=this.bufferOffset;for(;_+i<=b;){let g=this.buffer[_],u=this.buffer.readUInt32BE(_+s),v=s+u;if(v+_<=b){let w=this.handlePacket(_+i,g,u,this.buffer);p(w),_+=v}else break}_===b?(this.buffer=o,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=b-_,this.bufferOffset=_)}mergeBuffer(h){if(this.bufferLength>0){let p=this.bufferLength+h.byteLength;if(p+this.bufferOffset>this.buffer.byteLength){let b;if(p<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)b=this.buffer;else{let _=this.buffer.byteLength*2;for(;p>=_;)_*=2;b=re.allocUnsafe(_)}this.buffer.copy(b,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=b,this.bufferOffset=0}h.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=p}else this.buffer=h,this.bufferOffset=0,this.bufferLength=h.byteLength}handlePacket(h,p,b,_){switch(p){case 50:return e.bindComplete;case 49:return e.parseComplete;case 51:return e.closeComplete;case 110:return e.noData;case 115:return e.portalSuspended;case 99:return e.copyDone;case 87:return e.replicationStart;case 73:return e.emptyQuery;case 68:return this.parseDataRowMessage(h,b,_);case 67:return this.parseCommandCompleteMessage(h,b,_);case 90:return this.parseReadyForQueryMessage(h,b,_);case 65:return this.parseNotificationMessage(h,b,_);case 82:return this.parseAuthenticationResponse(h,b,_);case 83:return this.parseParameterStatusMessage(h,b,_);case 75:return this.parseBackendKeyData(h,b,_);case 69:return this.parseErrorMessage(h,b,_,"error");case 78:return this.parseErrorMessage(h,b,_,"notice");case 84:return this.parseRowDescriptionMessage(h,b,_);case 116:return this.parseParameterDescriptionMessage(h,b,_);case 71:return this.parseCopyInMessage(h,b,_);case 72:return this.parseCopyOutMessage(h,b,_);case 100:return this.parseCopyData(h,b,_);default:return new e.DatabaseError("received invalid response: "+p.toString(16),b,"error")}}parseReadyForQueryMessage(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.string(1);return new e.ReadyForQueryMessage(p,_)}parseCommandCompleteMessage(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.cstring();return new e.CommandCompleteMessage(p,_)}parseCopyData(h,p,b){let _=b.slice(h,h+(p-4));return new e.CopyDataMessage(p,_)}parseCopyInMessage(h,p,b){return this.parseCopyMessage(h,p,b,"copyInResponse")}parseCopyOutMessage(h,p,b){return this.parseCopyMessage(h,p,b,"copyOutResponse")}parseCopyMessage(h,p,b,_){this.reader.setBuffer(h,b);let g=this.reader.byte()!==0,u=this.reader.int16(),v=new e.CopyResponse(p,_,g,u);for(let w=0;w<u;w++)v.columnTypes[w]=this.reader.int16();return v}parseNotificationMessage(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.int32(),g=this.reader.cstring(),u=this.reader.cstring();return new e.NotificationResponseMessage(p,_,g,u)}parseRowDescriptionMessage(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.int16(),g=new e.RowDescriptionMessage(p,_);for(let u=0;u<_;u++)g.fields[u]=this.parseField();return g}parseField(){let h=this.reader.cstring(),p=this.reader.int32(),b=this.reader.int16(),_=this.reader.int32(),g=this.reader.int16(),u=this.reader.int32(),v=this.reader.int16()===0?"text":"binary";return new e.Field(h,p,b,_,g,u,v)}parseParameterDescriptionMessage(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.int16(),g=new e.ParameterDescriptionMessage(p,_);for(let u=0;u<_;u++)g.dataTypeIDs[u]=this.reader.int32();return g}parseDataRowMessage(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.int16(),g=new Array(_);for(let u=0;u<_;u++){let v=this.reader.int32();g[u]=v===-1?null:this.reader.string(v)}return new e.DataRowMessage(p,g)}parseParameterStatusMessage(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.cstring(),g=this.reader.cstring();return new e.ParameterStatusMessage(p,_,g)}parseBackendKeyData(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.int32(),g=this.reader.int32();return new e.BackendKeyDataMessage(p,_,g)}parseAuthenticationResponse(h,p,b){this.reader.setBuffer(h,b);let _=this.reader.int32(),g={name:"authenticationOk",length:p};switch(_){case 0:break;case 3:g.length===8&&(g.name="authenticationCleartextPassword");break;case 5:if(g.length===12){g.name="authenticationMD5Password";let v=this.reader.bytes(4);return new e.AuthenticationMD5Password(p,v)}break;case 10:g.name="authenticationSASL",g.mechanisms=[];let u;do u=this.reader.cstring(),u&&g.mechanisms.push(u);while(u);break;case 11:g.name="authenticationSASLContinue",g.data=this.reader.string(p-8);break;case 12:g.name="authenticationSASLFinal",g.data=this.reader.string(p-8);break;default:throw new Error("Unknown authenticationOk message type "+_)}return g}parseErrorMessage(h,p,b,_){this.reader.setBuffer(h,b);let g={},u=this.reader.string(1);for(;u!=="\0";)g[u]=this.reader.cstring(),u=this.reader.string(1);let v=g.M,w=_==="notice"?new e.NoticeMessage(p,v):new e.DatabaseError(v,p,_);return w.severity=g.S,w.code=g.C,w.detail=g.D,w.hint=g.H,w.position=g.P,w.internalPosition=g.p,w.internalQuery=g.q,w.where=g.W,w.schema=g.s,w.table=g.t,w.column=g.c,w.dataType=g.d,w.constraint=g.n,w.file=g.F,w.line=g.L,w.routine=g.R,w}};y(a,"Parser");var c=a;r.Parser=c}),sl=ue(r=>{"use strict";Y(),Object.defineProperty(r,"__esModule",{value:!0}),r.DatabaseError=r.serialize=r.parse=void 0;var e=rl();Object.defineProperty(r,"DatabaseError",{enumerable:!0,get:y(function(){return e.DatabaseError},"get")});var t=Sf();Object.defineProperty(r,"serialize",{enumerable:!0,get:y(function(){return t.serialize},"get")});var s=Ef();function n(i,o){let a=new s.Parser;return i.on("data",c=>a.parse(c,o)),new Promise(c=>i.on("end",()=>c()))}y(n,"parse"),r.parse=n}),nl={};st(nl,{connect:()=>il});function il({socket:r,servername:e}){return r.startTls(e),r}var Tf=Ue(()=>{"use strict";Y(),y(il,"connect")}),ol=ue((r,e)=>{"use strict";Y();var t=(Hn(),Le(el)),s=Ft().EventEmitter,{parse:n,serialize:i}=sl(),o=i.flush(),a=i.sync(),c=i.end(),d=class extends s{constructor(b){super(),b=b||{},this.stream=b.stream||new t.Socket,this._keepAlive=b.keepAlive,this._keepAliveInitialDelayMillis=b.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=b.ssl||!1,this._ending=!1,this._emitMessage=!1;var _=this;this.on("newListener",function(g){g==="message"&&(_._emitMessage=!0)})}connect(b,_){var g=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(b,_),this.stream.once("connect",function(){g._keepAlive&&g.stream.setKeepAlive(!0,g._keepAliveInitialDelayMillis),g.emit("connect")});let u=y(function(v){g._ending&&(v.code==="ECONNRESET"||v.code==="EPIPE")||g.emit("error",v)},"reportStreamError");if(this.stream.on("error",u),this.stream.on("close",function(){g.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(v){var w=v.toString("utf8");switch(w){case"S":break;case"N":return g.stream.end(),g.emit("error",new Error("The server does not support SSL connections"));default:return g.stream.end(),g.emit("error",new Error("There was an error establishing an SSL connection"))}var S=(Tf(),Le(nl));let E={socket:g.stream};g.ssl!==!0&&(Object.assign(E,g.ssl),"key"in g.ssl&&(E.key=g.ssl.key)),t.isIP(_)===0&&(E.servername=_);try{g.stream=S.connect(E)}catch(O){return g.emit("error",O)}g.attachListeners(g.stream),g.stream.on("error",u),g.emit("sslconnect")})}attachListeners(b){b.on("end",()=>{this.emit("end")}),n(b,_=>{var g=_.name==="error"?"errorMessage":_.name;this._emitMessage&&this.emit("message",_),this.emit(g,_)})}requestSsl(){this.stream.write(i.requestSsl())}startup(b){this.stream.write(i.startup(b))}cancel(b,_){this._send(i.cancel(b,_))}password(b){this._send(i.password(b))}sendSASLInitialResponseMessage(b,_){this._send(i.sendSASLInitialResponseMessage(b,_))}sendSCRAMClientFinalMessage(b){this._send(i.sendSCRAMClientFinalMessage(b))}_send(b){return this.stream.writable?this.stream.write(b):!1}query(b){this._send(i.query(b))}parse(b){this._send(i.parse(b))}bind(b){this._send(i.bind(b))}execute(b){this._send(i.execute(b))}flush(){this.stream.writable&&this.stream.write(o)}sync(){this._ending=!0,this._send(o),this._send(a)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(c,()=>{this.stream.end()})}close(b){this._send(i.close(b))}describe(b){this._send(i.describe(b))}sendCopyFromChunk(b){this._send(i.copyData(b))}endCopyFrom(){this._send(i.copyDone())}sendCopyFail(b){this._send(i.copyFail(b))}};y(d,"Connection");var h=d;e.exports=h}),Cf=ue((r,e)=>{"use strict";Y();var t=Ft().EventEmitter,s=(Ms(),Le(Kr)),n=$s(),i=ff(),o=gf(),a=Kn(),c=Zn(),d=_f(),h=Ds(),p=ol(),b=class extends t{constructor(u){super(),this.connectionParameters=new c(u),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var v=u||{};this._Promise=v.Promise||Rs.Promise,this._types=new a(v.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=v.connection||new p({stream:v.stream,ssl:this.connectionParameters.ssl,keepAlive:v.keepAlive||!1,keepAliveInitialDelayMillis:v.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=v.binary||h.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=v.connectionTimeoutMillis||0}_errorAllQueries(u){let v=y(w=>{le.nextTick(()=>{w.handleError(u,this.connection)})},"enqueueError");this.activeQuery&&(v(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(v),this.queryQueue.length=0}_connect(u){var v=this,w=this.connection;if(this._connectionCallback=u,this._connecting||this._connected){let S=new Error("Client has already been connected. You cannot reuse a client.");le.nextTick(()=>{u(S)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{w._ending=!0,w.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?w.connect(this.host+"/.s.PGSQL."+this.port):w.connect(this.port,this.host),w.on("connect",function(){v.ssl?w.requestSsl():w.startup(v.getStartupConf())}),w.on("sslconnect",function(){w.startup(v.getStartupConf())}),this._attachListeners(w),w.once("end",()=>{let S=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(S),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(S):this._handleErrorEvent(S):this._connectionError||this._handleErrorEvent(S)),le.nextTick(()=>{this.emit("end")})})}connect(u){if(u){this._connect(u);return}return new this._Promise((v,w)=>{this._connect(S=>{S?w(S):v()})})}_attachListeners(u){u.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),u.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),u.on("authenticationSASL",this._handleAuthSASL.bind(this)),u.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),u.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),u.on("backendKeyData",this._handleBackendKeyData.bind(this)),u.on("error",this._handleErrorEvent.bind(this)),u.on("errorMessage",this._handleErrorMessage.bind(this)),u.on("readyForQuery",this._handleReadyForQuery.bind(this)),u.on("notice",this._handleNotice.bind(this)),u.on("rowDescription",this._handleRowDescription.bind(this)),u.on("dataRow",this._handleDataRow.bind(this)),u.on("portalSuspended",this._handlePortalSuspended.bind(this)),u.on("emptyQuery",this._handleEmptyQuery.bind(this)),u.on("commandComplete",this._handleCommandComplete.bind(this)),u.on("parseComplete",this._handleParseComplete.bind(this)),u.on("copyInResponse",this._handleCopyInResponse.bind(this)),u.on("copyData",this._handleCopyData.bind(this)),u.on("notification",this._handleNotification.bind(this))}_checkPgPass(u){let v=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(w=>{if(w!==void 0){if(typeof w!="string"){v.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=w}else this.connectionParameters.password=this.password=null;u()}).catch(w=>{v.emit("error",w)}):this.password!==null?u():o(this.connectionParameters,w=>{w!==void 0&&(this.connectionParameters.password=this.password=w),u()})}_handleAuthCleartextPassword(u){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(u){this._checkPgPass(()=>{let v=n.postgresMd5PasswordHash(this.user,this.password,u.salt);this.connection.password(v)})}_handleAuthSASL(u){this._checkPgPass(()=>{this.saslSession=i.startSession(u.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(u){i.continueSession(this.saslSession,this.password,u.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(u){i.finalizeSession(this.saslSession,u.data),this.saslSession=null}_handleBackendKeyData(u){this.processID=u.processID,this.secretKey=u.secretKey}_handleReadyForQuery(u){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:v}=this;this.activeQuery=null,this.readyForQuery=!0,v&&v.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(u){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(u);this.emit("error",u)}}_handleErrorEvent(u){if(this._connecting)return this._handleErrorWhileConnecting(u);this._queryable=!1,this._errorAllQueries(u),this.emit("error",u)}_handleErrorMessage(u){if(this._connecting)return this._handleErrorWhileConnecting(u);let v=this.activeQuery;if(!v){this._handleErrorEvent(u);return}this.activeQuery=null,v.handleError(u,this.connection)}_handleRowDescription(u){this.activeQuery.handleRowDescription(u)}_handleDataRow(u){this.activeQuery.handleDataRow(u)}_handlePortalSuspended(u){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(u){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(u){this.activeQuery.handleCommandComplete(u,this.connection)}_handleParseComplete(u){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(u){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(u){this.activeQuery.handleCopyData(u,this.connection)}_handleNotification(u){this.emit("notification",u)}_handleNotice(u){this.emit("notice",u)}getStartupConf(){var u=this.connectionParameters,v={user:u.user,database:u.database},w=u.application_name||u.fallback_application_name;return w&&(v.application_name=w),u.replication&&(v.replication=""+u.replication),u.statement_timeout&&(v.statement_timeout=String(parseInt(u.statement_timeout,10))),u.lock_timeout&&(v.lock_timeout=String(parseInt(u.lock_timeout,10))),u.idle_in_transaction_session_timeout&&(v.idle_in_transaction_session_timeout=String(parseInt(u.idle_in_transaction_session_timeout,10))),u.options&&(v.options=u.options),v}cancel(u,v){if(u.activeQuery===v){var w=this.connection;this.host&&this.host.indexOf("/")===0?w.connect(this.host+"/.s.PGSQL."+this.port):w.connect(this.port,this.host),w.on("connect",function(){w.cancel(u.processID,u.secretKey)})}else u.queryQueue.indexOf(v)!==-1&&u.queryQueue.splice(u.queryQueue.indexOf(v),1)}setTypeParser(u,v,w){return this._types.setTypeParser(u,v,w)}getTypeParser(u,v){return this._types.getTypeParser(u,v)}escapeIdentifier(u){return'"'+u.replace(/"/g,'""')+'"'}escapeLiteral(u){for(var v=!1,w="'",S=0;S<u.length;S++){var E=u[S];E==="'"?w+=E+E:E==="\\"?(w+=E+E,v=!0):w+=E}return w+="'",v===!0&&(w=" E"+w),w}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let u=this.activeQuery.submit(this.connection);u&&le.nextTick(()=>{this.activeQuery.handleError(u,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(u,v,w){var S,E,O,L,x;if(u==null)throw new TypeError("Client was passed a null or undefined query");return typeof u.submit=="function"?(O=u.query_timeout||this.connectionParameters.query_timeout,E=S=u,typeof v=="function"&&(S.callback=S.callback||v)):(O=this.connectionParameters.query_timeout,S=new d(u,v,w),S.callback||(E=new this._Promise((k,P)=>{S.callback=(C,B)=>C?P(C):k(B)}))),O&&(x=S.callback,L=setTimeout(()=>{var k=new Error("Query read timeout");le.nextTick(()=>{S.handleError(k,this.connection)}),x(k),S.callback=()=>{};var P=this.queryQueue.indexOf(S);P>-1&&this.queryQueue.splice(P,1),this._pulseQueryQueue()},O),S.callback=(k,P)=>{clearTimeout(L),x(k,P)}),this.binary&&!S.binary&&(S.binary=!0),S._result&&!S._result._types&&(S._result._types=this._types),this._queryable?this._ending?(le.nextTick(()=>{S.handleError(new Error("Client was closed and is not queryable"),this.connection)}),E):(this.queryQueue.push(S),this._pulseQueryQueue(),E):(le.nextTick(()=>{S.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),E)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(u){if(this._ending=!0,!this.connection._connecting)if(u)u();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),u)this.connection.once("end",u);else return new this._Promise(v=>{this.connection.once("end",v)})}};y(b,"Client");var _=b;_.Query=d,e.exports=_}),Nf=ue((r,e)=>{"use strict";Y();var t=Ft().EventEmitter,s=y(function(){},"NOOP"),n=y((g,u)=>{let v=g.findIndex(u);return v===-1?void 0:g.splice(v,1)[0]},"removeWhere"),i=class{constructor(u,v,w){this.client=u,this.idleListener=v,this.timeoutId=w}};y(i,"IdleItem");var o=i,a=class{constructor(u){this.callback=u}};y(a,"PendingItem");var c=a;function d(){throw new Error("Release called on client which has already been released to the pool.")}y(d,"throwOnDoubleRelease");function h(g,u){if(u)return{callback:u,result:void 0};let v,w,S=y(function(O,L){O?v(O):w(L)},"cb"),E=new g(function(O,L){w=O,v=L}).catch(O=>{throw Error.captureStackTrace(O),O});return{callback:S,result:E}}y(h,"promisify");function p(g,u){return y(function v(w){w.client=u,u.removeListener("error",v),u.on("error",()=>{g.log("additional client error after disconnection due to error",w)}),g._remove(u),g.emit("error",w,u)},"idleListener")}y(p,"makeIdleListener");var b=class extends t{constructor(u,v){super(),this.options=Object.assign({},u),u!=null&&"password"in u&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:u.password}),u!=null&&u.ssl&&u.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||v||Jn().Client,this.Promise=this.options.Promise||Rs.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(v=>{this._remove(v.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let u=this._pendingQueue.shift();if(this._idle.length){let v=this._idle.pop();clearTimeout(v.timeoutId);let w=v.client;w.ref&&w.ref();let S=v.idleListener;return this._acquireClient(w,u,S,!1)}if(!this._isFull())return this.newClient(u);throw new Error("unexpected condition")}_remove(u){let v=n(this._idle,w=>w.client===u);v!==void 0&&clearTimeout(v.timeoutId),this._clients=this._clients.filter(w=>w!==u),u.end(),this.emit("remove",u)}connect(u){if(this.ending){let S=new Error("Cannot use a pool after calling end on the pool");return u?u(S):this.Promise.reject(S)}let v=h(this.Promise,u),w=v.result;if(this._isFull()||this._idle.length){if(this._idle.length&&le.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new c(v.callback)),w;let S=y((L,x,k)=>{clearTimeout(O),v.callback(L,x,k)},"queueCallback"),E=new c(S),O=setTimeout(()=>{n(this._pendingQueue,L=>L.callback===S),E.timedOut=!0,v.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(E),w}return this.newClient(new c(v.callback)),w}newClient(u){let v=new this.Client(this.options);this._clients.push(v);let w=p(this,v);this.log("checking client timeout");let S,E=!1;this.options.connectionTimeoutMillis&&(S=setTimeout(()=>{this.log("ending client due to timeout"),E=!0,v.connection?v.connection.stream.destroy():v.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),v.connect(O=>{if(S&&clearTimeout(S),v.on("error",w),O)this.log("client failed to connect",O),this._clients=this._clients.filter(L=>L!==v),E&&(O.message="Connection terminated due to connection timeout"),this._pulseQueue(),u.timedOut||u.callback(O,void 0,s);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let L=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(v),this._idle.findIndex(x=>x.client===v)!==-1&&this._acquireClient(v,new c((x,k,P)=>P()),w,!1)},this.options.maxLifetimeSeconds*1e3);L.unref(),v.once("end",()=>clearTimeout(L))}return this._acquireClient(v,u,w,!0)}})}_acquireClient(u,v,w,S){S&&this.emit("connect",u),this.emit("acquire",u),u.release=this._releaseOnce(u,w),u.removeListener("error",w),v.timedOut?S&&this.options.verify?this.options.verify(u,u.release):u.release():S&&this.options.verify?this.options.verify(u,E=>{if(E)return u.release(E),v.callback(E,void 0,s);v.callback(void 0,u,u.release)}):v.callback(void 0,u,u.release)}_releaseOnce(u,v){let w=!1;return S=>{w&&d(),w=!0,this._release(u,v,S)}}_release(u,v,w){if(u.on("error",v),u._poolUseCount=(u._poolUseCount||0)+1,this.emit("release",w,u),w||this.ending||!u._queryable||u._ending||u._poolUseCount>=this.options.maxUses){u._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(u),this._pulseQueue();return}if(this._expired.has(u)){this.log("remove expired client"),this._expired.delete(u),this._remove(u),this._pulseQueue();return}let S;this.options.idleTimeoutMillis&&(S=setTimeout(()=>{this.log("remove idle client"),this._remove(u)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&S.unref()),this.options.allowExitOnIdle&&u.unref(),this._idle.push(new o(u,v,S)),this._pulseQueue()}query(u,v,w){if(typeof u=="function"){let E=h(this.Promise,u);return Un(function(){return E.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),E.result}typeof v=="function"&&(w=v,v=void 0);let S=h(this.Promise,w);return w=S.callback,this.connect((E,O)=>{if(E)return w(E);let L=!1,x=y(k=>{L||(L=!0,O.release(k),w(k))},"onError");O.once("error",x),this.log("dispatching query");try{O.query(u,v,(k,P)=>{if(this.log("query dispatched"),O.removeListener("error",x),!L)return L=!0,O.release(k),k?w(k):w(void 0,P)})}catch(k){return O.release(k),w(k)}}),S.result}end(u){if(this.log("ending"),this.ending){let w=new Error("Called end on pool more than once");return u?u(w):this.Promise.reject(w)}this.ending=!0;let v=h(this.Promise,u);return this._endCallback=v.callback,this._pulseQueue(),v.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((u,v)=>u+(this._expired.has(v)?1:0),0)}get totalCount(){return this._clients.length}};y(b,"Pool");var _=b;e.exports=_}),al={};st(al,{default:()=>ll});var ll,Af=Ue(()=>{"use strict";Y(),ll={}}),Pf=ue((r,e)=>{e.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),kf=ue((r,e)=>{"use strict";Y();var t=Ft().EventEmitter,s=(Ms(),Le(Kr)),n=$s(),i=e.exports=function(a,c,d){t.call(this),a=n.normalizeQueryConfig(a,c,d),this.text=a.text,this.values=a.values,this.name=a.name,this.callback=a.callback,this.state="new",this._arrayMode=a.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(h){h==="row"&&(this._emitRowEvents=!0)}.bind(this))};s.inherits(i,t);var o={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};i.prototype.handleError=function(a){var c=this.native.pq.resultErrorFields();if(c)for(var d in c){var h=o[d]||d;a[h]=c[d]}this.callback?this.callback(a):this.emit("error",a),this.state="error"},i.prototype.then=function(a,c){return this._getPromise().then(a,c)},i.prototype.catch=function(a){return this._getPromise().catch(a)},i.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(a,c){this._once("end",a),this._once("error",c)}.bind(this)),this._promise)},i.prototype.submit=function(a){this.state="running";var c=this;this.native=a.native,a.native.arrayMode=this._arrayMode;var d=y(function(b,_,g){if(a.native.arrayMode=!1,Un(function(){c.emit("_done")}),b)return c.handleError(b);c._emitRowEvents&&(g.length>1?_.forEach((u,v)=>{u.forEach(w=>{c.emit("row",w,g[v])})}):_.forEach(function(u){c.emit("row",u,g)})),c.state="end",c.emit("end",g),c.callback&&c.callback(null,g)},"after");if(le.domain&&(d=le.domain.bind(d)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var h=(this.values||[]).map(n.prepareValue);if(a.namedQueries[this.name]){if(this.text&&a.namedQueries[this.name]!==this.text){let b=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return d(b)}return a.native.execute(this.name,h,d)}return a.native.prepare(this.name,this.text,h.length,function(b){return b?d(b):(a.namedQueries[c.name]=c.text,c.native.execute(c.name,h,d))})}else if(this.values){if(!Array.isArray(this.values)){let b=new Error("Query values must be an array");return d(b)}var p=this.values.map(n.prepareValue);a.native.query(this.text,p,d)}else a.native.query(this.text,d)}}),If=ue((r,e)=>{"use strict";Y();var t=(Af(),Le(al)),s=Kn(),n=Pf(),i=Ft().EventEmitter,o=(Ms(),Le(Kr)),a=Zn(),c=kf(),d=e.exports=function(h){i.call(this),h=h||{},this._Promise=h.Promise||Rs.Promise,this._types=new s(h.types),this.native=new t({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var p=this.connectionParameters=new a(h);this.user=p.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:p.password}),this.database=p.database,this.host=p.host,this.port=p.port,this.namedQueries={}};d.Query=c,o.inherits(d,i),d.prototype._errorAllQueries=function(h){let p=y(b=>{le.nextTick(()=>{b.native=this.native,b.handleError(h)})},"enqueueError");this._hasActiveQuery()&&(p(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(p),this._queryQueue.length=0},d.prototype._connect=function(h){var p=this;if(this._connecting){le.nextTick(()=>h(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(b,_){if(b)return h(b);p.native.connect(_,function(g){if(g)return p.native.end(),h(g);p._connected=!0,p.native.on("error",function(u){p._queryable=!1,p._errorAllQueries(u),p.emit("error",u)}),p.native.on("notification",function(u){p.emit("notification",{channel:u.relname,payload:u.extra})}),p.emit("connect"),p._pulseQueryQueue(!0),h()})})},d.prototype.connect=function(h){if(h){this._connect(h);return}return new this._Promise((p,b)=>{this._connect(_=>{_?b(_):p()})})},d.prototype.query=function(h,p,b){var _,g,u,v,w;if(h==null)throw new TypeError("Client was passed a null or undefined query");if(typeof h.submit=="function")u=h.query_timeout||this.connectionParameters.query_timeout,g=_=h,typeof p=="function"&&(h.callback=p);else if(u=this.connectionParameters.query_timeout,_=new c(h,p,b),!_.callback){let S,E;g=new this._Promise((O,L)=>{S=O,E=L}),_.callback=(O,L)=>O?E(O):S(L)}return u&&(w=_.callback,v=setTimeout(()=>{var S=new Error("Query read timeout");le.nextTick(()=>{_.handleError(S,this.connection)}),w(S),_.callback=()=>{};var E=this._queryQueue.indexOf(_);E>-1&&this._queryQueue.splice(E,1),this._pulseQueryQueue()},u),_.callback=(S,E)=>{clearTimeout(v),w(S,E)}),this._queryable?this._ending?(_.native=this.native,le.nextTick(()=>{_.handleError(new Error("Client was closed and is not queryable"))}),g):(this._queryQueue.push(_),this._pulseQueryQueue(),g):(_.native=this.native,le.nextTick(()=>{_.handleError(new Error("Client has encountered a connection error and is not queryable"))}),g)},d.prototype.end=function(h){var p=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,h));var b;return h||(b=new this._Promise(function(_,g){h=y(u=>u?g(u):_(),"cb")})),this.native.end(function(){p._errorAllQueries(new Error("Connection terminated")),le.nextTick(()=>{p.emit("end"),h&&h()})}),b},d.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},d.prototype._pulseQueryQueue=function(h){if(this._connected&&!this._hasActiveQuery()){var p=this._queryQueue.shift();if(!p){h||this.emit("drain");return}this._activeQuery=p,p.submit(this);var b=this;p.once("_done",function(){b._pulseQueryQueue()})}},d.prototype.cancel=function(h){this._activeQuery===h?this.native.cancel(function(){}):this._queryQueue.indexOf(h)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(h),1)},d.prototype.ref=function(){},d.prototype.unref=function(){},d.prototype.setTypeParser=function(h,p,b){return this._types.setTypeParser(h,p,b)},d.prototype.getTypeParser=function(h,p){return this._types.getTypeParser(h,p)}}),Ia=ue((r,e)=>{"use strict";Y(),e.exports=If()}),Jn=ue((r,e)=>{"use strict";Y();var t=Cf(),s=Ds(),n=ol(),i=Nf(),{DatabaseError:o}=sl(),a=y(d=>{var h;return h=class extends i{constructor(p){super(p,d)}},y(h,"BoundPool"),h},"poolFactory"),c=y(function(d){this.defaults=s,this.Client=d,this.Query=this.Client.Query,this.Pool=a(this.Client),this._pools=[],this.Connection=n,this.types=Bs(),this.DatabaseError=o},"PG");typeof le.env.NODE_PG_FORCE_NATIVE<"u"?e.exports=new c(Ia()):(e.exports=new c(t),Object.defineProperty(e.exports,"native",{configurable:!0,enumerable:!1,get(){var d=null;try{d=new c(Ia())}catch(h){if(h.code!=="MODULE_NOT_FOUND")throw h}return Object.defineProperty(e.exports,"native",{value:d}),d}}))});Y();var ul=gr(Jn());Hn();Y();Hn();Xa();var Of=gr($s()),Lf=gr(Kn());function cl(r){return r instanceof re?"\\x"+r.toString("hex"):r}y(cl,"encodeBuffersAsBytea");var hl=class fl extends Error{constructor(e){super(e),se(this,"name","NeonDbError"),se(this,"severity"),se(this,"code"),se(this,"detail"),se(this,"hint"),se(this,"position"),se(this,"internalPosition"),se(this,"internalQuery"),se(this,"where"),se(this,"schema"),se(this,"table"),se(this,"column"),se(this,"dataType"),se(this,"constraint"),se(this,"file"),se(this,"line"),se(this,"routine"),se(this,"sourceError"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,fl)}};y(hl,"NeonDbError");var pr=hl,Oa="transaction() expects an array of queries, or a function returning an array of queries",Rf=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function dl(r,{arrayMode:e,fullResults:t,fetchOptions:s,isolationLevel:n,readOnly:i,deferrable:o,queryCallback:a,resultCallback:c,authToken:d}={}){if(!r)throw new Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");let h;try{h=Gn(r)}catch{throw new Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(r))}let{protocol:p,username:b,hostname:_,port:g,pathname:u}=h;if(p!=="postgres:"&&p!=="postgresql:"||!b||!_||!u)throw new Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function v(S,...E){let O,L;if(typeof S=="string")O=S,L=E[1],E=E[0]??[];else{O="";for(let k=0;k<S.length;k++)O+=S[k],k<E.length&&(O+="$"+(k+1))}E=E.map(k=>cl((0,Of.prepareValue)(k)));let x={query:O,params:E};return a&&a(x),pl(w,x,L)}y(v,"resolve"),v.transaction=async(S,E)=>{if(typeof S=="function"&&(S=S(v)),!Array.isArray(S))throw new Error(Oa);S.forEach(x=>{if(x[Symbol.toStringTag]!=="NeonQueryPromise")throw new Error(Oa)});let O=S.map(x=>x.parameterizedQuery),L=S.map(x=>x.opts??{});return w(O,L,E)};async function w(S,E,O){let{fetchEndpoint:L,fetchFunction:x}=gt,k=Array.isArray(S)?{queries:S}:S,P=s??{},C=e??!1,B=t??!1,M=n,W=i,K=o;O!==void 0&&(O.fetchOptions!==void 0&&(P={...P,...O.fetchOptions}),O.arrayMode!==void 0&&(C=O.arrayMode),O.fullResults!==void 0&&(B=O.fullResults),O.isolationLevel!==void 0&&(M=O.isolationLevel),O.readOnly!==void 0&&(W=O.readOnly),O.deferrable!==void 0&&(K=O.deferrable)),E!==void 0&&!Array.isArray(E)&&E.fetchOptions!==void 0&&(P={...P,...E.fetchOptions});let R=d;!Array.isArray(E)&&E?.authToken!==void 0&&(R=E.authToken);let U=typeof L=="function"?L(_,g,{jwtAuth:R!==void 0}):L,J={"Neon-Connection-String":r,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},ne=await ml(R);ne&&(J.Authorization=`Bearer ${ne}`),Array.isArray(S)&&(M!==void 0&&(J["Neon-Batch-Isolation-Level"]=M),W!==void 0&&(J["Neon-Batch-Read-Only"]=String(W)),K!==void 0&&(J["Neon-Batch-Deferrable"]=String(K)));let fe;try{fe=await(x??fetch)(U,{method:"POST",body:JSON.stringify(k),headers:J,...P})}catch(pe){let ke=new pr(`Error connecting to database: ${pe.message}`);throw ke.sourceError=pe,ke}if(fe.ok){let pe=await fe.json();if(Array.isArray(S)){let ke=pe.results;if(!Array.isArray(ke))throw new pr("Neon internal error: unexpected result format");return ke.map((ge,we)=>{let qt=E[we]??{},Fr=qt.arrayMode??C,Ur=qt.fullResults??B;return Fn(ge,{arrayMode:Fr,fullResults:Ur,parameterizedQuery:S[we],resultCallback:c,types:qt.types})})}else{let ke=E??{},ge=ke.arrayMode??C,we=ke.fullResults??B;return Fn(pe,{arrayMode:ge,fullResults:we,parameterizedQuery:S,resultCallback:c,types:ke.types})}}else{let{status:pe}=fe;if(pe===400){let ke=await fe.json(),ge=new pr(ke.message);for(let we of Rf)ge[we]=ke[we]??void 0;throw ge}else{let ke=await fe.text();throw new pr(`Server error (HTTP status ${pe}): ${ke}`)}}}return y(w,"execute"),v}y(dl,"neon");function pl(r,e,t){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:e,opts:t,then:y((s,n)=>r(e,t).then(s,n),"then"),catch:y(s=>r(e,t).catch(s),"catch"),finally:y(s=>r(e,t).finally(s),"finally")}}y(pl,"createNeonQueryPromise");function Fn(r,{arrayMode:e,fullResults:t,parameterizedQuery:s,resultCallback:n,types:i}){let o=new Lf.default(i),a=r.fields.map(h=>h.name),c=r.fields.map(h=>o.getTypeParser(h.dataTypeID)),d=e===!0?r.rows.map(h=>h.map((p,b)=>p===null?null:c[b](p))):r.rows.map(h=>Object.fromEntries(h.map((p,b)=>[a[b],p===null?null:c[b](p)])));return n&&n(s,r,d,{arrayMode:e,fullResults:t}),t?(r.viaNeonFetch=!0,r.rowAsArray=e,r.rows=d,r._parsers=c,r._types=o,r):d}y(Fn,"processQueryResult");async function ml(r){if(typeof r=="string")return r;if(typeof r=="function")try{return await Promise.resolve(r())}catch(e){let t=new pr("Error getting auth token.");throw e instanceof Error&&(t=new pr(`Error getting auth token: ${e.message}`)),t}}y(ml,"getAuthToken");var Mf=gr(Zn()),yr=gr(Jn()),gl=class extends ul.Client{constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let s=this.config?.host!==void 0||this.config?.connectionString!==void 0||le.env.PGHOST!==void 0,n=le.env.USER??le.env.USERNAME;if(!s&&this.host==="localhost"&&this.user===n&&this.database===n&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${n}, db: ${n}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let i=super.connect(e),o=t.pipelineTLS&&this.ssl,a=t.pipelineConnect==="password";if(!o&&!t.pipelineConnect)return i;let c=this.connection;if(o&&c.on("connect",()=>c.stream.emit("data","S")),a){c.removeAllListeners("authenticationCleartextPassword"),c.removeAllListeners("readyForQuery"),c.once("readyForQuery",()=>c.on("readyForQuery",this._handleReadyForQuery.bind(this)));let d=this.ssl?"sslconnect":"connect";c.on(d,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return i}async _handleAuthSASLContinue(e){let t=this.saslSession,s=this.password,n=e.data;if(t.message!=="SASLInitialResponse"||typeof s!="string"||typeof n!="string")throw new Error("SASL: protocol error");let i=Object.fromEntries(n.split(",").map(ne=>{if(!/^.=/.test(ne))throw new Error("SASL: Invalid attribute pair entry");let fe=ne[0],pe=ne.substring(2);return[fe,pe]})),o=i.r,a=i.s,c=i.i;if(!o||!/^[!-+--~]+$/.test(o))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!a||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!c||!/^[1-9][0-9]*$/.test(c))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!o.startsWith(t.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(o.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let d=parseInt(c,10),h=re.from(a,"base64"),p=new TextEncoder,b=p.encode(s),_=await Be.subtle.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),g=new Uint8Array(await Be.subtle.sign("HMAC",_,re.concat([h,re.from([0,0,0,1])]))),u=g;for(var v=0;v<d-1;v++)g=new Uint8Array(await Be.subtle.sign("HMAC",_,g)),u=re.from(u.map((ne,fe)=>u[fe]^g[fe]));let w=u,S=await Be.subtle.importKey("raw",w,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),E=new Uint8Array(await Be.subtle.sign("HMAC",S,p.encode("Client Key"))),O=await Be.subtle.digest("SHA-256",E),L="n=*,r="+t.clientNonce,x="r="+o+",s="+a+",i="+d,k="c=biws,r="+o,P=L+","+x+","+k,C=await Be.subtle.importKey("raw",O,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var B=new Uint8Array(await Be.subtle.sign("HMAC",C,p.encode(P))),M=re.from(E.map((ne,fe)=>E[fe]^B[fe])),W=M.toString("base64");let K=await Be.subtle.importKey("raw",w,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),R=await Be.subtle.sign("HMAC",K,p.encode("Server Key")),U=await Be.subtle.importKey("raw",R,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var J=re.from(await Be.subtle.sign("HMAC",U,p.encode(P)));t.message="SASLResponse",t.serverSignature=J.toString("base64"),t.response=k+",p="+W,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};y(gl,"NeonClient");var Bf=gl;function yl(r,e){if(e)return{callback:e,result:void 0};let t,s,n=y(function(o,a){o?t(o):s(a)},"cb"),i=new r(function(o,a){s=o,t=a});return{callback:n,result:i}}y(yl,"promisify");var bl=class extends ul.Pool{constructor(){super(...arguments),se(this,"Client",Bf),se(this,"hasFetchUnsupportedListeners",!1)}on(e,t){return e!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(e,t)}query(e,t,s){if(!gt.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof e=="function")return super.query(e,t,s);typeof t=="function"&&(s=t,t=void 0);let n=yl(this.Promise,s);s=n.callback;try{let i=new Mf.default(this.options),o=encodeURIComponent,a=encodeURI,c=`postgresql://${o(i.user)}:${o(i.password)}@${o(i.host)}/${a(i.database)}`,d=typeof e=="string"?e:e.text,h=t??e.values??[];dl(c,{fullResults:!0,arrayMode:e.rowMode==="array"})(d,h,{types:e.types??this.options?.types}).then(p=>s(void 0,p)).catch(p=>s(p))}catch(i){s(i)}return n.result}};y(bl,"NeonPool");var yt=bl,Cg=yr.ClientBase,Ng=yr.Connection,Ag=yr.DatabaseError,Pg=yr.Query,kg=yr.defaults,nt=yr.types;var T=Symbol.for("drizzle:entityKind"),Rg=Symbol.for("drizzle:hasOwnEntityKind");function D(r,e){if(!r||typeof r!="object")return!1;if(r instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,T))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(r).constructor;if(t)for(;t;){if(T in t&&t[T]===e[T])return!0;t=Object.getPrototypeOf(t)}return!1}var Yn=class{static[T]="ConsoleLogWriter";write(e){console.log(e)}},qs=class{static[T]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Yn}logQuery(e,t){let s=t.map(i=>{try{return JSON.stringify(i)}catch{return String(i)}}),n=s.length?` -- params: [${s.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},js=class{static[T]="NoopLogger";logQuery(){}};var De=class{static[T]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};var de=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[T]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}};var Fs=class{static[T]="ColumnBuilder";config;constructor(e,t,s){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:s,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}};var it=Symbol.for("drizzle:Name");var Us=class{static[T]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:s,columns:n,foreignColumns:i}=e();return{name:s,columns:n,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Xn(e,this)}},Xn=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[T]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:s}=this.reference(),n=t.map(a=>a.name),i=s.map(a=>a.name),o=[this.table[it],...n,s[0].table[it],...i];return e??`${o.join("_")}_fk`}};function Qs(r,...e){return r(...e)}function ri(r,e){return`${r[it]}_${e.join("_")}_unique`}var ei=class{constructor(e,t){this.name=t,this.columns=e}static[T]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new ti(e,this.columns,this.nullsNotDistinctConfig,this.name)}},vl=class{static[T]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new ei(e,this.name)}},ti=class{constructor(e,t,s,n){this.table=e,this.columns=t,this.name=n??ri(this.table,this.columns.map(i=>i.name)),this.nullsNotDistinct=s}static[T]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}};function _l(r,e,t){for(let s=e;s<r.length;s++){let n=r[s];if(n==="\\"){s++;continue}if(n==='"')return[r.slice(e,s).replace(/\\/g,""),s+1];if(!t&&(n===","||n==="}"))return[r.slice(e,s).replace(/\\/g,""),s]}return[r.slice(e).replace(/\\/g,""),r.length]}function wl(r,e=0){let t=[],s=e,n=!1;for(;s<r.length;){let i=r[s];if(i===","){(n||s===e)&&t.push(""),n=!0,s++;continue}if(n=!1,i==="\\"){s+=2;continue}if(i==='"'){let[c,d]=_l(r,s+1,!0);t.push(c),s=d;continue}if(i==="}")return[t,s+1];if(i==="{"){let[c,d]=wl(r,s+1);t.push(c),s=d;continue}let[o,a]=_l(r,s,!1);t.push(o),s=a}return[t,s]}function Sl(r){let[e]=wl(r,1);return e}function si(r){return`{${r.map(e=>Array.isArray(e)?si(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Z=class extends Fs{foreignKeyConfigs=[];static[T]="PgColumnBuilder";array(e){return new ii(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:s,actions:n})=>Qs((i,o)=>{let a=new Us(()=>{let c=i();return{columns:[e],foreignColumns:[c]}});return o.onUpdate&&a.onUpdate(o.onUpdate),o.onDelete&&a.onDelete(o.onDelete),a.build(t)},s,n))}buildExtraConfigColumn(e){return new ni(e,this.config)}},F=class extends de{constructor(e,t){t.uniqueName||(t.uniqueName=ri(e,[t.name])),super(e,t),this.table=e}static[T]="PgColumn"},ni=class extends F{static[T]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},xl=class{static[T]="IndexedColumn";constructor(e,t,s,n){this.name=e,this.keyAsName=t,this.type=s,this.indexConfig=n}name;keyAsName;type;indexConfig},ii=class extends Z{static[T]="PgArrayBuilder";constructor(e,t,s){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=s}build(e){let t=this.config.baseBuilder.build(e);return new oi(e,this.config,t)}},oi=class r extends F{constructor(e,t,s,n){super(e,t),this.baseColumn=s,this.range=n,this.size=t.size}size;static[T]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=Sl(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let s=e.map(n=>n===null?null:D(this.baseColumn,r)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return t?s:si(s)}};var El=Symbol.for("drizzle:isPgEnum");function Cl(r){return!!r&&typeof r=="function"&&El in r&&r[El]===!0}var Tl=class extends Z{static[T]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new ai(e,this.config)}},ai=class extends F{static[T]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};var Ne=class{static[T]="Subquery";constructor(e,t,s,n=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:s,isWith:n}}},br=class extends Ne{static[T]="WithSubquery"};var Nl="0.39.1";var li,ui,Ae={startActiveSpan(r,e){return li?(ui||(ui=li.trace.getTracer("drizzle-orm",Nl)),Qs((t,s)=>s.startActiveSpan(r,n=>{try{return e(n)}catch(i){throw n.setStatus({code:t.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{n.end()}}),li,ui)):e()}};var me=Symbol.for("drizzle:ViewBaseConfig");var Vs=Symbol.for("drizzle:Schema"),zs=Symbol.for("drizzle:Columns"),Al=Symbol.for("drizzle:ExtraConfigColumns"),ci=Symbol.for("drizzle:OriginalName"),hi=Symbol.for("drizzle:BaseName"),Gr=Symbol.for("drizzle:IsAlias"),Pl=Symbol.for("drizzle:ExtraConfigBuilder"),kl=Symbol.for("drizzle:IsDrizzleTable"),V=class{static[T]="Table";static Symbol={Name:it,Schema:Vs,OriginalName:ci,Columns:zs,ExtraConfigColumns:Al,BaseName:hi,IsAlias:Gr,ExtraConfigBuilder:Pl};[it];[ci];[Vs];[zs];[Al];[hi];[Gr]=!1;[kl]=!0;[Pl]=void 0;constructor(e,t,s){this[it]=this[ci]=e,this[Vs]=t,this[hi]=s}};function fi(r){return typeof r=="object"&&r!==null&&kl in r}function Qe(r){return r[it]}function Ut(r){return`${r[Vs]??"public"}.${r[it]}`}var Il=class{static[T]="FakePrimitiveParam"};function di(r){return r!=null&&typeof r.getSQL=="function"}function Df(r){let e={sql:"",params:[]};for(let t of r)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}var Pe=class{static[T]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new G([this])}},G=class r{constructor(e){this.queryChunks=e}static[T]="SQL";decoder=Ll;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Ae.startActiveSpan("drizzle.buildSQL",t=>{let s=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":s.sql,"drizzle.query.params":JSON.stringify(s.params)}),s})}buildQueryFromSourceParams(e,t){let s=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:n,escapeName:i,escapeParam:o,prepareTyping:a,inlineParams:c,paramStartIndex:d}=s;return Df(e.map(h=>{if(D(h,Pe))return{sql:h.value.join(""),params:[]};if(D(h,Zr))return{sql:i(h.value),params:[]};if(h===void 0)return{sql:"",params:[]};if(Array.isArray(h)){let p=[new Pe("(")];for(let[b,_]of h.entries())p.push(_),b<h.length-1&&p.push(new Pe(", "));return p.push(new Pe(")")),this.buildQueryFromSourceParams(p,s)}if(D(h,r))return this.buildQueryFromSourceParams(h.queryChunks,{...s,inlineParams:c||h.shouldInlineParams});if(D(h,V)){let p=h[V.Symbol.Schema],b=h[V.Symbol.Name];return{sql:p===void 0||h[Gr]?i(b):i(p)+"."+i(b),params:[]}}if(D(h,de)){let p=n.getColumnCasing(h);if(t.invokeSource==="indexes")return{sql:i(p),params:[]};let b=h.table[V.Symbol.Schema];return{sql:h.table[Gr]||b===void 0?i(h.table[V.Symbol.Name])+"."+i(p):i(b)+"."+i(h.table[V.Symbol.Name])+"."+i(p),params:[]}}if(D(h,je)){let p=h[me].schema,b=h[me].name;return{sql:p===void 0||h[me].isAlias?i(b):i(p)+"."+i(b),params:[]}}if(D(h,Ve)){if(D(h.value,bt))return{sql:o(d.value++,h),params:[h],typings:["none"]};let p=h.value===null?null:h.encoder.mapToDriverValue(h.value);if(D(p,r))return this.buildQueryFromSourceParams([p],s);if(c)return{sql:this.mapInlineParam(p,s),params:[]};let b=["none"];return a&&(b=[a(h.encoder)]),{sql:o(d.value++,p),params:[p],typings:b}}return D(h,bt)?{sql:o(d.value++,h),params:[h],typings:["none"]}:D(h,r.Aliased)&&h.fieldAlias!==void 0?{sql:i(h.fieldAlias),params:[]}:D(h,Ne)?h._.isWith?{sql:i(h._.alias),params:[]}:this.buildQueryFromSourceParams([new Pe("("),h._.sql,new Pe(") "),new Zr(h._.alias)],s):Cl(h)?h.schema?{sql:i(h.schema)+"."+i(h.enumName),params:[]}:{sql:i(h.enumName),params:[]}:di(h)?h.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([h.getSQL()],s):this.buildQueryFromSourceParams([new Pe("("),h.getSQL(),new Pe(")")],s):c?{sql:this.mapInlineParam(h,s),params:[]}:{sql:o(d.value++,h),params:[h],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let s=e.toString();return t(s==="[object Object]"?JSON.stringify(e):s)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new r.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Zr=class{constructor(e){this.value=e}static[T]="Name";brand;getSQL(){return new G([this])}};function Ol(r){return typeof r=="object"&&r!==null&&"mapToDriverValue"in r&&typeof r.mapToDriverValue=="function"}var Ll={mapFromDriverValue:r=>r},Rl={mapToDriverValue:r=>r},Ny={...Ll,...Rl},Ve=class{constructor(e,t=Rl){this.value=e,this.encoder=t}static[T]="Param";brand;getSQL(){return new G([this])}};function A(r,...e){let t=[];(e.length>0||r.length>0&&r[0]!=="")&&t.push(new Pe(r[0]));for(let[s,n]of e.entries())t.push(n,new Pe(r[s+1]));return new G(t)}(r=>{function e(){return new G([])}r.empty=e;function t(c){return new G(c)}r.fromList=t;function s(c){return new G([new Pe(c)])}r.raw=s;function n(c,d){let h=[];for(let[p,b]of c.entries())p>0&&d!==void 0&&h.push(d),h.push(b);return new G(h)}r.join=n;function i(c){return new Zr(c)}r.identifier=i;function o(c){return new bt(c)}r.placeholder=o;function a(c,d){return new Ve(c,d)}r.param=a})(A||(A={}));(r=>{class e{constructor(s,n){this.sql=s,this.fieldAlias=n}static[T]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}r.Aliased=e})(G||(G={}));var bt=class{constructor(e){this.name=e}static[T]="Placeholder";getSQL(){return new G([this])}};function Ws(r,e){return r.map(t=>{if(D(t,bt)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(D(t,Ve)&&D(t.value,bt)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}var Ml=Symbol.for("drizzle:IsDrizzleView"),je=class{static[T]="View";[me];[Ml]=!0;constructor({name:e,schema:t,selectedFields:s,query:n}){this[me]={name:e,originalName:e,schema:t,selectedFields:s,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new G([this])}};function Bl(r){return typeof r=="object"&&r!==null&&Ml in r}de.prototype.getSQL=function(){return new G([this])};V.prototype.getSQL=function(){return new G([this])};Ne.prototype.getSQL=function(){return new G([this])};var Qt=class{constructor(e){this.table=e}static[T]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},vr=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[T]="TableAliasProxyHandler";get(e,t){if(t===V.Symbol.IsAlias)return!0;if(t===V.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===V.Symbol.OriginalName)return this.alias;if(t===me)return{...e[me],name:this.alias,isAlias:!0};if(t===V.Symbol.Columns){let n=e[V.Symbol.Columns];if(!n)return n;let i={};return Object.keys(n).map(o=>{i[o]=new Proxy(n[o],new Qt(new Proxy(e,this)))}),i}let s=e[t];return D(s,de)?new Proxy(s,new Qt(new Proxy(e,this))):s}},Dl=class{constructor(e){this.alias=e}static[T]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?Hr(e.sourceTable,this.alias):e[t]}};function Hr(r,e){return new Proxy(r,new vr(e,!1))}function lt(r,e){return new Proxy(r,new Qt(new Proxy(r.table,new vr(e,!1))))}function pi(r,e){return new G.Aliased(Jr(r.sql,e),r.fieldAlias)}function Jr(r,e){return A.join(r.queryChunks.map(t=>D(t,de)?lt(t,e):D(t,G)?Jr(t,e):D(t,G.Aliased)?pi(t,e):t))}var xe=class r{static[T]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===me)return{...e[me],selectedFields:new Proxy(e[me].selectedFields,this)};if(typeof t=="symbol")return e[t];let n=(D(e,Ne)?e._.selectedFields:D(e,je)?e[me].selectedFields:e)[t];if(D(n,G.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;let i=n.clone();return i.isSelectionField=!0,i}if(D(n,G)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return D(n,de)?this.config.alias?new Proxy(n,new Qt(new Proxy(n.table,new vr(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new r(this.config))}};function $l(r,e,t){let s={},n=r.reduce((i,{path:o,field:a},c)=>{let d;D(a,de)?d=a:D(a,G)?d=a.decoder:d=a.sql.decoder;let h=i;for(let[p,b]of o.entries())if(p<o.length-1)b in h||(h[b]={}),h=h[b];else{let _=e[c],g=h[b]=_===null?null:d.mapFromDriverValue(_);if(t&&D(a,de)&&o.length===2){let u=o[0];u in s?typeof s[u]=="string"&&s[u]!==Qe(a.table)&&(s[u]=!1):s[u]=g===null?Qe(a.table):!1}}return i},{});if(t&&Object.keys(s).length>0)for(let[i,o]of Object.entries(s))typeof o=="string"&&!t[o]&&(n[i]=null);return n}function Je(r,e){return Object.entries(r).reduce((t,[s,n])=>{if(typeof s!="string")return t;let i=e?[...e,s]:[s];return D(n,de)||D(n,G)||D(n,G.Aliased)?t.push({path:i,field:n}):D(n,V)?t.push(...Je(n[V.Symbol.Columns],i)):t.push(...Je(n,i)),t},[])}function Yr(r,e){let t=Object.keys(r),s=Object.keys(e);if(t.length!==s.length)return!1;for(let[n,i]of t.entries())if(i!==s[n])return!1;return!0}function Ks(r,e){let t=Object.entries(e).filter(([,s])=>s!==void 0).map(([s,n])=>D(n,G)||D(n,de)?[s,n]:[s,new Ve(n,r[V.Symbol.Columns][s])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function ql(r,e){for(let t of e)for(let s of Object.getOwnPropertyNames(t.prototype))s!=="constructor"&&Object.defineProperty(r.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s)||Object.create(null))}function Gs(r){return r[V.Symbol.Columns]}function jl(r){return r[me].selectedFields}function vt(r){return D(r,Ne)?r._.alias:D(r,je)?r[me].name:D(r,G)?void 0:r[V.Symbol.IsAlias]?r[V.Symbol.Name]:r[V.Symbol.BaseName]}function ce(r,e){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:e}}function Fl(r){if(typeof r!="object"||r===null||r.constructor.name!=="Object")return!1;if("logger"in r){let e=typeof r.logger;return!(e!=="boolean"&&(e!=="object"||typeof r.logger.logQuery!="function")&&e!=="undefined")}if("schema"in r){let e=typeof r.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in r){let e=typeof r.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in r)return!(r.mode!=="default"||r.mode!=="planetscale"||r.mode!==void 0);if("connection"in r){let e=typeof r.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in r){let e=typeof r.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(r).length===0}var Xr=class extends De{constructor(e,t,s,n){super(),this.session=t,this.dialect=s,this.config={table:e,withList:n}}static[T]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[V.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Je(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new xe({alias:Qe(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};function $f(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function qf(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,s,n)=>{let i=n===0?s.toLowerCase():`${s[0].toUpperCase()}${s.slice(1)}`;return t+i},"")}function jf(r){return r}var Zs=class{static[T]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?$f:e==="camelCase"?qf:jf}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[V.Symbol.Schema]??"public",s=e.table[V.Symbol.OriginalName],n=`${t}.${s}.${e.name}`;return this.cache[n]||this.cacheTable(e.table),this.cache[n]}cacheTable(e){let t=e[V.Symbol.Schema]??"public",s=e[V.Symbol.OriginalName],n=`${t}.${s}`;if(!this.cachedTables[n]){for(let i of Object.values(e[V.Symbol.Columns])){let o=`${n}.${i.name}`;this.cache[o]=this.convert(i.name)}this.cachedTables[n]=!0}}clearCache(){this.cache={},this.cachedTables={}}};var es=class extends Error{static[T]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},Hs=class extends es{static[T]="TransactionRollbackError";constructor(){super({message:"Rollback"})}};var _t=class extends Z{static[T]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...s}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:s}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...s}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:s}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}};var mi=class extends _t{static[T]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new gi(e,this.config)}},gi=class extends F{static[T]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},yi=class extends _t{static[T]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new bi(e,this.config)}},bi=class extends F{static[T]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}};function Ul(r,e){let{name:t,config:s}=ce(r,e);return s.mode==="number"?new mi(t):new yi(t)}var vi=class extends Z{static[T]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new _i(e,this.config)}},_i=class extends F{static[T]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},wi=class extends Z{static[T]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Si(e,this.config)}},Si=class extends F{static[T]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};function Ql(r,e){let{name:t,config:s}=ce(r,e);return s.mode==="number"?new vi(t):new wi(t)}var xi=class extends Z{static[T]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Ei(e,this.config)}},Ei=class extends F{static[T]="PgBoolean";getSQLType(){return"boolean"}};function _r(r){return new xi(r??"")}var Ti=class extends Z{static[T]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Ci(e,this.config)}},Ci=class extends F{static[T]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}};function Vl(r,e={}){let{name:t,config:s}=ce(r,e);return new Ti(t,s)}var Ni=class extends Z{static[T]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new Ai(e,this.config)}},Ai=class extends F{static[T]="PgCidr";getSQLType(){return"cidr"}};function zl(r){return new Ni(r??"")}var Pi=class extends Z{static[T]="PgCustomColumnBuilder";constructor(e,t,s){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=s}build(e){return new ki(e,this.config)}},ki=class extends F{static[T]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}};function Wl(r){return(e,t)=>{let{name:s,config:n}=ce(e,t);return new Pi(s,n,r)}}var ut=class extends Z{static[T]="PgDateColumnBaseBuilder";defaultNow(){return this.default(A`now()`)}};var Ii=class extends ut{static[T]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new ts(e,this.config)}},ts=class extends F{static[T]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},Oi=class extends ut{static[T]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new rs(e,this.config)}},rs=class extends F{static[T]="PgDateString";getSQLType(){return"date"}};function Kl(r,e){let{name:t,config:s}=ce(r,e);return s?.mode==="date"?new Ii(t):new Oi(t)}var Li=class extends Z{static[T]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Ri(e,this.config)}},Ri=class extends F{static[T]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};function Gl(r){return new Li(r??"")}var Mi=class extends Z{static[T]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new Bi(e,this.config)}},Bi=class extends F{static[T]="PgInet";getSQLType(){return"inet"}};function Zl(r){return new Mi(r??"")}var Di=class extends _t{static[T]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new $i(e,this.config)}},$i=class extends F{static[T]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};function kt(r){return new Di(r??"")}var qi=class extends Z{static[T]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new ji(e,this.config)}},ji=class extends F{static[T]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}};function Hl(r,e={}){let{name:t,config:s}=ce(r,e);return new qi(t,s)}var Fi=class extends Z{static[T]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new ss(e,this.config)}},ss=class extends F{static[T]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Jl(r){return new Fi(r??"")}var Ui=class extends Z{static[T]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new ns(e,this.config)}},ns=class extends F{static[T]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Yl(r){return new Ui(r??"")}var Qi=class extends Z{static[T]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Vi(e,this.config)}},Vi=class extends F{static[T]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,s,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(s),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},zi=class extends Z{static[T]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new Wi(e,this.config)}},Wi=class extends F{static[T]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,s,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(s),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}};function Xl(r,e){let{name:t,config:s}=ce(r,e);return!s?.mode||s.mode==="tuple"?new Qi(t):new zi(t)}var Ki=class extends Z{static[T]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Gi(e,this.config)}},Gi=class extends F{static[T]="PgMacaddr";getSQLType(){return"macaddr"}};function eu(r){return new Ki(r??"")}var Zi=class extends Z{static[T]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Hi(e,this.config)}},Hi=class extends F{static[T]="PgMacaddr8";getSQLType(){return"macaddr8"}};function tu(r){return new Zi(r??"")}var Ji=class extends Z{static[T]="PgNumericBuilder";constructor(e,t,s){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=s}build(e){return new is(e,this.config)}},is=class extends F{static[T]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};function ru(r,e){let{name:t,config:s}=ce(r,e);return new Ji(t,s?.precision,s?.scale)}var Yi=class extends Z{static[T]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Xi(e,this.config)}},Xi=class extends F{static[T]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,s]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(s)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},eo=class extends Z{static[T]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new to(e,this.config)}},to=class extends F{static[T]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,s]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(s)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}};function su(r,e){let{name:t,config:s}=ce(r,e);return!s?.mode||s.mode==="tuple"?new Yi(t):new eo(t)}function Ff(r){let e=[];for(let t=0;t<r.length;t+=2)e.push(Number.parseInt(r.slice(t,t+2),16));return new Uint8Array(e)}function nu(r,e){let t=new ArrayBuffer(8),s=new DataView(t);for(let n=0;n<8;n++)s.setUint8(n,r[e+n]);return s.getFloat64(0,!0)}function ro(r){let e=Ff(r),t=0,s=e[t];t+=1;let n=new DataView(e.buffer),i=n.getUint32(t,s===1);t+=4;let o;if(i&536870912&&(o=n.getUint32(t,s===1),t+=4),(i&65535)===1){let a=nu(e,t);t+=8;let c=nu(e,t);return t+=8,[a,c]}throw new Error("Unsupported geometry type")}var so=class extends Z{static[T]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new no(e,this.config)}},no=class extends F{static[T]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return ro(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},io=class extends Z{static[T]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new oo(e,this.config)}},oo=class extends F{static[T]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=ro(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}};function iu(r,e){let{name:t,config:s}=ce(r,e);return!s?.mode||s.mode==="tuple"?new so(t):new io(t)}var ao=class extends Z{static[T]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new lo(e,this.config)}},lo=class extends F{static[T]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};function ou(r){return new ao(r??"")}var uo=class extends Z{static[T]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new co(e,this.config)}},co=class extends F{static[T]="PgSerial";getSQLType(){return"serial"}};function It(r){return new uo(r??"")}var ho=class extends _t{static[T]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new fo(e,this.config)}},fo=class extends F{static[T]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e};function au(r){return new ho(r??"")}var po=class extends Z{static[T]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new mo(e,this.config)}},mo=class extends F{static[T]="PgSmallSerial";getSQLType(){return"smallserial"}};function lu(r){return new po(r??"")}var go=class extends Z{static[T]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new yo(e,this.config)}},yo=class extends F{static[T]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}};function ie(r,e={}){let{name:t,config:s}=ce(r,e);return new go(t,s)}var bo=class extends ut{constructor(e,t,s){super(e,"string","PgTime"),this.withTimezone=t,this.precision=s,this.config.withTimezone=t,this.config.precision=s}static[T]="PgTimeBuilder";build(e){return new os(e,this.config)}},os=class extends F{static[T]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function uu(r,e={}){let{name:t,config:s}=ce(r,e);return new bo(t,s.withTimezone??!1,s.precision)}var vo=class extends ut{static[T]="PgTimestampBuilder";constructor(e,t,s){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=s}build(e){return new as(e,this.config)}},as=class extends F{static[T]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},_o=class extends ut{static[T]="PgTimestampStringBuilder";constructor(e,t,s){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=s}build(e){return new ls(e,this.config)}},ls=class extends F{static[T]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function Vt(r,e={}){let{name:t,config:s}=ce(r,e);return s?.mode==="string"?new _o(t,s.withTimezone??!1,s.precision):new vo(t,s?.withTimezone??!1,s?.precision)}var wo=class extends Z{static[T]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(A`gen_random_uuid()`)}build(e){return new us(e,this.config)}},us=class extends F{static[T]="PgUUID";getSQLType(){return"uuid"}};function cu(r){return new wo(r??"")}var So=class extends Z{static[T]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new xo(e,this.config)}},xo=class extends F{static[T]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};function hu(r,e={}){let{name:t,config:s}=ce(r,e);return new So(t,s)}var Eo=class extends Z{static[T]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new To(e,this.config)}},To=class extends F{static[T]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}};function fu(r,e){let{name:t,config:s}=ce(r,e);return new Eo(t,s)}var Co=class extends Z{static[T]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new No(e,this.config)}},No=class extends F{static[T]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function du(r,e){let{name:t,config:s}=ce(r,e);return new Co(t,s)}var Ao=class extends Z{static[T]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new Po(e,this.config)}},Po=class extends F{static[T]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}};function pu(r,e){let{name:t,config:s}=ce(r,e);return new Ao(t,s)}var ko=class extends Z{static[T]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new Io(e,this.config)}},Io=class extends F{static[T]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function mu(r,e){let{name:t,config:s}=ce(r,e);return new ko(t,s)}function gu(){return{bigint:Ul,bigserial:Ql,boolean:_r,char:Vl,cidr:zl,customType:Wl,date:Kl,doublePrecision:Gl,inet:Zl,integer:kt,interval:Hl,json:Jl,jsonb:Yl,line:Xl,macaddr:eu,macaddr8:tu,numeric:ru,point:su,geometry:iu,real:ou,serial:It,smallint:au,smallserial:lu,text:ie,time:uu,timestamp:Vt,uuid:cu,varchar:hu,bit:fu,halfvec:du,sparsevec:pu,vector:mu}}var Oo=Symbol.for("drizzle:PgInlineForeignKeys"),yu=Symbol.for("drizzle:EnableRLS"),Re=class extends V{static[T]="PgTable";static Symbol=Object.assign({},V.Symbol,{InlineForeignKeys:Oo,EnableRLS:yu});[Oo]=[];[yu]=!1;[V.Symbol.ExtraConfigBuilder]=void 0};function Uf(r,e,t,s,n=r){let i=new Re(r,s,n),o=typeof e=="function"?e(gu()):e,a=Object.fromEntries(Object.entries(o).map(([h,p])=>{let b=p;b.setName(h);let _=b.build(i);return i[Oo].push(...b.buildForeignKeys(_,i)),[h,_]})),c=Object.fromEntries(Object.entries(o).map(([h,p])=>{let b=p;b.setName(h);let _=b.buildExtraConfigColumn(i);return[h,_]})),d=Object.assign(i,a);return d[V.Symbol.Columns]=a,d[V.Symbol.ExtraConfigColumns]=c,t&&(d[Re.Symbol.ExtraConfigBuilder]=t),Object.assign(d,{enableRLS:()=>(d[Re.Symbol.EnableRLS]=!0,d)})}var wr=(r,e,t)=>Uf(r,e,t,void 0);var Js=class{static[T]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new Lo(e,this.columns,this.name)}},Lo=class{constructor(e,t,s){this.table=e,this.columns=t,this.name=s}static[T]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[Re.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};function ze(r,e){return Ol(e)&&!di(r)&&!D(r,Ve)&&!D(r,bt)&&!D(r,de)&&!D(r,V)&&!D(r,je)?new Ve(r,e):r}var Sr=(r,e)=>A`${r} = ${ze(e,r)}`,bu=(r,e)=>A`${r} <> ${ze(e,r)}`;function cs(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new G(e):new G([new Pe("("),A.join(e,new Pe(" and ")),new Pe(")")])}function vu(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new G(e):new G([new Pe("("),A.join(e,new Pe(" or ")),new Pe(")")])}function _u(r){return A`not ${r}`}var wu=(r,e)=>A`${r} > ${ze(e,r)}`,Su=(r,e)=>A`${r} >= ${ze(e,r)}`,xu=(r,e)=>A`${r} < ${ze(e,r)}`,Eu=(r,e)=>A`${r} <= ${ze(e,r)}`;function Tu(r,e){return Array.isArray(e)?e.length===0?A`false`:A`${r} in ${e.map(t=>ze(t,r))}`:A`${r} in ${ze(e,r)}`}function Cu(r,e){return Array.isArray(e)?e.length===0?A`true`:A`${r} not in ${e.map(t=>ze(t,r))}`:A`${r} not in ${ze(e,r)}`}function Nu(r){return A`${r} is null`}function Au(r){return A`${r} is not null`}function Pu(r){return A`exists ${r}`}function ku(r){return A`not exists ${r}`}function Iu(r,e,t){return A`${r} between ${ze(e,r)} and ${ze(t,r)}`}function Ou(r,e,t){return A`${r} not between ${ze(e,r)} and ${ze(t,r)}`}function Lu(r,e){return A`${r} like ${e}`}function Ru(r,e){return A`${r} not like ${e}`}function Mu(r,e){return A`${r} ilike ${e}`}function Bu(r,e){return A`${r} not ilike ${e}`}function Du(r){return A`${r} asc`}function $u(r){return A`${r} desc`}var Ys=class{constructor(e,t,s){this.sourceTable=e,this.referencedTable=t,this.relationName=s,this.referencedTableName=t[V.Symbol.Name]}static[T]="Relation";referencedTableName;fieldName},Ro=class{constructor(e,t){this.table=e,this.config=t}static[T]="Relations"},Ot=class r extends Ys{constructor(e,t,s,n){super(e,t,s?.relationName),this.config=s,this.isNullable=n}static[T]="One";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},hs=class r extends Ys{constructor(e,t,s){super(e,t,s?.relationName),this.config=s}static[T]="Many";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}};function qu(){return{and:cs,between:Iu,eq:Sr,exists:Pu,gt:wu,gte:Su,ilike:Mu,inArray:Tu,isNull:Nu,isNotNull:Au,like:Lu,lt:xu,lte:Eu,ne:bu,not:_u,notBetween:Ou,notExists:ku,notLike:Ru,notIlike:Bu,notInArray:Cu,or:vu,sql:A}}function ju(){return{sql:A,asc:Du,desc:$u}}function Fu(r,e){Object.keys(r).length===1&&"default"in r&&!D(r.default,V)&&(r=r.default);let t={},s={},n={};for(let[i,o]of Object.entries(r))if(D(o,V)){let a=Ut(o),c=s[a];t[a]=i,n[i]={tsName:i,dbName:o[V.Symbol.Name],schema:o[V.Symbol.Schema],columns:o[V.Symbol.Columns],relations:c?.relations??{},primaryKey:c?.primaryKey??[]};for(let h of Object.values(o[V.Symbol.Columns]))h.primary&&n[i].primaryKey.push(h);let d=o[V.Symbol.ExtraConfigBuilder]?.(o[V.Symbol.ExtraConfigColumns]);if(d)for(let h of Object.values(d))D(h,Js)&&n[i].primaryKey.push(...h.columns)}else if(D(o,Ro)){let a=Ut(o.table),c=t[a],d=o.config(e(o.table)),h;for(let[p,b]of Object.entries(d))if(c){let _=n[c];_.relations[p]=b,h&&_.primaryKey.push(...h)}else a in s||(s[a]={relations:{},primaryKey:h}),s[a].relations[p]=b}return{tables:n,tableNamesMap:t}}function Qf(r){return function(t,s){return new Ot(r,t,s,s?.fields.reduce((n,i)=>n&&i.notNull,!0)??!1)}}function Vf(r){return function(t,s){return new hs(r,t,s)}}function Uu(r,e,t){if(D(t,Ot)&&t.config)return{fields:t.config.fields,references:t.config.references};let s=e[Ut(t.referencedTable)];if(!s)throw new Error(`Table "${t.referencedTable[V.Symbol.Name]}" not found in schema`);let n=r[s];if(!n)throw new Error(`Table "${s}" not found in schema`);let i=t.sourceTable,o=e[Ut(i)];if(!o)throw new Error(`Table "${i[V.Symbol.Name]}" not found in schema`);let a=[];for(let c of Object.values(n.relations))(t.relationName&&t!==c&&c.relationName===t.relationName||!t.relationName&&c.referencedTable===t.sourceTable)&&a.push(c);if(a.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${s}"`):new Error(`There are multiple relations between "${s}" and "${t.sourceTable[V.Symbol.Name]}". Please specify relation name`);if(a[0]&&D(a[0],Ot)&&a[0].config)return{fields:a[0].config.references,references:a[0].config.fields};throw new Error(`There is not enough information to infer relation "${o}.${t.fieldName}"`)}function Qu(r){return{one:Qf(r),many:Vf(r)}}function Xs(r,e,t,s,n=i=>i){let i={};for(let[o,a]of s.entries())if(a.isJson){let c=e.relations[a.tsKey],d=t[o],h=typeof d=="string"?JSON.parse(d):d;i[a.tsKey]=D(c,Ot)?h&&Xs(r,r[a.relationTableTsKey],h,a.selection,n):h.map(p=>Xs(r,r[a.relationTableTsKey],p,a.selection,n))}else{let c=n(t[o]),d=a.field,h;D(d,de)?h=d:D(d,G)?h=d.decoder:h=d.sql.decoder,i[a.tsKey]=c===null?null:h.mapFromDriverValue(c)}return i}var xr=class extends je{static[T]="PgViewBase"};var Lt=class{static[T]="PgDialect";casing;constructor(e){this.casing=new Zs(e?.casing)}async migrate(e,t,s){let n=typeof s=="string"?"__drizzle_migrations":s.migrationsTable??"__drizzle_migrations",i=typeof s=="string"?"drizzle":s.migrationsSchema??"drizzle",o=A`
			CREATE TABLE IF NOT EXISTS ${A.identifier(i)}.${A.identifier(n)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(A`CREATE SCHEMA IF NOT EXISTS ${A.identifier(i)}`),await t.execute(o);let c=(await t.all(A`select id, hash, created_at from ${A.identifier(i)}.${A.identifier(n)} order by created_at desc limit 1`))[0];await t.transaction(async d=>{for await(let h of e)if(!c||Number(c.created_at)<h.folderMillis){for(let p of h.sql)await d.execute(A.raw(p));await d.execute(A`insert into ${A.identifier(i)}.${A.identifier(n)} ("hash", "created_at") values(${h.hash}, ${h.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[A`with `];for(let[s,n]of e.entries())t.push(A`${A.identifier(n._.alias)} as (${n._.sql})`),s<e.length-1&&t.push(A`, `);return t.push(A` `),A.join(t)}buildDeleteQuery({table:e,where:t,returning:s,withList:n}){let i=this.buildWithCTE(n),o=s?A` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,a=t?A` where ${t}`:void 0;return A`${i}delete from ${e}${a}${o}`}buildUpdateSet(e,t){let s=e[V.Symbol.Columns],n=Object.keys(s).filter(o=>t[o]!==void 0||s[o]?.onUpdateFn!==void 0),i=n.length;return A.join(n.flatMap((o,a)=>{let c=s[o],d=t[o]??A.param(c.onUpdateFn(),c),h=A`${A.identifier(this.casing.getColumnCasing(c))} = ${d}`;return a<i-1?[h,A.raw(", ")]:[h]}))}buildUpdateQuery({table:e,set:t,where:s,returning:n,withList:i,from:o,joins:a}){let c=this.buildWithCTE(i),d=e[Re.Symbol.Name],h=e[Re.Symbol.Schema],p=e[Re.Symbol.OriginalName],b=d===p?void 0:d,_=A`${h?A`${A.identifier(h)}.`:void 0}${A.identifier(p)}${b&&A` ${A.identifier(b)}`}`,g=this.buildUpdateSet(e,t),u=o&&A.join([A.raw(" from "),this.buildFromTable(o)]),v=this.buildJoins(a),w=n?A` returning ${this.buildSelection(n,{isSingleTable:!o})}`:void 0,S=s?A` where ${s}`:void 0;return A`${c}update ${_} set ${g}${u}${v}${S}${w}`}buildSelection(e,{isSingleTable:t=!1}={}){let s=e.length,n=e.flatMap(({field:i},o)=>{let a=[];if(D(i,G.Aliased)&&i.isSelectionField)a.push(A.identifier(i.fieldAlias));else if(D(i,G.Aliased)||D(i,G)){let c=D(i,G.Aliased)?i.sql:i;t?a.push(new G(c.queryChunks.map(d=>D(d,F)?A.identifier(this.casing.getColumnCasing(d)):d))):a.push(c),D(i,G.Aliased)&&a.push(A` as ${A.identifier(i.fieldAlias)}`)}else D(i,de)&&(t?a.push(A.identifier(this.casing.getColumnCasing(i))):a.push(i));return o<s-1&&a.push(A`, `),a});return A.join(n)}buildJoins(e){if(!e||e.length===0)return;let t=[];for(let[s,n]of e.entries()){s===0&&t.push(A` `);let i=n.table,o=n.lateral?A` lateral`:void 0;if(D(i,Re)){let a=i[Re.Symbol.Name],c=i[Re.Symbol.Schema],d=i[Re.Symbol.OriginalName],h=a===d?void 0:n.alias;t.push(A`${A.raw(n.joinType)} join${o} ${c?A`${A.identifier(c)}.`:void 0}${A.identifier(d)}${h&&A` ${A.identifier(h)}`} on ${n.on}`)}else if(D(i,je)){let a=i[me].name,c=i[me].schema,d=i[me].originalName,h=a===d?void 0:n.alias;t.push(A`${A.raw(n.joinType)} join${o} ${c?A`${A.identifier(c)}.`:void 0}${A.identifier(d)}${h&&A` ${A.identifier(h)}`} on ${n.on}`)}else t.push(A`${A.raw(n.joinType)} join${o} ${i} on ${n.on}`);s<e.length-1&&t.push(A` `)}return A.join(t)}buildFromTable(e){if(D(e,V)&&e[V.Symbol.OriginalName]!==e[V.Symbol.Name]){let t=A`${A.identifier(e[V.Symbol.OriginalName])}`;return e[V.Symbol.Schema]&&(t=A`${A.identifier(e[V.Symbol.Schema])}.${t}`),A`${t} ${A.identifier(e[V.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:s,where:n,having:i,table:o,joins:a,orderBy:c,groupBy:d,limit:h,offset:p,lockingClause:b,distinct:_,setOperators:g}){let u=s??Je(t);for(let R of u)if(D(R.field,de)&&Qe(R.field.table)!==(D(o,Ne)?o._.alias:D(o,xr)?o[me].name:D(o,G)?void 0:Qe(o))&&!(U=>a?.some(({alias:J})=>J===(U[V.Symbol.IsAlias]?Qe(U):U[V.Symbol.BaseName])))(R.field.table)){let U=Qe(R.field.table);throw new Error(`Your "${R.path.join("->")}" field references a column "${U}"."${R.field.name}", but the table "${U}" is not part of the query! Did you forget to join it?`)}let v=!a||a.length===0,w=this.buildWithCTE(e),S;_&&(S=_===!0?A` distinct`:A` distinct on (${A.join(_.on,A`, `)})`);let E=this.buildSelection(u,{isSingleTable:v}),O=this.buildFromTable(o),L=this.buildJoins(a),x=n?A` where ${n}`:void 0,k=i?A` having ${i}`:void 0,P;c&&c.length>0&&(P=A` order by ${A.join(c,A`, `)}`);let C;d&&d.length>0&&(C=A` group by ${A.join(d,A`, `)}`);let B=typeof h=="object"||typeof h=="number"&&h>=0?A` limit ${h}`:void 0,M=p?A` offset ${p}`:void 0,W=A.empty();if(b){let R=A` for ${A.raw(b.strength)}`;b.config.of&&R.append(A` of ${A.join(Array.isArray(b.config.of)?b.config.of:[b.config.of],A`, `)}`),b.config.noWait?R.append(A` no wait`):b.config.skipLocked&&R.append(A` skip locked`),W.append(R)}let K=A`${w}select${S} ${E} from ${O}${L}${x}${C}${k}${P}${B}${M}${W}`;return g.length>0?this.buildSetOperations(K,g):K}buildSetOperations(e,t){let[s,...n]=t;if(!s)throw new Error("Cannot pass undefined values to any set operator");return n.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:s}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:s}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:s,rightSelect:n,limit:i,orderBy:o,offset:a}}){let c=A`(${e.getSQL()}) `,d=A`(${n.getSQL()})`,h;if(o&&o.length>0){let g=[];for(let u of o)if(D(u,F))g.push(A.identifier(u.name));else if(D(u,G)){for(let v=0;v<u.queryChunks.length;v++){let w=u.queryChunks[v];D(w,F)&&(u.queryChunks[v]=A.identifier(w.name))}g.push(A`${u}`)}else g.push(A`${u}`);h=A` order by ${A.join(g,A`, `)} `}let p=typeof i=="object"||typeof i=="number"&&i>=0?A` limit ${i}`:void 0,b=A.raw(`${t} ${s?"all ":""}`),_=a?A` offset ${a}`:void 0;return A`${c}${b}${d}${h}${p}${_}`}buildInsertQuery({table:e,values:t,onConflict:s,returning:n,withList:i,select:o,overridingSystemValue_:a}){let c=[],d=e[V.Symbol.Columns],h=Object.entries(d).filter(([w,S])=>!S.shouldDisableInsert()),p=h.map(([,w])=>A.identifier(this.casing.getColumnCasing(w)));if(o){let w=t;D(w,G)?c.push(w):c.push(w.getSQL())}else{let w=t;c.push(A.raw("values "));for(let[S,E]of w.entries()){let O=[];for(let[L,x]of h){let k=E[L];if(k===void 0||D(k,Ve)&&k.value===void 0)if(x.defaultFn!==void 0){let P=x.defaultFn(),C=D(P,G)?P:A.param(P,x);O.push(C)}else if(!x.default&&x.onUpdateFn!==void 0){let P=x.onUpdateFn(),C=D(P,G)?P:A.param(P,x);O.push(C)}else O.push(A`default`);else O.push(k)}c.push(O),S<w.length-1&&c.push(A`, `)}}let b=this.buildWithCTE(i),_=A.join(c),g=n?A` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,u=s?A` on conflict ${s}`:void 0,v=a===!0?A`overriding system value `:void 0;return A`${b}insert into ${e} ${p} ${v}${_}${u}${g}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:s}){let n=t?A` concurrently`:void 0,i=s?A` with no data`:void 0;return A`refresh materialized view${n} ${e}${i}`}prepareTyping(e){return D(e,ns)||D(e,ss)?"json":D(e,is)?"decimal":D(e,os)?"time":D(e,as)||D(e,ls)?"timestamp":D(e,ts)||D(e,rs)?"date":D(e,us)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:s,table:n,tableConfig:i,queryConfig:o,tableAlias:a,nestedQueryRelation:c,joinOn:d}){let h=[],p,b,_=[],g,u=[];if(o===!0)h=Object.entries(i.columns).map(([S,E])=>({dbKey:E.name,tsKey:S,field:lt(E,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(i.columns).map(([k,P])=>[k,lt(P,a)]));if(o.where){let k=typeof o.where=="function"?o.where(w,qu()):o.where;g=k&&Jr(k,a)}let S=[],E=[];if(o.columns){let k=!1;for(let[P,C]of Object.entries(o.columns))C!==void 0&&P in i.columns&&(!k&&C===!0&&(k=!0),E.push(P));E.length>0&&(E=k?E.filter(P=>o.columns?.[P]===!0):Object.keys(i.columns).filter(P=>!E.includes(P)))}else E=Object.keys(i.columns);for(let k of E){let P=i.columns[k];S.push({tsKey:k,value:P})}let O=[];o.with&&(O=Object.entries(o.with).filter(k=>!!k[1]).map(([k,P])=>({tsKey:k,queryConfig:P,relation:i.relations[k]})));let L;if(o.extras){L=typeof o.extras=="function"?o.extras(w,{sql:A}):o.extras;for(let[k,P]of Object.entries(L))S.push({tsKey:k,value:pi(P,a)})}for(let{tsKey:k,value:P}of S)h.push({dbKey:D(P,G.Aliased)?P.fieldAlias:i.columns[k].name,tsKey:k,field:D(P,de)?lt(P,a):P,relationTableTsKey:void 0,isJson:!1,selection:[]});let x=typeof o.orderBy=="function"?o.orderBy(w,ju()):o.orderBy??[];Array.isArray(x)||(x=[x]),_=x.map(k=>D(k,de)?lt(k,a):Jr(k,a)),p=o.limit,b=o.offset;for(let{tsKey:k,queryConfig:P,relation:C}of O){let B=Uu(t,s,C),M=Ut(C.referencedTable),W=s[M],K=`${a}_${k}`,R=cs(...B.fields.map((ne,fe)=>Sr(lt(B.references[fe],K),lt(ne,a)))),U=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:s,table:e[W],tableConfig:t[W],queryConfig:D(C,Ot)?P===!0?{limit:1}:{...P,limit:1}:P,tableAlias:K,joinOn:R,nestedQueryRelation:C}),J=A`${A.identifier(K)}.${A.identifier("data")}`.as(k);u.push({on:A`true`,table:new Ne(U.sql,{},K),alias:K,joinType:"left",lateral:!0}),h.push({dbKey:k,tsKey:k,field:J,relationTableTsKey:W,isJson:!0,selection:U.selection})}}if(h.length===0)throw new es({message:`No fields selected for table "${i.tsName}" ("${a}")`});let v;if(g=cs(d,g),c){let w=A`json_build_array(${A.join(h.map(({field:O,tsKey:L,isJson:x})=>x?A`${A.identifier(`${a}_${L}`)}.${A.identifier("data")}`:D(O,G.Aliased)?O.sql:O),A`, `)})`;D(c,hs)&&(w=A`coalesce(json_agg(${w}${_.length>0?A` order by ${A.join(_,A`, `)}`:void 0}), '[]'::json)`);let S=[{dbKey:"data",tsKey:"data",field:w.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:h}];p!==void 0||b!==void 0||_.length>0?(v=this.buildSelectQuery({table:Hr(n,a),fields:{},fieldsFlat:[{path:[],field:A.raw("*")}],where:g,limit:p,offset:b,orderBy:_,setOperators:[]}),g=void 0,p=void 0,b=void 0,_=[]):v=Hr(n,a),v=this.buildSelectQuery({table:D(v,Re)?v:new Ne(v,{},a),fields:{},fieldsFlat:S.map(({field:O})=>({path:[],field:D(O,de)?lt(O,a):O})),joins:u,where:g,limit:p,offset:b,orderBy:_,setOperators:[]})}else v=this.buildSelectQuery({table:Hr(n,a),fields:{},fieldsFlat:h.map(({field:w})=>({path:[],field:D(w,de)?lt(w,a):w})),joins:u,where:g,limit:p,offset:b,orderBy:_,setOperators:[]});return{tableTsKey:i.tsName,sql:v,selection:h}}};var en=class{static[T]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var $e=class{static[T]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let t=!!this.fields,s=e,n;return this.fields?n=this.fields:D(s,Ne)?n=Object.fromEntries(Object.keys(s._.selectedFields).map(i=>[i,s[i]])):D(s,xr)?n=s[me].selectedFields:D(s,G)?n={}:n=Gs(s),new tn({table:s,fields:n,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Mo=class extends en{static[T]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:s,session:n,dialect:i,withList:o,distinct:a}){super(),this.config={withList:o,table:e,fields:{...t},distinct:a,setOperators:[]},this.isPartialSelect=s,this.session=n,this.dialect=i,this._={selectedFields:t},this.tableName=vt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(t,s)=>{let n=this.tableName,i=vt(t);if(typeof i=="string"&&this.config.joins?.some(o=>o.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof n=="string"&&(this.config.fields={[n]:this.config.fields}),typeof i=="string"&&!D(t,G))){let o=D(t,Ne)?t._.selectedFields:D(t,je)?t[me].selectedFields:t[V.Symbol.Columns];this.config.fields[i]=o}if(typeof s=="function"&&(s=s(new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:s,table:t,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return s=>{let n=typeof s=="function"?s(zf()):s;if(!Yr(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),s=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=s:this.config.orderBy=s}else{let t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new Ne(this.getSQL(),this.config.fields,e),new xe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new xe({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},tn=class extends Mo{static[T]="PgSelect";_prepare(e){let{session:t,config:s,dialect:n,joinsNotNullableMap:i,authToken:o}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return Ae.startActiveSpan("drizzle.prepareQuery",()=>{let a=Je(s.fields),c=t.prepareQuery(n.sqlToQuery(this.getSQL()),a,e,!0);return c.joinsNotNullableMap=i,c.setToken(o)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};ql(tn,[De]);function Er(r,e){return(t,s,...n)=>{let i=[s,...n].map(o=>({type:r,isAll:e,rightSelect:o}));for(let o of i)if(!Yr(t.getSelectedFields(),o.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(i)}}var zf=()=>({union:Wf,unionAll:Kf,intersect:Gf,intersectAll:Zf,except:Hf,exceptAll:Jf}),Wf=Er("union",!1),Kf=Er("union",!0),Gf=Er("intersect",!1),Zf=Er("intersect",!0),Hf=Er("except",!1),Jf=Er("except",!0);var Tr=class{static[T]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=D(e,Lt)?e:void 0,this.dialectConfig=D(e,Lt)?void 0:e}$with=(e,t)=>{let s=this;return{as:i=>(typeof i=="function"&&(i=i(s)),new Proxy(new br(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new xe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;function s(o){return new $e({fields:o??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function n(o){return new $e({fields:o??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function i(o,a){return new $e({fields:a??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:o}})}return{select:s,selectDistinct:n,selectDistinctOn:i}}select(e){return new $e({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new $e({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new $e({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Lt(this.dialectConfig)),this.dialect}};var fs=class{constructor(e,t,s,n,i){this.table=e,this.session=t,this.dialect=s,this.withList=n,this.overridingSystemValue_=i}static[T]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let t=e.map(s=>{let n={},i=this.table[V.Symbol.Columns];for(let o of Object.keys(s)){let a=s[o];n[o]=D(a,G)?a:new Ve(a,i[o])}return n});return new rn(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let t=typeof e=="function"?e(new Tr):e;if(!D(t,G)&&!Yr(this.table[zs],t._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new rn(this.table,t,this.session,this.dialect,this.withList,!0)}},rn=class extends De{constructor(e,t,s,n,i,o,a){super(),this.session=s,this.dialect=n,this.config={table:e,values:t,withList:i,select:o,overridingSystemValue_:a}}static[T]="PgInsert";config;returning(e=this.config.table[V.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Je(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=A`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(n=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(n))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let s=e.where?A` where ${e.where}`:void 0;this.config.onConflict=A`(${A.raw(t)})${s} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?A` where ${e.where}`:void 0,s=e.targetWhere?A` where ${e.targetWhere}`:void 0,n=e.setWhere?A` where ${e.setWhere}`:void 0,i=this.dialect.buildUpdateSet(this.config.table,Ks(this.config.table,e.set)),o="";return o=Array.isArray(e.target)?e.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=A`(${A.raw(o)})${s} do update set ${i}${t}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new xe({alias:Qe(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var sn=class extends De{constructor(e,t,s){super(),this.session=t,this.dialect=s,this.config={view:e}}static[T]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var ds=class{constructor(e,t,s,n){this.table=e,this.session=t,this.dialect=s,this.withList=n}static[T]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Bo(this.table,Ks(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Bo=class extends De{constructor(e,t,s,n,i){super(),this.session=s,this.dialect=n,this.config={set:t,table:e,withList:i,joins:[]},this.tableName=vt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[T]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let t=e,s=vt(t);return typeof s=="string"&&(this.joinsNotNullableMap[s]=!0),this.config.from=t,this}getTableLikeFields(e){return D(e,Re)?e[V.Symbol.Columns]:D(e,Ne)?e._.selectedFields:e[me].selectedFields}createJoin(e){return(t,s)=>{let n=vt(t);if(typeof n=="string"&&this.config.joins.some(i=>i.alias===n))throw new Error(`Alias "${n}" is already used in this query`);if(typeof s=="function"){let i=this.config.from&&!D(this.config.from,G)?this.getTableLikeFields(this.config.from):void 0;s=s(new Proxy(this.config.table[V.Symbol.Columns],new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),i&&new Proxy(i,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:s,table:t,joinType:e,alias:n}),typeof n=="string")switch(e){case"left":{this.joinsNotNullableMap[n]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[n]=!0;break}case"inner":{this.joinsNotNullableMap[n]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[n]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[V.Symbol.Columns]),this.config.from)){let t=vt(this.config.from);if(typeof t=="string"&&this.config.from&&!D(this.config.from,G)){let s=this.getTableLikeFields(this.config.from);e[t]=s}for(let s of this.config.joins){let n=vt(s.table);if(typeof n=="string"&&!D(s.table,G)){let i=this.getTableLikeFields(s.table);e[n]=i}}}return this.config.returningFields=e,this.config.returning=Je(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new xe({alias:Qe(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var nn=class r extends G{constructor(e){super(r.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=r.buildCount(e.source,e.filters)}sql;token;static[T]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return A`(select count(*) from ${e}${A.raw(" where ").if(t)}${t})`}static buildCount(e,t){return A`select count(*) as count from ${e}${A.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}};var on=class{constructor(e,t,s,n,i,o,a){this.fullSchema=e,this.schema=t,this.tableNamesMap=s,this.table=n,this.tableConfig=i,this.dialect=o,this.session=a}static[T]="PgRelationalQueryBuilder";findMany(e){return new an(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new an(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},an=class extends De{constructor(e,t,s,n,i,o,a,c,d){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=s,this.table=n,this.tableConfig=i,this.dialect=o,this.session=a,this.config=c,this.mode=d}static[T]="PgRelationalQuery";_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:s}=this._toSQL();return this.session.prepareQuery(s,void 0,e,!0,(n,i)=>{let o=n.map(a=>Xs(this.schema,this.tableConfig,a,t.selection,i));return this.mode==="first"?o[0]:o})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var ln=class extends De{constructor(e,t,s,n){super(),this.execute=e,this.sql=t,this.query=s,this.mapBatchResult=n}static[T]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var Cr=class{constructor(e,t,s){if(this.dialect=e,this.session=t,this._=s?{schema:s.schema,fullSchema:s.fullSchema,tableNamesMap:s.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[n,i]of Object.entries(this._.schema))this.query[n]=new on(s.fullSchema,this._.schema,this._.tableNamesMap,s.fullSchema[n],i,e,t)}static[T]="PgDatabase";query;$with=(e,t)=>{let s=this;return{as:i=>(typeof i=="function"&&(i=i(new Tr(s.dialect))),new Proxy(new br(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new xe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new nn({source:e,filters:t,session:this.session})}with(...e){let t=this;function s(d){return new $e({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e})}function n(d){return new $e({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}function i(d,h){return new $e({fields:h??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:d}})}function o(d){return new ds(d,t.session,t.dialect,e)}function a(d){return new fs(d,t.session,t.dialect,e)}function c(d){return new Xr(d,t.session,t.dialect,e)}return{select:s,selectDistinct:n,selectDistinctOn:i,update:o,insert:a,delete:c}}select(e){return new $e({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new $e({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new $e({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new ds(e,this.session,this.dialect)}insert(e){return new fs(e,this.session,this.dialect)}delete(e){return new Xr(e,this.session,this.dialect)}refreshMaterializedView(e){return new sn(e,this.session,this.dialect)}authToken;execute(e){let t=typeof e=="string"?A.raw(e):e.getSQL(),s=this.dialect.sqlToQuery(t),n=this.session.prepareQuery(s,void 0,void 0,!1);return new ln(()=>n.execute(void 0,this.authToken),t,s,i=>n.mapResult(i,!0))}transaction(e,t){return this.session.transaction(e,t)}};var un=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static[T]="PgPreparedQuery";joinsNotNullableMap},cn=class{constructor(e){this.dialect=e}static[T]="PgSession";execute(e,t){return Ae.startActiveSpan("drizzle.operation",()=>Ae.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){let s=await this.execute(e,t);return Number(s[0].count)}},hn=class extends Cr{constructor(e,t,s,n=0){super(e,t,s),this.schema=s,this.nestedIndex=n}static[T]="PgTransaction";rollback(){throw new Hs}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),typeof e.deferrable=="boolean"&&t.push(e.deferrable?"deferrable":"not deferrable"),A.raw(t.join(" "))}setTransaction(e){return this.session.execute(A`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Do=class extends un{constructor(e,t,s,n,i,o,a,c){super({sql:t,params:s}),this.client=e,this.params=s,this.logger=n,this.fields=i,this._isResponseInArrayMode=a,this.customResultMapper=c,this.rawQueryConfig={name:o,text:t,types:{getTypeParser:(d,h)=>d===nt.builtins.TIMESTAMPTZ?p=>p:d===nt.builtins.TIMESTAMP?p=>p:d===nt.builtins.DATE?p=>p:d===nt.builtins.INTERVAL?p=>p:nt.getTypeParser(d,h)}},this.queryConfig={name:o,text:t,rowMode:"array",types:{getTypeParser:(d,h)=>d===nt.builtins.TIMESTAMPTZ?p=>p:d===nt.builtins.TIMESTAMP?p=>p:d===nt.builtins.DATE?p=>p:d===nt.builtins.INTERVAL?p=>p:nt.getTypeParser(d,h)}}}static[T]="NeonPreparedQuery";rawQueryConfig;queryConfig;async execute(e={}){let t=Ws(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,t);let{fields:s,client:n,rawQueryConfig:i,queryConfig:o,joinsNotNullableMap:a,customResultMapper:c}=this;if(!s&&!c)return n.query(i,t);let d=await n.query(o,t);return c?c(d.rows):d.rows.map(h=>$l(s,h,a))}all(e={}){let t=Ws(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),this.client.query(this.rawQueryConfig,t).then(s=>s.rows)}values(e={}){let t=Ws(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),this.client.query(this.queryConfig,t).then(s=>s.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}},fn=class r extends cn{constructor(e,t,s,n={}){super(t),this.client=e,this.schema=s,this.options=n,this.logger=n.logger??new js}static[T]="NeonSession";logger;prepareQuery(e,t,s,n,i){return new Do(this.client,e.sql,e.params,this.logger,t,s,n,i)}async query(e,t){return this.logger.logQuery(e,t),await this.client.query({rowMode:"array",text:e,values:t})}async queryObjects(e,t){return this.client.query(e,t)}async count(e){let t=await this.execute(e);return Number(t.rows[0].count)}async transaction(e,t={}){let s=this.client instanceof yt?new r(await this.client.connect(),this.dialect,this.schema,this.options):this,n=new $o(this.dialect,s,this.schema);await n.execute(A`begin ${n.getTransactionConfigSQL(t)}`);try{let i=await e(n);return await n.execute(A`commit`),i}catch(i){throw await n.execute(A`rollback`),i}finally{this.client instanceof yt&&s.client.release()}}},$o=class r extends hn{static[T]="NeonTransaction";async transaction(e){let t=`sp${this.nestedIndex+1}`,s=new r(this.dialect,this.session,this.schema,this.nestedIndex+1);await s.execute(A.raw(`savepoint ${t}`));try{let n=await e(s);return await s.execute(A.raw(`release savepoint ${t}`)),n}catch(n){throw await s.execute(A.raw(`rollback to savepoint ${t}`)),n}}};var qo=class{constructor(e,t,s={}){this.client=e,this.dialect=t,this.options=s}static[T]="NeonDriver";createSession(e){return new fn(this.client,this.dialect,e,{logger:this.options.logger})}},jo=class extends Cr{static[T]="NeonServerlessDatabase"};function ps(r,e={}){let t=new Lt({casing:e.casing}),s;e.logger===!0?s=new qs:e.logger!==!1&&(s=e.logger);let n;if(e.schema){let c=Fu(e.schema,Qu);n={fullSchema:e.schema,schema:c.tables,tableNamesMap:c.tableNamesMap}}let o=new qo(r,t,{logger:s}).createSession(n),a=new jo(t,o,n);return a.$client=r,a}function dn(...r){if(typeof r[0]=="string"){let e=new yt({connectionString:r[0]});return ps(e,r[1])}if(Fl(r[0])){let{connection:e,client:t,ws:s,...n}=r[0];if(s&&(gt.webSocketConstructor=s),t)return ps(t,n);let i=typeof e=="string"?new yt({connectionString:e}):new yt(e);return ps(i,n)}return ps(r[0],r[1])}(r=>{function e(t){return ps({},t)}r.mock=e})(dn||(dn={}));var he;(function(r){r.assertEqual=n=>n;function e(n){}r.assertIs=e;function t(n){throw new Error}r.assertNever=t,r.arrayToEnum=n=>{let i={};for(let o of n)i[o]=o;return i},r.getValidEnumValues=n=>{let i=r.objectKeys(n).filter(a=>typeof n[n[a]]!="number"),o={};for(let a of i)o[a]=n[a];return r.objectValues(o)},r.objectValues=n=>r.objectKeys(n).map(function(i){return n[i]}),r.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},r.find=(n,i)=>{for(let o of n)if(i(o))return o},r.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}r.joinValues=s,r.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(he||(he={}));var Uo;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(Uo||(Uo={}));var z=he.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),St=r=>{switch(typeof r){case"undefined":return z.undefined;case"string":return z.string;case"number":return isNaN(r)?z.nan:z.number;case"boolean":return z.boolean;case"function":return z.function;case"bigint":return z.bigint;case"symbol":return z.symbol;case"object":return Array.isArray(r)?z.array:r===null?z.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?z.promise:typeof Map<"u"&&r instanceof Map?z.map:typeof Set<"u"&&r instanceof Set?z.set:typeof Date<"u"&&r instanceof Date?z.date:z.object;default:return z.unknown}},q=he.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Yf=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),Ke=class r extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(t(o));else{let a=s,c=0;for(;c<o.path.length;){let d=o.path[c];c===o.path.length-1?(a[d]=a[d]||{_errors:[]},a[d]._errors.push(t(o))):a[d]=a[d]||{_errors:[]},a=a[d],c++}}};return n(this),s}static assert(e){if(!(e instanceof r))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,he.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},s=[];for(let n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}};Ke.create=r=>new Ke(r);var Pr=(r,e)=>{let t;switch(r.code){case q.invalid_type:r.received===z.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case q.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,he.jsonStringifyReplacer)}`;break;case q.unrecognized_keys:t=`Unrecognized key(s) in object: ${he.joinValues(r.keys,", ")}`;break;case q.invalid_union:t="Invalid input";break;case q.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${he.joinValues(r.options)}`;break;case q.invalid_enum_value:t=`Invalid enum value. Expected ${he.joinValues(r.options)}, received '${r.received}'`;break;case q.invalid_arguments:t="Invalid function arguments";break;case q.invalid_return_type:t="Invalid function return type";break;case q.invalid_date:t="Invalid date";break;case q.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:he.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case q.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case q.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case q.custom:t="Invalid input";break;case q.invalid_intersection_types:t="Intersection results could not be merged";break;case q.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case q.not_finite:t="Number must be finite";break;default:t=e.defaultError,he.assertNever(r)}return{message:t}},Ku=Pr;function Xf(r){Ku=r}function pn(){return Ku}var mn=r=>{let{data:e,path:t,errorMaps:s,issueData:n}=r,i=[...t,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let a="",c=s.filter(d=>!!d).slice().reverse();for(let d of c)a=d(o,{data:e,defaultError:a}).message;return{...n,path:i,message:a}},ed=[];function Q(r,e){let t=pn(),s=mn({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Pr?void 0:Pr].filter(n=>!!n)});r.common.issues.push(s)}var qe=class r{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let s=[];for(let n of t){if(n.status==="aborted")return te;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){let s=[];for(let n of t){let i=await n.key,o=await n.value;s.push({key:i,value:o})}return r.mergeObjectSync(e,s)}static mergeObjectSync(e,t){let s={};for(let n of t){let{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return te;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}},te=Object.freeze({status:"aborted"}),Ar=r=>({status:"dirty",value:r}),Fe=r=>({status:"valid",value:r}),Qo=r=>r.status==="aborted",Vo=r=>r.status==="dirty",zt=r=>r.status==="valid",ys=r=>typeof Promise<"u"&&r instanceof Promise;function gn(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)}function Gu(r,e,t,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(r,t):n?n.value=t:e.set(r,t),t}var H;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(H||(H={}));var ms,gs,Xe=class{constructor(e,t,s,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Vu=(r,e)=>{if(zt(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new Ke(r.common.issues);return this._error=t,this._error}}};function oe(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:s,description:n}=r;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(o,a)=>{var c,d;let{message:h}=r;return o.code==="invalid_enum_value"?{message:h??a.defaultError}:typeof a.data>"u"?{message:(c=h??s)!==null&&c!==void 0?c:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(d=h??t)!==null&&d!==void 0?d:a.defaultError}},description:n}}var ae=class{get description(){return this._def.description}_getType(e){return St(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:St(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new qe,ctx:{common:e.parent.common,data:e.data,parsedType:St(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(ys(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;let n={common:{issues:[],async:(s=t?.async)!==null&&s!==void 0?s:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:St(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Vu(n,i)}"~validate"(e){var t,s;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:St(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:n});return zt(i)?{value:i.value}:{issues:n.common.issues}}catch(i){!((s=(t=i?.message)===null||t===void 0?void 0:t.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>zt(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,t){let s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){let s={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:St(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(ys(n)?n:Promise.resolve(n));return Vu(s,i)}refine(e,t){let s=n=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(n):t;return this._refinement((n,i)=>{let o=e(n),a=()=>i.addIssue({code:q.custom,...s(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof t=="function"?t(s,n):t),!1))}_refinement(e){return new Ge({schema:this,typeName:ee.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Ye.create(this,this._def)}nullable(){return ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Et.create(this)}promise(){return Bt.create(this,this._def)}or(e){return Yt.create([this,e],this._def)}and(e){return Xt.create(this,e,this._def)}transform(e){return new Ge({...oe(this._def),schema:this,typeName:ee.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new nr({...oe(this._def),innerType:this,defaultValue:t,typeName:ee.ZodDefault})}brand(){return new bs({typeName:ee.ZodBranded,type:this,...oe(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new ir({...oe(this._def),innerType:this,catchValue:t,typeName:ee.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return vs.create(this,e)}readonly(){return or.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},td=/^c[^\s-]{8,}$/i,rd=/^[0-9a-z]+$/,sd=/^[0-9A-HJKMNP-TV-Z]{26}$/i,nd=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,id=/^[a-z0-9_-]{21}$/i,od=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ad=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ld=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ud="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Fo,cd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,hd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,fd=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,dd=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,pd=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,md=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Zu="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",gd=new RegExp(`^${Zu}$`);function Hu(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function yd(r){return new RegExp(`^${Hu(r)}$`)}function Ju(r){let e=`${Zu}T${Hu(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function bd(r,e){return!!((e==="v4"||!e)&&cd.test(r)||(e==="v6"||!e)&&fd.test(r))}function vd(r,e){if(!od.test(r))return!1;try{let[t]=r.split("."),s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),n=JSON.parse(atob(s));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function _d(r,e){return!!((e==="v4"||!e)&&hd.test(r)||(e==="v6"||!e)&&dd.test(r))}var Rt=class r extends ae{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==z.string){let i=this._getOrReturnCtx(e);return Q(i,{code:q.invalid_type,expected:z.string,received:i.parsedType}),te}let s=new qe,n;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),Q(n,{code:q.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),Q(n,{code:q.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){let o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(n=this._getOrReturnCtx(e,n),o?Q(n,{code:q.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Q(n,{code:q.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")ld.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"email",code:q.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")Fo||(Fo=new RegExp(ud,"u")),Fo.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"emoji",code:q.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")nd.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"uuid",code:q.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")id.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"nanoid",code:q.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")td.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"cuid",code:q.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")rd.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"cuid2",code:q.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")sd.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"ulid",code:q.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),Q(n,{validation:"url",code:q.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"regex",code:q.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),Q(n,{code:q.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),Q(n,{code:q.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),Q(n,{code:q.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?Ju(i).test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{code:q.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?gd.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{code:q.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?yd(i).test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{code:q.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?ad.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"duration",code:q.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?bd(e.data,i.version)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"ip",code:q.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?vd(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"jwt",code:q.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?_d(e.data,i.version)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"cidr",code:q.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?pd.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"base64",code:q.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?md.test(e.data)||(n=this._getOrReturnCtx(e,n),Q(n,{validation:"base64url",code:q.invalid_string,message:i.message}),s.dirty()):he.assertNever(i);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(n=>e.test(n),{validation:t,code:q.invalid_string,...H.errToObj(s)})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...H.errToObj(e)})}url(e){return this._addCheck({kind:"url",...H.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...H.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...H.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...H.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...H.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...H.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...H.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...H.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...H.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...H.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...H.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...H.errToObj(e)})}datetime(e){var t,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(s=e?.local)!==null&&s!==void 0?s:!1,...H.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...H.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...H.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...H.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...H.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...H.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...H.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...H.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...H.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...H.errToObj(t)})}nonempty(e){return this.min(1,H.errToObj(e))}trim(){return new r({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Rt.create=r=>{var e;return new Rt({checks:[],typeName:ee.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...oe(r)})};function wd(r,e){let t=(r.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=t>s?t:s,i=parseInt(r.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return i%o/Math.pow(10,n)}var Wt=class r extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==z.number){let i=this._getOrReturnCtx(e);return Q(i,{code:q.invalid_type,expected:z.number,received:i.parsedType}),te}let s,n=new qe;for(let i of this._def.checks)i.kind==="int"?he.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:q.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Q(s,{code:q.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Q(s,{code:q.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?wd(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),Q(s,{code:q.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:q.not_finite,message:i.message}),n.dirty()):he.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,s,n){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:H.toString(n)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:H.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:H.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:H.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:H.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&he.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}};Wt.create=r=>new Wt({checks:[],typeName:ee.ZodNumber,coerce:r?.coerce||!1,...oe(r)});var Kt=class r extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==z.bigint)return this._getInvalidInput(e);let s,n=new qe;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Q(s,{code:q.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Q(s,{code:q.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),Q(s,{code:q.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):he.assertNever(i);return{status:n.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return Q(t,{code:q.invalid_type,expected:z.bigint,received:t.parsedType}),te}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,s,n){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:H.toString(n)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Kt.create=r=>{var e;return new Kt({checks:[],typeName:ee.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...oe(r)})};var Gt=class extends ae{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==z.boolean){let s=this._getOrReturnCtx(e);return Q(s,{code:q.invalid_type,expected:z.boolean,received:s.parsedType}),te}return Fe(e.data)}};Gt.create=r=>new Gt({typeName:ee.ZodBoolean,coerce:r?.coerce||!1,...oe(r)});var Zt=class r extends ae{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==z.date){let i=this._getOrReturnCtx(e);return Q(i,{code:q.invalid_type,expected:z.date,received:i.parsedType}),te}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return Q(i,{code:q.invalid_date}),te}let s=new qe,n;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),Q(n,{code:q.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),Q(n,{code:q.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):he.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:H.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:H.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};Zt.create=r=>new Zt({checks:[],coerce:r?.coerce||!1,typeName:ee.ZodDate,...oe(r)});var kr=class extends ae{_parse(e){if(this._getType(e)!==z.symbol){let s=this._getOrReturnCtx(e);return Q(s,{code:q.invalid_type,expected:z.symbol,received:s.parsedType}),te}return Fe(e.data)}};kr.create=r=>new kr({typeName:ee.ZodSymbol,...oe(r)});var Ht=class extends ae{_parse(e){if(this._getType(e)!==z.undefined){let s=this._getOrReturnCtx(e);return Q(s,{code:q.invalid_type,expected:z.undefined,received:s.parsedType}),te}return Fe(e.data)}};Ht.create=r=>new Ht({typeName:ee.ZodUndefined,...oe(r)});var Jt=class extends ae{_parse(e){if(this._getType(e)!==z.null){let s=this._getOrReturnCtx(e);return Q(s,{code:q.invalid_type,expected:z.null,received:s.parsedType}),te}return Fe(e.data)}};Jt.create=r=>new Jt({typeName:ee.ZodNull,...oe(r)});var Mt=class extends ae{constructor(){super(...arguments),this._any=!0}_parse(e){return Fe(e.data)}};Mt.create=r=>new Mt({typeName:ee.ZodAny,...oe(r)});var xt=class extends ae{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Fe(e.data)}};xt.create=r=>new xt({typeName:ee.ZodUnknown,...oe(r)});var ot=class extends ae{_parse(e){let t=this._getOrReturnCtx(e);return Q(t,{code:q.invalid_type,expected:z.never,received:t.parsedType}),te}};ot.create=r=>new ot({typeName:ee.ZodNever,...oe(r)});var Ir=class extends ae{_parse(e){if(this._getType(e)!==z.undefined){let s=this._getOrReturnCtx(e);return Q(s,{code:q.invalid_type,expected:z.void,received:s.parsedType}),te}return Fe(e.data)}};Ir.create=r=>new Ir({typeName:ee.ZodVoid,...oe(r)});var Et=class r extends ae{_parse(e){let{ctx:t,status:s}=this._processInputParams(e),n=this._def;if(t.parsedType!==z.array)return Q(t,{code:q.invalid_type,expected:z.array,received:t.parsedType}),te;if(n.exactLength!==null){let o=t.data.length>n.exactLength.value,a=t.data.length<n.exactLength.value;(o||a)&&(Q(t,{code:o?q.too_big:q.too_small,minimum:a?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&t.data.length<n.minLength.value&&(Q(t,{code:q.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&t.data.length>n.maxLength.value&&(Q(t,{code:q.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>n.type._parseAsync(new Xe(t,o,t.path,a)))).then(o=>qe.mergeArray(s,o));let i=[...t.data].map((o,a)=>n.type._parseSync(new Xe(t,o,t.path,a)));return qe.mergeArray(s,i)}get element(){return this._def.type}min(e,t){return new r({...this._def,minLength:{value:e,message:H.toString(t)}})}max(e,t){return new r({...this._def,maxLength:{value:e,message:H.toString(t)}})}length(e,t){return new r({...this._def,exactLength:{value:e,message:H.toString(t)}})}nonempty(e){return this.min(1,e)}};Et.create=(r,e)=>new Et({type:r,minLength:null,maxLength:null,exactLength:null,typeName:ee.ZodArray,...oe(e)});function Nr(r){if(r instanceof We){let e={};for(let t in r.shape){let s=r.shape[t];e[t]=Ye.create(Nr(s))}return new We({...r._def,shape:()=>e})}else return r instanceof Et?new Et({...r._def,type:Nr(r.element)}):r instanceof Ye?Ye.create(Nr(r.unwrap())):r instanceof ht?ht.create(Nr(r.unwrap())):r instanceof ct?ct.create(r.items.map(e=>Nr(e))):r}var We=class r extends ae{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=he.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==z.object){let d=this._getOrReturnCtx(e);return Q(d,{code:q.invalid_type,expected:z.object,received:d.parsedType}),te}let{status:s,ctx:n}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof ot&&this._def.unknownKeys==="strip"))for(let d in n.data)o.includes(d)||a.push(d);let c=[];for(let d of o){let h=i[d],p=n.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new Xe(n,p,n.path,d)),alwaysSet:d in n.data})}if(this._def.catchall instanceof ot){let d=this._def.unknownKeys;if(d==="passthrough")for(let h of a)c.push({key:{status:"valid",value:h},value:{status:"valid",value:n.data[h]}});else if(d==="strict")a.length>0&&(Q(n,{code:q.unrecognized_keys,keys:a}),s.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let d=this._def.catchall;for(let h of a){let p=n.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new Xe(n,p,n.path,h)),alwaysSet:h in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let d=[];for(let h of c){let p=await h.key,b=await h.value;d.push({key:p,value:b,alwaysSet:h.alwaysSet})}return d}).then(d=>qe.mergeObjectSync(s,d)):qe.mergeObjectSync(s,c)}get shape(){return this._def.shape()}strict(e){return H.errToObj,new r({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{var n,i,o,a;let c=(o=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,t,s).message)!==null&&o!==void 0?o:s.defaultError;return t.code==="unrecognized_keys"?{message:(a=H.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new r({...this._def,unknownKeys:"strip"})}passthrough(){return new r({...this._def,unknownKeys:"passthrough"})}extend(e){return new r({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new r({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ee.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new r({...this._def,catchall:e})}pick(e){let t={};return he.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(t[s]=this.shape[s])}),new r({...this._def,shape:()=>t})}omit(e){let t={};return he.objectKeys(this.shape).forEach(s=>{e[s]||(t[s]=this.shape[s])}),new r({...this._def,shape:()=>t})}deepPartial(){return Nr(this)}partial(e){let t={};return he.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?t[s]=n:t[s]=n.optional()}),new r({...this._def,shape:()=>t})}required(e){let t={};return he.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])t[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof Ye;)i=i._def.innerType;t[s]=i}}),new r({...this._def,shape:()=>t})}keyof(){return Yu(he.objectKeys(this.shape))}};We.create=(r,e)=>new We({shape:()=>r,unknownKeys:"strip",catchall:ot.create(),typeName:ee.ZodObject,...oe(e)});We.strictCreate=(r,e)=>new We({shape:()=>r,unknownKeys:"strict",catchall:ot.create(),typeName:ee.ZodObject,...oe(e)});We.lazycreate=(r,e)=>new We({shape:r,unknownKeys:"strip",catchall:ot.create(),typeName:ee.ZodObject,...oe(e)});var Yt=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),s=this._def.options;function n(i){for(let a of i)if(a.result.status==="valid")return a.result;for(let a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let o=i.map(a=>new Ke(a.ctx.common.issues));return Q(t,{code:q.invalid_union,unionErrors:o}),te}if(t.common.async)return Promise.all(s.map(async i=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(n);{let i,o=[];for(let c of s){let d={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;let a=o.map(c=>new Ke(c));return Q(t,{code:q.invalid_union,unionErrors:a}),te}}get options(){return this._def.options}};Yt.create=(r,e)=>new Yt({options:r,typeName:ee.ZodUnion,...oe(e)});var wt=r=>r instanceof er?wt(r.schema):r instanceof Ge?wt(r.innerType()):r instanceof tr?[r.value]:r instanceof rr?r.options:r instanceof sr?he.objectValues(r.enum):r instanceof nr?wt(r._def.innerType):r instanceof Ht?[void 0]:r instanceof Jt?[null]:r instanceof Ye?[void 0,...wt(r.unwrap())]:r instanceof ht?[null,...wt(r.unwrap())]:r instanceof bs||r instanceof or?wt(r.unwrap()):r instanceof ir?wt(r._def.innerType):[],yn=class r extends ae{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==z.object)return Q(t,{code:q.invalid_type,expected:z.object,received:t.parsedType}),te;let s=this.discriminator,n=t.data[s],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(Q(t,{code:q.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),te)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){let n=new Map;for(let i of t){let o=wt(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,i)}}return new r({typeName:ee.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...oe(s)})}};function zo(r,e){let t=St(r),s=St(e);if(r===e)return{valid:!0,data:r};if(t===z.object&&s===z.object){let n=he.objectKeys(e),i=he.objectKeys(r).filter(a=>n.indexOf(a)!==-1),o={...r,...e};for(let a of i){let c=zo(r[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===z.array&&s===z.array){if(r.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<r.length;i++){let o=r[i],a=e[i],c=zo(o,a);if(!c.valid)return{valid:!1};n.push(c.data)}return{valid:!0,data:n}}else return t===z.date&&s===z.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}var Xt=class extends ae{_parse(e){let{status:t,ctx:s}=this._processInputParams(e),n=(i,o)=>{if(Qo(i)||Qo(o))return te;let a=zo(i.value,o.value);return a.valid?((Vo(i)||Vo(o))&&t.dirty(),{status:t.value,value:a.data}):(Q(s,{code:q.invalid_intersection_types}),te)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};Xt.create=(r,e,t)=>new Xt({left:r,right:e,typeName:ee.ZodIntersection,...oe(t)});var ct=class r extends ae{_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==z.array)return Q(s,{code:q.invalid_type,expected:z.array,received:s.parsedType}),te;if(s.data.length<this._def.items.length)return Q(s,{code:q.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),te;!this._def.rest&&s.data.length>this._def.items.length&&(Q(s,{code:q.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...s.data].map((o,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new Xe(s,o,s.path,a)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>qe.mergeArray(t,o)):qe.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new r({...this._def,rest:e})}};ct.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ct({items:r,typeName:ee.ZodTuple,rest:null,...oe(e)})};var bn=class r extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==z.object)return Q(s,{code:q.invalid_type,expected:z.object,received:s.parsedType}),te;let n=[],i=this._def.keyType,o=this._def.valueType;for(let a in s.data)n.push({key:i._parse(new Xe(s,a,s.path,a)),value:o._parse(new Xe(s,s.data[a],s.path,a)),alwaysSet:a in s.data});return s.common.async?qe.mergeObjectAsync(t,n):qe.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,s){return t instanceof ae?new r({keyType:e,valueType:t,typeName:ee.ZodRecord,...oe(s)}):new r({keyType:Rt.create(),valueType:e,typeName:ee.ZodRecord,...oe(t)})}},Or=class extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==z.map)return Q(s,{code:q.invalid_type,expected:z.map,received:s.parsedType}),te;let n=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([a,c],d)=>({key:n._parse(new Xe(s,a,s.path,[d,"key"])),value:i._parse(new Xe(s,c,s.path,[d,"value"]))}));if(s.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of o){let d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return te;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),a.set(d.value,h.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let c of o){let d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return te;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),a.set(d.value,h.value)}return{status:t.value,value:a}}}};Or.create=(r,e,t)=>new Or({valueType:e,keyType:r,typeName:ee.ZodMap,...oe(t)});var Lr=class r extends ae{_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==z.set)return Q(s,{code:q.invalid_type,expected:z.set,received:s.parsedType}),te;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(Q(s,{code:q.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(Q(s,{code:q.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());let i=this._def.valueType;function o(c){let d=new Set;for(let h of c){if(h.status==="aborted")return te;h.status==="dirty"&&t.dirty(),d.add(h.value)}return{status:t.value,value:d}}let a=[...s.data.values()].map((c,d)=>i._parse(new Xe(s,c,s.path,d)));return s.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new r({...this._def,minSize:{value:e,message:H.toString(t)}})}max(e,t){return new r({...this._def,maxSize:{value:e,message:H.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};Lr.create=(r,e)=>new Lr({valueType:r,minSize:null,maxSize:null,typeName:ee.ZodSet,...oe(e)});var vn=class r extends ae{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==z.function)return Q(t,{code:q.invalid_type,expected:z.function,received:t.parsedType}),te;function s(a,c){return mn({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,pn(),Pr].filter(d=>!!d),issueData:{code:q.invalid_arguments,argumentsError:c}})}function n(a,c){return mn({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,pn(),Pr].filter(d=>!!d),issueData:{code:q.invalid_return_type,returnTypeError:c}})}let i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Bt){let a=this;return Fe(async function(...c){let d=new Ke([]),h=await a._def.args.parseAsync(c,i).catch(_=>{throw d.addIssue(s(c,_)),d}),p=await Reflect.apply(o,this,h);return await a._def.returns._def.type.parseAsync(p,i).catch(_=>{throw d.addIssue(n(p,_)),d})})}else{let a=this;return Fe(function(...c){let d=a._def.args.safeParse(c,i);if(!d.success)throw new Ke([s(c,d.error)]);let h=Reflect.apply(o,this,d.data),p=a._def.returns.safeParse(h,i);if(!p.success)throw new Ke([n(h,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new r({...this._def,args:ct.create(e).rest(xt.create())})}returns(e){return new r({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,s){return new r({args:e||ct.create([]).rest(xt.create()),returns:t||xt.create(),typeName:ee.ZodFunction,...oe(s)})}},er=class extends ae{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};er.create=(r,e)=>new er({getter:r,typeName:ee.ZodLazy,...oe(e)});var tr=class extends ae{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return Q(t,{received:t.data,code:q.invalid_literal,expected:this._def.value}),te}return{status:"valid",value:e.data}}get value(){return this._def.value}};tr.create=(r,e)=>new tr({value:r,typeName:ee.ZodLiteral,...oe(e)});function Yu(r,e){return new rr({values:r,typeName:ee.ZodEnum,...oe(e)})}var rr=class r extends ae{constructor(){super(...arguments),ms.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),s=this._def.values;return Q(t,{expected:he.joinValues(s),received:t.parsedType,code:q.invalid_type}),te}if(gn(this,ms,"f")||Gu(this,ms,new Set(this._def.values),"f"),!gn(this,ms,"f").has(e.data)){let t=this._getOrReturnCtx(e),s=this._def.values;return Q(t,{received:t.data,code:q.invalid_enum_value,options:s}),te}return Fe(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return r.create(e,{...this._def,...t})}exclude(e,t=this._def){return r.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}};ms=new WeakMap;rr.create=Yu;var sr=class extends ae{constructor(){super(...arguments),gs.set(this,void 0)}_parse(e){let t=he.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==z.string&&s.parsedType!==z.number){let n=he.objectValues(t);return Q(s,{expected:he.joinValues(n),received:s.parsedType,code:q.invalid_type}),te}if(gn(this,gs,"f")||Gu(this,gs,new Set(he.getValidEnumValues(this._def.values)),"f"),!gn(this,gs,"f").has(e.data)){let n=he.objectValues(t);return Q(s,{received:s.data,code:q.invalid_enum_value,options:n}),te}return Fe(e.data)}get enum(){return this._def.values}};gs=new WeakMap;sr.create=(r,e)=>new sr({values:r,typeName:ee.ZodNativeEnum,...oe(e)});var Bt=class extends ae{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==z.promise&&t.common.async===!1)return Q(t,{code:q.invalid_type,expected:z.promise,received:t.parsedType}),te;let s=t.parsedType===z.promise?t.data:Promise.resolve(t.data);return Fe(s.then(n=>this._def.type.parseAsync(n,{path:t.path,errorMap:t.common.contextualErrorMap})))}};Bt.create=(r,e)=>new Bt({type:r,typeName:ee.ZodPromise,...oe(e)});var Ge=class extends ae{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ee.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:o=>{Q(s,o),o.fatal?t.abort():t.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let o=n.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return te;let c=await this._def.schema._parseAsync({data:a,path:s.path,parent:s});return c.status==="aborted"?te:c.status==="dirty"||t.value==="dirty"?Ar(c.value):c});{if(t.value==="aborted")return te;let a=this._def.schema._parseSync({data:o,path:s.path,parent:s});return a.status==="aborted"?te:a.status==="dirty"||t.value==="dirty"?Ar(a.value):a}}if(n.type==="refinement"){let o=a=>{let c=n.refinement(a,i);if(s.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(s.common.async===!1){let a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?te:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>a.status==="aborted"?te:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(n.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!zt(o))return o;let a=n.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>zt(o)?Promise.resolve(n.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);he.assertNever(n)}};Ge.create=(r,e,t)=>new Ge({schema:r,typeName:ee.ZodEffects,effect:e,...oe(t)});Ge.createWithPreprocess=(r,e,t)=>new Ge({schema:e,effect:{type:"preprocess",transform:r},typeName:ee.ZodEffects,...oe(t)});var Ye=class extends ae{_parse(e){return this._getType(e)===z.undefined?Fe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ye.create=(r,e)=>new Ye({innerType:r,typeName:ee.ZodOptional,...oe(e)});var ht=class extends ae{_parse(e){return this._getType(e)===z.null?Fe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ht.create=(r,e)=>new ht({innerType:r,typeName:ee.ZodNullable,...oe(e)});var nr=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),s=t.data;return t.parsedType===z.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};nr.create=(r,e)=>new nr({innerType:r,typeName:ee.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...oe(e)});var ir=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return ys(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ke(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Ke(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};ir.create=(r,e)=>new ir({innerType:r,typeName:ee.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...oe(e)});var Rr=class extends ae{_parse(e){if(this._getType(e)!==z.nan){let s=this._getOrReturnCtx(e);return Q(s,{code:q.invalid_type,expected:z.nan,received:s.parsedType}),te}return{status:"valid",value:e.data}}};Rr.create=r=>new Rr({typeName:ee.ZodNaN,...oe(r)});var Sd=Symbol("zod_brand"),bs=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}},vs=class r extends ae{_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?te:i.status==="dirty"?(t.dirty(),Ar(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?te:n.status==="dirty"?(t.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,t){return new r({in:e,out:t,typeName:ee.ZodPipeline})}},or=class extends ae{_parse(e){let t=this._def.innerType._parse(e),s=n=>(zt(n)&&(n.value=Object.freeze(n.value)),n);return ys(t)?t.then(n=>s(n)):s(t)}unwrap(){return this._def.innerType}};or.create=(r,e)=>new or({innerType:r,typeName:ee.ZodReadonly,...oe(e)});function zu(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function Xu(r,e={},t){return r?Mt.create().superRefine((s,n)=>{var i,o;let a=r(s);if(a instanceof Promise)return a.then(c=>{var d,h;if(!c){let p=zu(e,s),b=(h=(d=p.fatal)!==null&&d!==void 0?d:t)!==null&&h!==void 0?h:!0;n.addIssue({code:"custom",...p,fatal:b})}});if(!a){let c=zu(e,s),d=(o=(i=c.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0;n.addIssue({code:"custom",...c,fatal:d})}}):Mt.create()}var xd={object:We.lazycreate},ee;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(ee||(ee={}));var Ed=(r,e={message:`Input not instance of ${r.name}`})=>Xu(t=>t instanceof r,e),ec=Rt.create,tc=Wt.create,Td=Rr.create,Cd=Kt.create,rc=Gt.create,Nd=Zt.create,Ad=kr.create,Pd=Ht.create,kd=Jt.create,Id=Mt.create,Od=xt.create,Ld=ot.create,Rd=Ir.create,Md=Et.create,Bd=We.create,Dd=We.strictCreate,$d=Yt.create,qd=yn.create,jd=Xt.create,Fd=ct.create,Ud=bn.create,Qd=Or.create,Vd=Lr.create,zd=vn.create,Wd=er.create,Kd=tr.create,Gd=rr.create,Zd=sr.create,Hd=Bt.create,Wu=Ge.create,Jd=Ye.create,Yd=ht.create,Xd=Ge.createWithPreprocess,ep=vs.create,tp=()=>ec().optional(),rp=()=>tc().optional(),sp=()=>rc().optional(),np={string:r=>Rt.create({...r,coerce:!0}),number:r=>Wt.create({...r,coerce:!0}),boolean:r=>Gt.create({...r,coerce:!0}),bigint:r=>Kt.create({...r,coerce:!0}),date:r=>Zt.create({...r,coerce:!0})},ip=te,Ee=Object.freeze({__proto__:null,defaultErrorMap:Pr,setErrorMap:Xf,getErrorMap:pn,makeIssue:mn,EMPTY_PATH:ed,addIssueToContext:Q,ParseStatus:qe,INVALID:te,DIRTY:Ar,OK:Fe,isAborted:Qo,isDirty:Vo,isValid:zt,isAsync:ys,get util(){return he},get objectUtil(){return Uo},ZodParsedType:z,getParsedType:St,ZodType:ae,datetimeRegex:Ju,ZodString:Rt,ZodNumber:Wt,ZodBigInt:Kt,ZodBoolean:Gt,ZodDate:Zt,ZodSymbol:kr,ZodUndefined:Ht,ZodNull:Jt,ZodAny:Mt,ZodUnknown:xt,ZodNever:ot,ZodVoid:Ir,ZodArray:Et,ZodObject:We,ZodUnion:Yt,ZodDiscriminatedUnion:yn,ZodIntersection:Xt,ZodTuple:ct,ZodRecord:bn,ZodMap:Or,ZodSet:Lr,ZodFunction:vn,ZodLazy:er,ZodLiteral:tr,ZodEnum:rr,ZodNativeEnum:sr,ZodPromise:Bt,ZodEffects:Ge,ZodTransformer:Ge,ZodOptional:Ye,ZodNullable:ht,ZodDefault:nr,ZodCatch:ir,ZodNaN:Rr,BRAND:Sd,ZodBranded:bs,ZodPipeline:vs,ZodReadonly:or,custom:Xu,Schema:ae,ZodSchema:ae,late:xd,get ZodFirstPartyTypeKind(){return ee},coerce:np,any:Id,array:Md,bigint:Cd,boolean:rc,date:Nd,discriminatedUnion:qd,effect:Wu,enum:Gd,function:zd,instanceof:Ed,intersection:jd,lazy:Wd,literal:Kd,map:Qd,nan:Td,nativeEnum:Zd,never:Ld,null:kd,nullable:Yd,number:tc,object:Bd,oboolean:sp,onumber:rp,optional:Jd,ostring:tp,pipeline:ep,preprocess:Xd,promise:Hd,record:Ud,set:Vd,strictObject:Dd,string:ec,symbol:Ad,transformer:Wu,tuple:Fd,undefined:Pd,union:$d,unknown:Od,void:Rd,NEVER:ip,ZodIssueCode:q,quotelessJson:Yf,ZodError:Ke});var Se={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function Te(r,e){return e.includes(r.columnType)}function op(r){return"enumValues"in r&&Array.isArray(r.enumValues)&&r.enumValues.length>0}var ap=Ee.union([Ee.string(),Ee.number(),Ee.boolean(),Ee.null()]),lp=Ee.union([ap,Ee.record(Ee.any()),Ee.array(Ee.any())]),up=Ee.custom(r=>r instanceof Buffer);function sc(r,e){let t=e?.zodInstance??Ee,s=e?.coerce??{},n;return op(r)&&(n=r.enumValues.length?t.enum(r.enumValues):t.string()),n||(Te(r,["PgGeometry","PgPointTuple"])?n=t.tuple([t.number(),t.number()]):Te(r,["PgGeometryObject","PgPointObject"])?n=t.object({x:t.number(),y:t.number()}):Te(r,["PgHalfVector","PgVector"])?(n=t.array(t.number()),n=r.dimensions?n.length(r.dimensions):n):Te(r,["PgLine"])?n=t.tuple([t.number(),t.number(),t.number()]):Te(r,["PgLineABC"])?n=t.object({a:t.number(),b:t.number(),c:t.number()}):Te(r,["PgArray"])?(n=t.array(sc(r.baseColumn,t)),n=r.size?n.length(r.size):n):r.dataType==="array"?n=t.array(t.any()):r.dataType==="number"?n=cp(r,t,s):r.dataType==="bigint"?n=hp(r,t,s):r.dataType==="boolean"?n=s===!0||s.boolean?t.coerce.boolean():t.boolean():r.dataType==="date"?n=s===!0||s.date?t.coerce.date():t.date():r.dataType==="string"?n=fp(r,t,s):r.dataType==="json"?n=lp:r.dataType==="custom"?n=t.any():r.dataType==="buffer"&&(n=up)),n||(n=t.any()),n}function cp(r,e,t){let s=r.getSQLType().includes("unsigned"),n,i,o=!1;Te(r,["MySqlTinyInt","SingleStoreTinyInt"])?(n=s?0:Se.INT8_MIN,i=s?Se.INT8_UNSIGNED_MAX:Se.INT8_MAX,o=!0):Te(r,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(n=s?0:Se.INT16_MIN,i=s?Se.INT16_UNSIGNED_MAX:Se.INT16_MAX,o=!0):Te(r,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(n=s?0:Se.INT24_MIN,i=s?Se.INT24_UNSIGNED_MAX:Se.INT24_MAX,o=Te(r,["MySqlMediumInt","SingleStoreMediumInt"])):Te(r,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(n=s?0:Se.INT32_MIN,i=s?Se.INT32_UNSIGNED_MAX:Se.INT32_MAX,o=!0):Te(r,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(n=s?0:Se.INT48_MIN,i=s?Se.INT48_UNSIGNED_MAX:Se.INT48_MAX):Te(r,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(s=s||Te(r,["MySqlSerial","SingleStoreSerial"]),n=s?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=!0):Te(r,["MySqlYear","SingleStoreYear"])?(n=1901,i=2155,o=!0):(n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let a=t===!0||t?.number?e.coerce.number():e.number();return a=a.min(n).max(i),o?a.int():a}function hp(r,e,t){let s=r.getSQLType().includes("unsigned"),n=s?0n:Se.INT64_MIN,i=s?Se.INT64_UNSIGNED_MAX:Se.INT64_MAX;return(t===!0||t?.bigint?e.coerce.bigint():e.bigint()).min(n).max(i)}function fp(r,e,t){if(Te(r,["PgUUID"]))return e.string().uuid();let s,n,i=!1;Te(r,["PgVarchar","SQLiteText"])?s=r.length:Te(r,["MySqlVarChar","SingleStoreVarChar"])?s=r.length??Se.INT16_UNSIGNED_MAX:Te(r,["MySqlText","SingleStoreText"])&&(r.textType==="longtext"?s=Se.INT32_UNSIGNED_MAX:r.textType==="mediumtext"?s=Se.INT24_UNSIGNED_MAX:r.textType==="text"?s=Se.INT16_UNSIGNED_MAX:s=Se.INT8_UNSIGNED_MAX),Te(r,["PgChar","MySqlChar","SingleStoreChar"])&&(s=r.length,i=!0),Te(r,["PgBinaryVector"])&&(n=/^[01]+$/,s=r.dimensions);let o=t===!0||t?.string?e.coerce.string():e.string();return o=n?o.regex(n):o,s&&i?o.length(s):s?o.max(s):o}function nc(r){return fi(r)?Gs(r):jl(r)}function ic(r,e,t,s){let n={};for(let[i,o]of Object.entries(r)){if(!D(o,de)&&!D(o,G)&&!D(o,G.Aliased)&&typeof o=="object"){let p=fi(o)||Bl(o)?nc(o):o;n[i]=ic(p,e[i]??{},t,s);continue}let a=e[i];if(a!==void 0&&typeof a!="function"){n[i]=a;continue}let c=D(o,de)?o:void 0,d=c?sc(c,s):Ee.any(),h=typeof a=="function"?a(d):d;t.never(c)||(n[i]=h,c&&(t.nullable(c)&&(n[i]=n[i].nullable()),t.optional(c)&&(n[i]=n[i].optional())))}return Ee.object(n)}var dp={never:r=>r?.generated?.type==="always"||r?.generatedIdentity?.type==="always",optional:r=>!r.notNull||r.notNull&&r.hasDefault,nullable:r=>!r.notNull};var Mr=(r,e)=>{let t=nc(r);return ic(t,e??{},dp)};var pp=wr("users",{id:It("id").primaryKey(),username:ie("username").notNull().unique(),password:ie("password").notNull()}),_s=wr("franchises",{id:It("id").primaryKey(),name:ie("name").notNull(),description:ie("description"),category:ie("category").notNull(),country:ie("country").notNull(),state:ie("state"),investmentRange:ie("investment_range"),imageUrl:ie("image_url"),contactEmail:ie("contact_email"),investmentMin:kt("investment_min"),investmentMax:kt("investment_max"),isActive:_r("is_active").default(!0),createdAt:Vt("created_at").defaultNow()}),mp=wr("businesses",{id:It("id").primaryKey(),name:ie("name").notNull(),description:ie("description"),category:ie("category").notNull(),country:ie("country").notNull(),state:ie("state"),price:kt("price"),imageUrl:ie("image_url"),contactEmail:ie("contact_email"),package:ie("package"),yearEstablished:ie("year_established"),employees:ie("employees"),revenue:ie("revenue"),reason:ie("reason"),assets:ie("assets"),status:ie("status").default("pending"),paymentStatus:ie("payment_status").default("unpaid"),isActive:_r("is_active").default(!1),createdAt:Vt("created_at").defaultNow()}),gp=wr("advertisements",{id:It("id").primaryKey(),title:ie("title").notNull(),description:ie("description"),imageUrl:ie("image_url").notNull(),targetUrl:ie("target_url"),package:ie("package"),company:ie("company"),contactEmail:ie("contact_email"),contactPhone:ie("contact_phone"),budget:ie("budget"),status:ie("status").default("pending"),paymentStatus:ie("payment_status").default("unpaid"),isActive:_r("is_active").default(!1),createdAt:Vt("created_at").defaultNow()}),yp=wr("inquiries",{id:It("id").primaryKey(),name:ie("name").notNull(),email:ie("email").notNull(),phone:ie("phone"),subject:ie("subject").notNull(),message:ie("message").notNull(),franchiseId:kt("franchise_id"),businessId:kt("business_id"),status:ie("status").default("pending"),createdAt:Vt("created_at").defaultNow()}),$S=Mr(pp).pick({username:!0,password:!0}),qS=Ee.object({username:Ee.string().min(1),password:Ee.string().min(6)}),jS=Ee.object({username:Ee.string().min(1),password:Ee.string().min(6)}),FS=Mr(_s).omit({id:!0,createdAt:!0}),US=Mr(mp).omit({id:!0,createdAt:!0}),QS=Mr(gp).omit({id:!0,createdAt:!0}),VS=Mr(yp).omit({id:!0,createdAt:!0});var zm=Vr(uc(),1),Wm=Vr(fa(),1),Km=Vr(ma(),1),Oh=Vr(Sa(),1),Gm=Vr(Ih(),1);var Lh=Oh.default;gt.fetchConnectionCache=!0;gt.webSocketConstructor=Lh;var Mh=new yt({connectionString:"postgresql://neondb_owner:npg_0CpHBlm2zqaF@ep-nameless-feather-a4dga2p7-pooler.us-east-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require",max:1}),Rh=dn(Mh),Zm=async r=>{let e={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Content-Type","Access-Control-Allow-Methods":"GET, POST, PATCH, OPTIONS","Content-Type":"application/json"};if(r.httpMethod==="OPTIONS")return{statusCode:200,headers:e};try{if(r.httpMethod==="GET"){let t=r.queryStringParameters||{},{category:s,country:n,state:i,priceRange:o}=t,a=r.path.includes("/admin/franchises"),c=a?"SELECT * FROM franchises":"SELECT * FROM franchises WHERE is_active = true",d=[],h=[];if(s&&typeof s=="string"&&(d.push(`category = $${h.length+1}`),h.push(s)),n&&typeof n=="string"&&(d.push(`country = $${h.length+1}`),h.push(n)),i&&typeof i=="string"&&(d.push(`state = $${h.length+1}`),h.push(i)),o&&typeof o=="string"){let[b,_]=o.split("-").map(Number);b&&!isNaN(b)&&(d.push(`investment_min >= $${h.length+1}`),h.push(b)),_&&!isNaN(_)&&(d.push(`investment_max <= $${h.length+1}`),h.push(_))}d.length>0&&(c+=(a?" WHERE ":" AND ")+d.join(" AND "));let p=await Mh.query(c,h);return{statusCode:200,headers:e,body:JSON.stringify(p.rows)}}if(r.httpMethod==="POST"){let t=JSON.parse(r.body||"{}"),s=await Rh.insert(_s).values(t).returning();return{statusCode:201,headers:e,body:JSON.stringify(s[0])}}if(r.httpMethod==="PATCH"){let t=r.path.split("/"),s=parseInt(t[t.length-2]);if(t[t.length-1]==="status"){let{isActive:i}=JSON.parse(r.body||"{}");if(typeof i!="boolean")return{statusCode:400,headers:e,body:JSON.stringify({error:"isActive must be a boolean value"})};let o=await Rh.update(_s).set({isActive:i}).where(Sr(_s.id,s)).returning();return o.length===0?{statusCode:404,headers:e,body:JSON.stringify({error:"Franchise not found"})}:{statusCode:200,headers:e,body:JSON.stringify(o[0])}}}return{statusCode:405,headers:e,body:JSON.stringify({error:"Method not allowed"})}}catch(t){return console.error("Error:",t),{statusCode:500,headers:e,body:JSON.stringify({error:"Internal server error"})}}};0&&(module.exports={handler});
/*! Bundled license information:

@neondatabase/serverless/index.mjs:
  (*! Bundled license information:
  
  ieee754/index.js:
    (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  
  buffer/index.js:
    (*!
     * The buffer module from node.js, for the browser.
     *
     * @author   Feross Aboukhadijeh <https://feross.org>
     * @license  MIT
     *)
  *)
*/
