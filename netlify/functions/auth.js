"use strict";var zg=Object.create;var Os=Object.defineProperty;var Wg=Object.getOwnPropertyDescriptor;var Gg=Object.getOwnPropertyNames;var Kg=Object.getPrototypeOf,Hg=Object.prototype.hasOwnProperty;var j=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Zg=(r,e)=>{for(var t in e)Os(r,t,{get:e[t],enumerable:!0})},Ju=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Gg(e))!Hg.call(r,s)&&s!==t&&Os(r,s,{get:()=>e[s],enumerable:!(n=Wg(e,s))||n.enumerable});return r};var hr=(r,e,t)=>(t=r!=null?zg(Kg(r)):{},Ju(e||!r||!r.__esModule?Os(t,"default",{value:r,enumerable:!0}):t,r)),Xg=r=>Ju(Os({},"__esModule",{value:!0}),r);var hn=j((Ic,Fh)=>{var vi=require("buffer"),Ot=vi.Buffer;function jh(r,e){for(var t in r)e[t]=r[t]}Ot.from&&Ot.alloc&&Ot.allocUnsafe&&Ot.allocUnsafeSlow?Fh.exports=vi:(jh(vi,Ic),Ic.Buffer=kr);function kr(r,e,t){return Ot(r,e,t)}kr.prototype=Object.create(Ot.prototype);jh(Ot,kr);kr.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return Ot(r,e,t)};kr.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=Ot(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};kr.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Ot(r)};kr.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return vi.SlowBuffer(r)}});var Oc=j((wA,Uh)=>{var wi=hn().Buffer,Mx=require("stream"),qx=require("util");function _i(r){if(this.buffer=null,this.writable=!0,this.readable=!0,!r)return this.buffer=wi.alloc(0),this;if(typeof r.pipe=="function")return this.buffer=wi.alloc(0),r.pipe(this),this;if(r.length||typeof r=="object")return this.buffer=r,this.writable=!1,process.nextTick(function(){this.emit("end",r),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof r+")")}qx.inherits(_i,Mx);_i.prototype.write=function(e){this.buffer=wi.concat([this.buffer,wi.from(e)]),this.emit("data",e)};_i.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};Uh.exports=_i});var Vh=j((_A,Qh)=>{"use strict";function Pc(r){var e=(r/8|0)+(r%8===0?0:1);return e}var Dx={ES256:Pc(256),ES384:Pc(384),ES512:Pc(521)};function jx(r){var e=Dx[r];if(e)return e;throw new Error('Unknown algorithm "'+r+'"')}Qh.exports=jx});var Xh=j((SA,Zh)=>{"use strict";var Si=hn().Buffer,Wh=Vh(),Ei=128,Gh=0,Fx=32,Ux=16,Qx=2,Kh=Ux|Fx|Gh<<6,Ti=Qx|Gh<<6;function Vx(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Hh(r){if(Si.isBuffer(r))return r;if(typeof r=="string")return Si.from(r,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function zx(r,e){r=Hh(r);var t=Wh(e),n=t+1,s=r.length,i=0;if(r[i++]!==Kh)throw new Error('Could not find expected "seq"');var o=r[i++];if(o===(Ei|1)&&(o=r[i++]),s-i<o)throw new Error('"seq" specified length of "'+o+'", only "'+(s-i)+'" remaining');if(r[i++]!==Ti)throw new Error('Could not find expected "int" for "r"');var a=r[i++];if(s-i-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(s-i-2)+'" available');if(n<a)throw new Error('"r" specified length of "'+a+'", max of "'+n+'" is acceptable');var u=i;if(i+=a,r[i++]!==Ti)throw new Error('Could not find expected "int" for "s"');var h=r[i++];if(s-i!==h)throw new Error('"s" specified length of "'+h+'", expected "'+(s-i)+'"');if(n<h)throw new Error('"s" specified length of "'+h+'", max of "'+n+'" is acceptable');var l=i;if(i+=h,i!==s)throw new Error('Expected to consume entire buffer, but "'+(s-i)+'" bytes remain');var d=t-a,g=t-h,x=Si.allocUnsafe(d+a+g+h);for(i=0;i<d;++i)x[i]=0;r.copy(x,i,u+Math.max(-d,0),u+a),i=t;for(var m=i;i<m+g;++i)x[i]=0;return r.copy(x,i,l+Math.max(-g,0),l+h),x=x.toString("base64"),x=Vx(x),x}function zh(r,e,t){for(var n=0;e+n<t&&r[e+n]===0;)++n;var s=r[e+n]>=Ei;return s&&--n,n}function Wx(r,e){r=Hh(r);var t=Wh(e),n=r.length;if(n!==t*2)throw new TypeError('"'+e+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var s=zh(r,0,t),i=zh(r,t,r.length),o=t-s,a=t-i,u=2+o+1+1+a,h=u<Ei,l=Si.allocUnsafe((h?2:3)+u),d=0;return l[d++]=Kh,h?l[d++]=u:(l[d++]=Ei|1,l[d++]=u&255),l[d++]=Ti,l[d++]=o,s<0?(l[d++]=0,d+=r.copy(l,d,0,t)):d+=r.copy(l,d,s,t),l[d++]=Ti,l[d++]=a,i<0?(l[d++]=0,r.copy(l,d,t)):r.copy(l,d,t+i),l}Zh.exports={derToJose:zx,joseToDer:Wx}});var Yh=j((EA,Jh)=>{"use strict";var as=require("buffer").Buffer,Rc=require("buffer").SlowBuffer;Jh.exports=Ci;function Ci(r,e){if(!as.isBuffer(r)||!as.isBuffer(e)||r.length!==e.length)return!1;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}Ci.install=function(){as.prototype.equal=Rc.prototype.equal=function(e){return Ci(this,e)}};var Gx=as.prototype.equal,Kx=Rc.prototype.equal;Ci.restore=function(){as.prototype.equal=Gx,Rc.prototype.equal=Kx}});var Bc=j((TA,cd)=>{var pn=hn().Buffer,ft=require("crypto"),td=Xh(),ed=require("util"),Hx=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,cs="secret must be a string or buffer",dn="key must be a string or a buffer",Zx="key must be a string, a buffer or an object",kc=typeof ft.createPublicKey=="function";kc&&(dn+=" or a KeyObject",cs+="or a KeyObject");function rd(r){if(!pn.isBuffer(r)&&typeof r!="string"&&(!kc||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw St(dn)}function nd(r){if(!pn.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw St(Zx)}function Xx(r){if(!pn.isBuffer(r)){if(typeof r=="string")return r;if(!kc||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw St(cs)}}function $c(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function sd(r){r=r.toString();var e=4-r.length%4;if(e!==4)for(var t=0;t<e;++t)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function St(r){var e=[].slice.call(arguments,1),t=ed.format.bind(ed,r).apply(null,e);return new TypeError(t)}function Jx(r){return pn.isBuffer(r)||typeof r=="string"}function us(r){return Jx(r)||(r=JSON.stringify(r)),r}function id(r){return function(t,n){Xx(n),t=us(t);var s=ft.createHmac("sha"+r,n),i=(s.update(t),s.digest("base64"));return $c(i)}}var Lc,Yx="timingSafeEqual"in ft?function(e,t){return e.byteLength!==t.byteLength?!1:ft.timingSafeEqual(e,t)}:function(e,t){return Lc||(Lc=Yh()),Lc(e,t)};function e1(r){return function(t,n,s){var i=id(r)(t,s);return Yx(pn.from(n),pn.from(i))}}function od(r){return function(t,n){nd(n),t=us(t);var s=ft.createSign("RSA-SHA"+r),i=(s.update(t),s.sign(n,"base64"));return $c(i)}}function ad(r){return function(t,n,s){rd(s),t=us(t),n=sd(n);var i=ft.createVerify("RSA-SHA"+r);return i.update(t),i.verify(s,n,"base64")}}function t1(r){return function(t,n){nd(n),t=us(t);var s=ft.createSign("RSA-SHA"+r),i=(s.update(t),s.sign({key:n,padding:ft.constants.RSA_PKCS1_PSS_PADDING,saltLength:ft.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return $c(i)}}function r1(r){return function(t,n,s){rd(s),t=us(t),n=sd(n);var i=ft.createVerify("RSA-SHA"+r);return i.update(t),i.verify({key:s,padding:ft.constants.RSA_PKCS1_PSS_PADDING,saltLength:ft.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function n1(r){var e=od(r);return function(){var n=e.apply(null,arguments);return n=td.derToJose(n,"ES"+r),n}}function s1(r){var e=ad(r);return function(n,s,i){s=td.joseToDer(s,"ES"+r).toString("base64");var o=e(n,s,i);return o}}function i1(){return function(){return""}}function o1(){return function(e,t){return t===""}}cd.exports=function(e){var t={hs:id,rs:od,ps:t1,es:n1,none:i1},n={hs:e1,rs:ad,ps:r1,es:s1,none:o1},s=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!s)throw St(Hx,e);var i=(s[1]||s[3]).toLowerCase(),o=s[2];return{sign:t[i](o),verify:n[i](o)}}});var Mc=j((CA,ud)=>{var a1=require("buffer").Buffer;ud.exports=function(e){return typeof e=="string"?e:typeof e=="number"||a1.isBuffer(e)?e.toString():JSON.stringify(e)}});var md=j((NA,pd)=>{var c1=hn().Buffer,ld=Oc(),u1=Bc(),l1=require("stream"),fd=Mc(),qc=require("util");function hd(r,e){return c1.from(r,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f1(r,e,t){t=t||"utf8";var n=hd(fd(r),"binary"),s=hd(fd(e),t);return qc.format("%s.%s",n,s)}function dd(r){var e=r.header,t=r.payload,n=r.secret||r.privateKey,s=r.encoding,i=u1(e.alg),o=f1(e,t,s),a=i.sign(o,n);return qc.format("%s.%s",o,a)}function Ni(r){var e=r.secret||r.privateKey||r.key,t=new ld(e);this.readable=!0,this.header=r.header,this.encoding=r.encoding,this.secret=this.privateKey=this.key=t,this.payload=new ld(r.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}qc.inherits(Ni,l1);Ni.prototype.sign=function(){try{var e=dd({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};Ni.sign=dd;pd.exports=Ni});var Td=j((AA,Ed)=>{var yd=hn().Buffer,gd=Oc(),h1=Bc(),d1=require("stream"),bd=Mc(),p1=require("util"),m1=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function g1(r){return Object.prototype.toString.call(r)==="[object Object]"}function y1(r){if(g1(r))return r;try{return JSON.parse(r)}catch{return}}function xd(r){var e=r.split(".",1)[0];return y1(yd.from(e,"base64").toString("binary"))}function b1(r){return r.split(".",2).join(".")}function vd(r){return r.split(".")[2]}function x1(r,e){e=e||"utf8";var t=r.split(".")[1];return yd.from(t,"base64").toString(e)}function wd(r){return m1.test(r)&&!!xd(r)}function _d(r,e,t){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}r=bd(r);var s=vd(r),i=b1(r),o=h1(e);return o.verify(i,s,t)}function Sd(r,e){if(e=e||{},r=bd(r),!wd(r))return null;var t=xd(r);if(!t)return null;var n=x1(r);return(t.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:t,payload:n,signature:vd(r)}}function mn(r){r=r||{};var e=r.secret||r.publicKey||r.key,t=new gd(e);this.readable=!0,this.algorithm=r.algorithm,this.encoding=r.encoding,this.secret=this.publicKey=this.key=t,this.signature=new gd(r.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}p1.inherits(mn,d1);mn.prototype.verify=function(){try{var e=_d(this.signature.buffer,this.algorithm,this.key.buffer),t=Sd(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};mn.decode=Sd;mn.isValid=wd;mn.verify=_d;Ed.exports=mn});var Ii=j(or=>{var Cd=md(),Ai=Td(),v1=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];or.ALGORITHMS=v1;or.sign=Cd.sign;or.verify=Ai.verify;or.decode=Ai.decode;or.isValid=Ai.isValid;or.createSign=function(e){return new Cd(e)};or.createVerify=function(e){return new Ai(e)}});var Dc=j((OA,Nd)=>{var w1=Ii();Nd.exports=function(r,e){e=e||{};var t=w1.decode(r,e);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var s=JSON.parse(n);s!==null&&typeof s=="object"&&(n=s)}catch{}return e.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var ls=j((PA,Ad)=>{var Oi=function(r,e){Error.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=r,e&&(this.inner=e)};Oi.prototype=Object.create(Error.prototype);Oi.prototype.constructor=Oi;Ad.exports=Oi});var jc=j((RA,Od)=>{var Id=ls(),Pi=function(r,e){Id.call(this,r),this.name="NotBeforeError",this.date=e};Pi.prototype=Object.create(Id.prototype);Pi.prototype.constructor=Pi;Od.exports=Pi});var Fc=j((LA,Rd)=>{var Pd=ls(),Ri=function(r,e){Pd.call(this,r),this.name="TokenExpiredError",this.expiredAt=e};Ri.prototype=Object.create(Pd.prototype);Ri.prototype.constructor=Ri;Rd.exports=Ri});var kd=j((kA,Ld)=>{var gn=1e3,yn=gn*60,bn=yn*60,$r=bn*24,_1=$r*7,S1=$r*365.25;Ld.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return E1(r);if(t==="number"&&isFinite(r))return e.long?C1(r):T1(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function E1(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*S1;case"weeks":case"week":case"w":return t*_1;case"days":case"day":case"d":return t*$r;case"hours":case"hour":case"hrs":case"hr":case"h":return t*bn;case"minutes":case"minute":case"mins":case"min":case"m":return t*yn;case"seconds":case"second":case"secs":case"sec":case"s":return t*gn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function T1(r){var e=Math.abs(r);return e>=$r?Math.round(r/$r)+"d":e>=bn?Math.round(r/bn)+"h":e>=yn?Math.round(r/yn)+"m":e>=gn?Math.round(r/gn)+"s":r+"ms"}function C1(r){var e=Math.abs(r);return e>=$r?Li(r,e,$r,"day"):e>=bn?Li(r,e,bn,"hour"):e>=yn?Li(r,e,yn,"minute"):e>=gn?Li(r,e,gn,"second"):r+" ms"}function Li(r,e,t,n){var s=e>=t*1.5;return Math.round(r/t)+" "+n+(s?"s":"")}});var Uc=j(($A,$d)=>{var N1=kd();$d.exports=function(r,e){var t=e||Math.floor(Date.now()/1e3);if(typeof r=="string"){var n=N1(r);return typeof n>"u"?void 0:Math.floor(t+n/1e3)}else return typeof r=="number"?t+r:void 0}});var fs=j((BA,Bd)=>{"use strict";var A1="2.0.0",I1=Number.MAX_SAFE_INTEGER||9007199254740991,O1=16,P1=250,R1=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Bd.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:O1,MAX_SAFE_BUILD_LENGTH:P1,MAX_SAFE_INTEGER:I1,RELEASE_TYPES:R1,SEMVER_SPEC_VERSION:A1,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var hs=j((MA,Md)=>{"use strict";var L1=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};Md.exports=L1});var xn=j((Pt,qd)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Qc,MAX_SAFE_BUILD_LENGTH:k1,MAX_LENGTH:$1}=fs(),B1=hs();Pt=qd.exports={};var M1=Pt.re=[],q1=Pt.safeRe=[],K=Pt.src=[],D1=Pt.safeSrc=[],H=Pt.t={},j1=0,Vc="[a-zA-Z0-9-]",F1=[["\\s",1],["\\d",$1],[Vc,k1]],U1=r=>{for(let[e,t]of F1)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},ue=(r,e,t)=>{let n=U1(e),s=j1++;B1(r,s,e),H[r]=s,K[s]=e,D1[s]=n,M1[s]=new RegExp(e,t?"g":void 0),q1[s]=new RegExp(n,t?"g":void 0)};ue("NUMERICIDENTIFIER","0|[1-9]\\d*");ue("NUMERICIDENTIFIERLOOSE","\\d+");ue("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Vc}*`);ue("MAINVERSION",`(${K[H.NUMERICIDENTIFIER]})\\.(${K[H.NUMERICIDENTIFIER]})\\.(${K[H.NUMERICIDENTIFIER]})`);ue("MAINVERSIONLOOSE",`(${K[H.NUMERICIDENTIFIERLOOSE]})\\.(${K[H.NUMERICIDENTIFIERLOOSE]})\\.(${K[H.NUMERICIDENTIFIERLOOSE]})`);ue("PRERELEASEIDENTIFIER",`(?:${K[H.NONNUMERICIDENTIFIER]}|${K[H.NUMERICIDENTIFIER]})`);ue("PRERELEASEIDENTIFIERLOOSE",`(?:${K[H.NONNUMERICIDENTIFIER]}|${K[H.NUMERICIDENTIFIERLOOSE]})`);ue("PRERELEASE",`(?:-(${K[H.PRERELEASEIDENTIFIER]}(?:\\.${K[H.PRERELEASEIDENTIFIER]})*))`);ue("PRERELEASELOOSE",`(?:-?(${K[H.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${K[H.PRERELEASEIDENTIFIERLOOSE]})*))`);ue("BUILDIDENTIFIER",`${Vc}+`);ue("BUILD",`(?:\\+(${K[H.BUILDIDENTIFIER]}(?:\\.${K[H.BUILDIDENTIFIER]})*))`);ue("FULLPLAIN",`v?${K[H.MAINVERSION]}${K[H.PRERELEASE]}?${K[H.BUILD]}?`);ue("FULL",`^${K[H.FULLPLAIN]}$`);ue("LOOSEPLAIN",`[v=\\s]*${K[H.MAINVERSIONLOOSE]}${K[H.PRERELEASELOOSE]}?${K[H.BUILD]}?`);ue("LOOSE",`^${K[H.LOOSEPLAIN]}$`);ue("GTLT","((?:<|>)?=?)");ue("XRANGEIDENTIFIERLOOSE",`${K[H.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ue("XRANGEIDENTIFIER",`${K[H.NUMERICIDENTIFIER]}|x|X|\\*`);ue("XRANGEPLAIN",`[v=\\s]*(${K[H.XRANGEIDENTIFIER]})(?:\\.(${K[H.XRANGEIDENTIFIER]})(?:\\.(${K[H.XRANGEIDENTIFIER]})(?:${K[H.PRERELEASE]})?${K[H.BUILD]}?)?)?`);ue("XRANGEPLAINLOOSE",`[v=\\s]*(${K[H.XRANGEIDENTIFIERLOOSE]})(?:\\.(${K[H.XRANGEIDENTIFIERLOOSE]})(?:\\.(${K[H.XRANGEIDENTIFIERLOOSE]})(?:${K[H.PRERELEASELOOSE]})?${K[H.BUILD]}?)?)?`);ue("XRANGE",`^${K[H.GTLT]}\\s*${K[H.XRANGEPLAIN]}$`);ue("XRANGELOOSE",`^${K[H.GTLT]}\\s*${K[H.XRANGEPLAINLOOSE]}$`);ue("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Qc}})(?:\\.(\\d{1,${Qc}}))?(?:\\.(\\d{1,${Qc}}))?`);ue("COERCE",`${K[H.COERCEPLAIN]}(?:$|[^\\d])`);ue("COERCEFULL",K[H.COERCEPLAIN]+`(?:${K[H.PRERELEASE]})?(?:${K[H.BUILD]})?(?:$|[^\\d])`);ue("COERCERTL",K[H.COERCE],!0);ue("COERCERTLFULL",K[H.COERCEFULL],!0);ue("LONETILDE","(?:~>?)");ue("TILDETRIM",`(\\s*)${K[H.LONETILDE]}\\s+`,!0);Pt.tildeTrimReplace="$1~";ue("TILDE",`^${K[H.LONETILDE]}${K[H.XRANGEPLAIN]}$`);ue("TILDELOOSE",`^${K[H.LONETILDE]}${K[H.XRANGEPLAINLOOSE]}$`);ue("LONECARET","(?:\\^)");ue("CARETTRIM",`(\\s*)${K[H.LONECARET]}\\s+`,!0);Pt.caretTrimReplace="$1^";ue("CARET",`^${K[H.LONECARET]}${K[H.XRANGEPLAIN]}$`);ue("CARETLOOSE",`^${K[H.LONECARET]}${K[H.XRANGEPLAINLOOSE]}$`);ue("COMPARATORLOOSE",`^${K[H.GTLT]}\\s*(${K[H.LOOSEPLAIN]})$|^$`);ue("COMPARATOR",`^${K[H.GTLT]}\\s*(${K[H.FULLPLAIN]})$|^$`);ue("COMPARATORTRIM",`(\\s*)${K[H.GTLT]}\\s*(${K[H.LOOSEPLAIN]}|${K[H.XRANGEPLAIN]})`,!0);Pt.comparatorTrimReplace="$1$2$3";ue("HYPHENRANGE",`^\\s*(${K[H.XRANGEPLAIN]})\\s+-\\s+(${K[H.XRANGEPLAIN]})\\s*$`);ue("HYPHENRANGELOOSE",`^\\s*(${K[H.XRANGEPLAINLOOSE]})\\s+-\\s+(${K[H.XRANGEPLAINLOOSE]})\\s*$`);ue("STAR","(<|>)?=?\\s*\\*");ue("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");ue("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var ki=j((qA,Dd)=>{"use strict";var Q1=Object.freeze({loose:!0}),V1=Object.freeze({}),z1=r=>r?typeof r!="object"?Q1:r:V1;Dd.exports=z1});var zc=j((DA,Ud)=>{"use strict";var jd=/^[0-9]+$/,Fd=(r,e)=>{let t=jd.test(r),n=jd.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},W1=(r,e)=>Fd(e,r);Ud.exports={compareIdentifiers:Fd,rcompareIdentifiers:W1}});var ze=j((jA,Vd)=>{"use strict";var $i=hs(),{MAX_LENGTH:Qd,MAX_SAFE_INTEGER:Bi}=fs(),{safeRe:Mi,t:qi}=xn(),G1=ki(),{compareIdentifiers:vn}=zc(),Wc=class r{constructor(e,t){if(t=G1(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Qd)throw new TypeError(`version is longer than ${Qd} characters`);$i("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?Mi[qi.LOOSE]:Mi[qi.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Bi||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Bi||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Bi||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let i=+s;if(i>=0&&i<Bi)return i}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if($i("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),vn(this.major,e.major)||vn(this.minor,e.minor)||vn(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],s=e.prerelease[t];if($i("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return vn(n,s)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],s=e.build[t];if($i("build compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return vn(n,s)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let s=`-${t}`.match(this.options.loose?Mi[qi.PRERELEASELOOSE]:Mi[qi.PRERELEASE]);if(!s||s[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let s=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(t){let i=[t,s];n===!1&&(i=[t]),vn(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Vd.exports=Wc});var Br=j((FA,Wd)=>{"use strict";var zd=ze(),K1=(r,e,t=!1)=>{if(r instanceof zd)return r;try{return new zd(r,e)}catch(n){if(!t)return null;throw n}};Wd.exports=K1});var Kd=j((UA,Gd)=>{"use strict";var H1=Br(),Z1=(r,e)=>{let t=H1(r,e);return t?t.version:null};Gd.exports=Z1});var Zd=j((QA,Hd)=>{"use strict";var X1=Br(),J1=(r,e)=>{let t=X1(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};Hd.exports=J1});var Yd=j((VA,Jd)=>{"use strict";var Xd=ze(),Y1=(r,e,t,n,s)=>{typeof t=="string"&&(s=n,n=t,t=void 0);try{return new Xd(r instanceof Xd?r.version:r,t).inc(e,n,s).version}catch{return null}};Jd.exports=Y1});var rp=j((zA,tp)=>{"use strict";var ep=Br(),ev=(r,e)=>{let t=ep(r,null,!0),n=ep(e,null,!0),s=t.compare(n);if(s===0)return null;let i=s>0,o=i?t:n,a=i?n:t,u=!!o.prerelease.length;if(!!a.prerelease.length&&!u){if(!a.patch&&!a.minor)return"major";if(a.compareMain(o)===0)return a.minor&&!a.patch?"minor":"patch"}let l=u?"pre":"";return t.major!==n.major?l+"major":t.minor!==n.minor?l+"minor":t.patch!==n.patch?l+"patch":"prerelease"};tp.exports=ev});var sp=j((WA,np)=>{"use strict";var tv=ze(),rv=(r,e)=>new tv(r,e).major;np.exports=rv});var op=j((GA,ip)=>{"use strict";var nv=ze(),sv=(r,e)=>new nv(r,e).minor;ip.exports=sv});var cp=j((KA,ap)=>{"use strict";var iv=ze(),ov=(r,e)=>new iv(r,e).patch;ap.exports=ov});var lp=j((HA,up)=>{"use strict";var av=Br(),cv=(r,e)=>{let t=av(r,e);return t&&t.prerelease.length?t.prerelease:null};up.exports=cv});var ht=j((ZA,hp)=>{"use strict";var fp=ze(),uv=(r,e,t)=>new fp(r,t).compare(new fp(e,t));hp.exports=uv});var pp=j((XA,dp)=>{"use strict";var lv=ht(),fv=(r,e,t)=>lv(e,r,t);dp.exports=fv});var gp=j((JA,mp)=>{"use strict";var hv=ht(),dv=(r,e)=>hv(r,e,!0);mp.exports=dv});var Di=j((YA,bp)=>{"use strict";var yp=ze(),pv=(r,e,t)=>{let n=new yp(r,t),s=new yp(e,t);return n.compare(s)||n.compareBuild(s)};bp.exports=pv});var vp=j((eI,xp)=>{"use strict";var mv=Di(),gv=(r,e)=>r.sort((t,n)=>mv(t,n,e));xp.exports=gv});var _p=j((tI,wp)=>{"use strict";var yv=Di(),bv=(r,e)=>r.sort((t,n)=>yv(n,t,e));wp.exports=bv});var ds=j((rI,Sp)=>{"use strict";var xv=ht(),vv=(r,e,t)=>xv(r,e,t)>0;Sp.exports=vv});var ji=j((nI,Ep)=>{"use strict";var wv=ht(),_v=(r,e,t)=>wv(r,e,t)<0;Ep.exports=_v});var Gc=j((sI,Tp)=>{"use strict";var Sv=ht(),Ev=(r,e,t)=>Sv(r,e,t)===0;Tp.exports=Ev});var Kc=j((iI,Cp)=>{"use strict";var Tv=ht(),Cv=(r,e,t)=>Tv(r,e,t)!==0;Cp.exports=Cv});var Fi=j((oI,Np)=>{"use strict";var Nv=ht(),Av=(r,e,t)=>Nv(r,e,t)>=0;Np.exports=Av});var Ui=j((aI,Ap)=>{"use strict";var Iv=ht(),Ov=(r,e,t)=>Iv(r,e,t)<=0;Ap.exports=Ov});var Hc=j((cI,Ip)=>{"use strict";var Pv=Gc(),Rv=Kc(),Lv=ds(),kv=Fi(),$v=ji(),Bv=Ui(),Mv=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return Pv(r,t,n);case"!=":return Rv(r,t,n);case">":return Lv(r,t,n);case">=":return kv(r,t,n);case"<":return $v(r,t,n);case"<=":return Bv(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Ip.exports=Mv});var Pp=j((uI,Op)=>{"use strict";var qv=ze(),Dv=Br(),{safeRe:Qi,t:Vi}=xn(),jv=(r,e)=>{if(r instanceof qv)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?Qi[Vi.COERCEFULL]:Qi[Vi.COERCE]);else{let u=e.includePrerelease?Qi[Vi.COERCERTLFULL]:Qi[Vi.COERCERTL],h;for(;(h=u.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||h.index+h[0].length!==t.index+t[0].length)&&(t=h),u.lastIndex=h.index+h[1].length+h[2].length;u.lastIndex=-1}if(t===null)return null;let n=t[2],s=t[3]||"0",i=t[4]||"0",o=e.includePrerelease&&t[5]?`-${t[5]}`:"",a=e.includePrerelease&&t[6]?`+${t[6]}`:"";return Dv(`${n}.${s}.${i}${o}${a}`,e)};Op.exports=jv});var Lp=j((lI,Rp)=>{"use strict";var Zc=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let s=this.map.keys().next().value;this.delete(s)}this.map.set(e,t)}return this}};Rp.exports=Zc});var dt=j((fI,Mp)=>{"use strict";var Fv=/\s+/g,Xc=class r{constructor(e,t){if(t=Qv(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof Jc)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(Fv," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(s=>!$p(s[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let s of this.set)if(s.length===1&&Zv(s[0])){this.set=[s];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&Kv)|(this.options.loose&&Hv))+":"+e,s=kp.get(n);if(s)return s;let i=this.options.loose,o=i?rt[He.HYPHENRANGELOOSE]:rt[He.HYPHENRANGE];e=e.replace(o,ow(this.options.includePrerelease)),Te("hyphen replace",e),e=e.replace(rt[He.COMPARATORTRIM],zv),Te("comparator trim",e),e=e.replace(rt[He.TILDETRIM],Wv),Te("tilde trim",e),e=e.replace(rt[He.CARETTRIM],Gv),Te("caret trim",e);let a=e.split(" ").map(d=>Xv(d,this.options)).join(" ").split(/\s+/).map(d=>iw(d,this.options));i&&(a=a.filter(d=>(Te("loose invalid filter",d,this.options),!!d.match(rt[He.COMPARATORLOOSE])))),Te("range list",a);let u=new Map,h=a.map(d=>new Jc(d,this.options));for(let d of h){if($p(d))return[d];u.set(d.value,d)}u.size>1&&u.has("")&&u.delete("");let l=[...u.values()];return kp.set(n,l),l}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>Bp(n,t)&&e.set.some(s=>Bp(s,t)&&n.every(i=>s.every(o=>i.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Vv(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(aw(this.set[t],e,this.options))return!0;return!1}};Mp.exports=Xc;var Uv=Lp(),kp=new Uv,Qv=ki(),Jc=ps(),Te=hs(),Vv=ze(),{safeRe:rt,t:He,comparatorTrimReplace:zv,tildeTrimReplace:Wv,caretTrimReplace:Gv}=xn(),{FLAG_INCLUDE_PRERELEASE:Kv,FLAG_LOOSE:Hv}=fs(),$p=r=>r.value==="<0.0.0-0",Zv=r=>r.value==="",Bp=(r,e)=>{let t=!0,n=r.slice(),s=n.pop();for(;t&&n.length;)t=n.every(i=>s.intersects(i,e)),s=n.pop();return t},Xv=(r,e)=>(Te("comp",r,e),r=ew(r,e),Te("caret",r),r=Jv(r,e),Te("tildes",r),r=rw(r,e),Te("xrange",r),r=sw(r,e),Te("stars",r),r),Ze=r=>!r||r.toLowerCase()==="x"||r==="*",Jv=(r,e)=>r.trim().split(/\s+/).map(t=>Yv(t,e)).join(" "),Yv=(r,e)=>{let t=e.loose?rt[He.TILDELOOSE]:rt[He.TILDE];return r.replace(t,(n,s,i,o,a)=>{Te("tilde",r,n,s,i,o,a);let u;return Ze(s)?u="":Ze(i)?u=`>=${s}.0.0 <${+s+1}.0.0-0`:Ze(o)?u=`>=${s}.${i}.0 <${s}.${+i+1}.0-0`:a?(Te("replaceTilde pr",a),u=`>=${s}.${i}.${o}-${a} <${s}.${+i+1}.0-0`):u=`>=${s}.${i}.${o} <${s}.${+i+1}.0-0`,Te("tilde return",u),u})},ew=(r,e)=>r.trim().split(/\s+/).map(t=>tw(t,e)).join(" "),tw=(r,e)=>{Te("caret",r,e);let t=e.loose?rt[He.CARETLOOSE]:rt[He.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(s,i,o,a,u)=>{Te("caret",r,s,i,o,a,u);let h;return Ze(i)?h="":Ze(o)?h=`>=${i}.0.0${n} <${+i+1}.0.0-0`:Ze(a)?i==="0"?h=`>=${i}.${o}.0${n} <${i}.${+o+1}.0-0`:h=`>=${i}.${o}.0${n} <${+i+1}.0.0-0`:u?(Te("replaceCaret pr",u),i==="0"?o==="0"?h=`>=${i}.${o}.${a}-${u} <${i}.${o}.${+a+1}-0`:h=`>=${i}.${o}.${a}-${u} <${i}.${+o+1}.0-0`:h=`>=${i}.${o}.${a}-${u} <${+i+1}.0.0-0`):(Te("no pr"),i==="0"?o==="0"?h=`>=${i}.${o}.${a}${n} <${i}.${o}.${+a+1}-0`:h=`>=${i}.${o}.${a}${n} <${i}.${+o+1}.0-0`:h=`>=${i}.${o}.${a} <${+i+1}.0.0-0`),Te("caret return",h),h})},rw=(r,e)=>(Te("replaceXRanges",r,e),r.split(/\s+/).map(t=>nw(t,e)).join(" ")),nw=(r,e)=>{r=r.trim();let t=e.loose?rt[He.XRANGELOOSE]:rt[He.XRANGE];return r.replace(t,(n,s,i,o,a,u)=>{Te("xRange",r,n,s,i,o,a,u);let h=Ze(i),l=h||Ze(o),d=l||Ze(a),g=d;return s==="="&&g&&(s=""),u=e.includePrerelease?"-0":"",h?s===">"||s==="<"?n="<0.0.0-0":n="*":s&&g?(l&&(o=0),a=0,s===">"?(s=">=",l?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):s==="<="&&(s="<",l?i=+i+1:o=+o+1),s==="<"&&(u="-0"),n=`${s+i}.${o}.${a}${u}`):l?n=`>=${i}.0.0${u} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${o}.0${u} <${i}.${+o+1}.0-0`),Te("xRange return",n),n})},sw=(r,e)=>(Te("replaceStars",r,e),r.trim().replace(rt[He.STAR],"")),iw=(r,e)=>(Te("replaceGTE0",r,e),r.trim().replace(rt[e.includePrerelease?He.GTE0PRE:He.GTE0],"")),ow=r=>(e,t,n,s,i,o,a,u,h,l,d,g)=>(Ze(n)?t="":Ze(s)?t=`>=${n}.0.0${r?"-0":""}`:Ze(i)?t=`>=${n}.${s}.0${r?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,Ze(h)?u="":Ze(l)?u=`<${+h+1}.0.0-0`:Ze(d)?u=`<${h}.${+l+1}.0-0`:g?u=`<=${h}.${l}.${d}-${g}`:r?u=`<${h}.${l}.${+d+1}-0`:u=`<=${u}`,`${t} ${u}`.trim()),aw=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(Te(r[n].semver),r[n].semver!==Jc.ANY&&r[n].semver.prerelease.length>0){let s=r[n].semver;if(s.major===e.major&&s.minor===e.minor&&s.patch===e.patch)return!0}return!1}return!0}});var ps=j((hI,Qp)=>{"use strict";var ms=Symbol("SemVer ANY"),tu=class r{static get ANY(){return ms}constructor(e,t){if(t=qp(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),eu("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ms?this.value="":this.value=this.operator+this.semver.version,eu("comp",this)}parse(e){let t=this.options.loose?Dp[jp.COMPARATORLOOSE]:Dp[jp.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Fp(n[2],this.options.loose):this.semver=ms}toString(){return this.value}test(e){if(eu("Comparator.test",e,this.options.loose),this.semver===ms||e===ms)return!0;if(typeof e=="string")try{e=new Fp(e,this.options)}catch{return!1}return Yc(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Up(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new Up(this.value,t).test(e.semver):(t=qp(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Yc(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Yc(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Qp.exports=tu;var qp=ki(),{safeRe:Dp,t:jp}=xn(),Yc=Hc(),eu=hs(),Fp=ze(),Up=dt()});var gs=j((dI,Vp)=>{"use strict";var cw=dt(),uw=(r,e,t)=>{try{e=new cw(e,t)}catch{return!1}return e.test(r)};Vp.exports=uw});var Wp=j((pI,zp)=>{"use strict";var lw=dt(),fw=(r,e)=>new lw(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));zp.exports=fw});var Kp=j((mI,Gp)=>{"use strict";var hw=ze(),dw=dt(),pw=(r,e,t)=>{let n=null,s=null,i=null;try{i=new dw(e,t)}catch{return null}return r.forEach(o=>{i.test(o)&&(!n||s.compare(o)===-1)&&(n=o,s=new hw(n,t))}),n};Gp.exports=pw});var Zp=j((gI,Hp)=>{"use strict";var mw=ze(),gw=dt(),yw=(r,e,t)=>{let n=null,s=null,i=null;try{i=new gw(e,t)}catch{return null}return r.forEach(o=>{i.test(o)&&(!n||s.compare(o)===1)&&(n=o,s=new mw(n,t))}),n};Hp.exports=yw});var Yp=j((yI,Jp)=>{"use strict";var ru=ze(),bw=dt(),Xp=ds(),xw=(r,e)=>{r=new bw(r,e);let t=new ru("0.0.0");if(r.test(t)||(t=new ru("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){let s=r.set[n],i=null;s.forEach(o=>{let a=new ru(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||Xp(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!t||Xp(t,i))&&(t=i)}return t&&r.test(t)?t:null};Jp.exports=xw});var tm=j((bI,em)=>{"use strict";var vw=dt(),ww=(r,e)=>{try{return new vw(r,e).range||"*"}catch{return null}};em.exports=ww});var zi=j((xI,im)=>{"use strict";var _w=ze(),sm=ps(),{ANY:Sw}=sm,Ew=dt(),Tw=gs(),rm=ds(),nm=ji(),Cw=Ui(),Nw=Fi(),Aw=(r,e,t,n)=>{r=new _w(r,n),e=new Ew(e,n);let s,i,o,a,u;switch(t){case">":s=rm,i=Cw,o=nm,a=">",u=">=";break;case"<":s=nm,i=Nw,o=rm,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Tw(r,e,n))return!1;for(let h=0;h<e.set.length;++h){let l=e.set[h],d=null,g=null;if(l.forEach(x=>{x.semver===Sw&&(x=new sm(">=0.0.0")),d=d||x,g=g||x,s(x.semver,d.semver,n)?d=x:o(x.semver,g.semver,n)&&(g=x)}),d.operator===a||d.operator===u||(!g.operator||g.operator===a)&&i(r,g.semver))return!1;if(g.operator===u&&o(r,g.semver))return!1}return!0};im.exports=Aw});var am=j((vI,om)=>{"use strict";var Iw=zi(),Ow=(r,e,t)=>Iw(r,e,">",t);om.exports=Ow});var um=j((wI,cm)=>{"use strict";var Pw=zi(),Rw=(r,e,t)=>Pw(r,e,"<",t);cm.exports=Rw});var hm=j((_I,fm)=>{"use strict";var lm=dt(),Lw=(r,e,t)=>(r=new lm(r,t),e=new lm(e,t),r.intersects(e,t));fm.exports=Lw});var pm=j((SI,dm)=>{"use strict";var kw=gs(),$w=ht();dm.exports=(r,e,t)=>{let n=[],s=null,i=null,o=r.sort((l,d)=>$w(l,d,t));for(let l of o)kw(l,e,t)?(i=l,s||(s=l)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);let a=[];for(let[l,d]of n)l===d?a.push(l):!d&&l===o[0]?a.push("*"):d?l===o[0]?a.push(`<=${d}`):a.push(`${l} - ${d}`):a.push(`>=${l}`);let u=a.join(" || "),h=typeof e.raw=="string"?e.raw:String(e);return u.length<h.length?u:e}});var vm=j((EI,xm)=>{"use strict";var mm=dt(),su=ps(),{ANY:nu}=su,ys=gs(),iu=ht(),Bw=(r,e,t={})=>{if(r===e)return!0;r=new mm(r,t),e=new mm(e,t);let n=!1;e:for(let s of r.set){for(let i of e.set){let o=qw(s,i,t);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},Mw=[new su(">=0.0.0-0")],gm=[new su(">=0.0.0")],qw=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===nu){if(e.length===1&&e[0].semver===nu)return!0;t.includePrerelease?r=Mw:r=gm}if(e.length===1&&e[0].semver===nu){if(t.includePrerelease)return!0;e=gm}let n=new Set,s,i;for(let x of r)x.operator===">"||x.operator===">="?s=ym(s,x,t):x.operator==="<"||x.operator==="<="?i=bm(i,x,t):n.add(x.semver);if(n.size>1)return null;let o;if(s&&i){if(o=iu(s.semver,i.semver,t),o>0)return null;if(o===0&&(s.operator!==">="||i.operator!=="<="))return null}for(let x of n){if(s&&!ys(x,String(s),t)||i&&!ys(x,String(i),t))return null;for(let m of e)if(!ys(x,String(m),t))return!1;return!0}let a,u,h,l,d=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,g=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let x of e){if(l=l||x.operator===">"||x.operator===">=",h=h||x.operator==="<"||x.operator==="<=",s){if(g&&x.semver.prerelease&&x.semver.prerelease.length&&x.semver.major===g.major&&x.semver.minor===g.minor&&x.semver.patch===g.patch&&(g=!1),x.operator===">"||x.operator===">="){if(a=ym(s,x,t),a===x&&a!==s)return!1}else if(s.operator===">="&&!ys(s.semver,String(x),t))return!1}if(i){if(d&&x.semver.prerelease&&x.semver.prerelease.length&&x.semver.major===d.major&&x.semver.minor===d.minor&&x.semver.patch===d.patch&&(d=!1),x.operator==="<"||x.operator==="<="){if(u=bm(i,x,t),u===x&&u!==i)return!1}else if(i.operator==="<="&&!ys(i.semver,String(x),t))return!1}if(!x.operator&&(i||s)&&o!==0)return!1}return!(s&&h&&!i&&o!==0||i&&l&&!s&&o!==0||g||d)},ym=(r,e,t)=>{if(!r)return e;let n=iu(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},bm=(r,e,t)=>{if(!r)return e;let n=iu(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};xm.exports=Bw});var Wi=j((TI,Sm)=>{"use strict";var ou=xn(),wm=fs(),Dw=ze(),_m=zc(),jw=Br(),Fw=Kd(),Uw=Zd(),Qw=Yd(),Vw=rp(),zw=sp(),Ww=op(),Gw=cp(),Kw=lp(),Hw=ht(),Zw=pp(),Xw=gp(),Jw=Di(),Yw=vp(),e_=_p(),t_=ds(),r_=ji(),n_=Gc(),s_=Kc(),i_=Fi(),o_=Ui(),a_=Hc(),c_=Pp(),u_=ps(),l_=dt(),f_=gs(),h_=Wp(),d_=Kp(),p_=Zp(),m_=Yp(),g_=tm(),y_=zi(),b_=am(),x_=um(),v_=hm(),w_=pm(),__=vm();Sm.exports={parse:jw,valid:Fw,clean:Uw,inc:Qw,diff:Vw,major:zw,minor:Ww,patch:Gw,prerelease:Kw,compare:Hw,rcompare:Zw,compareLoose:Xw,compareBuild:Jw,sort:Yw,rsort:e_,gt:t_,lt:r_,eq:n_,neq:s_,gte:i_,lte:o_,cmp:a_,coerce:c_,Comparator:u_,Range:l_,satisfies:f_,toComparators:h_,maxSatisfying:d_,minSatisfying:p_,minVersion:m_,validRange:g_,outside:y_,gtr:b_,ltr:x_,intersects:v_,simplifyRange:w_,subset:__,SemVer:Dw,re:ou.re,src:ou.src,tokens:ou.t,SEMVER_SPEC_VERSION:wm.SEMVER_SPEC_VERSION,RELEASE_TYPES:wm.RELEASE_TYPES,compareIdentifiers:_m.compareIdentifiers,rcompareIdentifiers:_m.rcompareIdentifiers}});var Tm=j((CI,Em)=>{var S_=Wi();Em.exports=S_.satisfies(process.version,">=15.7.0")});var Nm=j((NI,Cm)=>{var E_=Wi();Cm.exports=E_.satisfies(process.version,">=16.9.0")});var au=j((AI,Am)=>{var T_=Tm(),C_=Nm(),N_={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},A_={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};Am.exports=function(r,e){if(!r||!e)return;let t=e.asymmetricKeyType;if(!t)return;let n=N_[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(r))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(T_)switch(t){case"ec":let s=e.asymmetricKeyDetails.namedCurve,i=A_[r];if(s!==i)throw new Error(`"alg" parameter "${r}" requires curve "${i}".`);break;case"rsa-pss":if(C_){let o=parseInt(r.slice(-3),10),{hashAlgorithm:a,mgf1HashAlgorithm:u,saltLength:h}=e.asymmetricKeyDetails;if(a!==`sha${o}`||u!==a)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${r}.`);if(h!==void 0&&h>o>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${r}.`)}break}}});var cu=j((II,Im)=>{var I_=Wi();Im.exports=I_.satisfies(process.version,"^6.12.0 || >=8.0.0")});var Rm=j((OI,Pm)=>{var Ee=ls(),O_=jc(),Om=Fc(),P_=Dc(),R_=Uc(),L_=au(),k_=cu(),$_=Ii(),{KeyObject:B_,createSecretKey:M_,createPublicKey:q_}=require("crypto"),uu=["RS256","RS384","RS512"],D_=["ES256","ES384","ES512"],lu=["RS256","RS384","RS512"],j_=["HS256","HS384","HS512"];k_&&(uu.splice(uu.length,0,"PS256","PS384","PS512"),lu.splice(lu.length,0,"PS256","PS384","PS512"));Pm.exports=function(r,e,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let s;if(n?s=n:s=function(l,d){if(l)throw l;return d},t.clockTimestamp&&typeof t.clockTimestamp!="number")return s(new Ee("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return s(new Ee("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return s(new Ee("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!r)return s(new Ee("jwt must be provided"));if(typeof r!="string")return s(new Ee("jwt must be a string"));let o=r.split(".");if(o.length!==3)return s(new Ee("jwt malformed"));let a;try{a=P_(r,{complete:!0})}catch(l){return s(l)}if(!a)return s(new Ee("invalid token"));let u=a.header,h;if(typeof e=="function"){if(!n)return s(new Ee("verify must be called asynchronous if secret or public key is provided as a callback"));h=e}else h=function(l,d){return d(null,e)};return h(u,function(l,d){if(l)return s(new Ee("error in secret or public key callback: "+l.message));let g=o[2].trim()!=="";if(!g&&d)return s(new Ee("jwt signature is required"));if(g&&!d)return s(new Ee("secret or public key must be provided"));if(!g&&!t.algorithms)return s(new Ee('please specify "none" in "algorithms" to verify unsigned tokens'));if(d!=null&&!(d instanceof B_))try{d=q_(d)}catch{try{d=M_(typeof d=="string"?Buffer.from(d):d)}catch{return s(new Ee("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(d.type==="secret"?t.algorithms=j_:["rsa","rsa-pss"].includes(d.asymmetricKeyType)?t.algorithms=lu:d.asymmetricKeyType==="ec"?t.algorithms=D_:t.algorithms=uu),t.algorithms.indexOf(a.header.alg)===-1)return s(new Ee("invalid algorithm"));if(u.alg.startsWith("HS")&&d.type!=="secret")return s(new Ee(`secretOrPublicKey must be a symmetric key when using ${u.alg}`));if(/^(?:RS|PS|ES)/.test(u.alg)&&d.type!=="public")return s(new Ee(`secretOrPublicKey must be an asymmetric key when using ${u.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{L_(u.alg,d)}catch(f){return s(f)}let x;try{x=$_.verify(r,a.header.alg,d)}catch(f){return s(f)}if(!x)return s(new Ee("invalid signature"));let m=a.payload;if(typeof m.nbf<"u"&&!t.ignoreNotBefore){if(typeof m.nbf!="number")return s(new Ee("invalid nbf value"));if(m.nbf>i+(t.clockTolerance||0))return s(new O_("jwt not active",new Date(m.nbf*1e3)))}if(typeof m.exp<"u"&&!t.ignoreExpiration){if(typeof m.exp!="number")return s(new Ee("invalid exp value"));if(i>=m.exp+(t.clockTolerance||0))return s(new Om("jwt expired",new Date(m.exp*1e3)))}if(t.audience){let f=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(m.aud)?m.aud:[m.aud]).some(function(_){return f.some(function(E){return E instanceof RegExp?E.test(_):E===_})}))return s(new Ee("jwt audience invalid. expected: "+f.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&m.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(m.iss)===-1))return s(new Ee("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&m.sub!==t.subject)return s(new Ee("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&m.jti!==t.jwtid)return s(new Ee("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&m.nonce!==t.nonce)return s(new Ee("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof m.iat!="number")return s(new Ee("iat required when maxAge is specified"));let f=R_(t.maxAge,m.iat);if(typeof f>"u")return s(new Ee('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=f+(t.clockTolerance||0))return s(new Om("maxAge exceeded",new Date(f*1e3)))}if(t.complete===!0){let f=a.signature;return s(null,{header:u,payload:m,signature:f})}return s(null,m)})}});var qm=j((PI,Mm)=>{var Lm=1/0,$m=9007199254740991,F_=17976931348623157e292,km=NaN,U_="[object Arguments]",Q_="[object Function]",V_="[object GeneratorFunction]",z_="[object String]",W_="[object Symbol]",G_=/^\s+|\s+$/g,K_=/^[-+]0x[0-9a-f]+$/i,H_=/^0b[01]+$/i,Z_=/^0o[0-7]+$/i,X_=/^(?:0|[1-9]\d*)$/,J_=parseInt;function Y_(r,e){for(var t=-1,n=r?r.length:0,s=Array(n);++t<n;)s[t]=e(r[t],t,r);return s}function eS(r,e,t,n){for(var s=r.length,i=t+(n?1:-1);n?i--:++i<s;)if(e(r[i],i,r))return i;return-1}function tS(r,e,t){if(e!==e)return eS(r,rS,t);for(var n=t-1,s=r.length;++n<s;)if(r[n]===e)return n;return-1}function rS(r){return r!==r}function nS(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}function sS(r,e){return Y_(e,function(t){return r[t]})}function iS(r,e){return function(t){return r(e(t))}}var Gi=Object.prototype,hu=Gi.hasOwnProperty,Ki=Gi.toString,oS=Gi.propertyIsEnumerable,aS=iS(Object.keys,Object),cS=Math.max;function uS(r,e){var t=Bm(r)||pS(r)?nS(r.length,String):[],n=t.length,s=!!n;for(var i in r)(e||hu.call(r,i))&&!(s&&(i=="length"||fS(i,n)))&&t.push(i);return t}function lS(r){if(!hS(r))return aS(r);var e=[];for(var t in Object(r))hu.call(r,t)&&t!="constructor"&&e.push(t);return e}function fS(r,e){return e=e??$m,!!e&&(typeof r=="number"||X_.test(r))&&r>-1&&r%1==0&&r<e}function hS(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||Gi;return r===t}function dS(r,e,t,n){r=du(r)?r:ES(r),t=t&&!n?wS(t):0;var s=r.length;return t<0&&(t=cS(s+t,0)),bS(r)?t<=s&&r.indexOf(e,t)>-1:!!s&&tS(r,e,t)>-1}function pS(r){return mS(r)&&hu.call(r,"callee")&&(!oS.call(r,"callee")||Ki.call(r)==U_)}var Bm=Array.isArray;function du(r){return r!=null&&yS(r.length)&&!gS(r)}function mS(r){return pu(r)&&du(r)}function gS(r){var e=fu(r)?Ki.call(r):"";return e==Q_||e==V_}function yS(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=$m}function fu(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function pu(r){return!!r&&typeof r=="object"}function bS(r){return typeof r=="string"||!Bm(r)&&pu(r)&&Ki.call(r)==z_}function xS(r){return typeof r=="symbol"||pu(r)&&Ki.call(r)==W_}function vS(r){if(!r)return r===0?r:0;if(r=_S(r),r===Lm||r===-Lm){var e=r<0?-1:1;return e*F_}return r===r?r:0}function wS(r){var e=vS(r),t=e%1;return e===e?t?e-t:e:0}function _S(r){if(typeof r=="number")return r;if(xS(r))return km;if(fu(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=fu(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(G_,"");var t=H_.test(r);return t||Z_.test(r)?J_(r.slice(2),t?2:8):K_.test(r)?km:+r}function SS(r){return du(r)?uS(r):lS(r)}function ES(r){return r?sS(r,SS(r)):[]}Mm.exports=dS});var jm=j((RI,Dm)=>{var TS="[object Boolean]",CS=Object.prototype,NS=CS.toString;function AS(r){return r===!0||r===!1||IS(r)&&NS.call(r)==TS}function IS(r){return!!r&&typeof r=="object"}Dm.exports=AS});var zm=j((LI,Vm)=>{var Fm=1/0,OS=17976931348623157e292,Um=NaN,PS="[object Symbol]",RS=/^\s+|\s+$/g,LS=/^[-+]0x[0-9a-f]+$/i,kS=/^0b[01]+$/i,$S=/^0o[0-7]+$/i,BS=parseInt,MS=Object.prototype,qS=MS.toString;function DS(r){return typeof r=="number"&&r==QS(r)}function Qm(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function jS(r){return!!r&&typeof r=="object"}function FS(r){return typeof r=="symbol"||jS(r)&&qS.call(r)==PS}function US(r){if(!r)return r===0?r:0;if(r=VS(r),r===Fm||r===-Fm){var e=r<0?-1:1;return e*OS}return r===r?r:0}function QS(r){var e=US(r),t=e%1;return e===e?t?e-t:e:0}function VS(r){if(typeof r=="number")return r;if(FS(r))return Um;if(Qm(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Qm(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(RS,"");var t=kS.test(r);return t||$S.test(r)?BS(r.slice(2),t?2:8):LS.test(r)?Um:+r}Vm.exports=DS});var Gm=j((kI,Wm)=>{var zS="[object Number]",WS=Object.prototype,GS=WS.toString;function KS(r){return!!r&&typeof r=="object"}function HS(r){return typeof r=="number"||KS(r)&&GS.call(r)==zS}Wm.exports=HS});var Xm=j(($I,Zm)=>{var ZS="[object Object]";function XS(r){var e=!1;if(r!=null&&typeof r.toString!="function")try{e=!!(r+"")}catch{}return e}function JS(r,e){return function(t){return r(e(t))}}var YS=Function.prototype,Km=Object.prototype,Hm=YS.toString,e2=Km.hasOwnProperty,t2=Hm.call(Object),r2=Km.toString,n2=JS(Object.getPrototypeOf,Object);function s2(r){return!!r&&typeof r=="object"}function i2(r){if(!s2(r)||r2.call(r)!=ZS||XS(r))return!1;var e=n2(r);if(e===null)return!0;var t=e2.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Hm.call(t)==t2}Zm.exports=i2});var Ym=j((BI,Jm)=>{var o2="[object String]",a2=Object.prototype,c2=a2.toString,u2=Array.isArray;function l2(r){return!!r&&typeof r=="object"}function f2(r){return typeof r=="string"||!u2(r)&&l2(r)&&c2.call(r)==o2}Jm.exports=f2});var s0=j((MI,n0)=>{var h2="Expected a function",e0=1/0,d2=17976931348623157e292,t0=NaN,p2="[object Symbol]",m2=/^\s+|\s+$/g,g2=/^[-+]0x[0-9a-f]+$/i,y2=/^0b[01]+$/i,b2=/^0o[0-7]+$/i,x2=parseInt,v2=Object.prototype,w2=v2.toString;function _2(r,e){var t;if(typeof e!="function")throw new TypeError(h2);return r=N2(r),function(){return--r>0&&(t=e.apply(this,arguments)),r<=1&&(e=void 0),t}}function S2(r){return _2(2,r)}function r0(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function E2(r){return!!r&&typeof r=="object"}function T2(r){return typeof r=="symbol"||E2(r)&&w2.call(r)==p2}function C2(r){if(!r)return r===0?r:0;if(r=A2(r),r===e0||r===-e0){var e=r<0?-1:1;return e*d2}return r===r?r:0}function N2(r){var e=C2(r),t=e%1;return e===e?t?e-t:e:0}function A2(r){if(typeof r=="number")return r;if(T2(r))return t0;if(r0(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=r0(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(m2,"");var t=y2.test(r);return t||b2.test(r)?x2(r.slice(2),t?2:8):g2.test(r)?t0:+r}n0.exports=S2});var d0=j((qI,h0)=>{var i0=Uc(),I2=cu(),O2=au(),o0=Ii(),P2=qm(),Hi=jm(),a0=zm(),mu=Gm(),u0=Xm(),ar=Ym(),R2=s0(),{KeyObject:L2,createSecretKey:k2,createPrivateKey:$2}=require("crypto"),l0=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];I2&&l0.splice(3,0,"PS256","PS384","PS512");var B2={expiresIn:{isValid:function(r){return a0(r)||ar(r)&&r},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(r){return a0(r)||ar(r)&&r},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(r){return ar(r)||Array.isArray(r)},message:'"audience" must be a string or array'},algorithm:{isValid:P2.bind(null,l0),message:'"algorithm" must be a valid string enum value'},header:{isValid:u0,message:'"header" must be an object'},encoding:{isValid:ar,message:'"encoding" must be a string'},issuer:{isValid:ar,message:'"issuer" must be a string'},subject:{isValid:ar,message:'"subject" must be a string'},jwtid:{isValid:ar,message:'"jwtid" must be a string'},noTimestamp:{isValid:Hi,message:'"noTimestamp" must be a boolean'},keyid:{isValid:ar,message:'"keyid" must be a string'},mutatePayload:{isValid:Hi,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Hi,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Hi,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},M2={iat:{isValid:mu,message:'"iat" should be a number of seconds'},exp:{isValid:mu,message:'"exp" should be a number of seconds'},nbf:{isValid:mu,message:'"nbf" should be a number of seconds'}};function f0(r,e,t,n){if(!u0(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(s){let i=r[s];if(!i){if(!e)throw new Error('"'+s+'" is not allowed in "'+n+'"');return}if(!i.isValid(t[s]))throw new Error(i.message)})}function q2(r){return f0(B2,!1,r,"options")}function D2(r){return f0(M2,!0,r,"payload")}var c0={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},j2=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];h0.exports=function(r,e,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let s=typeof r=="object"&&!Buffer.isBuffer(r),i=Object.assign({alg:t.algorithm||"HS256",typ:s?"JWT":void 0,kid:t.keyid},t.header);function o(h){if(n)return n(h);throw h}if(!e&&t.algorithm!=="none")return o(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof L2))try{e=$2(e)}catch{try{e=k2(typeof e=="string"?Buffer.from(e):e)}catch{return o(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return o(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return o(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!t.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return o(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof r>"u")return o(new Error("payload is required"));if(s){try{D2(r)}catch(h){return o(h)}t.mutatePayload||(r=Object.assign({},r))}else{let h=j2.filter(function(l){return typeof t[l]<"u"});if(h.length>0)return o(new Error("invalid "+h.join(",")+" option for "+typeof r+" payload"))}if(typeof r.exp<"u"&&typeof t.expiresIn<"u")return o(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof r.nbf<"u"&&typeof t.notBefore<"u")return o(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{q2(t)}catch(h){return o(h)}if(!t.allowInvalidAsymmetricKeyTypes)try{O2(i.alg,e)}catch(h){return o(h)}let a=r.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete r.iat:s&&(r.iat=a),typeof t.notBefore<"u"){try{r.nbf=i0(t.notBefore,a)}catch(h){return o(h)}if(typeof r.nbf>"u")return o(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn<"u"&&typeof r=="object"){try{r.exp=i0(t.expiresIn,a)}catch(h){return o(h)}if(typeof r.exp>"u")return o(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(c0).forEach(function(h){let l=c0[h];if(typeof t[h]<"u"){if(typeof r[l]<"u")return o(new Error('Bad "options.'+h+'" option. The payload already has an "'+l+'" property.'));r[l]=t[h]}});let u=t.encoding||"utf8";if(typeof n=="function")n=n&&R2(n),o0.createSign({header:i,privateKey:e,payload:r,encoding:u}).once("error",n).once("done",function(h){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&h.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,h)});else{let h=o0.sign({header:i,payload:r,secret:e,encoding:u});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&h.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return h}}});var m0=j((DI,p0)=>{p0.exports={decode:Dc(),verify:Rm(),sign:d0(),JsonWebTokenError:ls(),NotBeforeError:jc(),TokenExpiredError:Fc()}});var x0=j((jI,b0)=>{"use strict";var{Duplex:F2}=require("stream");function g0(r){r.emit("close")}function U2(){!this.destroyed&&this._writableState.finished&&this.destroy()}function y0(r){this.removeListener("error",y0),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function Q2(r,e){let t=!0,n=new F2({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return r.on("message",function(i,o){let a=!o&&n._readableState.objectMode?i.toString():i;n.push(a)||r.pause()}),r.once("error",function(i){n.destroyed||(t=!1,n.destroy(i))}),r.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(s,i){if(r.readyState===r.CLOSED){i(s),process.nextTick(g0,n);return}let o=!1;r.once("error",function(u){o=!0,i(u)}),r.once("close",function(){o||i(s),process.nextTick(g0,n)}),t&&r.terminate()},n._final=function(s){if(r.readyState===r.CONNECTING){r.once("open",function(){n._final(s)});return}r._socket!==null&&(r._socket._writableState.finished?(s(),n._readableState.endEmitted&&n.destroy()):(r._socket.once("finish",function(){s()}),r.close()))},n._read=function(){r.isPaused&&r.resume()},n._write=function(s,i,o){if(r.readyState===r.CONNECTING){r.once("open",function(){n._write(s,i,o)});return}r.send(s,o)},n.on("end",U2),n.on("error",y0),n}b0.exports=Q2});var Wt=j((FI,_0)=>{"use strict";var v0=["nodebuffer","arraybuffer","fragments"],w0=typeof Blob<"u";w0&&v0.push("blob");_0.exports={BINARY_TYPES:v0,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:w0,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var q0=j((UI,M0)=>{var C0=require("fs"),Gt=require("path"),N0=require("os"),A0=typeof __webpack_require__=="function"?__non_webpack_require__:require,V2=process.config&&process.config.variables||{},z2=!!process.env.PREBUILDS_ONLY,S0=process.versions.modules,gu=K2()?"electron":G2()?"node-webkit":"node",yu=process.env.npm_config_arch||N0.arch(),bu=process.env.npm_config_platform||N0.platform(),I0=process.env.LIBC||(H2(bu)?"musl":"glibc"),xu=process.env.ARM_VERSION||(yu==="arm64"?"8":V2.arm_version)||"",O0=(process.versions.uv||"").split(".")[0];M0.exports=Rt;function Rt(r){return A0(Rt.resolve(r))}Rt.resolve=Rt.path=function(r){r=Gt.resolve(r||".");try{var e=A0(Gt.join(r,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[e+"_PREBUILD"]&&(r=process.env[e+"_PREBUILD"])}catch{}if(!z2){var t=E0(Gt.join(r,"build/Release"),T0);if(t)return t;var n=E0(Gt.join(r,"build/Debug"),T0);if(n)return n}var s=a(r);if(s)return s;var i=a(Gt.dirname(process.execPath));if(i)return i;var o=["platform="+bu,"arch="+yu,"runtime="+gu,"abi="+S0,"uv="+O0,xu?"armv="+xu:"","libc="+I0,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+o+`
    loaded from: `+r+`
`);function a(u){var h=vu(Gt.join(u,"prebuilds")).map(P0),l=h.filter(R0(bu,yu)).sort(L0)[0];if(l){var d=Gt.join(u,"prebuilds",l.name),g=vu(d).map(k0),x=g.filter($0(gu,S0)),m=x.sort(B0(gu))[0];if(m)return Gt.join(d,m.file)}}};function vu(r){try{return C0.readdirSync(r)}catch{return[]}}function E0(r,e){var t=vu(r).filter(e);return t[0]&&Gt.join(r,t[0])}function T0(r){return/\.node$/.test(r)}function P0(r){var e=r.split("-");if(e.length===2){var t=e[0],n=e[1].split("+");if(t&&n.length&&n.every(Boolean))return{name:r,platform:t,architectures:n}}}function R0(r,e){return function(t){return t==null||t.platform!==r?!1:t.architectures.includes(e)}}function L0(r,e){return r.architectures.length-e.architectures.length}function k0(r){var e=r.split("."),t=e.pop(),n={file:r,specificity:0};if(t==="node"){for(var s=0;s<e.length;s++){var i=e[s];if(i==="node"||i==="electron"||i==="node-webkit")n.runtime=i;else if(i==="napi")n.napi=!0;else if(i.slice(0,3)==="abi")n.abi=i.slice(3);else if(i.slice(0,2)==="uv")n.uv=i.slice(2);else if(i.slice(0,4)==="armv")n.armv=i.slice(4);else if(i==="glibc"||i==="musl")n.libc=i;else continue;n.specificity++}return n}}function $0(r,e){return function(t){return!(t==null||t.runtime&&t.runtime!==r&&!W2(t)||t.abi&&t.abi!==e&&!t.napi||t.uv&&t.uv!==O0||t.armv&&t.armv!==xu||t.libc&&t.libc!==I0)}}function W2(r){return r.runtime==="node"&&r.napi}function B0(r){return function(e,t){return e.runtime!==t.runtime?e.runtime===r?-1:1:e.abi!==t.abi?e.abi?-1:1:e.specificity!==t.specificity?e.specificity>t.specificity?-1:1:0}}function G2(){return!!(process.versions&&process.versions.nw)}function K2(){return process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function H2(r){return r==="linux"&&C0.existsSync("/etc/alpine-release")}Rt.parseTags=k0;Rt.matchTags=$0;Rt.compareTags=B0;Rt.parseTuple=P0;Rt.matchTuple=R0;Rt.compareTuples=L0});var D0=j((QI,_u)=>{var wu=typeof __webpack_require__=="function"?__non_webpack_require__:require;typeof wu.addon=="function"?_u.exports=wu.addon.bind(wu):_u.exports=q0()});var F0=j((VI,j0)=>{"use strict";var Z2=(r,e,t,n,s)=>{for(var i=0;i<s;i++)t[n+i]=r[i]^e[i&3]},X2=(r,e)=>{let t=r.length;for(var n=0;n<t;n++)r[n]^=e[n&3]};j0.exports={mask:Z2,unmask:X2}});var U0=j((zI,Su)=>{"use strict";try{Su.exports=D0()(__dirname)}catch{Su.exports=F0()}});var bs=j((WI,Zi)=>{"use strict";var{EMPTY_BUFFER:J2}=Wt(),Eu=Buffer[Symbol.species];function Y2(r,e){if(r.length===0)return J2;if(r.length===1)return r[0];let t=Buffer.allocUnsafe(e),n=0;for(let s=0;s<r.length;s++){let i=r[s];t.set(i,n),n+=i.length}return n<e?new Eu(t.buffer,t.byteOffset,n):t}function Q0(r,e,t,n,s){for(let i=0;i<s;i++)t[n+i]=r[i]^e[i&3]}function V0(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t&3]}function eE(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function Tu(r){if(Tu.readOnly=!0,Buffer.isBuffer(r))return r;let e;return r instanceof ArrayBuffer?e=new Eu(r):ArrayBuffer.isView(r)?e=new Eu(r.buffer,r.byteOffset,r.byteLength):(e=Buffer.from(r),Tu.readOnly=!1),e}Zi.exports={concat:Y2,mask:Q0,toArrayBuffer:eE,toBuffer:Tu,unmask:V0};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=U0();Zi.exports.mask=function(e,t,n,s,i){i<48?Q0(e,t,n,s,i):r.mask(e,t,n,s,i)},Zi.exports.unmask=function(e,t){e.length<32?V0(e,t):r.unmask(e,t)}}catch{}});var G0=j((GI,W0)=>{"use strict";var z0=Symbol("kDone"),Cu=Symbol("kRun"),Nu=class{constructor(e){this[z0]=()=>{this.pending--,this[Cu]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[Cu]()}[Cu](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[z0])}}};W0.exports=Nu});var ws=j((KI,X0)=>{"use strict";var xs=require("zlib"),K0=bs(),tE=G0(),{kStatusCode:H0}=Wt(),rE=Buffer[Symbol.species],nE=Buffer.from([0,0,255,255]),Yi=Symbol("permessage-deflate"),Kt=Symbol("total-length"),vs=Symbol("callback"),cr=Symbol("buffers"),Ji=Symbol("error"),Xi,Au=class{constructor(e,t,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!Xi){let s=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Xi=new tE(s)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[vs];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,n=e.find(s=>!(t.serverNoContextTakeover===!1&&s.server_no_context_takeover||s.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>s.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!s.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(n.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?n.client_max_window_bits=t.clientMaxWindowBits:(n.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(n=>{let s=t[n];if(s.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(s=s[0],n==="client_max_window_bits"){if(s!==!0){let i=+s;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${n}": ${s}`);s=i}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${s}`)}else if(n==="server_max_window_bits"){let i=+s;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${n}": ${s}`);s=i}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(s!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${s}`)}else throw new Error(`Unknown parameter "${n}"`);t[n]=s})}),e}decompress(e,t,n){Xi.add(s=>{this._decompress(e,t,(i,o)=>{s(),n(i,o)})})}compress(e,t,n){Xi.add(s=>{this._compress(e,t,(i,o)=>{s(),n(i,o)})})}_decompress(e,t,n){let s=this._isServer?"client":"server";if(!this._inflate){let i=`${s}_max_window_bits`,o=typeof this.params[i]!="number"?xs.Z_DEFAULT_WINDOWBITS:this.params[i];this._inflate=xs.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[Yi]=this,this._inflate[Kt]=0,this._inflate[cr]=[],this._inflate.on("error",iE),this._inflate.on("data",Z0)}this._inflate[vs]=n,this._inflate.write(e),t&&this._inflate.write(nE),this._inflate.flush(()=>{let i=this._inflate[Ji];if(i){this._inflate.close(),this._inflate=null,n(i);return}let o=K0.concat(this._inflate[cr],this._inflate[Kt]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Kt]=0,this._inflate[cr]=[],t&&this.params[`${s}_no_context_takeover`]&&this._inflate.reset()),n(null,o)})}_compress(e,t,n){let s=this._isServer?"server":"client";if(!this._deflate){let i=`${s}_max_window_bits`,o=typeof this.params[i]!="number"?xs.Z_DEFAULT_WINDOWBITS:this.params[i];this._deflate=xs.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[Kt]=0,this._deflate[cr]=[],this._deflate.on("data",sE)}this._deflate[vs]=n,this._deflate.write(e),this._deflate.flush(xs.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let i=K0.concat(this._deflate[cr],this._deflate[Kt]);t&&(i=new rE(i.buffer,i.byteOffset,i.length-4)),this._deflate[vs]=null,this._deflate[Kt]=0,this._deflate[cr]=[],t&&this.params[`${s}_no_context_takeover`]&&this._deflate.reset(),n(null,i)})}};X0.exports=Au;function sE(r){this[cr].push(r),this[Kt]+=r.length}function Z0(r){if(this[Kt]+=r.length,this[Yi]._maxPayload<1||this[Kt]<=this[Yi]._maxPayload){this[cr].push(r);return}this[Ji]=new RangeError("Max payload size exceeded"),this[Ji].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Ji][H0]=1009,this.removeListener("data",Z0),this.reset()}function iE(r){this[Yi]._inflate=null,r[H0]=1007,this[vs](r)}});var wn=j((HI,eo)=>{"use strict";var{isUtf8:J0}=require("buffer"),{hasBlob:oE}=Wt(),aE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function cE(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function Iu(r){let e=r.length,t=0;for(;t<e;)if((r[t]&128)===0)t++;else if((r[t]&224)===192){if(t+1===e||(r[t+1]&192)!==128||(r[t]&254)===192)return!1;t+=2}else if((r[t]&240)===224){if(t+2>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||r[t]===224&&(r[t+1]&224)===128||r[t]===237&&(r[t+1]&224)===160)return!1;t+=3}else if((r[t]&248)===240){if(t+3>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||(r[t+3]&192)!==128||r[t]===240&&(r[t+1]&240)===128||r[t]===244&&r[t+1]>143||r[t]>244)return!1;t+=4}else return!1;return!0}function uE(r){return oE&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&(r[Symbol.toStringTag]==="Blob"||r[Symbol.toStringTag]==="File")}eo.exports={isBlob:uE,isValidStatusCode:cE,isValidUTF8:Iu,tokenChars:aE};if(J0)eo.exports.isValidUTF8=function(r){return r.length<24?Iu(r):J0(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=require("utf-8-validate");eo.exports.isValidUTF8=function(e){return e.length<32?Iu(e):r(e)}}catch{}});var ku=j((ZI,ig)=>{"use strict";var{Writable:lE}=require("stream"),Y0=ws(),{BINARY_TYPES:fE,EMPTY_BUFFER:eg,kStatusCode:hE,kWebSocket:dE}=Wt(),{concat:Ou,toArrayBuffer:pE,unmask:mE}=bs(),{isValidStatusCode:gE,isValidUTF8:tg}=wn(),to=Buffer[Symbol.species],pt=0,rg=1,ng=2,sg=3,Pu=4,Ru=5,ro=6,Lu=class extends lE{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||fE[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[dE]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=pt}_write(e,t,n){if(this._opcode===8&&this._state==pt)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new to(n.buffer,n.byteOffset+e,n.length-e),new to(n.buffer,n.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let n=this._buffers[0],s=t.length-e;e>=n.length?t.set(this._buffers.shift(),s):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),s),this._buffers[0]=new to(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case pt:this.getInfo(e);break;case rg:this.getPayloadLength16(e);break;case ng:this.getPayloadLength64(e);break;case sg:this.getMask();break;case Pu:this.getData(e);break;case Ru:case ro:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0){let s=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(s);return}let n=(t[0]&64)===64;if(n&&!this._extensions[Y0.extensionName]){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(n){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(!this._fragmented){let s=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let s=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(s);return}if(n){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let s=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(s);return}}else{let s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked){let s=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(s);return}}else if(this._masked){let s=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(s);return}this._payloadLength===126?this._state=rg:this._payloadLength===127?this._state=ng:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),n=t.readUInt32BE(0);if(n>Math.pow(2,21)-1){let s=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(s);return}this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let t=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(t);return}this._masked?this._state=sg:this._state=Pu}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=Pu}getData(e){let t=eg;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&mE(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=Ru,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[Y0.extensionName].decompress(e,this._fin,(s,i)=>{if(s)return t(s);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");t(o);return}this._fragments.push(i)}this.dataMessage(t),this._state===pt&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=pt;return}let t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=Ou(n,t):this._binaryType==="arraybuffer"?s=pE(Ou(n,t)):this._binaryType==="blob"?s=new Blob(n):s=n,this._allowSynchronousEvents?(this.emit("message",s,!0),this._state=pt):(this._state=ro,setImmediate(()=>{this.emit("message",s,!0),this._state=pt,this.startLoop(e)}))}else{let s=Ou(n,t);if(!this._skipUTF8Validation&&!tg(s)){let i=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(i);return}this._state===Ru||this._allowSynchronousEvents?(this.emit("message",s,!1),this._state=pt):(this._state=ro,setImmediate(()=>{this.emit("message",s,!1),this._state=pt,this.startLoop(e)}))}}controlMessage(e,t){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,eg),this.end();else{let n=e.readUInt16BE(0);if(!gE(n)){let i=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");t(i);return}let s=new to(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!tg(s)){let i=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");t(i);return}this._loop=!1,this.emit("conclude",n,s),this.end()}this._state=pt;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=pt):(this._state=ro,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=pt,this.startLoop(t)}))}createError(e,t,n,s,i){this._loop=!1,this._errored=!0;let o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,this.createError),o.code=i,o[hE]=s,o}};ig.exports=Lu});var Mu=j((JI,cg)=>{"use strict";var{Duplex:XI}=require("stream"),{randomFillSync:yE}=require("crypto"),og=ws(),{EMPTY_BUFFER:bE,kWebSocket:xE,NOOP:vE}=Wt(),{isBlob:_n,isValidStatusCode:wE}=wn(),{mask:ag,toBuffer:Mr}=bs(),mt=Symbol("kByteLength"),_E=Buffer.alloc(4),no=8*1024,qr,Sn=no,Et=0,SE=1,EE=2,$u=class r{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=Et,this.onerror=vE,this[xE]=void 0}static frame(e,t){let n,s=!1,i=2,o=!1;t.mask&&(n=t.maskBuffer||_E,t.generateMask?t.generateMask(n):(Sn===no&&(qr===void 0&&(qr=Buffer.alloc(no)),yE(qr,0,no),Sn=0),n[0]=qr[Sn++],n[1]=qr[Sn++],n[2]=qr[Sn++],n[3]=qr[Sn++]),o=(n[0]|n[1]|n[2]|n[3])===0,i=6);let a;typeof e=="string"?(!t.mask||o)&&t[mt]!==void 0?a=t[mt]:(e=Buffer.from(e),a=e.length):(a=e.length,s=t.mask&&t.readOnly&&!o);let u=a;a>=65536?(i+=8,u=127):a>125&&(i+=2,u=126);let h=Buffer.allocUnsafe(s?a+i:i);return h[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(h[0]|=64),h[1]=u,u===126?h.writeUInt16BE(a,2):u===127&&(h[2]=h[3]=0,h.writeUIntBE(a,4,6)),t.mask?(h[1]|=128,h[i-4]=n[0],h[i-3]=n[1],h[i-2]=n[2],h[i-1]=n[3],o?[h,e]:s?(ag(e,n,h,i,a),[h]):(ag(e,n,e,0,a),[h,e])):[h,e]}close(e,t,n,s){let i;if(e===void 0)i=bE;else{if(typeof e!="number"||!wE(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||!t.length)i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0);else{let a=Buffer.byteLength(t);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+a),i.writeUInt16BE(e,0),typeof t=="string"?i.write(t,2):i.set(t,2)}}let o={[mt]:i.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==Et?this.enqueue([this.dispatch,i,!1,o,s]):this.sendFrame(r.frame(i,o),s)}ping(e,t,n){let s,i;if(typeof e=="string"?(s=Buffer.byteLength(e),i=!1):_n(e)?(s=e.size,i=!1):(e=Mr(e),s=e.length,i=Mr.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[mt]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};_n(e)?this._state!==Et?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):this._state!==Et?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(r.frame(e,o),n)}pong(e,t,n){let s,i;if(typeof e=="string"?(s=Buffer.byteLength(e),i=!1):_n(e)?(s=e.size,i=!1):(e=Mr(e),s=e.length,i=Mr.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[mt]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};_n(e)?this._state!==Et?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):this._state!==Et?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(r.frame(e,o),n)}send(e,t,n){let s=this._extensions[og.extensionName],i=t.binary?2:1,o=t.compress,a,u;typeof e=="string"?(a=Buffer.byteLength(e),u=!1):_n(e)?(a=e.size,u=!1):(e=Mr(e),a=e.length,u=Mr.readOnly),this._firstFragment?(this._firstFragment=!1,o&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=a>=s._threshold),this._compress=o):(o=!1,i=0),t.fin&&(this._firstFragment=!0);let h={[mt]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:i,readOnly:u,rsv1:o};_n(e)?this._state!==Et?this.enqueue([this.getBlobData,e,this._compress,h,n]):this.getBlobData(e,this._compress,h,n):this._state!==Et?this.enqueue([this.dispatch,e,this._compress,h,n]):this.dispatch(e,this._compress,h,n)}getBlobData(e,t,n,s){this._bufferedBytes+=n[mt],this._state=EE,e.arrayBuffer().then(i=>{if(this._socket.destroyed){let a=new Error("The socket was closed while the blob was being read");process.nextTick(Bu,this,a,s);return}this._bufferedBytes-=n[mt];let o=Mr(i);t?this.dispatch(o,t,n,s):(this._state=Et,this.sendFrame(r.frame(o,n),s),this.dequeue())}).catch(i=>{process.nextTick(TE,this,i,s)})}dispatch(e,t,n,s){if(!t){this.sendFrame(r.frame(e,n),s);return}let i=this._extensions[og.extensionName];this._bufferedBytes+=n[mt],this._state=SE,i.compress(e,n.fin,(o,a)=>{if(this._socket.destroyed){let u=new Error("The socket was closed while data was being compressed");Bu(this,u,s);return}this._bufferedBytes-=n[mt],this._state=Et,n.readOnly=!1,this.sendFrame(r.frame(a,n),s),this.dequeue()})}dequeue(){for(;this._state===Et&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][mt],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][mt],this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};cg.exports=$u;function Bu(r,e,t){typeof t=="function"&&t(e);for(let n=0;n<r._queue.length;n++){let s=r._queue[n],i=s[s.length-1];typeof i=="function"&&i(e)}}function TE(r,e,t){Bu(r,e,t),r.onerror(e)}});var yg=j((YI,gg)=>{"use strict";var{kForOnEventAttribute:_s,kListener:qu}=Wt(),ug=Symbol("kCode"),lg=Symbol("kData"),fg=Symbol("kError"),hg=Symbol("kMessage"),dg=Symbol("kReason"),En=Symbol("kTarget"),pg=Symbol("kType"),mg=Symbol("kWasClean"),Ht=class{constructor(e){this[En]=null,this[pg]=e}get target(){return this[En]}get type(){return this[pg]}};Object.defineProperty(Ht.prototype,"target",{enumerable:!0});Object.defineProperty(Ht.prototype,"type",{enumerable:!0});var Dr=class extends Ht{constructor(e,t={}){super(e),this[ug]=t.code===void 0?0:t.code,this[dg]=t.reason===void 0?"":t.reason,this[mg]=t.wasClean===void 0?!1:t.wasClean}get code(){return this[ug]}get reason(){return this[dg]}get wasClean(){return this[mg]}};Object.defineProperty(Dr.prototype,"code",{enumerable:!0});Object.defineProperty(Dr.prototype,"reason",{enumerable:!0});Object.defineProperty(Dr.prototype,"wasClean",{enumerable:!0});var Tn=class extends Ht{constructor(e,t={}){super(e),this[fg]=t.error===void 0?null:t.error,this[hg]=t.message===void 0?"":t.message}get error(){return this[fg]}get message(){return this[hg]}};Object.defineProperty(Tn.prototype,"error",{enumerable:!0});Object.defineProperty(Tn.prototype,"message",{enumerable:!0});var Ss=class extends Ht{constructor(e,t={}){super(e),this[lg]=t.data===void 0?null:t.data}get data(){return this[lg]}};Object.defineProperty(Ss.prototype,"data",{enumerable:!0});var CE={addEventListener(r,e,t={}){for(let s of this.listeners(r))if(!t[_s]&&s[qu]===e&&!s[_s])return;let n;if(r==="message")n=function(i,o){let a=new Ss("message",{data:o?i:i.toString()});a[En]=this,so(e,this,a)};else if(r==="close")n=function(i,o){let a=new Dr("close",{code:i,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[En]=this,so(e,this,a)};else if(r==="error")n=function(i){let o=new Tn("error",{error:i,message:i.message});o[En]=this,so(e,this,o)};else if(r==="open")n=function(){let i=new Ht("open");i[En]=this,so(e,this,i)};else return;n[_s]=!!t[_s],n[qu]=e,t.once?this.once(r,n):this.on(r,n)},removeEventListener(r,e){for(let t of this.listeners(r))if(t[qu]===e&&!t[_s]){this.removeListener(r,t);break}}};gg.exports={CloseEvent:Dr,ErrorEvent:Tn,Event:Ht,EventTarget:CE,MessageEvent:Ss};function so(r,e,t){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,t):r.call(e,t)}});var Du=j((eO,bg)=>{"use strict";var{tokenChars:Es}=wn();function Lt(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}function NE(r){let e=Object.create(null),t=Object.create(null),n=!1,s=!1,i=!1,o,a,u=-1,h=-1,l=-1,d=0;for(;d<r.length;d++)if(h=r.charCodeAt(d),o===void 0)if(l===-1&&Es[h]===1)u===-1&&(u=d);else if(d!==0&&(h===32||h===9))l===-1&&u!==-1&&(l=d);else if(h===59||h===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${d}`);l===-1&&(l=d);let x=r.slice(u,l);h===44?(Lt(e,x,t),t=Object.create(null)):o=x,u=l=-1}else throw new SyntaxError(`Unexpected character at index ${d}`);else if(a===void 0)if(l===-1&&Es[h]===1)u===-1&&(u=d);else if(h===32||h===9)l===-1&&u!==-1&&(l=d);else if(h===59||h===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${d}`);l===-1&&(l=d),Lt(t,r.slice(u,l),!0),h===44&&(Lt(e,o,t),t=Object.create(null),o=void 0),u=l=-1}else if(h===61&&u!==-1&&l===-1)a=r.slice(u,d),u=l=-1;else throw new SyntaxError(`Unexpected character at index ${d}`);else if(s){if(Es[h]!==1)throw new SyntaxError(`Unexpected character at index ${d}`);u===-1?u=d:n||(n=!0),s=!1}else if(i)if(Es[h]===1)u===-1&&(u=d);else if(h===34&&u!==-1)i=!1,l=d;else if(h===92)s=!0;else throw new SyntaxError(`Unexpected character at index ${d}`);else if(h===34&&r.charCodeAt(d-1)===61)i=!0;else if(l===-1&&Es[h]===1)u===-1&&(u=d);else if(u!==-1&&(h===32||h===9))l===-1&&(l=d);else if(h===59||h===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${d}`);l===-1&&(l=d);let x=r.slice(u,l);n&&(x=x.replace(/\\/g,""),n=!1),Lt(t,a,x),h===44&&(Lt(e,o,t),t=Object.create(null),o=void 0),a=void 0,u=l=-1}else throw new SyntaxError(`Unexpected character at index ${d}`);if(u===-1||i||h===32||h===9)throw new SyntaxError("Unexpected end of input");l===-1&&(l=d);let g=r.slice(u,l);return o===void 0?Lt(e,g,t):(a===void 0?Lt(t,g,!0):n?Lt(t,a,g.replace(/\\/g,"")):Lt(t,a,g),Lt(e,o,t)),e}function AE(r){return Object.keys(r).map(e=>{let t=r[e];return Array.isArray(t)||(t=[t]),t.map(n=>[e].concat(Object.keys(n).map(s=>{let i=n[s];return Array.isArray(i)||(i=[i]),i.map(o=>o===!0?s:`${s}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}bg.exports={format:AE,parse:NE}});var Vu=j((nO,Og)=>{"use strict";var IE=require("events"),OE=require("https"),PE=require("http"),wg=require("net"),RE=require("tls"),{randomBytes:LE,createHash:kE}=require("crypto"),{Duplex:tO,Readable:rO}=require("stream"),{URL:ju}=require("url"),ur=ws(),$E=ku(),BE=Mu(),{isBlob:ME}=wn(),{BINARY_TYPES:xg,EMPTY_BUFFER:io,GUID:qE,kForOnEventAttribute:Fu,kListener:DE,kStatusCode:jE,kWebSocket:je,NOOP:_g}=Wt(),{EventTarget:{addEventListener:FE,removeEventListener:UE}}=yg(),{format:QE,parse:VE}=Du(),{toBuffer:zE}=bs(),WE=30*1e3,Sg=Symbol("kAborted"),Uu=[8,13],Zt=["CONNECTING","OPEN","CLOSING","CLOSED"],GE=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Ne=class r extends IE{constructor(e,t,n){super(),this._binaryType=xg[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=io,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=r.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,t===void 0?t=[]:Array.isArray(t)||(typeof t=="object"&&t!==null?(n=t,t=[]):t=[t]),Eg(this,e,t,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){xg.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){let s=new $E({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation}),i=new BE(e,this._extensions,n.generateMask);this._receiver=s,this._sender=i,this._socket=e,s[je]=this,i[je]=this,e[je]=this,s.on("conclude",ZE),s.on("drain",XE),s.on("error",JE),s.on("message",YE),s.on("ping",eT),s.on("pong",tT),i.onerror=rT,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Ng),e.on("data",ao),e.on("end",Ag),e.on("error",Ig),this._readyState=r.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[ur.extensionName]&&this._extensions[ur.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){it(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===r.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=r.CLOSING,this._sender.close(e,t,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),Cg(this)}}pause(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){Qu(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||io,t,n)}pong(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){Qu(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||io,t,n)}resume(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(n=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){Qu(this,e,n);return}let s={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[ur.extensionName]||(s.compress=!1),this._sender.send(e||io,s,n)}terminate(){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){it(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=r.CLOSING,this._socket.destroy())}}};Object.defineProperty(Ne,"CONNECTING",{enumerable:!0,value:Zt.indexOf("CONNECTING")});Object.defineProperty(Ne.prototype,"CONNECTING",{enumerable:!0,value:Zt.indexOf("CONNECTING")});Object.defineProperty(Ne,"OPEN",{enumerable:!0,value:Zt.indexOf("OPEN")});Object.defineProperty(Ne.prototype,"OPEN",{enumerable:!0,value:Zt.indexOf("OPEN")});Object.defineProperty(Ne,"CLOSING",{enumerable:!0,value:Zt.indexOf("CLOSING")});Object.defineProperty(Ne.prototype,"CLOSING",{enumerable:!0,value:Zt.indexOf("CLOSING")});Object.defineProperty(Ne,"CLOSED",{enumerable:!0,value:Zt.indexOf("CLOSED")});Object.defineProperty(Ne.prototype,"CLOSED",{enumerable:!0,value:Zt.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(Ne.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(Ne.prototype,`on${r}`,{enumerable:!0,get(){for(let e of this.listeners(r))if(e[Fu])return e[DE];return null},set(e){for(let t of this.listeners(r))if(t[Fu]){this.removeListener(r,t);break}typeof e=="function"&&this.addEventListener(r,e,{[Fu]:!0})}})});Ne.prototype.addEventListener=FE;Ne.prototype.removeEventListener=UE;Og.exports=Ne;function Eg(r,e,t,n){let s={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:Uu[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(r._autoPong=s.autoPong,!Uu.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${Uu.join(", ")})`);let i;if(e instanceof ju)i=e;else try{i=new ju(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}i.protocol==="http:"?i.protocol="ws:":i.protocol==="https:"&&(i.protocol="wss:"),r._url=i.href;let o=i.protocol==="wss:",a=i.protocol==="ws+unix:",u;if(i.protocol!=="ws:"&&!o&&!a?u=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:a&&!i.pathname?u="The URL's pathname is empty":i.hash&&(u="The URL contains a fragment identifier"),u){let f=new SyntaxError(u);if(r._redirects===0)throw f;oo(r,f);return}let h=o?443:80,l=LE(16).toString("base64"),d=o?OE.request:PE.request,g=new Set,x;if(s.createConnection=s.createConnection||(o?HE:KE),s.defaultPort=s.defaultPort||h,s.port=i.port||h,s.host=i.hostname.startsWith("[")?i.hostname.slice(1,-1):i.hostname,s.headers={...s.headers,"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":l,Connection:"Upgrade",Upgrade:"websocket"},s.path=i.pathname+i.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(x=new ur(s.perMessageDeflate!==!0?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=QE({[ur.extensionName]:x.offer()})),t.length){for(let f of t){if(typeof f!="string"||!GE.test(f)||g.has(f))throw new SyntaxError("An invalid or duplicated subprotocol was specified");g.add(f)}s.headers["Sec-WebSocket-Protocol"]=t.join(",")}if(s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin),(i.username||i.password)&&(s.auth=`${i.username}:${i.password}`),a){let f=s.path.split(":");s.socketPath=f[0],s.path=f[1]}let m;if(s.followRedirects){if(r._redirects===0){r._originalIpc=a,r._originalSecure=o,r._originalHostOrSocketPath=a?s.socketPath:i.host;let f=n&&n.headers;if(n={...n,headers:{}},f)for(let[v,w]of Object.entries(f))n.headers[v.toLowerCase()]=w}else if(r.listenerCount("redirect")===0){let f=a?r._originalIpc?s.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:i.host===r._originalHostOrSocketPath;(!f||r._originalSecure&&!o)&&(delete s.headers.authorization,delete s.headers.cookie,f||delete s.headers.host,s.auth=void 0)}s.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(s.auth).toString("base64")),m=r._req=d(s),r._redirects&&r.emit("redirect",r.url,m)}else m=r._req=d(s);s.timeout&&m.on("timeout",()=>{it(r,m,"Opening handshake has timed out")}),m.on("error",f=>{m===null||m[Sg]||(m=r._req=null,oo(r,f))}),m.on("response",f=>{let v=f.headers.location,w=f.statusCode;if(v&&s.followRedirects&&w>=300&&w<400){if(++r._redirects>s.maxRedirects){it(r,m,"Maximum redirects exceeded");return}m.abort();let _;try{_=new ju(v,e)}catch{let R=new SyntaxError(`Invalid URL: ${v}`);oo(r,R);return}Eg(r,_,t,n)}else r.emit("unexpected-response",m,f)||it(r,m,`Unexpected server response: ${f.statusCode}`)}),m.on("upgrade",(f,v,w)=>{if(r.emit("upgrade",f),r.readyState!==Ne.CONNECTING)return;m=r._req=null;let _=f.headers.upgrade;if(_===void 0||_.toLowerCase()!=="websocket"){it(r,v,"Invalid Upgrade header");return}let E=kE("sha1").update(l+qE).digest("base64");if(f.headers["sec-websocket-accept"]!==E){it(r,v,"Invalid Sec-WebSocket-Accept header");return}let R=f.headers["sec-websocket-protocol"],L;if(R!==void 0?g.size?g.has(R)||(L="Server sent an invalid subprotocol"):L="Server sent a subprotocol but none was requested":g.size&&(L="Server sent no subprotocol"),L){it(r,v,L);return}R&&(r._protocol=R);let S=f.headers["sec-websocket-extensions"];if(S!==void 0){if(!x){it(r,v,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let O;try{O=VE(S)}catch{it(r,v,"Invalid Sec-WebSocket-Extensions header");return}let I=Object.keys(O);if(I.length!==1||I[0]!==ur.extensionName){it(r,v,"Server indicated an extension that was not requested");return}try{x.accept(O[ur.extensionName])}catch{it(r,v,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[ur.extensionName]=x}r.setSocket(v,w,{allowSynchronousEvents:s.allowSynchronousEvents,generateMask:s.generateMask,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation})}),s.finishRequest?s.finishRequest(m,r):m.end()}function oo(r,e){r._readyState=Ne.CLOSING,r._errorEmitted=!0,r.emit("error",e),r.emitClose()}function KE(r){return r.path=r.socketPath,wg.connect(r)}function HE(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=wg.isIP(r.host)?"":r.host),RE.connect(r)}function it(r,e,t){r._readyState=Ne.CLOSING;let n=new Error(t);Error.captureStackTrace(n,it),e.setHeader?(e[Sg]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(oo,r,n)):(e.destroy(n),e.once("error",r.emit.bind(r,"error")),e.once("close",r.emitClose.bind(r)))}function Qu(r,e,t){if(e){let n=ME(e)?e.size:zE(e).length;r._socket?r._sender._bufferedBytes+=n:r._bufferedAmount+=n}if(t){let n=new Error(`WebSocket is not open: readyState ${r.readyState} (${Zt[r.readyState]})`);process.nextTick(t,n)}}function ZE(r,e){let t=this[je];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=r,t._socket[je]!==void 0&&(t._socket.removeListener("data",ao),process.nextTick(Tg,t._socket),r===1005?t.close():t.close(r,e))}function XE(){let r=this[je];r.isPaused||r._socket.resume()}function JE(r){let e=this[je];e._socket[je]!==void 0&&(e._socket.removeListener("data",ao),process.nextTick(Tg,e._socket),e.close(r[jE])),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",r))}function vg(){this[je].emitClose()}function YE(r,e){this[je].emit("message",r,e)}function eT(r){let e=this[je];e._autoPong&&e.pong(r,!this._isServer,_g),e.emit("ping",r)}function tT(r){this[je].emit("pong",r)}function Tg(r){r.resume()}function rT(r){let e=this[je];e.readyState!==Ne.CLOSED&&(e.readyState===Ne.OPEN&&(e._readyState=Ne.CLOSING,Cg(e)),this._socket.end(),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",r)))}function Cg(r){r._closeTimer=setTimeout(r._socket.destroy.bind(r._socket),WE)}function Ng(){let r=this[je];this.removeListener("close",Ng),this.removeListener("data",ao),this.removeListener("end",Ag),r._readyState=Ne.CLOSING;let e;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(e=r._socket.read())!==null&&r._receiver.write(e),r._receiver.end(),this[je]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",vg),r._receiver.on("finish",vg))}function ao(r){this[je]._receiver.write(r)||this.pause()}function Ag(){let r=this[je];r._readyState=Ne.CLOSING,r._receiver.end(),this.end()}function Ig(){let r=this[je];this.removeListener("error",Ig),this.on("error",_g),r&&(r._readyState=Ne.CLOSING,this.destroy())}});var Rg=j((sO,Pg)=>{"use strict";var{tokenChars:nT}=wn();function sT(r){let e=new Set,t=-1,n=-1,s=0;for(s;s<r.length;s++){let o=r.charCodeAt(s);if(n===-1&&nT[o]===1)t===-1&&(t=s);else if(s!==0&&(o===32||o===9))n===-1&&t!==-1&&(n=s);else if(o===44){if(t===-1)throw new SyntaxError(`Unexpected character at index ${s}`);n===-1&&(n=s);let a=r.slice(t,n);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),t=n=-1}else throw new SyntaxError(`Unexpected character at index ${s}`)}if(t===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let i=r.slice(t,s);if(e.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);return e.add(i),e}Pg.exports={parse:sT}});var Dg=j((oO,qg)=>{"use strict";var iT=require("events"),co=require("http"),{Duplex:iO}=require("stream"),{createHash:oT}=require("crypto"),Lg=Du(),jr=ws(),aT=Rg(),cT=Vu(),{GUID:uT,kWebSocket:lT}=Wt(),fT=/^[+/0-9A-Za-z]{22}==$/,kg=0,$g=1,Mg=2,zu=class extends iT{constructor(e,t){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:cT,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=co.createServer((n,s)=>{let i=co.STATUS_CODES[426];s.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),s.end(i)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=hT(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(s,i,o)=>{this.handleUpgrade(s,i,o,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=kg}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===Mg){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(Ts,this);return}if(e&&this.once("close",e),this._state!==$g)if(this._state=$g,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(Ts,this):process.nextTick(Ts,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{Ts(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,s){t.on("error",Bg);let i=e.headers["sec-websocket-key"],o=e.headers.upgrade,a=+e.headers["sec-websocket-version"];if(e.method!=="GET"){Fr(this,e,t,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){Fr(this,e,t,400,"Invalid Upgrade header");return}if(i===void 0||!fT.test(i)){Fr(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(a!==8&&a!==13){Fr(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Cs(t,400);return}let u=e.headers["sec-websocket-protocol"],h=new Set;if(u!==void 0)try{h=aT.parse(u)}catch{Fr(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let l=e.headers["sec-websocket-extensions"],d={};if(this.options.perMessageDeflate&&l!==void 0){let g=new jr(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let x=Lg.parse(l);x[jr.extensionName]&&(g.accept(x[jr.extensionName]),d[jr.extensionName]=g)}catch{Fr(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let g={origin:e.headers[`${a===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(g,(x,m,f,v)=>{if(!x)return Cs(t,m||401,f,v);this.completeUpgrade(d,i,h,e,t,n,s)});return}if(!this.options.verifyClient(g))return Cs(t,401)}this.completeUpgrade(d,i,h,e,t,n,s)}completeUpgrade(e,t,n,s,i,o,a){if(!i.readable||!i.writable)return i.destroy();if(i[lT])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>kg)return Cs(i,503);let h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${oT("sha1").update(t+uT).digest("base64")}`],l=new this.options.WebSocket(null,void 0,this.options);if(n.size){let d=this.options.handleProtocols?this.options.handleProtocols(n,s):n.values().next().value;d&&(h.push(`Sec-WebSocket-Protocol: ${d}`),l._protocol=d)}if(e[jr.extensionName]){let d=e[jr.extensionName].params,g=Lg.format({[jr.extensionName]:[d]});h.push(`Sec-WebSocket-Extensions: ${g}`),l._extensions=e}this.emit("headers",h,s),i.write(h.concat(`\r
`).join(`\r
`)),i.removeListener("error",Bg),l.setSocket(i,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(l),l.on("close",()=>{this.clients.delete(l),this._shouldEmitClose&&!this.clients.size&&process.nextTick(Ts,this)})),a(l,s)}};qg.exports=zu;function hT(r,e){for(let t of Object.keys(e))r.on(t,e[t]);return function(){for(let n of Object.keys(e))r.removeListener(n,e[n])}}function Ts(r){r._state=Mg,r.emit("close")}function Bg(){this.destroy()}function Cs(r,e,t,n){t=t||co.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...n},r.once("finish",r.destroy),r.end(`HTTP/1.1 ${e} ${co.STATUS_CODES[e]}\r
`+Object.keys(n).map(s=>`${s}: ${n[s]}`).join(`\r
`)+`\r
\r
`+t)}function Fr(r,e,t,n,s){if(r.listenerCount("wsClientError")){let i=new Error(s);Error.captureStackTrace(i,Fr),r.emit("wsClientError",i,t,e)}else Cs(t,n,s)}});var xT={};Zg(xT,{handler:()=>bT});module.exports=Xg(xT);var Jg=Object.create,zr=Object.defineProperty,Yg=Object.getOwnPropertyDescriptor,ey=Object.getOwnPropertyNames,ty=Object.getPrototypeOf,ry=Object.prototype.hasOwnProperty,ny=(r,e,t)=>e in r?zr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,b=(r,e)=>zr(r,"name",{value:e,configurable:!0}),Xe=(r,e)=>()=>(r&&(e=r(r=0)),e),de=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),yt=(r,e)=>{for(var t in e)zr(r,t,{get:e[t],enumerable:!0})},rl=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ey(e))!ry.call(r,s)&&s!==t&&zr(r,s,{get:()=>e[s],enumerable:!(n=Yg(e,s))||n.enumerable});return r},Wr=(r,e,t)=>(t=r!=null?Jg(ty(r)):{},rl(e||!r||!r.__esModule?zr(t,"default",{value:r,enumerable:!0}):t,r)),qe=r=>rl(zr({},"__esModule",{value:!0}),r),ae=(r,e,t)=>ny(r,typeof e!="symbol"?e+"":e,t),sy=de(r=>{"use strict";te(),r.byteLength=u,r.toByteArray=l,r.fromByteArray=x;var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(i=0,o=s.length;i<o;++i)e[i]=s[i],t[s.charCodeAt(i)]=i;var i,o;t[45]=62,t[95]=63;function a(m){var f=m.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=m.indexOf("=");v===-1&&(v=f);var w=v===f?0:4-v%4;return[v,w]}b(a,"getLens");function u(m){var f=a(m),v=f[0],w=f[1];return(v+w)*3/4-w}b(u,"byteLength");function h(m,f,v){return(f+v)*3/4-v}b(h,"_byteLength");function l(m){var f,v=a(m),w=v[0],_=v[1],E=new n(h(m,w,_)),R=0,L=_>0?w-4:w,S;for(S=0;S<L;S+=4)f=t[m.charCodeAt(S)]<<18|t[m.charCodeAt(S+1)]<<12|t[m.charCodeAt(S+2)]<<6|t[m.charCodeAt(S+3)],E[R++]=f>>16&255,E[R++]=f>>8&255,E[R++]=f&255;return _===2&&(f=t[m.charCodeAt(S)]<<2|t[m.charCodeAt(S+1)]>>4,E[R++]=f&255),_===1&&(f=t[m.charCodeAt(S)]<<10|t[m.charCodeAt(S+1)]<<4|t[m.charCodeAt(S+2)]>>2,E[R++]=f>>8&255,E[R++]=f&255),E}b(l,"toByteArray");function d(m){return e[m>>18&63]+e[m>>12&63]+e[m>>6&63]+e[m&63]}b(d,"tripletToBase64");function g(m,f,v){for(var w,_=[],E=f;E<v;E+=3)w=(m[E]<<16&16711680)+(m[E+1]<<8&65280)+(m[E+2]&255),_.push(d(w));return _.join("")}b(g,"encodeChunk");function x(m){for(var f,v=m.length,w=v%3,_=[],E=16383,R=0,L=v-w;R<L;R+=E)_.push(g(m,R,R+E>L?L:R+E));return w===1?(f=m[v-1],_.push(e[f>>2]+e[f<<4&63]+"==")):w===2&&(f=(m[v-2]<<8)+m[v-1],_.push(e[f>>10]+e[f>>4&63]+e[f<<2&63]+"=")),_.join("")}b(x,"fromByteArray")}),iy=de(r=>{te(),r.read=function(e,t,n,s,i){var o,a,u=i*8-s-1,h=(1<<u)-1,l=h>>1,d=-7,g=n?i-1:0,x=n?-1:1,m=e[t+g];for(g+=x,o=m&(1<<-d)-1,m>>=-d,d+=u;d>0;o=o*256+e[t+g],g+=x,d-=8);for(a=o&(1<<-d)-1,o>>=-d,d+=s;d>0;a=a*256+e[t+g],g+=x,d-=8);if(o===0)o=1-l;else{if(o===h)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,s),o=o-l}return(m?-1:1)*a*Math.pow(2,o-s)},r.write=function(e,t,n,s,i,o){var a,u,h,l=o*8-i-1,d=(1<<l)-1,g=d>>1,x=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=s?0:o-1,f=s?1:-1,v=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-a))<1&&(a--,h*=2),a+g>=1?t+=x/h:t+=x*Math.pow(2,1-g),t*h>=2&&(a++,h/=2),a+g>=d?(u=0,a=d):a+g>=1?(u=(t*h-1)*Math.pow(2,i),a=a+g):(u=t*Math.pow(2,g-1)*Math.pow(2,i),a=0));i>=8;e[n+m]=u&255,m+=f,u/=256,i-=8);for(a=a<<i|u,l+=i;l>0;e[n+m]=a&255,m+=f,a/=256,l-=8);e[n+m-f]|=v*128}}),oy=de(r=>{"use strict";te();var e=sy(),t=iy(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=a,r.SlowBuffer=_,r.INSPECT_MAX_BYTES=50;var s=2147483647;r.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{let c=new Uint8Array(1),p={foo:b(function(){return 42},"foo")};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(c,p),c.foo()===42}catch{return!1}}b(i,"typedArraySupport"),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:b(function(){if(a.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:b(function(){if(a.isBuffer(this))return this.byteOffset},"get")});function o(c){if(c>s)throw new RangeError('The value "'+c+'" is invalid for option "size"');let p=new Uint8Array(c);return Object.setPrototypeOf(p,a.prototype),p}b(o,"createBuffer");function a(c,p,y){if(typeof c=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(c)}return u(c,p,y)}b(a,"Buffer"),a.poolSize=8192;function u(c,p,y){if(typeof c=="string")return g(c,p);if(ArrayBuffer.isView(c))return m(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(gt(c,ArrayBuffer)||c&&gt(c.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(gt(c,SharedArrayBuffer)||c&&gt(c.buffer,SharedArrayBuffer)))return f(c,p,y);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let N=c.valueOf&&c.valueOf();if(N!=null&&N!==c)return a.from(N,p,y);let P=v(c);if(P)return P;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return a.from(c[Symbol.toPrimitive]("string"),p,y);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}b(u,"from"),a.from=function(c,p,y){return u(c,p,y)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function h(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}b(h,"assertSize");function l(c,p,y){return h(c),c<=0?o(c):p!==void 0?typeof y=="string"?o(c).fill(p,y):o(c).fill(p):o(c)}b(l,"alloc"),a.alloc=function(c,p,y){return l(c,p,y)};function d(c){return h(c),o(c<0?0:w(c)|0)}b(d,"allocUnsafe"),a.allocUnsafe=function(c){return d(c)},a.allocUnsafeSlow=function(c){return d(c)};function g(c,p){if((typeof p!="string"||p==="")&&(p="utf8"),!a.isEncoding(p))throw new TypeError("Unknown encoding: "+p);let y=E(c,p)|0,N=o(y),P=N.write(c,p);return P!==y&&(N=N.slice(0,P)),N}b(g,"fromString");function x(c){let p=c.length<0?0:w(c.length)|0,y=o(p);for(let N=0;N<p;N+=1)y[N]=c[N]&255;return y}b(x,"fromArrayLike");function m(c){if(gt(c,Uint8Array)){let p=new Uint8Array(c);return f(p.buffer,p.byteOffset,p.byteLength)}return x(c)}b(m,"fromArrayView");function f(c,p,y){if(p<0||c.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<p+(y||0))throw new RangeError('"length" is outside of buffer bounds');let N;return p===void 0&&y===void 0?N=new Uint8Array(c):y===void 0?N=new Uint8Array(c,p):N=new Uint8Array(c,p,y),Object.setPrototypeOf(N,a.prototype),N}b(f,"fromArrayBuffer");function v(c){if(a.isBuffer(c)){let p=w(c.length)|0,y=o(p);return y.length===0||c.copy(y,0,0,p),y}if(c.length!==void 0)return typeof c.length!="number"||Is(c.length)?o(0):x(c);if(c.type==="Buffer"&&Array.isArray(c.data))return x(c.data)}b(v,"fromObject");function w(c){if(c>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return c|0}b(w,"checked");function _(c){return+c!=c&&(c=0),a.alloc(+c)}b(_,"SlowBuffer"),a.isBuffer=b(function(c){return c!=null&&c._isBuffer===!0&&c!==a.prototype},"isBuffer"),a.compare=b(function(c,p){if(gt(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),gt(p,Uint8Array)&&(p=a.from(p,p.offset,p.byteLength)),!a.isBuffer(c)||!a.isBuffer(p))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===p)return 0;let y=c.length,N=p.length;for(let P=0,q=Math.min(y,N);P<q;++P)if(c[P]!==p[P]){y=c[P],N=p[P];break}return y<N?-1:N<y?1:0},"compare"),a.isEncoding=b(function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),a.concat=b(function(c,p){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(c.length===0)return a.alloc(0);let y;if(p===void 0)for(p=0,y=0;y<c.length;++y)p+=c[y].length;let N=a.allocUnsafe(p),P=0;for(y=0;y<c.length;++y){let q=c[y];if(gt(q,Uint8Array))P+q.length>N.length?(a.isBuffer(q)||(q=a.from(q)),q.copy(N,P)):Uint8Array.prototype.set.call(N,q,P);else if(a.isBuffer(q))q.copy(N,P);else throw new TypeError('"list" argument must be an Array of Buffers');P+=q.length}return N},"concat");function E(c,p){if(a.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||gt(c,ArrayBuffer))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);let y=c.length,N=arguments.length>2&&arguments[2]===!0;if(!N&&y===0)return 0;let P=!1;for(;;)switch(p){case"ascii":case"latin1":case"binary":return y;case"utf8":case"utf-8":return As(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y*2;case"hex":return y>>>1;case"base64":return mo(c).length;default:if(P)return N?-1:As(c).length;p=(""+p).toLowerCase(),P=!0}}b(E,"byteLength"),a.byteLength=E;function R(c,p,y){let N=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((y===void 0||y>this.length)&&(y=this.length),y<=0)||(y>>>=0,p>>>=0,y<=p))return"";for(c||(c="utf8");;)switch(c){case"hex":return be(this,p,y);case"utf8":case"utf-8":return k(this,p,y);case"ascii":return ce(this,p,y);case"latin1":case"binary":return ge(this,p,y);case"base64":return X(this,p,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,p,y);default:if(N)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),N=!0}}b(R,"slowToString"),a.prototype._isBuffer=!0;function L(c,p,y){let N=c[p];c[p]=c[y],c[y]=N}b(L,"swap"),a.prototype.swap16=b(function(){let c=this.length;if(c%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let p=0;p<c;p+=2)L(this,p,p+1);return this},"swap16"),a.prototype.swap32=b(function(){let c=this.length;if(c%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let p=0;p<c;p+=4)L(this,p,p+3),L(this,p+1,p+2);return this},"swap32"),a.prototype.swap64=b(function(){let c=this.length;if(c%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let p=0;p<c;p+=8)L(this,p,p+7),L(this,p+1,p+6),L(this,p+2,p+5),L(this,p+3,p+4);return this},"swap64"),a.prototype.toString=b(function(){let c=this.length;return c===0?"":arguments.length===0?k(this,0,c):R.apply(this,arguments)},"toString"),a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=b(function(c){if(!a.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:a.compare(this,c)===0},"equals"),a.prototype.inspect=b(function(){let c="",p=r.INSPECT_MAX_BYTES;return c=this.toString("hex",0,p).replace(/(.{2})/g,"$1 ").trim(),this.length>p&&(c+=" ... "),"<Buffer "+c+">"},"inspect"),n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=b(function(c,p,y,N,P){if(gt(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),!a.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(p===void 0&&(p=0),y===void 0&&(y=c?c.length:0),N===void 0&&(N=0),P===void 0&&(P=this.length),p<0||y>c.length||N<0||P>this.length)throw new RangeError("out of range index");if(N>=P&&p>=y)return 0;if(N>=P)return-1;if(p>=y)return 1;if(p>>>=0,y>>>=0,N>>>=0,P>>>=0,this===c)return 0;let q=P-N,F=y-p,_e=Math.min(q,F),Me=this.slice(N,P),Ce=c.slice(p,y);for(let Se=0;Se<_e;++Se)if(Me[Se]!==Ce[Se]){q=Me[Se],F=Ce[Se];break}return q<F?-1:F<q?1:0},"compare");function S(c,p,y,N,P){if(c.length===0)return-1;if(typeof y=="string"?(N=y,y=0):y>2147483647?y=2147483647:y<-2147483648&&(y=-2147483648),y=+y,Is(y)&&(y=P?0:c.length-1),y<0&&(y=c.length+y),y>=c.length){if(P)return-1;y=c.length-1}else if(y<0)if(P)y=0;else return-1;if(typeof p=="string"&&(p=a.from(p,N)),a.isBuffer(p))return p.length===0?-1:O(c,p,y,N,P);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?P?Uint8Array.prototype.indexOf.call(c,p,y):Uint8Array.prototype.lastIndexOf.call(c,p,y):O(c,[p],y,N,P);throw new TypeError("val must be string, number or Buffer")}b(S,"bidirectionalIndexOf");function O(c,p,y,N,P){let q=1,F=c.length,_e=p.length;if(N!==void 0&&(N=String(N).toLowerCase(),N==="ucs2"||N==="ucs-2"||N==="utf16le"||N==="utf-16le")){if(c.length<2||p.length<2)return-1;q=2,F/=2,_e/=2,y/=2}function Me(Se,Re){return q===1?Se[Re]:Se.readUInt16BE(Re*q)}b(Me,"read");let Ce;if(P){let Se=-1;for(Ce=y;Ce<F;Ce++)if(Me(c,Ce)===Me(p,Se===-1?0:Ce-Se)){if(Se===-1&&(Se=Ce),Ce-Se+1===_e)return Se*q}else Se!==-1&&(Ce-=Ce-Se),Se=-1}else for(y+_e>F&&(y=F-_e),Ce=y;Ce>=0;Ce--){let Se=!0;for(let Re=0;Re<_e;Re++)if(Me(c,Ce+Re)!==Me(p,Re)){Se=!1;break}if(Se)return Ce}return-1}b(O,"arrayIndexOf"),a.prototype.includes=b(function(c,p,y){return this.indexOf(c,p,y)!==-1},"includes"),a.prototype.indexOf=b(function(c,p,y){return S(this,c,p,y,!0)},"indexOf"),a.prototype.lastIndexOf=b(function(c,p,y){return S(this,c,p,y,!1)},"lastIndexOf");function I(c,p,y,N){y=Number(y)||0;let P=c.length-y;N?(N=Number(N),N>P&&(N=P)):N=P;let q=p.length;N>q/2&&(N=q/2);let F;for(F=0;F<N;++F){let _e=parseInt(p.substr(F*2,2),16);if(Is(_e))return F;c[y+F]=_e}return F}b(I,"hexWrite");function C(c,p,y,N){return An(As(p,c.length-y),c,y,N)}b(C,"utf8Write");function M(c,p,y,N){return An(Hu(p),c,y,N)}b(M,"asciiWrite");function $(c,p,y,N){return An(mo(p),c,y,N)}b($,"base64Write");function Z(c,p,y,N){return An(Zu(p,c.length-y),c,y,N)}b(Z,"ucs2Write"),a.prototype.write=b(function(c,p,y,N){if(p===void 0)N="utf8",y=this.length,p=0;else if(y===void 0&&typeof p=="string")N=p,y=this.length,p=0;else if(isFinite(p))p=p>>>0,isFinite(y)?(y=y>>>0,N===void 0&&(N="utf8")):(N=y,y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let P=this.length-p;if((y===void 0||y>P)&&(y=P),c.length>0&&(y<0||p<0)||p>this.length)throw new RangeError("Attempt to write outside buffer bounds");N||(N="utf8");let q=!1;for(;;)switch(N){case"hex":return I(this,c,p,y);case"utf8":case"utf-8":return C(this,c,p,y);case"ascii":case"latin1":case"binary":return M(this,c,p,y);case"base64":return $(this,c,p,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,c,p,y);default:if(q)throw new TypeError("Unknown encoding: "+N);N=(""+N).toLowerCase(),q=!0}},"write"),a.prototype.toJSON=b(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function X(c,p,y){return p===0&&y===c.length?e.fromByteArray(c):e.fromByteArray(c.slice(p,y))}b(X,"base64Slice");function k(c,p,y){y=Math.min(c.length,y);let N=[],P=p;for(;P<y;){let q=c[P],F=null,_e=q>239?4:q>223?3:q>191?2:1;if(P+_e<=y){let Me,Ce,Se,Re;switch(_e){case 1:q<128&&(F=q);break;case 2:Me=c[P+1],(Me&192)===128&&(Re=(q&31)<<6|Me&63,Re>127&&(F=Re));break;case 3:Me=c[P+1],Ce=c[P+2],(Me&192)===128&&(Ce&192)===128&&(Re=(q&15)<<12|(Me&63)<<6|Ce&63,Re>2047&&(Re<55296||Re>57343)&&(F=Re));break;case 4:Me=c[P+1],Ce=c[P+2],Se=c[P+3],(Me&192)===128&&(Ce&192)===128&&(Se&192)===128&&(Re=(q&15)<<18|(Me&63)<<12|(Ce&63)<<6|Se&63,Re>65535&&Re<1114112&&(F=Re))}}F===null?(F=65533,_e=1):F>65535&&(F-=65536,N.push(F>>>10&1023|55296),F=56320|F&1023),N.push(F),P+=_e}return ee(N)}b(k,"utf8Slice");var Q=4096;function ee(c){let p=c.length;if(p<=Q)return String.fromCharCode.apply(String,c);let y="",N=0;for(;N<p;)y+=String.fromCharCode.apply(String,c.slice(N,N+=Q));return y}b(ee,"decodeCodePointsArray");function ce(c,p,y){let N="";y=Math.min(c.length,y);for(let P=p;P<y;++P)N+=String.fromCharCode(c[P]&127);return N}b(ce,"asciiSlice");function ge(c,p,y){let N="";y=Math.min(c.length,y);for(let P=p;P<y;++P)N+=String.fromCharCode(c[P]);return N}b(ge,"latin1Slice");function be(c,p,y){let N=c.length;(!p||p<0)&&(p=0),(!y||y<0||y>N)&&(y=N);let P="";for(let q=p;q<y;++q)P+=Vg[c[q]];return P}b(be,"hexSlice");function Be(c,p,y){let N=c.slice(p,y),P="";for(let q=0;q<N.length-1;q+=2)P+=String.fromCharCode(N[q]+N[q+1]*256);return P}b(Be,"utf16leSlice"),a.prototype.slice=b(function(c,p){let y=this.length;c=~~c,p=p===void 0?y:~~p,c<0?(c+=y,c<0&&(c=0)):c>y&&(c=y),p<0?(p+=y,p<0&&(p=0)):p>y&&(p=y),p<c&&(p=c);let N=this.subarray(c,p);return Object.setPrototypeOf(N,a.prototype),N},"slice");function we(c,p,y){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+p>y)throw new RangeError("Trying to access beyond buffer length")}b(we,"checkOffset"),a.prototype.readUintLE=a.prototype.readUIntLE=b(function(c,p,y){c=c>>>0,p=p>>>0,y||we(c,p,this.length);let N=this[c],P=1,q=0;for(;++q<p&&(P*=256);)N+=this[c+q]*P;return N},"readUIntLE"),a.prototype.readUintBE=a.prototype.readUIntBE=b(function(c,p,y){c=c>>>0,p=p>>>0,y||we(c,p,this.length);let N=this[c+--p],P=1;for(;p>0&&(P*=256);)N+=this[c+--p]*P;return N},"readUIntBE"),a.prototype.readUint8=a.prototype.readUInt8=b(function(c,p){return c=c>>>0,p||we(c,1,this.length),this[c]},"readUInt8"),a.prototype.readUint16LE=a.prototype.readUInt16LE=b(function(c,p){return c=c>>>0,p||we(c,2,this.length),this[c]|this[c+1]<<8},"readUInt16LE"),a.prototype.readUint16BE=a.prototype.readUInt16BE=b(function(c,p){return c=c>>>0,p||we(c,2,this.length),this[c]<<8|this[c+1]},"readUInt16BE"),a.prototype.readUint32LE=a.prototype.readUInt32LE=b(function(c,p){return c=c>>>0,p||we(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+this[c+3]*16777216},"readUInt32LE"),a.prototype.readUint32BE=a.prototype.readUInt32BE=b(function(c,p){return c=c>>>0,p||we(c,4,this.length),this[c]*16777216+(this[c+1]<<16|this[c+2]<<8|this[c+3])},"readUInt32BE"),a.prototype.readBigUInt64LE=kt(b(function(c){c=c>>>0,fr(c,"offset");let p=this[c],y=this[c+7];(p===void 0||y===void 0)&&Qr(c,this.length-8);let N=p+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24,P=this[++c]+this[++c]*2**8+this[++c]*2**16+y*2**24;return BigInt(N)+(BigInt(P)<<BigInt(32))},"readBigUInt64LE")),a.prototype.readBigUInt64BE=kt(b(function(c){c=c>>>0,fr(c,"offset");let p=this[c],y=this[c+7];(p===void 0||y===void 0)&&Qr(c,this.length-8);let N=p*2**24+this[++c]*2**16+this[++c]*2**8+this[++c],P=this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+y;return(BigInt(N)<<BigInt(32))+BigInt(P)},"readBigUInt64BE")),a.prototype.readIntLE=b(function(c,p,y){c=c>>>0,p=p>>>0,y||we(c,p,this.length);let N=this[c],P=1,q=0;for(;++q<p&&(P*=256);)N+=this[c+q]*P;return P*=128,N>=P&&(N-=Math.pow(2,8*p)),N},"readIntLE"),a.prototype.readIntBE=b(function(c,p,y){c=c>>>0,p=p>>>0,y||we(c,p,this.length);let N=p,P=1,q=this[c+--N];for(;N>0&&(P*=256);)q+=this[c+--N]*P;return P*=128,q>=P&&(q-=Math.pow(2,8*p)),q},"readIntBE"),a.prototype.readInt8=b(function(c,p){return c=c>>>0,p||we(c,1,this.length),this[c]&128?(255-this[c]+1)*-1:this[c]},"readInt8"),a.prototype.readInt16LE=b(function(c,p){c=c>>>0,p||we(c,2,this.length);let y=this[c]|this[c+1]<<8;return y&32768?y|4294901760:y},"readInt16LE"),a.prototype.readInt16BE=b(function(c,p){c=c>>>0,p||we(c,2,this.length);let y=this[c+1]|this[c]<<8;return y&32768?y|4294901760:y},"readInt16BE"),a.prototype.readInt32LE=b(function(c,p){return c=c>>>0,p||we(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},"readInt32LE"),a.prototype.readInt32BE=b(function(c,p){return c=c>>>0,p||we(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},"readInt32BE"),a.prototype.readBigInt64LE=kt(b(function(c){c=c>>>0,fr(c,"offset");let p=this[c],y=this[c+7];(p===void 0||y===void 0)&&Qr(c,this.length-8);let N=this[c+4]+this[c+5]*2**8+this[c+6]*2**16+(y<<24);return(BigInt(N)<<BigInt(32))+BigInt(p+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24)},"readBigInt64LE")),a.prototype.readBigInt64BE=kt(b(function(c){c=c>>>0,fr(c,"offset");let p=this[c],y=this[c+7];(p===void 0||y===void 0)&&Qr(c,this.length-8);let N=(p<<24)+this[++c]*2**16+this[++c]*2**8+this[++c];return(BigInt(N)<<BigInt(32))+BigInt(this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+y)},"readBigInt64BE")),a.prototype.readFloatLE=b(function(c,p){return c=c>>>0,p||we(c,4,this.length),t.read(this,c,!0,23,4)},"readFloatLE"),a.prototype.readFloatBE=b(function(c,p){return c=c>>>0,p||we(c,4,this.length),t.read(this,c,!1,23,4)},"readFloatBE"),a.prototype.readDoubleLE=b(function(c,p){return c=c>>>0,p||we(c,8,this.length),t.read(this,c,!0,52,8)},"readDoubleLE"),a.prototype.readDoubleBE=b(function(c,p){return c=c>>>0,p||we(c,8,this.length),t.read(this,c,!1,52,8)},"readDoubleBE");function Ae(c,p,y,N,P,q){if(!a.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>P||p<q)throw new RangeError('"value" argument is out of bounds');if(y+N>c.length)throw new RangeError("Index out of range")}b(Ae,"checkInt"),a.prototype.writeUintLE=a.prototype.writeUIntLE=b(function(c,p,y,N){if(c=+c,p=p>>>0,y=y>>>0,!N){let F=Math.pow(2,8*y)-1;Ae(this,c,p,y,F,0)}let P=1,q=0;for(this[p]=c&255;++q<y&&(P*=256);)this[p+q]=c/P&255;return p+y},"writeUIntLE"),a.prototype.writeUintBE=a.prototype.writeUIntBE=b(function(c,p,y,N){if(c=+c,p=p>>>0,y=y>>>0,!N){let F=Math.pow(2,8*y)-1;Ae(this,c,p,y,F,0)}let P=y-1,q=1;for(this[p+P]=c&255;--P>=0&&(q*=256);)this[p+P]=c/q&255;return p+y},"writeUIntBE"),a.prototype.writeUint8=a.prototype.writeUInt8=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,1,255,0),this[p]=c&255,p+1},"writeUInt8"),a.prototype.writeUint16LE=a.prototype.writeUInt16LE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,2,65535,0),this[p]=c&255,this[p+1]=c>>>8,p+2},"writeUInt16LE"),a.prototype.writeUint16BE=a.prototype.writeUInt16BE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,2,65535,0),this[p]=c>>>8,this[p+1]=c&255,p+2},"writeUInt16BE"),a.prototype.writeUint32LE=a.prototype.writeUInt32LE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,4,4294967295,0),this[p+3]=c>>>24,this[p+2]=c>>>16,this[p+1]=c>>>8,this[p]=c&255,p+4},"writeUInt32LE"),a.prototype.writeUint32BE=a.prototype.writeUInt32BE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,4,4294967295,0),this[p]=c>>>24,this[p+1]=c>>>16,this[p+2]=c>>>8,this[p+3]=c&255,p+4},"writeUInt32BE");function lr(c,p,y,N,P){po(p,N,P,c,y,7);let q=Number(p&BigInt(4294967295));c[y++]=q,q=q>>8,c[y++]=q,q=q>>8,c[y++]=q,q=q>>8,c[y++]=q;let F=Number(p>>BigInt(32)&BigInt(4294967295));return c[y++]=F,F=F>>8,c[y++]=F,F=F>>8,c[y++]=F,F=F>>8,c[y++]=F,y}b(lr,"wrtBigUInt64LE");function Cn(c,p,y,N,P){po(p,N,P,c,y,7);let q=Number(p&BigInt(4294967295));c[y+7]=q,q=q>>8,c[y+6]=q,q=q>>8,c[y+5]=q,q=q>>8,c[y+4]=q;let F=Number(p>>BigInt(32)&BigInt(4294967295));return c[y+3]=F,F=F>>8,c[y+2]=F,F=F>>8,c[y+1]=F,F=F>>8,c[y]=F,y+8}b(Cn,"wrtBigUInt64BE"),a.prototype.writeBigUInt64LE=kt(b(function(c,p=0){return lr(this,c,p,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),a.prototype.writeBigUInt64BE=kt(b(function(c,p=0){return Cn(this,c,p,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),a.prototype.writeIntLE=b(function(c,p,y,N){if(c=+c,p=p>>>0,!N){let _e=Math.pow(2,8*y-1);Ae(this,c,p,y,_e-1,-_e)}let P=0,q=1,F=0;for(this[p]=c&255;++P<y&&(q*=256);)c<0&&F===0&&this[p+P-1]!==0&&(F=1),this[p+P]=(c/q>>0)-F&255;return p+y},"writeIntLE"),a.prototype.writeIntBE=b(function(c,p,y,N){if(c=+c,p=p>>>0,!N){let _e=Math.pow(2,8*y-1);Ae(this,c,p,y,_e-1,-_e)}let P=y-1,q=1,F=0;for(this[p+P]=c&255;--P>=0&&(q*=256);)c<0&&F===0&&this[p+P+1]!==0&&(F=1),this[p+P]=(c/q>>0)-F&255;return p+y},"writeIntBE"),a.prototype.writeInt8=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,1,127,-128),c<0&&(c=255+c+1),this[p]=c&255,p+1},"writeInt8"),a.prototype.writeInt16LE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,2,32767,-32768),this[p]=c&255,this[p+1]=c>>>8,p+2},"writeInt16LE"),a.prototype.writeInt16BE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,2,32767,-32768),this[p]=c>>>8,this[p+1]=c&255,p+2},"writeInt16BE"),a.prototype.writeInt32LE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,4,2147483647,-2147483648),this[p]=c&255,this[p+1]=c>>>8,this[p+2]=c>>>16,this[p+3]=c>>>24,p+4},"writeInt32LE"),a.prototype.writeInt32BE=b(function(c,p,y){return c=+c,p=p>>>0,y||Ae(this,c,p,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[p]=c>>>24,this[p+1]=c>>>16,this[p+2]=c>>>8,this[p+3]=c&255,p+4},"writeInt32BE"),a.prototype.writeBigInt64LE=kt(b(function(c,p=0){return lr(this,c,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),a.prototype.writeBigInt64BE=kt(b(function(c,p=0){return Cn(this,c,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function Nn(c,p,y,N,P,q){if(y+N>c.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("Index out of range")}b(Nn,"checkIEEE754");function lo(c,p,y,N,P){return p=+p,y=y>>>0,P||Nn(c,p,y,4,34028234663852886e22,-34028234663852886e22),t.write(c,p,y,N,23,4),y+4}b(lo,"writeFloat"),a.prototype.writeFloatLE=b(function(c,p,y){return lo(this,c,p,!0,y)},"writeFloatLE"),a.prototype.writeFloatBE=b(function(c,p,y){return lo(this,c,p,!1,y)},"writeFloatBE");function fo(c,p,y,N,P){return p=+p,y=y>>>0,P||Nn(c,p,y,8,17976931348623157e292,-17976931348623157e292),t.write(c,p,y,N,52,8),y+8}b(fo,"writeDouble"),a.prototype.writeDoubleLE=b(function(c,p,y){return fo(this,c,p,!0,y)},"writeDoubleLE"),a.prototype.writeDoubleBE=b(function(c,p,y){return fo(this,c,p,!1,y)},"writeDoubleBE"),a.prototype.copy=b(function(c,p,y,N){if(!a.isBuffer(c))throw new TypeError("argument should be a Buffer");if(y||(y=0),!N&&N!==0&&(N=this.length),p>=c.length&&(p=c.length),p||(p=0),N>0&&N<y&&(N=y),N===y||c.length===0||this.length===0)return 0;if(p<0)throw new RangeError("targetStart out of bounds");if(y<0||y>=this.length)throw new RangeError("Index out of range");if(N<0)throw new RangeError("sourceEnd out of bounds");N>this.length&&(N=this.length),c.length-p<N-y&&(N=c.length-p+y);let P=N-y;return this===c&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(p,y,N):Uint8Array.prototype.set.call(c,this.subarray(y,N),p),P},"copy"),a.prototype.fill=b(function(c,p,y,N){if(typeof c=="string"){if(typeof p=="string"?(N=p,p=0,y=this.length):typeof y=="string"&&(N=y,y=this.length),N!==void 0&&typeof N!="string")throw new TypeError("encoding must be a string");if(typeof N=="string"&&!a.isEncoding(N))throw new TypeError("Unknown encoding: "+N);if(c.length===1){let q=c.charCodeAt(0);(N==="utf8"&&q<128||N==="latin1")&&(c=q)}}else typeof c=="number"?c=c&255:typeof c=="boolean"&&(c=Number(c));if(p<0||this.length<p||this.length<y)throw new RangeError("Out of range index");if(y<=p)return this;p=p>>>0,y=y===void 0?this.length:y>>>0,c||(c=0);let P;if(typeof c=="number")for(P=p;P<y;++P)this[P]=c;else{let q=a.isBuffer(c)?c:a.from(c,N),F=q.length;if(F===0)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(P=0;P<y-p;++P)this[P+p]=q[P%F]}return this},"fill");var Ur={};function Ns(c,p,y){var N;Ur[c]=(N=class extends y{constructor(){super(),Object.defineProperty(this,"message",{value:p.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${c}]`,this.stack,delete this.name}get code(){return c}set code(P){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:P,writable:!0})}toString(){return`${this.name} [${c}]: ${this.message}`}},b(N,"NodeError"),N)}b(Ns,"E"),Ns("ERR_BUFFER_OUT_OF_BOUNDS",function(c){return c?`${c} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ns("ERR_INVALID_ARG_TYPE",function(c,p){return`The "${c}" argument must be of type number. Received type ${typeof p}`},TypeError),Ns("ERR_OUT_OF_RANGE",function(c,p,y){let N=`The value of "${c}" is out of range.`,P=y;return Number.isInteger(y)&&Math.abs(y)>2**32?P=ho(String(y)):typeof y=="bigint"&&(P=String(y),(y>BigInt(2)**BigInt(32)||y<-(BigInt(2)**BigInt(32)))&&(P=ho(P)),P+="n"),N+=` It must be ${p}. Received ${P}`,N},RangeError);function ho(c){let p="",y=c.length,N=c[0]==="-"?1:0;for(;y>=N+4;y-=3)p=`_${c.slice(y-3,y)}${p}`;return`${c.slice(0,y)}${p}`}b(ho,"addNumericalSeparator");function Gu(c,p,y){fr(p,"offset"),(c[p]===void 0||c[p+y]===void 0)&&Qr(p,c.length-(y+1))}b(Gu,"checkBounds");function po(c,p,y,N,P,q){if(c>y||c<p){let F=typeof p=="bigint"?"n":"",_e;throw q>3?p===0||p===BigInt(0)?_e=`>= 0${F} and < 2${F} ** ${(q+1)*8}${F}`:_e=`>= -(2${F} ** ${(q+1)*8-1}${F}) and < 2 ** ${(q+1)*8-1}${F}`:_e=`>= ${p}${F} and <= ${y}${F}`,new Ur.ERR_OUT_OF_RANGE("value",_e,c)}Gu(N,P,q)}b(po,"checkIntBI");function fr(c,p){if(typeof c!="number")throw new Ur.ERR_INVALID_ARG_TYPE(p,"number",c)}b(fr,"validateNumber");function Qr(c,p,y){throw Math.floor(c)!==c?(fr(c,y),new Ur.ERR_OUT_OF_RANGE(y||"offset","an integer",c)):p<0?new Ur.ERR_BUFFER_OUT_OF_BOUNDS:new Ur.ERR_OUT_OF_RANGE(y||"offset",`>= ${y?1:0} and <= ${p}`,c)}b(Qr,"boundsError");var Qg=/[^+/0-9A-Za-z-_]/g;function Ku(c){if(c=c.split("=")[0],c=c.trim().replace(Qg,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}b(Ku,"base64clean");function As(c,p){p=p||1/0;let y,N=c.length,P=null,q=[];for(let F=0;F<N;++F){if(y=c.charCodeAt(F),y>55295&&y<57344){if(!P){if(y>56319){(p-=3)>-1&&q.push(239,191,189);continue}else if(F+1===N){(p-=3)>-1&&q.push(239,191,189);continue}P=y;continue}if(y<56320){(p-=3)>-1&&q.push(239,191,189),P=y;continue}y=(P-55296<<10|y-56320)+65536}else P&&(p-=3)>-1&&q.push(239,191,189);if(P=null,y<128){if((p-=1)<0)break;q.push(y)}else if(y<2048){if((p-=2)<0)break;q.push(y>>6|192,y&63|128)}else if(y<65536){if((p-=3)<0)break;q.push(y>>12|224,y>>6&63|128,y&63|128)}else if(y<1114112){if((p-=4)<0)break;q.push(y>>18|240,y>>12&63|128,y>>6&63|128,y&63|128)}else throw new Error("Invalid code point")}return q}b(As,"utf8ToBytes");function Hu(c){let p=[];for(let y=0;y<c.length;++y)p.push(c.charCodeAt(y)&255);return p}b(Hu,"asciiToBytes");function Zu(c,p){let y,N,P,q=[];for(let F=0;F<c.length&&!((p-=2)<0);++F)y=c.charCodeAt(F),N=y>>8,P=y%256,q.push(P),q.push(N);return q}b(Zu,"utf16leToBytes");function mo(c){return e.toByteArray(Ku(c))}b(mo,"base64ToBytes");function An(c,p,y,N){let P;for(P=0;P<N&&!(P+y>=p.length||P>=c.length);++P)p[P+y]=c[P];return P}b(An,"blitBuffer");function gt(c,p){return c instanceof p||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===p.name}b(gt,"isInstance");function Is(c){return c!==c}b(Is,"numberIsNaN");var Vg=function(){let c="0123456789abcdef",p=new Array(256);for(let y=0;y<16;++y){let N=y*16;for(let P=0;P<16;++P)p[N+P]=c[y]+c[P]}return p}();function kt(c){return typeof BigInt>"u"?Xu:c}b(kt,"defineBigIntMethod");function Xu(){throw new Error("BigInt not supported")}b(Xu,"BufferBigIntNotDefined")}),Ps,vo,ay,Fe,oe,he,te=Xe(()=>{"use strict";Ps=globalThis,vo=globalThis.setImmediate??(r=>setTimeout(r,0)),ay=globalThis.clearImmediate??(r=>clearTimeout(r)),Fe=globalThis.crypto??{},Fe.subtle??(Fe.subtle={}),oe=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:oy().Buffer,he=globalThis.process??{},he.env??(he.env={});try{he.nextTick(()=>{})}catch{let r=Promise.resolve();he.nextTick=r.then.bind(r)}}),dr=de((r,e)=>{"use strict";te();var t=typeof Reflect=="object"?Reflect:null,n=t&&typeof t.apply=="function"?t.apply:b(function(S,O,I){return Function.prototype.apply.call(S,O,I)},"ReflectApply"),s;t&&typeof t.ownKeys=="function"?s=t.ownKeys:Object.getOwnPropertySymbols?s=b(function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))},"ReflectOwnKeys"):s=b(function(S){return Object.getOwnPropertyNames(S)},"ReflectOwnKeys");function i(S){console&&console.warn&&console.warn(S)}b(i,"ProcessEmitWarning");var o=Number.isNaN||b(function(S){return S!==S},"NumberIsNaN");function a(){a.init.call(this)}b(a,"EventEmitter"),e.exports=a,e.exports.once=E,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function h(S){if(typeof S!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof S)}b(h,"checkListener"),Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:b(function(){return u},"get"),set:b(function(S){if(typeof S!="number"||S<0||o(S))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+S+".");u=S},"set")}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=b(function(S){if(typeof S!="number"||S<0||o(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this},"setMaxListeners");function l(S){return S._maxListeners===void 0?a.defaultMaxListeners:S._maxListeners}b(l,"_getMaxListeners"),a.prototype.getMaxListeners=b(function(){return l(this)},"getMaxListeners"),a.prototype.emit=b(function(S){for(var O=[],I=1;I<arguments.length;I++)O.push(arguments[I]);var C=S==="error",M=this._events;if(M!==void 0)C=C&&M.error===void 0;else if(!C)return!1;if(C){var $;if(O.length>0&&($=O[0]),$ instanceof Error)throw $;var Z=new Error("Unhandled error."+($?" ("+$.message+")":""));throw Z.context=$,Z}var X=M[S];if(X===void 0)return!1;if(typeof X=="function")n(X,this,O);else for(var k=X.length,Q=v(X,k),I=0;I<k;++I)n(Q[I],this,O);return!0},"emit");function d(S,O,I,C){var M,$,Z;if(h(I),$=S._events,$===void 0?($=S._events=Object.create(null),S._eventsCount=0):($.newListener!==void 0&&(S.emit("newListener",O,I.listener?I.listener:I),$=S._events),Z=$[O]),Z===void 0)Z=$[O]=I,++S._eventsCount;else if(typeof Z=="function"?Z=$[O]=C?[I,Z]:[Z,I]:C?Z.unshift(I):Z.push(I),M=l(S),M>0&&Z.length>M&&!Z.warned){Z.warned=!0;var X=new Error("Possible EventEmitter memory leak detected. "+Z.length+" "+String(O)+" listeners added. Use emitter.setMaxListeners() to increase limit");X.name="MaxListenersExceededWarning",X.emitter=S,X.type=O,X.count=Z.length,i(X)}return S}b(d,"_addListener"),a.prototype.addListener=b(function(S,O){return d(this,S,O,!1)},"addListener"),a.prototype.on=a.prototype.addListener,a.prototype.prependListener=b(function(S,O){return d(this,S,O,!0)},"prependListener");function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}b(g,"onceWrapper");function x(S,O,I){var C={fired:!1,wrapFn:void 0,target:S,type:O,listener:I},M=g.bind(C);return M.listener=I,C.wrapFn=M,M}b(x,"_onceWrap"),a.prototype.once=b(function(S,O){return h(O),this.on(S,x(this,S,O)),this},"once"),a.prototype.prependOnceListener=b(function(S,O){return h(O),this.prependListener(S,x(this,S,O)),this},"prependOnceListener"),a.prototype.removeListener=b(function(S,O){var I,C,M,$,Z;if(h(O),C=this._events,C===void 0)return this;if(I=C[S],I===void 0)return this;if(I===O||I.listener===O)--this._eventsCount===0?this._events=Object.create(null):(delete C[S],C.removeListener&&this.emit("removeListener",S,I.listener||O));else if(typeof I!="function"){for(M=-1,$=I.length-1;$>=0;$--)if(I[$]===O||I[$].listener===O){Z=I[$].listener,M=$;break}if(M<0)return this;M===0?I.shift():w(I,M),I.length===1&&(C[S]=I[0]),C.removeListener!==void 0&&this.emit("removeListener",S,Z||O)}return this},"removeListener"),a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=b(function(S){var O,I,C;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[S]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete I[S]),this;if(arguments.length===0){var M=Object.keys(I),$;for(C=0;C<M.length;++C)$=M[C],$!=="removeListener"&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=I[S],typeof O=="function")this.removeListener(S,O);else if(O!==void 0)for(C=O.length-1;C>=0;C--)this.removeListener(S,O[C]);return this},"removeAllListeners");function m(S,O,I){var C=S._events;if(C===void 0)return[];var M=C[O];return M===void 0?[]:typeof M=="function"?I?[M.listener||M]:[M]:I?_(M):v(M,M.length)}b(m,"_listeners"),a.prototype.listeners=b(function(S){return m(this,S,!0)},"listeners"),a.prototype.rawListeners=b(function(S){return m(this,S,!1)},"rawListeners"),a.listenerCount=function(S,O){return typeof S.listenerCount=="function"?S.listenerCount(O):f.call(S,O)},a.prototype.listenerCount=f;function f(S){var O=this._events;if(O!==void 0){var I=O[S];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}b(f,"listenerCount"),a.prototype.eventNames=b(function(){return this._eventsCount>0?s(this._events):[]},"eventNames");function v(S,O){for(var I=new Array(O),C=0;C<O;++C)I[C]=S[C];return I}b(v,"arrayClone");function w(S,O){for(;O+1<S.length;O++)S[O]=S[O+1];S.pop()}b(w,"spliceOne");function _(S){for(var O=new Array(S.length),I=0;I<O.length;++I)O[I]=S[I].listener||S[I];return O}b(_,"unwrapListeners");function E(S,O){return new Promise(function(I,C){function M(Z){S.removeListener(O,$),C(Z)}b(M,"errorListener");function $(){typeof S.removeListener=="function"&&S.removeListener("error",M),I([].slice.call(arguments))}b($,"resolver"),L(S,O,$,{once:!0}),O!=="error"&&R(S,M,{once:!0})})}b(E,"once");function R(S,O,I){typeof S.on=="function"&&L(S,"error",O,I)}b(R,"addErrorHandlerIfEventEmitter");function L(S,O,I,C){if(typeof S.on=="function")C.once?S.once(O,I):S.on(O,I);else if(typeof S.addEventListener=="function")S.addEventListener(O,b(function M($){C.once&&S.removeEventListener(O,M),I($)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof S)}b(L,"eventTargetAgnosticAddListener")}),Pn={};yt(Pn,{default:()=>nl});var nl,Rs=Xe(()=>{"use strict";te(),nl={}});function On(r){let e=1779033703,t=3144134277,n=1013904242,s=2773480762,i=1359893119,o=2600822924,a=528734635,u=1541459225,h=0,l=0,d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=b((_,E)=>_>>>E|_<<32-E,"rrot"),x=new Uint32Array(64),m=new Uint8Array(64),f=b(()=>{for(let M=0,$=0;M<16;M++,$+=4)x[M]=m[$]<<24|m[$+1]<<16|m[$+2]<<8|m[$+3];for(let M=16;M<64;M++){let $=g(x[M-15],7)^g(x[M-15],18)^x[M-15]>>>3,Z=g(x[M-2],17)^g(x[M-2],19)^x[M-2]>>>10;x[M]=x[M-16]+$+x[M-7]+Z|0}let _=e,E=t,R=n,L=s,S=i,O=o,I=a,C=u;for(let M=0;M<64;M++){let $=g(S,6)^g(S,11)^g(S,25),Z=S&O^~S&I,X=C+$+Z+d[M]+x[M]|0,k=g(_,2)^g(_,13)^g(_,22),Q=_&E^_&R^E&R,ee=k+Q|0;C=I,I=O,O=S,S=L+X|0,L=R,R=E,E=_,_=X+ee|0}e=e+_|0,t=t+E|0,n=n+R|0,s=s+L|0,i=i+S|0,o=o+O|0,a=a+I|0,u=u+C|0,l=0},"process"),v=b(_=>{typeof _=="string"&&(_=new TextEncoder().encode(_));for(let E=0;E<_.length;E++)m[l++]=_[E],l===64&&f();h+=_.length},"add"),w=b(()=>{if(m[l++]=128,l==64&&f(),l+8>64){for(;l<64;)m[l++]=0;f()}for(;l<58;)m[l++]=0;let _=h*8;m[l++]=_/1099511627776&255,m[l++]=_/4294967296&255,m[l++]=_>>>24,m[l++]=_>>>16&255,m[l++]=_>>>8&255,m[l++]=_&255,f();let E=new Uint8Array(32);return E[0]=e>>>24,E[1]=e>>>16&255,E[2]=e>>>8&255,E[3]=e&255,E[4]=t>>>24,E[5]=t>>>16&255,E[6]=t>>>8&255,E[7]=t&255,E[8]=n>>>24,E[9]=n>>>16&255,E[10]=n>>>8&255,E[11]=n&255,E[12]=s>>>24,E[13]=s>>>16&255,E[14]=s>>>8&255,E[15]=s&255,E[16]=i>>>24,E[17]=i>>>16&255,E[18]=i>>>8&255,E[19]=i&255,E[20]=o>>>24,E[21]=o>>>16&255,E[22]=o>>>8&255,E[23]=o&255,E[24]=a>>>24,E[25]=a>>>16&255,E[26]=a>>>8&255,E[27]=a&255,E[28]=u>>>24,E[29]=u>>>16&255,E[30]=u>>>8&255,E[31]=u&255,E},"digest");return r===void 0?{add:v,digest:w}:(v(r),w())}var cy=Xe(()=>{"use strict";te(),b(On,"sha256")}),$t,bo,uy=Xe(()=>{"use strict";te(),$t=class ot{constructor(){ae(this,"_dataLength",0),ae(this,"_bufferLength",0),ae(this,"_state",new Int32Array(4)),ae(this,"_buffer",new ArrayBuffer(68)),ae(this,"_buffer8"),ae(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){let t=ot.hexChars,n=ot.hexOut,s,i,o,a;for(a=0;a<4;a+=1)for(i=a*8,s=e[a],o=0;o<8;o+=2)n[i+1+o]=t.charAt(s&15),s>>>=4,n[i+0+o]=t.charAt(s&15),s>>>=4;return n.join("")}static _md5cycle(e,t){let n=e[0],s=e[1],i=e[2],o=e[3];n+=(s&i|~s&o)+t[0]-680876936|0,n=(n<<7|n>>>25)+s|0,o+=(n&s|~n&i)+t[1]-389564586|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&s)+t[2]+606105819|0,i=(i<<17|i>>>15)+o|0,s+=(i&o|~i&n)+t[3]-1044525330|0,s=(s<<22|s>>>10)+i|0,n+=(s&i|~s&o)+t[4]-176418897|0,n=(n<<7|n>>>25)+s|0,o+=(n&s|~n&i)+t[5]+1200080426|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&s)+t[6]-1473231341|0,i=(i<<17|i>>>15)+o|0,s+=(i&o|~i&n)+t[7]-45705983|0,s=(s<<22|s>>>10)+i|0,n+=(s&i|~s&o)+t[8]+1770035416|0,n=(n<<7|n>>>25)+s|0,o+=(n&s|~n&i)+t[9]-1958414417|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&s)+t[10]-42063|0,i=(i<<17|i>>>15)+o|0,s+=(i&o|~i&n)+t[11]-1990404162|0,s=(s<<22|s>>>10)+i|0,n+=(s&i|~s&o)+t[12]+1804603682|0,n=(n<<7|n>>>25)+s|0,o+=(n&s|~n&i)+t[13]-40341101|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&s)+t[14]-1502002290|0,i=(i<<17|i>>>15)+o|0,s+=(i&o|~i&n)+t[15]+1236535329|0,s=(s<<22|s>>>10)+i|0,n+=(s&o|i&~o)+t[1]-165796510|0,n=(n<<5|n>>>27)+s|0,o+=(n&i|s&~i)+t[6]-1069501632|0,o=(o<<9|o>>>23)+n|0,i+=(o&s|n&~s)+t[11]+643717713|0,i=(i<<14|i>>>18)+o|0,s+=(i&n|o&~n)+t[0]-373897302|0,s=(s<<20|s>>>12)+i|0,n+=(s&o|i&~o)+t[5]-701558691|0,n=(n<<5|n>>>27)+s|0,o+=(n&i|s&~i)+t[10]+38016083|0,o=(o<<9|o>>>23)+n|0,i+=(o&s|n&~s)+t[15]-660478335|0,i=(i<<14|i>>>18)+o|0,s+=(i&n|o&~n)+t[4]-405537848|0,s=(s<<20|s>>>12)+i|0,n+=(s&o|i&~o)+t[9]+568446438|0,n=(n<<5|n>>>27)+s|0,o+=(n&i|s&~i)+t[14]-1019803690|0,o=(o<<9|o>>>23)+n|0,i+=(o&s|n&~s)+t[3]-187363961|0,i=(i<<14|i>>>18)+o|0,s+=(i&n|o&~n)+t[8]+1163531501|0,s=(s<<20|s>>>12)+i|0,n+=(s&o|i&~o)+t[13]-1444681467|0,n=(n<<5|n>>>27)+s|0,o+=(n&i|s&~i)+t[2]-51403784|0,o=(o<<9|o>>>23)+n|0,i+=(o&s|n&~s)+t[7]+1735328473|0,i=(i<<14|i>>>18)+o|0,s+=(i&n|o&~n)+t[12]-1926607734|0,s=(s<<20|s>>>12)+i|0,n+=(s^i^o)+t[5]-378558|0,n=(n<<4|n>>>28)+s|0,o+=(n^s^i)+t[8]-2022574463|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^s)+t[11]+1839030562|0,i=(i<<16|i>>>16)+o|0,s+=(i^o^n)+t[14]-35309556|0,s=(s<<23|s>>>9)+i|0,n+=(s^i^o)+t[1]-1530992060|0,n=(n<<4|n>>>28)+s|0,o+=(n^s^i)+t[4]+1272893353|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^s)+t[7]-155497632|0,i=(i<<16|i>>>16)+o|0,s+=(i^o^n)+t[10]-1094730640|0,s=(s<<23|s>>>9)+i|0,n+=(s^i^o)+t[13]+681279174|0,n=(n<<4|n>>>28)+s|0,o+=(n^s^i)+t[0]-358537222|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^s)+t[3]-722521979|0,i=(i<<16|i>>>16)+o|0,s+=(i^o^n)+t[6]+76029189|0,s=(s<<23|s>>>9)+i|0,n+=(s^i^o)+t[9]-640364487|0,n=(n<<4|n>>>28)+s|0,o+=(n^s^i)+t[12]-421815835|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^s)+t[15]+530742520|0,i=(i<<16|i>>>16)+o|0,s+=(i^o^n)+t[2]-995338651|0,s=(s<<23|s>>>9)+i|0,n+=(i^(s|~o))+t[0]-198630844|0,n=(n<<6|n>>>26)+s|0,o+=(s^(n|~i))+t[7]+1126891415|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~s))+t[14]-1416354905|0,i=(i<<15|i>>>17)+o|0,s+=(o^(i|~n))+t[5]-57434055|0,s=(s<<21|s>>>11)+i|0,n+=(i^(s|~o))+t[12]+1700485571|0,n=(n<<6|n>>>26)+s|0,o+=(s^(n|~i))+t[3]-1894986606|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~s))+t[10]-1051523|0,i=(i<<15|i>>>17)+o|0,s+=(o^(i|~n))+t[1]-2054922799|0,s=(s<<21|s>>>11)+i|0,n+=(i^(s|~o))+t[8]+1873313359|0,n=(n<<6|n>>>26)+s|0,o+=(s^(n|~i))+t[15]-30611744|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~s))+t[6]-1560198380|0,i=(i<<15|i>>>17)+o|0,s+=(o^(i|~n))+t[13]+1309151649|0,s=(s<<21|s>>>11)+i|0,n+=(i^(s|~o))+t[4]-145523070|0,n=(n<<6|n>>>26)+s|0,o+=(s^(n|~i))+t[11]-1120210379|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~s))+t[2]+718787259|0,i=(i<<15|i>>>17)+o|0,s+=(o^(i|~n))+t[9]-343485551|0,s=(s<<21|s>>>11)+i|0,e[0]=n+e[0]|0,e[1]=s+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(ot.stateIdentity),this}appendStr(e){let t=this._buffer8,n=this._buffer32,s=this._bufferLength,i,o;for(o=0;o<e.length;o+=1){if(i=e.charCodeAt(o),i<128)t[s++]=i;else if(i<2048)t[s++]=(i>>>6)+192,t[s++]=i&63|128;else if(i<55296||i>56319)t[s++]=(i>>>12)+224,t[s++]=i>>>6&63|128,t[s++]=i&63|128;else{if(i=(i-55296)*1024+(e.charCodeAt(++o)-56320)+65536,i>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[s++]=(i>>>18)+240,t[s++]=i>>>12&63|128,t[s++]=i>>>6&63|128,t[s++]=i&63|128}s>=64&&(this._dataLength+=64,ot._md5cycle(this._state,n),s-=64,n[0]=n[16])}return this._bufferLength=s,this}appendAsciiStr(e){let t=this._buffer8,n=this._buffer32,s=this._bufferLength,i,o=0;for(;;){for(i=Math.min(e.length-o,64-s);i--;)t[s++]=e.charCodeAt(o++);if(s<64)break;this._dataLength+=64,ot._md5cycle(this._state,n),s=0}return this._bufferLength=s,this}appendByteArray(e){let t=this._buffer8,n=this._buffer32,s=this._bufferLength,i,o=0;for(;;){for(i=Math.min(e.length-o,64-s);i--;)t[s++]=e[o++];if(s<64)break;this._dataLength+=64,ot._md5cycle(this._state,n),s=0}return this._bufferLength=s,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,n=e.state,s=this._state,i;for(this._dataLength=e.length,this._bufferLength=e.buflen,s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],i=0;i<t.length;i+=1)this._buffer8[i]=t.charCodeAt(i)}end(e=!1){let t=this._bufferLength,n=this._buffer8,s=this._buffer32,i=(t>>2)+1;this._dataLength+=t;let o=this._dataLength*8;if(n[t]=128,n[t+1]=n[t+2]=n[t+3]=0,s.set(ot.buffer32Identity.subarray(i),i),t>55&&(ot._md5cycle(this._state,s),s.set(ot.buffer32Identity)),o<=4294967295)s[14]=o;else{let a=o.toString(16).match(/(.*?)(.{0,8})$/);if(a===null)return;let u=parseInt(a[2],16),h=parseInt(a[1],16)||0;s[14]=u,s[15]=h}return ot._md5cycle(this._state,s),e?this._state:ot._hex(this._state)}},b($t,"Md5"),ae($t,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),ae($t,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ae($t,"hexChars","0123456789abcdef"),ae($t,"hexOut",[]),ae($t,"onePassHasher",new $t),bo=$t}),wo={};yt(wo,{createHash:()=>il,createHmac:()=>ol,randomBytes:()=>sl});function sl(r){return Fe.getRandomValues(oe.alloc(r))}function il(r){if(r==="sha256")return{update:b(function(e){return{digest:b(function(){return oe.from(On(e))},"digest")}},"update")};if(r==="md5")return{update:b(function(e){return{digest:b(function(){return typeof e=="string"?bo.hashStr(e):bo.hashByteArray(e)},"digest")}},"update")};throw new Error(`Hash type '${r}' not supported`)}function ol(r,e){if(r!=="sha256")throw new Error(`Only sha256 is supported (requested: '${r}')`);return{update:b(function(t){return{digest:b(function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));let n=e.length;if(n>64)e=On(e);else if(n<64){let u=new Uint8Array(64);u.set(e),e=u}let s=new Uint8Array(64),i=new Uint8Array(64);for(let u=0;u<64;u++)s[u]=54^e[u],i[u]=92^e[u];let o=new Uint8Array(t.length+64);o.set(s,0),o.set(t,64);let a=new Uint8Array(96);return a.set(i,0),a.set(On(o),64),oe.from(On(a))},"digest")}},"update")}}var al=Xe(()=>{"use strict";te(),cy(),uy(),b(sl,"randomBytes"),b(il,"createHash"),b(ol,"createHmac")}),cl=de(r=>{"use strict";te(),r.parse=function(s,i){return new t(s,i).parse()};var e=class ul{constructor(i,o){this.source=i,this.transform=o||n,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var i=this.source[this.position++];return i==="\\"?{value:this.source[this.position++],escaped:!0}:{value:i,escaped:!1}}record(i){this.recorded.push(i)}newEntry(i){var o;(this.recorded.length>0||i)&&(o=this.recorded.join(""),o==="NULL"&&!i&&(o=null),o!==null&&(o=this.transform(o)),this.entries.push(o),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var i=this.nextCharacter();if(i.value==="=")break}}parse(i){var o,a,u;for(this.consumeDimensions();!this.isEof();)if(o=this.nextCharacter(),o.value==="{"&&!u)this.dimension++,this.dimension>1&&(a=new ul(this.source.substr(this.position-1),this.transform),this.entries.push(a.parse(!0)),this.position+=a.position-2);else if(o.value==="}"&&!u){if(this.dimension--,!this.dimension&&(this.newEntry(),i))return this.entries}else o.value==='"'&&!o.escaped?(u&&this.newEntry(!0),u=!u):o.value===","&&!u?this.newEntry():this.record(o.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};b(e,"ArrayParser");var t=e;function n(s){return s}b(n,"identity")}),ll=de((r,e)=>{te();var t=cl();e.exports={create:b(function(n,s){return{parse:b(function(){return t.parse(n,s)},"parse")}},"create")}}),ly=de((r,e)=>{"use strict";te();var t=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,n=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,s=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,i=/^-?infinity$/;e.exports=b(function(l){if(i.test(l))return Number(l.replace("i","I"));var d=t.exec(l);if(!d)return o(l)||null;var g=!!d[8],x=parseInt(d[1],10);g&&(x=u(x));var m=parseInt(d[2],10)-1,f=d[3],v=parseInt(d[4],10),w=parseInt(d[5],10),_=parseInt(d[6],10),E=d[7];E=E?1e3*parseFloat(E):0;var R,L=a(l);return L!=null?(R=new Date(Date.UTC(x,m,f,v,w,_,E)),h(x)&&R.setUTCFullYear(x),L!==0&&R.setTime(R.getTime()-L)):(R=new Date(x,m,f,v,w,_,E),h(x)&&R.setFullYear(x)),R},"parseDate");function o(l){var d=n.exec(l);if(d){var g=parseInt(d[1],10),x=!!d[4];x&&(g=u(g));var m=parseInt(d[2],10)-1,f=d[3],v=new Date(g,m,f);return h(g)&&v.setFullYear(g),v}}b(o,"getDate");function a(l){if(l.endsWith("+00"))return 0;var d=s.exec(l.split(" ")[1]);if(d){var g=d[1];if(g==="Z")return 0;var x=g==="-"?-1:1,m=parseInt(d[2],10)*3600+parseInt(d[3]||0,10)*60+parseInt(d[4]||0,10);return m*x*1e3}}b(a,"timeZoneOffset");function u(l){return-(l-1)}b(u,"bcYearToNegativeYear");function h(l){return l>=0&&l<100}b(h,"is0To99")}),fy=de((r,e)=>{te(),e.exports=n;var t=Object.prototype.hasOwnProperty;function n(s){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var a in o)t.call(o,a)&&(s[a]=o[a])}return s}b(n,"extend")}),hy=de((r,e)=>{"use strict";te();var t=fy();e.exports=n;function n(_){if(!(this instanceof n))return new n(_);t(this,w(_))}b(n,"PostgresInterval");var s=["seconds","minutes","hours","days","months","years"];n.prototype.toPostgres=function(){var _=s.filter(this.hasOwnProperty,this);return this.milliseconds&&_.indexOf("seconds")<0&&_.push("seconds"),_.length===0?"0":_.map(function(E){var R=this[E]||0;return E==="seconds"&&this.milliseconds&&(R=(R+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),R+" "+E},this).join(" ")};var i={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},o=["years","months","days"],a=["hours","minutes","seconds"];n.prototype.toISOString=n.prototype.toISO=function(){var _=o.map(R,this).join(""),E=a.map(R,this).join("");return"P"+_+"T"+E;function R(L){var S=this[L]||0;return L==="seconds"&&this.milliseconds&&(S=(S+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),S+i[L]}};var u="([+-]?\\d+)",h=u+"\\s+years?",l=u+"\\s+mons?",d=u+"\\s+days?",g="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",x=new RegExp([h,l,d,g].map(function(_){return"("+_+")?"}).join("\\s*")),m={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},f=["hours","minutes","seconds","milliseconds"];function v(_){var E=_+"000000".slice(_.length);return parseInt(E,10)/1e3}b(v,"parseMilliseconds");function w(_){if(!_)return{};var E=x.exec(_),R=E[8]==="-";return Object.keys(m).reduce(function(L,S){var O=m[S],I=E[O];return!I||(I=S==="milliseconds"?v(I):parseInt(I,10),!I)||(R&&~f.indexOf(S)&&(I*=-1),L[S]=I),L},{})}b(w,"parse")}),dy=de((r,e)=>{"use strict";te(),e.exports=b(function(t){if(/^\\x/.test(t))return new oe(t.substr(2),"hex");for(var n="",s=0;s<t.length;)if(t[s]!=="\\")n+=t[s],++s;else if(/[0-7]{3}/.test(t.substr(s+1,3)))n+=String.fromCharCode(parseInt(t.substr(s+1,3),8)),s+=4;else{for(var i=1;s+i<t.length&&t[s+i]==="\\";)i++;for(var o=0;o<Math.floor(i/2);++o)n+="\\";s+=Math.floor(i/2)*2}return new oe(n,"binary")},"parseBytea")}),py=de((r,e)=>{te();var t=cl(),n=ll(),s=ly(),i=hy(),o=dy();function a(C){return b(function(M){return M===null?M:C(M)},"nullAllowed")}b(a,"allowNull");function u(C){return C===null?C:C==="TRUE"||C==="t"||C==="true"||C==="y"||C==="yes"||C==="on"||C==="1"}b(u,"parseBool");function h(C){return C?t.parse(C,u):null}b(h,"parseBoolArray");function l(C){return parseInt(C,10)}b(l,"parseBaseTenInt");function d(C){return C?t.parse(C,a(l)):null}b(d,"parseIntegerArray");function g(C){return C?t.parse(C,a(function(M){return R(M).trim()})):null}b(g,"parseBigIntegerArray");var x=b(function(C){if(!C)return null;var M=n.create(C,function($){return $!==null&&($=S($)),$});return M.parse()},"parsePointArray"),m=b(function(C){if(!C)return null;var M=n.create(C,function($){return $!==null&&($=parseFloat($)),$});return M.parse()},"parseFloatArray"),f=b(function(C){if(!C)return null;var M=n.create(C);return M.parse()},"parseStringArray"),v=b(function(C){if(!C)return null;var M=n.create(C,function($){return $!==null&&($=s($)),$});return M.parse()},"parseDateArray"),w=b(function(C){if(!C)return null;var M=n.create(C,function($){return $!==null&&($=i($)),$});return M.parse()},"parseIntervalArray"),_=b(function(C){return C?t.parse(C,a(o)):null},"parseByteAArray"),E=b(function(C){return parseInt(C,10)},"parseInteger"),R=b(function(C){var M=String(C);return/^\d+$/.test(M)?M:C},"parseBigInteger"),L=b(function(C){return C?t.parse(C,a(JSON.parse)):null},"parseJsonArray"),S=b(function(C){return C[0]!=="("?null:(C=C.substring(1,C.length-1).split(","),{x:parseFloat(C[0]),y:parseFloat(C[1])})},"parsePoint"),O=b(function(C){if(C[0]!=="<"&&C[1]!=="(")return null;for(var M="(",$="",Z=!1,X=2;X<C.length-1;X++){if(Z||(M+=C[X]),C[X]===")"){Z=!0;continue}else if(!Z)continue;C[X]!==","&&($+=C[X])}var k=S(M);return k.radius=parseFloat($),k},"parseCircle"),I=b(function(C){C(20,R),C(21,E),C(23,E),C(26,E),C(700,parseFloat),C(701,parseFloat),C(16,u),C(1082,s),C(1114,s),C(1184,s),C(600,S),C(651,f),C(718,O),C(1e3,h),C(1001,_),C(1005,d),C(1007,d),C(1028,d),C(1016,g),C(1017,x),C(1021,m),C(1022,m),C(1231,m),C(1014,f),C(1015,f),C(1008,f),C(1009,f),C(1040,f),C(1041,f),C(1115,v),C(1182,v),C(1185,v),C(1186,i),C(1187,w),C(17,o),C(114,JSON.parse.bind(JSON)),C(3802,JSON.parse.bind(JSON)),C(199,L),C(3807,L),C(3907,f),C(2951,f),C(791,f),C(1183,f),C(1270,f)},"init");e.exports={init:I}}),my=de((r,e)=>{"use strict";te();var t=1e6;function n(s){var i=s.readInt32BE(0),o=s.readUInt32BE(4),a="";i<0&&(i=~i+(o===0),o=~o+1>>>0,a="-");var u="",h,l,d,g,x,m;{if(h=i%t,i=i/t>>>0,l=4294967296*h+o,o=l/t>>>0,d=""+(l-t*o),o===0&&i===0)return a+d+u;for(g="",x=6-d.length,m=0;m<x;m++)g+="0";u=g+d+u}{if(h=i%t,i=i/t>>>0,l=4294967296*h+o,o=l/t>>>0,d=""+(l-t*o),o===0&&i===0)return a+d+u;for(g="",x=6-d.length,m=0;m<x;m++)g+="0";u=g+d+u}{if(h=i%t,i=i/t>>>0,l=4294967296*h+o,o=l/t>>>0,d=""+(l-t*o),o===0&&i===0)return a+d+u;for(g="",x=6-d.length,m=0;m<x;m++)g+="0";u=g+d+u}return h=i%t,l=4294967296*h+o,d=""+l%t,a+d+u}b(n,"readInt8"),e.exports=n}),gy=de((r,e)=>{te();var t=my(),n=b(function(f,v,w,_,E){w=w||0,_=_||!1,E=E||function(Z,X,k){return Z*Math.pow(2,k)+X};var R=w>>3,L=b(function(Z){return _?~Z&255:Z},"inv"),S=255,O=8-w%8;v<O&&(S=255<<8-v&255,O=v),w&&(S=S>>w%8);var I=0;w%8+v>=8&&(I=E(0,L(f[R])&S,O));for(var C=v+w>>3,M=R+1;M<C;M++)I=E(I,L(f[M]),8);var $=(v+w)%8;return $>0&&(I=E(I,L(f[C])>>8-$,$)),I},"parseBits"),s=b(function(f,v,w){var _=Math.pow(2,w-1)-1,E=n(f,1),R=n(f,w,1);if(R===0)return 0;var L=1,S=b(function(I,C,M){I===0&&(I=1);for(var $=1;$<=M;$++)L/=2,(C&1<<M-$)>0&&(I+=L);return I},"parsePrecisionBits"),O=n(f,v,w+1,!1,S);return R==Math.pow(2,w+1)-1?O===0?E===0?1/0:-1/0:NaN:(E===0?1:-1)*Math.pow(2,R-_)*O},"parseFloatFromBits"),i=b(function(f){return n(f,1)==1?-1*(n(f,15,1,!0)+1):n(f,15,1)},"parseInt16"),o=b(function(f){return n(f,1)==1?-1*(n(f,31,1,!0)+1):n(f,31,1)},"parseInt32"),a=b(function(f){return s(f,23,8)},"parseFloat32"),u=b(function(f){return s(f,52,11)},"parseFloat64"),h=b(function(f){var v=n(f,16,32);if(v==49152)return NaN;for(var w=Math.pow(1e4,n(f,16,16)),_=0,E=[],R=n(f,16),L=0;L<R;L++)_+=n(f,16,64+16*L)*w,w/=1e4;var S=Math.pow(10,n(f,16,48));return(v===0?1:-1)*Math.round(_*S)/S},"parseNumeric"),l=b(function(f,v){var w=n(v,1),_=n(v,63,1),E=new Date((w===0?1:-1)*_/1e3+9466848e5);return f||E.setTime(E.getTime()+E.getTimezoneOffset()*6e4),E.usec=_%1e3,E.getMicroSeconds=function(){return this.usec},E.setMicroSeconds=function(R){this.usec=R},E.getUTCMicroSeconds=function(){return this.usec},E},"parseDate"),d=b(function(f){for(var v=n(f,32),w=n(f,32,32),_=n(f,32,64),E=96,R=[],L=0;L<v;L++)R[L]=n(f,32,E),E+=32,E+=32;var S=b(function(I){var C=n(f,32,E);if(E+=32,C==4294967295)return null;var M;if(I==23||I==20)return M=n(f,C*8,E),E+=C*8,M;if(I==25)return M=f.toString(this.encoding,E>>3,(E+=C<<3)>>3),M;console.log("ERROR: ElementType not implemented: "+I)},"parseElement"),O=b(function(I,C){var M=[],$;if(I.length>1){var Z=I.shift();for($=0;$<Z;$++)M[$]=O(I,C);I.unshift(Z)}else for($=0;$<I[0];$++)M[$]=S(C);return M},"parse");return O(R,_)},"parseArray"),g=b(function(f){return f.toString("utf8")},"parseText"),x=b(function(f){return f===null?null:n(f,8)>0},"parseBool"),m=b(function(f){f(20,t),f(21,i),f(23,o),f(26,o),f(1700,h),f(700,a),f(701,u),f(16,x),f(1114,l.bind(null,!1)),f(1184,l.bind(null,!0)),f(1e3,d),f(1007,d),f(1016,d),f(1008,d),f(1009,d),f(25,g)},"init");e.exports={init:m}}),yy=de((r,e)=>{te(),e.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),Ls=de(r=>{te();var e=py(),t=gy(),n=ll(),s=yy();r.getTypeParser=a,r.setTypeParser=u,r.arrayParser=n,r.builtins=s;var i={text:{},binary:{}};function o(h){return String(h)}b(o,"noParse");function a(h,l){return l=l||"text",i[l]&&i[l][h]||o}b(a,"getTypeParser");function u(h,l,d){typeof l=="function"&&(d=l,l="text"),i[l][h]=d}b(u,"setTypeParser"),e.init(function(h,l){i.text[h]=l}),t.init(function(h,l){i.binary[h]=l})}),ks=de((r,e)=>{"use strict";te(),e.exports={host:"localhost",user:he.platform==="win32"?he.env.USERNAME:he.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var t=Ls(),n=t.getTypeParser(20,"text"),s=t.getTypeParser(1016,"text");e.exports.__defineSetter__("parseInt8",function(i){t.setTypeParser(20,"text",i?t.getTypeParser(23,"text"):n),t.setTypeParser(1016,"text",i?t.getTypeParser(1007,"text"):s)})}),$s=de((r,e)=>{"use strict";te();var t=(al(),qe(wo)),n=ks();function s(m){var f=m.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+f+'"'}b(s,"escapeElement");function i(m){for(var f="{",v=0;v<m.length;v++)v>0&&(f=f+","),m[v]===null||typeof m[v]>"u"?f=f+"NULL":Array.isArray(m[v])?f=f+i(m[v]):m[v]instanceof oe?f+="\\\\x"+m[v].toString("hex"):f+=s(o(m[v]));return f=f+"}",f}b(i,"arrayString");var o=b(function(m,f){if(m==null)return null;if(m instanceof oe)return m;if(ArrayBuffer.isView(m)){var v=oe.from(m.buffer,m.byteOffset,m.byteLength);return v.length===m.byteLength?v:v.slice(m.byteOffset,m.byteOffset+m.byteLength)}return m instanceof Date?n.parseInputDatesAsUTC?l(m):h(m):Array.isArray(m)?i(m):typeof m=="object"?a(m,f):m.toString()},"prepareValue");function a(m,f){if(m&&typeof m.toPostgres=="function"){if(f=f||[],f.indexOf(m)!==-1)throw new Error('circular reference detected while preparing "'+m+'" for query');return f.push(m),o(m.toPostgres(o),f)}return JSON.stringify(m)}b(a,"prepareObject");function u(m,f){for(m=""+m;m.length<f;)m="0"+m;return m}b(u,"pad");function h(m){var f=-m.getTimezoneOffset(),v=m.getFullYear(),w=v<1;w&&(v=Math.abs(v)+1);var _=u(v,4)+"-"+u(m.getMonth()+1,2)+"-"+u(m.getDate(),2)+"T"+u(m.getHours(),2)+":"+u(m.getMinutes(),2)+":"+u(m.getSeconds(),2)+"."+u(m.getMilliseconds(),3);return f<0?(_+="-",f*=-1):_+="+",_+=u(Math.floor(f/60),2)+":"+u(f%60,2),w&&(_+=" BC"),_}b(h,"dateToString");function l(m){var f=m.getUTCFullYear(),v=f<1;v&&(f=Math.abs(f)+1);var w=u(f,4)+"-"+u(m.getUTCMonth()+1,2)+"-"+u(m.getUTCDate(),2)+"T"+u(m.getUTCHours(),2)+":"+u(m.getUTCMinutes(),2)+":"+u(m.getUTCSeconds(),2)+"."+u(m.getUTCMilliseconds(),3);return w+="+00:00",v&&(w+=" BC"),w}b(l,"dateToStringUTC");function d(m,f,v){return m=typeof m=="string"?{text:m}:m,f&&(typeof f=="function"?m.callback=f:m.values=f),v&&(m.callback=v),m}b(d,"normalizeQueryConfig");var g=b(function(m){return t.createHash("md5").update(m,"utf-8").digest("hex")},"md5"),x=b(function(m,f,v){var w=g(f+m),_=g(oe.concat([oe.from(w),v]));return"md5"+_},"postgresMd5PasswordHash");e.exports={prepareValue:b(function(m){return o(m)},"prepareValueWrapper"),normalizeQueryConfig:d,postgresMd5PasswordHash:x,md5:g}}),by=de((r,e)=>{"use strict";te();var t=(al(),qe(wo));function n(f){if(f.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let v=t.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:v,response:"n,,n=*,r="+v,message:"SASLInitialResponse"}}b(n,"startSession");function s(f,v,w){if(f.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof v!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof w!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let _=h(w);if(_.nonce.startsWith(f.clientNonce)){if(_.nonce.length===f.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var E=oe.from(_.salt,"base64"),R=m(v,E,_.iteration),L=x(R,"Client Key"),S=g(L),O="n=*,r="+f.clientNonce,I="r="+_.nonce+",s="+_.salt+",i="+_.iteration,C="c=biws,r="+_.nonce,M=O+","+I+","+C,$=x(S,M),Z=d(L,$),X=Z.toString("base64"),k=x(R,"Server Key"),Q=x(k,M);f.message="SASLResponse",f.serverSignature=Q.toString("base64"),f.response=C+",p="+X}b(s,"continueSession");function i(f,v){if(f.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof v!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:w}=l(v);if(w!==f.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}b(i,"finalizeSession");function o(f){if(typeof f!="string")throw new TypeError("SASL: text must be a string");return f.split("").map((v,w)=>f.charCodeAt(w)).every(v=>v>=33&&v<=43||v>=45&&v<=126)}b(o,"isPrintableChars");function a(f){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(f)}b(a,"isBase64");function u(f){if(typeof f!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(f.split(",").map(v=>{if(!/^.=/.test(v))throw new Error("SASL: Invalid attribute pair entry");let w=v[0],_=v.substring(2);return[w,_]}))}b(u,"parseAttributePairs");function h(f){let v=u(f),w=v.get("r");if(w){if(!o(w))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let _=v.get("s");if(_){if(!a(_))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let E=v.get("i");if(E){if(!/^[1-9][0-9]*$/.test(E))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let R=parseInt(E,10);return{nonce:w,salt:_,iteration:R}}b(h,"parseServerFirstMessage");function l(f){let v=u(f).get("v");if(v){if(!a(v))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:v}}b(l,"parseServerFinalMessage");function d(f,v){if(!oe.isBuffer(f))throw new TypeError("first argument must be a Buffer");if(!oe.isBuffer(v))throw new TypeError("second argument must be a Buffer");if(f.length!==v.length)throw new Error("Buffer lengths must match");if(f.length===0)throw new Error("Buffers cannot be empty");return oe.from(f.map((w,_)=>f[_]^v[_]))}b(d,"xorBuffers");function g(f){return t.createHash("sha256").update(f).digest()}b(g,"sha256");function x(f,v){return t.createHmac("sha256",f).update(v).digest()}b(x,"hmacSha256");function m(f,v,w){for(var _=x(f,oe.concat([v,oe.from([0,0,0,1])])),E=_,R=0;R<w-1;R++)_=x(f,_),E=d(E,_);return E}b(m,"Hi"),e.exports={startSession:n,continueSession:s,finalizeSession:i}}),_o={};yt(_o,{join:()=>fl});function fl(...r){return r.join("/")}var hl=Xe(()=>{"use strict";te(),b(fl,"join")}),So={};yt(So,{stat:()=>dl});function dl(r,e){e(new Error("No filesystem"))}var pl=Xe(()=>{"use strict";te(),b(dl,"stat")}),Eo={};yt(Eo,{default:()=>ml});var ml,gl=Xe(()=>{"use strict";te(),ml={}}),yl={};yt(yl,{StringDecoder:()=>bl});var go,bl,xy=Xe(()=>{"use strict";te(),go=class{constructor(e){ae(this,"td"),this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}},b(go,"StringDecoder"),bl=go}),vy=de((r,e)=>{"use strict";te();var{Transform:t}=(gl(),qe(Eo)),{StringDecoder:n}=(xy(),qe(yl)),s=Symbol("last"),i=Symbol("decoder");function o(d,g,x){let m;if(this.overflow){if(m=this[i].write(d).split(this.matcher),m.length===1)return x();m.shift(),this.overflow=!1}else this[s]+=this[i].write(d),m=this[s].split(this.matcher);this[s]=m.pop();for(let f=0;f<m.length;f++)try{u(this,this.mapper(m[f]))}catch(v){return x(v)}if(this.overflow=this[s].length>this.maxLength,this.overflow&&!this.skipOverflow){x(new Error("maximum buffer reached"));return}x()}b(o,"transform");function a(d){if(this[s]+=this[i].end(),this[s])try{u(this,this.mapper(this[s]))}catch(g){return d(g)}d()}b(a,"flush");function u(d,g){g!==void 0&&d.push(g)}b(u,"push");function h(d){return d}b(h,"noop");function l(d,g,x){switch(d=d||/\r?\n/,g=g||h,x=x||{},arguments.length){case 1:typeof d=="function"?(g=d,d=/\r?\n/):typeof d=="object"&&!(d instanceof RegExp)&&!d[Symbol.split]&&(x=d,d=/\r?\n/);break;case 2:typeof d=="function"?(x=g,g=d,d=/\r?\n/):typeof g=="object"&&(x=g,g=h)}x=Object.assign({},x),x.autoDestroy=!0,x.transform=o,x.flush=a,x.readableObjectMode=!0;let m=new t(x);return m[s]="",m[i]=new n("utf8"),m.matcher=d,m.mapper=g,m.maxLength=x.maxLength,m.skipOverflow=x.skipOverflow||!1,m.overflow=!1,m._destroy=function(f,v){this._writableState.errorEmitted=!1,v(f)},m}b(l,"split"),e.exports=l}),wy=de((r,e)=>{"use strict";te();var t=(hl(),qe(_o)),n=(gl(),qe(Eo)).Stream,s=vy(),i=(Rs(),qe(Pn)),o=5432,a=he.platform==="win32",u=he.stderr,h=56,l=7,d=61440,g=32768;function x(L){return(L&d)==g}b(x,"isRegFile");var m=["host","port","database","user","password"],f=m.length,v=m[f-1];function w(){var L=u instanceof n&&u.writable===!0;if(L){var S=Array.prototype.slice.call(arguments).concat(`
`);u.write(i.format.apply(i,S))}}b(w,"warn"),Object.defineProperty(e.exports,"isWin",{get:b(function(){return a},"get"),set:b(function(L){a=L},"set")}),e.exports.warnTo=function(L){var S=u;return u=L,S},e.exports.getFileName=function(L){var S=L||he.env,O=S.PGPASSFILE||(a?t.join(S.APPDATA||"./","postgresql","pgpass.conf"):t.join(S.HOME||"./",".pgpass"));return O},e.exports.usePgPass=function(L,S){return Object.prototype.hasOwnProperty.call(he.env,"PGPASSWORD")?!1:a?!0:(S=S||"<unkn>",x(L.mode)?L.mode&(h|l)?(w('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',S),!1):!0:(w('WARNING: password file "%s" is not a plain file',S),!1))};var _=e.exports.match=function(L,S){return m.slice(0,-1).reduce(function(O,I,C){return C==1&&Number(L[I]||o)===Number(S[I])?O&&!0:O&&(S[I]==="*"||S[I]===L[I])},!0)};e.exports.getPassword=function(L,S,O){var I,C=S.pipe(s());function M(X){var k=E(X);k&&R(k)&&_(L,k)&&(I=k[v],C.end())}b(M,"onLine");var $=b(function(){S.destroy(),O(I)},"onEnd"),Z=b(function(X){S.destroy(),w("WARNING: error on reading file: %s",X),O(void 0)},"onErr");S.on("error",Z),C.on("data",M).on("end",$).on("error",Z)};var E=e.exports.parseLine=function(L){if(L.length<11||L.match(/^\s+#/))return null;for(var S="",O="",I=0,C=0,M=0,$={},Z=!1,X=b(function(Q,ee,ce){var ge=L.substring(ee,ce);Object.hasOwnProperty.call(he.env,"PGPASS_NO_DEESCAPE")||(ge=ge.replace(/\\([:\\])/g,"$1")),$[m[Q]]=ge},"addToObj"),k=0;k<L.length-1;k+=1){if(S=L.charAt(k+1),O=L.charAt(k),Z=I==f-1,Z){X(I,C);break}k>=0&&S==":"&&O!=="\\"&&(X(I,C,k+1),C=k+2,I+=1)}return $=Object.keys($).length===f?$:null,$},R=e.exports.isValidEntry=function(L){for(var S={0:function($){return $.length>0},1:function($){return $==="*"?!0:($=Number($),isFinite($)&&$>0&&$<9007199254740992&&Math.floor($)===$)},2:function($){return $.length>0},3:function($){return $.length>0},4:function($){return $.length>0}},O=0;O<m.length;O+=1){var I=S[O],C=L[m[O]]||"",M=I(C);if(!M)return!1}return!0}}),_y=de((r,e)=>{"use strict";te();var t=(hl(),qe(_o)),n=(pl(),qe(So)),s=wy();e.exports=function(i,o){var a=s.getFileName();n.stat(a,function(u,h){if(u||!s.usePgPass(h,a))return o(void 0);var l=n.createReadStream(a);s.getPassword(i,l,o)})},e.exports.warnTo=s.warnTo}),To=de((r,e)=>{"use strict";te();var t=Ls();function n(s){this._types=s||t,this.text={},this.binary={}}b(n,"TypeOverrides"),n.prototype.getOverrides=function(s){switch(s){case"text":return this.text;case"binary":return this.binary;default:return{}}},n.prototype.setTypeParser=function(s,i,o){typeof i=="function"&&(o=i,i="text"),this.getOverrides(i)[s]=o},n.prototype.getTypeParser=function(s,i){return i=i||"text",this.getOverrides(i)[s]||this._types.getTypeParser(s,i)},e.exports=n}),xl={};yt(xl,{default:()=>vl});var vl,Sy=Xe(()=>{"use strict";te(),vl={}}),wl={};yt(wl,{parse:()=>Co});function Co(r,e=!1){let{protocol:t}=new URL(r),n="http:"+r.substring(t.length),{username:s,password:i,host:o,hostname:a,port:u,pathname:h,search:l,searchParams:d,hash:g}=new URL(n);i=decodeURIComponent(i),s=decodeURIComponent(s),h=decodeURIComponent(h);let x=s+":"+i,m=e?Object.fromEntries(d.entries()):l;return{href:r,protocol:t,auth:x,username:s,password:i,host:o,hostname:a,port:u,pathname:h,search:l,query:m,hash:g}}var _l=Xe(()=>{"use strict";te(),b(Co,"parse")}),Ey=de((r,e)=>{"use strict";te();var t=(_l(),qe(wl)),n=(pl(),qe(So));function s(i){if(i.charAt(0)==="/"){var a=i.split(" ");return{host:a[0],database:a[1]}}var o=t.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(i)?encodeURI(i).replace(/\%25(\d\d)/g,"%$1"):i,!0),a=o.query;for(var u in a)Array.isArray(a[u])&&(a[u]=a[u][a[u].length-1]);var h=(o.auth||":").split(":");if(a.user=h[0],a.password=h.splice(1).join(":"),a.port=o.port,o.protocol=="socket:")return a.host=decodeURI(o.pathname),a.database=o.query.db,a.client_encoding=o.query.encoding,a;a.host||(a.host=o.hostname);var l=o.pathname;if(!a.host&&l&&/^%2f/i.test(l)){var d=l.split("/");a.host=decodeURIComponent(d[0]),l=d.splice(1).join("/")}switch(l&&l.charAt(0)==="/"&&(l=l.slice(1)||null),a.database=l&&decodeURI(l),(a.ssl==="true"||a.ssl==="1")&&(a.ssl=!0),a.ssl==="0"&&(a.ssl=!1),(a.sslcert||a.sslkey||a.sslrootcert||a.sslmode)&&(a.ssl={}),a.sslcert&&(a.ssl.cert=n.readFileSync(a.sslcert).toString()),a.sslkey&&(a.ssl.key=n.readFileSync(a.sslkey).toString()),a.sslrootcert&&(a.ssl.ca=n.readFileSync(a.sslrootcert).toString()),a.sslmode){case"disable":{a.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{a.ssl.rejectUnauthorized=!1;break}}return a}b(s,"parse"),e.exports=s,s.parse=s}),No=de((r,e)=>{"use strict";te();var t=(Sy(),qe(xl)),n=ks(),s=Ey().parse,i=b(function(d,g,x){return x===void 0?x=he.env["PG"+d.toUpperCase()]:x===!1||(x=he.env[x]),g[d]||x||n[d]},"val"),o=b(function(){switch(he.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return n.ssl},"readSSLConfigFromEnvironment"),a=b(function(d){return"'"+(""+d).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),u=b(function(d,g,x){var m=g[x];m!=null&&d.push(x+"="+a(m))},"add"),h=class{constructor(g){g=typeof g=="string"?s(g):g||{},g.connectionString&&(g=Object.assign({},g,s(g.connectionString))),this.user=i("user",g),this.database=i("database",g),this.database===void 0&&(this.database=this.user),this.port=parseInt(i("port",g),10),this.host=i("host",g),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:i("password",g)}),this.binary=i("binary",g),this.options=i("options",g),this.ssl=typeof g.ssl>"u"?o():g.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=i("client_encoding",g),this.replication=i("replication",g),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=i("application_name",g,"PGAPPNAME"),this.fallback_application_name=i("fallback_application_name",g,!1),this.statement_timeout=i("statement_timeout",g,!1),this.lock_timeout=i("lock_timeout",g,!1),this.idle_in_transaction_session_timeout=i("idle_in_transaction_session_timeout",g,!1),this.query_timeout=i("query_timeout",g,!1),g.connectionTimeoutMillis===void 0?this.connect_timeout=he.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(g.connectionTimeoutMillis/1e3),g.keepAlive===!1?this.keepalives=0:g.keepAlive===!0&&(this.keepalives=1),typeof g.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(g.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(g){var x=[];u(x,this,"user"),u(x,this,"password"),u(x,this,"port"),u(x,this,"application_name"),u(x,this,"fallback_application_name"),u(x,this,"connect_timeout"),u(x,this,"options");var m=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(u(x,m,"sslmode"),u(x,m,"sslca"),u(x,m,"sslkey"),u(x,m,"sslcert"),u(x,m,"sslrootcert"),this.database&&x.push("dbname="+a(this.database)),this.replication&&x.push("replication="+a(this.replication)),this.host&&x.push("host="+a(this.host)),this.isDomainSocket)return g(null,x.join(" "));this.client_encoding&&x.push("client_encoding="+a(this.client_encoding)),t.lookup(this.host,function(f,v){return f?g(f,null):(x.push("hostaddr="+a(v)),g(null,x.join(" ")))})}};b(h,"ConnectionParameters");var l=h;e.exports=l}),Ty=de((r,e)=>{"use strict";te();var t=Ls(),n=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,s=class{constructor(a,u){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=u,this.RowCtor=null,this.rowAsArray=a==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(a){var u;a.text?u=n.exec(a.text):u=n.exec(a.command),u&&(this.command=u[1],u[3]?(this.oid=parseInt(u[2],10),this.rowCount=parseInt(u[3],10)):u[2]&&(this.rowCount=parseInt(u[2],10)))}_parseRowAsArray(a){for(var u=new Array(a.length),h=0,l=a.length;h<l;h++){var d=a[h];d!==null?u[h]=this._parsers[h](d):u[h]=null}return u}parseRow(a){for(var u={},h=0,l=a.length;h<l;h++){var d=a[h],g=this.fields[h].name;d!==null?u[g]=this._parsers[h](d):u[g]=null}return u}addRow(a){this.rows.push(a)}addFields(a){this.fields=a,this.fields.length&&(this._parsers=new Array(a.length));for(var u=0;u<a.length;u++){var h=a[u];this._types?this._parsers[u]=this._types.getTypeParser(h.dataTypeID,h.format||"text"):this._parsers[u]=t.getTypeParser(h.dataTypeID,h.format||"text")}}};b(s,"Result");var i=s;e.exports=i}),Cy=de((r,e)=>{"use strict";te();var{EventEmitter:t}=dr(),n=Ty(),s=$s(),i=class extends t{constructor(u,h,l){super(),u=s.normalizeQueryConfig(u,h,l),this.text=u.text,this.values=u.values,this.rows=u.rows,this.types=u.types,this.name=u.name,this.binary=u.binary,this.portal=u.portal||"",this.callback=u.callback,this._rowMode=u.rowMode,he.domain&&u.callback&&(this.callback=he.domain.bind(u.callback)),this._result=new n(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new n(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(u){this._checkForMultirow(),this._result.addFields(u.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(u){let h;if(!this._canceledDueToError){try{h=this._result.parseRow(u.fields)}catch(l){this._canceledDueToError=l;return}this.emit("row",h,this._result),this._accumulateRows&&this._result.addRow(h)}}handleCommandComplete(u,h){this._checkForMultirow(),this._result.addCommandComplete(u),this.rows&&h.sync()}handleEmptyQuery(u){this.rows&&u.sync()}handleError(u,h){if(this._canceledDueToError&&(u=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(u);this.emit("error",u)}handleReadyForQuery(u){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,u);if(this.callback)try{this.callback(null,this._results)}catch(h){he.nextTick(()=>{throw h})}this.emit("end",this._results)}submit(u){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let h=u.parsedStatements[this.name];return this.text&&h&&this.text!==h?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(u):u.query(this.text),null)}hasBeenParsed(u){return this.name&&u.parsedStatements[this.name]}handlePortalSuspended(u){this._getRows(u,this.rows)}_getRows(u,h){u.execute({portal:this.portal,rows:h}),h?u.flush():u.sync()}prepare(u){this.isPreparedStatement=!0,this.hasBeenParsed(u)||u.parse({text:this.text,name:this.name,types:this.types});try{u.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:s.prepareValue})}catch(h){this.handleError(h,u);return}u.describe({type:"P",name:this.portal||""}),this._getRows(u,this.rows)}handleCopyInResponse(u){u.sendCopyFail("No source stream defined")}handleCopyData(u,h){}};b(i,"Query");var o=i;e.exports=o}),Sl={};yt(Sl,{Socket:()=>Bt,isIP:()=>El});function El(r){return 0}var Yu,yo,In,Bt,Ao=Xe(()=>{"use strict";te(),Yu=Wr(dr(),1),b(El,"isIP"),yo=/^[^.]+\./,In=class re extends Yu.EventEmitter{constructor(){super(...arguments),ae(this,"opts",{}),ae(this,"connecting",!1),ae(this,"pending",!0),ae(this,"writable",!0),ae(this,"encrypted",!1),ae(this,"authorized",!1),ae(this,"destroyed",!1),ae(this,"ws",null),ae(this,"writeBuffer"),ae(this,"tlsState",0),ae(this,"tlsRead"),ae(this,"tlsWrite")}static get poolQueryViaFetch(){return re.opts.poolQueryViaFetch??re.defaults.poolQueryViaFetch}static set poolQueryViaFetch(e){re.opts.poolQueryViaFetch=e}static get fetchEndpoint(){return re.opts.fetchEndpoint??re.defaults.fetchEndpoint}static set fetchEndpoint(e){re.opts.fetchEndpoint=e}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return re.opts.fetchFunction??re.defaults.fetchFunction}static set fetchFunction(e){re.opts.fetchFunction=e}static get webSocketConstructor(){return re.opts.webSocketConstructor??re.defaults.webSocketConstructor}static set webSocketConstructor(e){re.opts.webSocketConstructor=e}get webSocketConstructor(){return this.opts.webSocketConstructor??re.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return re.opts.wsProxy??re.defaults.wsProxy}static set wsProxy(e){re.opts.wsProxy=e}get wsProxy(){return this.opts.wsProxy??re.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return re.opts.coalesceWrites??re.defaults.coalesceWrites}static set coalesceWrites(e){re.opts.coalesceWrites=e}get coalesceWrites(){return this.opts.coalesceWrites??re.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return re.opts.useSecureWebSocket??re.defaults.useSecureWebSocket}static set useSecureWebSocket(e){re.opts.useSecureWebSocket=e}get useSecureWebSocket(){return this.opts.useSecureWebSocket??re.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return re.opts.forceDisablePgSSL??re.defaults.forceDisablePgSSL}static set forceDisablePgSSL(e){re.opts.forceDisablePgSSL=e}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??re.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return re.opts.disableSNI??re.defaults.disableSNI}static set disableSNI(e){re.opts.disableSNI=e}get disableSNI(){return this.opts.disableSNI??re.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get pipelineConnect(){return re.opts.pipelineConnect??re.defaults.pipelineConnect}static set pipelineConnect(e){re.opts.pipelineConnect=e}get pipelineConnect(){return this.opts.pipelineConnect??re.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return re.opts.subtls??re.defaults.subtls}static set subtls(e){re.opts.subtls=e}get subtls(){return this.opts.subtls??re.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return re.opts.pipelineTLS??re.defaults.pipelineTLS}static set pipelineTLS(e){re.opts.pipelineTLS=e}get pipelineTLS(){return this.opts.pipelineTLS??re.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return re.opts.rootCerts??re.defaults.rootCerts}static set rootCerts(e){re.opts.rootCerts=e}get rootCerts(){return this.opts.rootCerts??re.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,t){let n=this.wsProxy;if(n===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof n=="function"?n(e,t):`${n}?address=${e}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,t,n){this.connecting=!0,n&&this.once("connect",n);let s=b(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),i=b((a,u=!1)=>{a.binaryType="arraybuffer",a.addEventListener("error",h=>{this.emit("error",h),this.emit("close")}),a.addEventListener("message",h=>{if(this.tlsState===0){let l=oe.from(h.data);this.emit("data",l)}}),a.addEventListener("close",()=>{this.emit("close")}),u?s():a.addEventListener("open",s)},"configureWebSocket"),o;try{o=this.wsProxyAddrForHost(t,typeof e=="string"?parseInt(e,10):e)}catch(a){this.emit("error",a),this.emit("close");return}try{let a=(this.useSecureWebSocket?"wss:":"ws:")+"//"+o;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(a),i(this.ws);else try{this.ws=new WebSocket(a),i(this.ws)}catch{this.ws=new __unstable_WebSocket(a),i(this.ws)}}catch(a){let u=(this.useSecureWebSocket?"https:":"http:")+"//"+o;fetch(u,{headers:{Upgrade:"websocket"}}).then(h=>{if(this.ws=h.webSocket,this.ws==null)throw a;this.ws.accept(),i(this.ws,!0)}).catch(h=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${h.message}`)),this.emit("close")})}}async startTls(e){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let t=this.subtls.TrustedCert.fromPEM(this.rootCerts),n=new this.subtls.WebSocketReadQueue(this.ws),s=n.read.bind(n),i=this.rawWrite.bind(this),[o,a]=await this.subtls.startTls(e,t,s,i,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=o,this.tlsWrite=a,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(e===void 0)break;{let t=oe.from(e);this.emit("data",t)}}}rawWrite(e){if(!this.coalesceWrites){this.ws.send(e);return}if(this.writeBuffer===void 0)this.writeBuffer=e,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+e.length);t.set(this.writeBuffer),t.set(e,this.writeBuffer.length),this.writeBuffer=t}}write(e,t="utf8",n=s=>{}){return e.length===0?(n(),!0):(typeof e=="string"&&(e=oe.from(e,t)),this.tlsState===0?(this.rawWrite(e),n()):this.tlsState===1?this.once("secureConnection",()=>{this.write(e,t,n)}):(this.tlsWrite(e),n()),!0)}end(e=oe.alloc(0),t="utf8",n=()=>{}){return this.write(e,t,()=>{this.ws.close(),n()}),this}destroy(){return this.destroyed=!0,this.end()}},b(In,"Socket"),ae(In,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:b((r,e,t)=>{let n;return t?.jwtAuth?n=r.replace(yo,"apiauth."):n=r.replace(yo,"api."),"https://"+n+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:b(r=>r+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),ae(In,"opts",{}),Bt=In}),Tl=de(r=>{"use strict";te(),Object.defineProperty(r,"__esModule",{value:!0}),r.NoticeMessage=r.DataRowMessage=r.CommandCompleteMessage=r.ReadyForQueryMessage=r.NotificationResponseMessage=r.BackendKeyDataMessage=r.AuthenticationMD5Password=r.ParameterStatusMessage=r.ParameterDescriptionMessage=r.RowDescriptionMessage=r.Field=r.CopyResponse=r.CopyDataMessage=r.DatabaseError=r.copyDone=r.emptyQuery=r.replicationStart=r.portalSuspended=r.noData=r.closeComplete=r.bindComplete=r.parseComplete=void 0,r.parseComplete={name:"parseComplete",length:5},r.bindComplete={name:"bindComplete",length:5},r.closeComplete={name:"closeComplete",length:5},r.noData={name:"noData",length:5},r.portalSuspended={name:"portalSuspended",length:5},r.replicationStart={name:"replicationStart",length:4},r.emptyQuery={name:"emptyQuery",length:4},r.copyDone={name:"copyDone",length:4};var e=class extends Error{constructor(k,Q,ee){super(k),this.length=Q,this.name=ee}};b(e,"DatabaseError");var t=e;r.DatabaseError=t;var n=class{constructor(k,Q){this.length=k,this.chunk=Q,this.name="copyData"}};b(n,"CopyDataMessage");var s=n;r.CopyDataMessage=s;var i=class{constructor(k,Q,ee,ce){this.length=k,this.name=Q,this.binary=ee,this.columnTypes=new Array(ce)}};b(i,"CopyResponse");var o=i;r.CopyResponse=o;var a=class{constructor(k,Q,ee,ce,ge,be,Be){this.name=k,this.tableID=Q,this.columnID=ee,this.dataTypeID=ce,this.dataTypeSize=ge,this.dataTypeModifier=be,this.format=Be}};b(a,"Field");var u=a;r.Field=u;var h=class{constructor(k,Q){this.length=k,this.fieldCount=Q,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};b(h,"RowDescriptionMessage");var l=h;r.RowDescriptionMessage=l;var d=class{constructor(k,Q){this.length=k,this.parameterCount=Q,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};b(d,"ParameterDescriptionMessage");var g=d;r.ParameterDescriptionMessage=g;var x=class{constructor(k,Q,ee){this.length=k,this.parameterName=Q,this.parameterValue=ee,this.name="parameterStatus"}};b(x,"ParameterStatusMessage");var m=x;r.ParameterStatusMessage=m;var f=class{constructor(k,Q){this.length=k,this.salt=Q,this.name="authenticationMD5Password"}};b(f,"AuthenticationMD5Password");var v=f;r.AuthenticationMD5Password=v;var w=class{constructor(k,Q,ee){this.length=k,this.processID=Q,this.secretKey=ee,this.name="backendKeyData"}};b(w,"BackendKeyDataMessage");var _=w;r.BackendKeyDataMessage=_;var E=class{constructor(k,Q,ee,ce){this.length=k,this.processId=Q,this.channel=ee,this.payload=ce,this.name="notification"}};b(E,"NotificationResponseMessage");var R=E;r.NotificationResponseMessage=R;var L=class{constructor(k,Q){this.length=k,this.status=Q,this.name="readyForQuery"}};b(L,"ReadyForQueryMessage");var S=L;r.ReadyForQueryMessage=S;var O=class{constructor(k,Q){this.length=k,this.text=Q,this.name="commandComplete"}};b(O,"CommandCompleteMessage");var I=O;r.CommandCompleteMessage=I;var C=class{constructor(k,Q){this.length=k,this.fields=Q,this.name="dataRow",this.fieldCount=Q.length}};b(C,"DataRowMessage");var M=C;r.DataRowMessage=M;var $=class{constructor(k,Q){this.length=k,this.message=Q,this.name="notice"}};b($,"NoticeMessage");var Z=$;r.NoticeMessage=Z}),Ny=de(r=>{"use strict";te(),Object.defineProperty(r,"__esModule",{value:!0}),r.Writer=void 0;var e=class{constructor(s=256){this.size=s,this.offset=5,this.headerPosition=0,this.buffer=oe.allocUnsafe(s)}ensure(s){var i=this.buffer.length-this.offset;if(i<s){var o=this.buffer,a=o.length+(o.length>>1)+s;this.buffer=oe.allocUnsafe(a),o.copy(this.buffer)}}addInt32(s){return this.ensure(4),this.buffer[this.offset++]=s>>>24&255,this.buffer[this.offset++]=s>>>16&255,this.buffer[this.offset++]=s>>>8&255,this.buffer[this.offset++]=s>>>0&255,this}addInt16(s){return this.ensure(2),this.buffer[this.offset++]=s>>>8&255,this.buffer[this.offset++]=s>>>0&255,this}addCString(s){if(!s)this.ensure(1);else{var i=oe.byteLength(s);this.ensure(i+1),this.buffer.write(s,this.offset,"utf-8"),this.offset+=i}return this.buffer[this.offset++]=0,this}addString(s=""){var i=oe.byteLength(s);return this.ensure(i),this.buffer.write(s,this.offset),this.offset+=i,this}add(s){return this.ensure(s.length),s.copy(this.buffer,this.offset),this.offset+=s.length,this}join(s){if(s){this.buffer[this.headerPosition]=s;let i=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(i,this.headerPosition+1)}return this.buffer.slice(s?0:5,this.offset)}flush(s){var i=this.join(s);return this.offset=5,this.headerPosition=0,this.buffer=oe.allocUnsafe(this.size),i}};b(e,"Writer");var t=e;r.Writer=t}),Ay=de(r=>{"use strict";te(),Object.defineProperty(r,"__esModule",{value:!0}),r.serialize=void 0;var e=Ny(),t=new e.Writer,n=b(k=>{t.addInt16(3).addInt16(0);for(let ce of Object.keys(k))t.addCString(ce).addCString(k[ce]);t.addCString("client_encoding").addCString("UTF8");var Q=t.addCString("").flush(),ee=Q.length+4;return new e.Writer().addInt32(ee).add(Q).flush()},"startup"),s=b(()=>{let k=oe.allocUnsafe(8);return k.writeInt32BE(8,0),k.writeInt32BE(80877103,4),k},"requestSsl"),i=b(k=>t.addCString(k).flush(112),"password"),o=b(function(k,Q){return t.addCString(k).addInt32(oe.byteLength(Q)).addString(Q),t.flush(112)},"sendSASLInitialResponseMessage"),a=b(function(k){return t.addString(k).flush(112)},"sendSCRAMClientFinalMessage"),u=b(k=>t.addCString(k).flush(81),"query"),h=[],l=b(k=>{let Q=k.name||"";Q.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",Q,Q.length),console.error("This can cause conflicts and silent errors executing queries"));let ee=k.types||h;for(var ce=ee.length,ge=t.addCString(Q).addCString(k.text).addInt16(ce),be=0;be<ce;be++)ge.addInt32(ee[be]);return t.flush(80)},"parse"),d=new e.Writer,g=b(function(k,Q){for(let ee=0;ee<k.length;ee++){let ce=Q?Q(k[ee],ee):k[ee];ce==null?(t.addInt16(0),d.addInt32(-1)):ce instanceof oe?(t.addInt16(1),d.addInt32(ce.length),d.add(ce)):(t.addInt16(0),d.addInt32(oe.byteLength(ce)),d.addString(ce))}},"writeValues"),x=b((k={})=>{let Q=k.portal||"",ee=k.statement||"",ce=k.binary||!1,ge=k.values||h,be=ge.length;return t.addCString(Q).addCString(ee),t.addInt16(be),g(ge,k.valueMapper),t.addInt16(be),t.add(d.flush()),t.addInt16(ce?1:0),t.flush(66)},"bind"),m=oe.from([69,0,0,0,9,0,0,0,0,0]),f=b(k=>{if(!k||!k.portal&&!k.rows)return m;let Q=k.portal||"",ee=k.rows||0,ce=oe.byteLength(Q),ge=4+ce+1+4,be=oe.allocUnsafe(1+ge);return be[0]=69,be.writeInt32BE(ge,1),be.write(Q,5,"utf-8"),be[ce+5]=0,be.writeUInt32BE(ee,be.length-4),be},"execute"),v=b((k,Q)=>{let ee=oe.allocUnsafe(16);return ee.writeInt32BE(16,0),ee.writeInt16BE(1234,4),ee.writeInt16BE(5678,6),ee.writeInt32BE(k,8),ee.writeInt32BE(Q,12),ee},"cancel"),w=b((k,Q)=>{let ee=4+oe.byteLength(Q)+1,ce=oe.allocUnsafe(1+ee);return ce[0]=k,ce.writeInt32BE(ee,1),ce.write(Q,5,"utf-8"),ce[ee]=0,ce},"cstringMessage"),_=t.addCString("P").flush(68),E=t.addCString("S").flush(68),R=b(k=>k.name?w(68,`${k.type}${k.name||""}`):k.type==="P"?_:E,"describe"),L=b(k=>{let Q=`${k.type}${k.name||""}`;return w(67,Q)},"close"),S=b(k=>t.add(k).flush(100),"copyData"),O=b(k=>w(102,k),"copyFail"),I=b(k=>oe.from([k,0,0,0,4]),"codeOnlyBuffer"),C=I(72),M=I(83),$=I(88),Z=I(99),X={startup:n,password:i,requestSsl:s,sendSASLInitialResponseMessage:o,sendSCRAMClientFinalMessage:a,query:u,parse:l,bind:x,execute:f,describe:R,close:L,flush:b(()=>C,"flush"),sync:b(()=>M,"sync"),end:b(()=>$,"end"),copyData:S,copyDone:b(()=>Z,"copyDone"),copyFail:O,cancel:v};r.serialize=X}),Iy=de(r=>{"use strict";te(),Object.defineProperty(r,"__esModule",{value:!0}),r.BufferReader=void 0;var e=oe.allocUnsafe(0),t=class{constructor(i=0){this.offset=i,this.buffer=e,this.encoding="utf-8"}setBuffer(i,o){this.offset=i,this.buffer=o}int16(){let i=this.buffer.readInt16BE(this.offset);return this.offset+=2,i}byte(){let i=this.buffer[this.offset];return this.offset++,i}int32(){let i=this.buffer.readInt32BE(this.offset);return this.offset+=4,i}string(i){let o=this.buffer.toString(this.encoding,this.offset,this.offset+i);return this.offset+=i,o}cstring(){let i=this.offset,o=i;for(;this.buffer[o++]!==0;);return this.offset=o,this.buffer.toString(this.encoding,i,o-1)}bytes(i){let o=this.buffer.slice(this.offset,this.offset+i);return this.offset+=i,o}};b(t,"BufferReader");var n=t;r.BufferReader=n}),Oy=de(r=>{"use strict";te(),Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var e=Tl(),t=Iy(),n=1,s=4,i=n+s,o=oe.allocUnsafe(0),a=class{constructor(l){if(this.buffer=o,this.bufferLength=0,this.bufferOffset=0,this.reader=new t.BufferReader,l?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=l?.mode||"text"}parse(l,d){this.mergeBuffer(l);let g=this.bufferOffset+this.bufferLength,x=this.bufferOffset;for(;x+i<=g;){let m=this.buffer[x],f=this.buffer.readUInt32BE(x+n),v=n+f;if(v+x<=g){let w=this.handlePacket(x+i,m,f,this.buffer);d(w),x+=v}else break}x===g?(this.buffer=o,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=g-x,this.bufferOffset=x)}mergeBuffer(l){if(this.bufferLength>0){let d=this.bufferLength+l.byteLength;if(d+this.bufferOffset>this.buffer.byteLength){let g;if(d<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)g=this.buffer;else{let x=this.buffer.byteLength*2;for(;d>=x;)x*=2;g=oe.allocUnsafe(x)}this.buffer.copy(g,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=g,this.bufferOffset=0}l.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=d}else this.buffer=l,this.bufferOffset=0,this.bufferLength=l.byteLength}handlePacket(l,d,g,x){switch(d){case 50:return e.bindComplete;case 49:return e.parseComplete;case 51:return e.closeComplete;case 110:return e.noData;case 115:return e.portalSuspended;case 99:return e.copyDone;case 87:return e.replicationStart;case 73:return e.emptyQuery;case 68:return this.parseDataRowMessage(l,g,x);case 67:return this.parseCommandCompleteMessage(l,g,x);case 90:return this.parseReadyForQueryMessage(l,g,x);case 65:return this.parseNotificationMessage(l,g,x);case 82:return this.parseAuthenticationResponse(l,g,x);case 83:return this.parseParameterStatusMessage(l,g,x);case 75:return this.parseBackendKeyData(l,g,x);case 69:return this.parseErrorMessage(l,g,x,"error");case 78:return this.parseErrorMessage(l,g,x,"notice");case 84:return this.parseRowDescriptionMessage(l,g,x);case 116:return this.parseParameterDescriptionMessage(l,g,x);case 71:return this.parseCopyInMessage(l,g,x);case 72:return this.parseCopyOutMessage(l,g,x);case 100:return this.parseCopyData(l,g,x);default:return new e.DatabaseError("received invalid response: "+d.toString(16),g,"error")}}parseReadyForQueryMessage(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.string(1);return new e.ReadyForQueryMessage(d,x)}parseCommandCompleteMessage(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.cstring();return new e.CommandCompleteMessage(d,x)}parseCopyData(l,d,g){let x=g.slice(l,l+(d-4));return new e.CopyDataMessage(d,x)}parseCopyInMessage(l,d,g){return this.parseCopyMessage(l,d,g,"copyInResponse")}parseCopyOutMessage(l,d,g){return this.parseCopyMessage(l,d,g,"copyOutResponse")}parseCopyMessage(l,d,g,x){this.reader.setBuffer(l,g);let m=this.reader.byte()!==0,f=this.reader.int16(),v=new e.CopyResponse(d,x,m,f);for(let w=0;w<f;w++)v.columnTypes[w]=this.reader.int16();return v}parseNotificationMessage(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.int32(),m=this.reader.cstring(),f=this.reader.cstring();return new e.NotificationResponseMessage(d,x,m,f)}parseRowDescriptionMessage(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.int16(),m=new e.RowDescriptionMessage(d,x);for(let f=0;f<x;f++)m.fields[f]=this.parseField();return m}parseField(){let l=this.reader.cstring(),d=this.reader.int32(),g=this.reader.int16(),x=this.reader.int32(),m=this.reader.int16(),f=this.reader.int32(),v=this.reader.int16()===0?"text":"binary";return new e.Field(l,d,g,x,m,f,v)}parseParameterDescriptionMessage(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.int16(),m=new e.ParameterDescriptionMessage(d,x);for(let f=0;f<x;f++)m.dataTypeIDs[f]=this.reader.int32();return m}parseDataRowMessage(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.int16(),m=new Array(x);for(let f=0;f<x;f++){let v=this.reader.int32();m[f]=v===-1?null:this.reader.string(v)}return new e.DataRowMessage(d,m)}parseParameterStatusMessage(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.cstring(),m=this.reader.cstring();return new e.ParameterStatusMessage(d,x,m)}parseBackendKeyData(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.int32(),m=this.reader.int32();return new e.BackendKeyDataMessage(d,x,m)}parseAuthenticationResponse(l,d,g){this.reader.setBuffer(l,g);let x=this.reader.int32(),m={name:"authenticationOk",length:d};switch(x){case 0:break;case 3:m.length===8&&(m.name="authenticationCleartextPassword");break;case 5:if(m.length===12){m.name="authenticationMD5Password";let v=this.reader.bytes(4);return new e.AuthenticationMD5Password(d,v)}break;case 10:m.name="authenticationSASL",m.mechanisms=[];let f;do f=this.reader.cstring(),f&&m.mechanisms.push(f);while(f);break;case 11:m.name="authenticationSASLContinue",m.data=this.reader.string(d-8);break;case 12:m.name="authenticationSASLFinal",m.data=this.reader.string(d-8);break;default:throw new Error("Unknown authenticationOk message type "+x)}return m}parseErrorMessage(l,d,g,x){this.reader.setBuffer(l,g);let m={},f=this.reader.string(1);for(;f!=="\0";)m[f]=this.reader.cstring(),f=this.reader.string(1);let v=m.M,w=x==="notice"?new e.NoticeMessage(d,v):new e.DatabaseError(v,d,x);return w.severity=m.S,w.code=m.C,w.detail=m.D,w.hint=m.H,w.position=m.P,w.internalPosition=m.p,w.internalQuery=m.q,w.where=m.W,w.schema=m.s,w.table=m.t,w.column=m.c,w.dataType=m.d,w.constraint=m.n,w.file=m.F,w.line=m.L,w.routine=m.R,w}};b(a,"Parser");var u=a;r.Parser=u}),Cl=de(r=>{"use strict";te(),Object.defineProperty(r,"__esModule",{value:!0}),r.DatabaseError=r.serialize=r.parse=void 0;var e=Tl();Object.defineProperty(r,"DatabaseError",{enumerable:!0,get:b(function(){return e.DatabaseError},"get")});var t=Ay();Object.defineProperty(r,"serialize",{enumerable:!0,get:b(function(){return t.serialize},"get")});var n=Oy();function s(i,o){let a=new n.Parser;return i.on("data",u=>a.parse(u,o)),new Promise(u=>i.on("end",()=>u()))}b(s,"parse"),r.parse=s}),Nl={};yt(Nl,{connect:()=>Al});function Al({socket:r,servername:e}){return r.startTls(e),r}var Py=Xe(()=>{"use strict";te(),b(Al,"connect")}),Il=de((r,e)=>{"use strict";te();var t=(Ao(),qe(Sl)),n=dr().EventEmitter,{parse:s,serialize:i}=Cl(),o=i.flush(),a=i.sync(),u=i.end(),h=class extends n{constructor(g){super(),g=g||{},this.stream=g.stream||new t.Socket,this._keepAlive=g.keepAlive,this._keepAliveInitialDelayMillis=g.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=g.ssl||!1,this._ending=!1,this._emitMessage=!1;var x=this;this.on("newListener",function(m){m==="message"&&(x._emitMessage=!0)})}connect(g,x){var m=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(g,x),this.stream.once("connect",function(){m._keepAlive&&m.stream.setKeepAlive(!0,m._keepAliveInitialDelayMillis),m.emit("connect")});let f=b(function(v){m._ending&&(v.code==="ECONNRESET"||v.code==="EPIPE")||m.emit("error",v)},"reportStreamError");if(this.stream.on("error",f),this.stream.on("close",function(){m.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(v){var w=v.toString("utf8");switch(w){case"S":break;case"N":return m.stream.end(),m.emit("error",new Error("The server does not support SSL connections"));default:return m.stream.end(),m.emit("error",new Error("There was an error establishing an SSL connection"))}var _=(Py(),qe(Nl));let E={socket:m.stream};m.ssl!==!0&&(Object.assign(E,m.ssl),"key"in m.ssl&&(E.key=m.ssl.key)),t.isIP(x)===0&&(E.servername=x);try{m.stream=_.connect(E)}catch(R){return m.emit("error",R)}m.attachListeners(m.stream),m.stream.on("error",f),m.emit("sslconnect")})}attachListeners(g){g.on("end",()=>{this.emit("end")}),s(g,x=>{var m=x.name==="error"?"errorMessage":x.name;this._emitMessage&&this.emit("message",x),this.emit(m,x)})}requestSsl(){this.stream.write(i.requestSsl())}startup(g){this.stream.write(i.startup(g))}cancel(g,x){this._send(i.cancel(g,x))}password(g){this._send(i.password(g))}sendSASLInitialResponseMessage(g,x){this._send(i.sendSASLInitialResponseMessage(g,x))}sendSCRAMClientFinalMessage(g){this._send(i.sendSCRAMClientFinalMessage(g))}_send(g){return this.stream.writable?this.stream.write(g):!1}query(g){this._send(i.query(g))}parse(g){this._send(i.parse(g))}bind(g){this._send(i.bind(g))}execute(g){this._send(i.execute(g))}flush(){this.stream.writable&&this.stream.write(o)}sync(){this._ending=!0,this._send(o),this._send(a)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(u,()=>{this.stream.end()})}close(g){this._send(i.close(g))}describe(g){this._send(i.describe(g))}sendCopyFromChunk(g){this._send(i.copyData(g))}endCopyFrom(){this._send(i.copyDone())}sendCopyFail(g){this._send(i.copyFail(g))}};b(h,"Connection");var l=h;e.exports=l}),Ry=de((r,e)=>{"use strict";te();var t=dr().EventEmitter,n=(Rs(),qe(Pn)),s=$s(),i=by(),o=_y(),a=To(),u=No(),h=Cy(),l=ks(),d=Il(),g=class extends t{constructor(f){super(),this.connectionParameters=new u(f),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var v=f||{};this._Promise=v.Promise||Ps.Promise,this._types=new a(v.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=v.connection||new d({stream:v.stream,ssl:this.connectionParameters.ssl,keepAlive:v.keepAlive||!1,keepAliveInitialDelayMillis:v.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=v.binary||l.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=v.connectionTimeoutMillis||0}_errorAllQueries(f){let v=b(w=>{he.nextTick(()=>{w.handleError(f,this.connection)})},"enqueueError");this.activeQuery&&(v(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(v),this.queryQueue.length=0}_connect(f){var v=this,w=this.connection;if(this._connectionCallback=f,this._connecting||this._connected){let _=new Error("Client has already been connected. You cannot reuse a client.");he.nextTick(()=>{f(_)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{w._ending=!0,w.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?w.connect(this.host+"/.s.PGSQL."+this.port):w.connect(this.port,this.host),w.on("connect",function(){v.ssl?w.requestSsl():w.startup(v.getStartupConf())}),w.on("sslconnect",function(){w.startup(v.getStartupConf())}),this._attachListeners(w),w.once("end",()=>{let _=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(_),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(_):this._handleErrorEvent(_):this._connectionError||this._handleErrorEvent(_)),he.nextTick(()=>{this.emit("end")})})}connect(f){if(f){this._connect(f);return}return new this._Promise((v,w)=>{this._connect(_=>{_?w(_):v()})})}_attachListeners(f){f.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),f.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),f.on("authenticationSASL",this._handleAuthSASL.bind(this)),f.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),f.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),f.on("backendKeyData",this._handleBackendKeyData.bind(this)),f.on("error",this._handleErrorEvent.bind(this)),f.on("errorMessage",this._handleErrorMessage.bind(this)),f.on("readyForQuery",this._handleReadyForQuery.bind(this)),f.on("notice",this._handleNotice.bind(this)),f.on("rowDescription",this._handleRowDescription.bind(this)),f.on("dataRow",this._handleDataRow.bind(this)),f.on("portalSuspended",this._handlePortalSuspended.bind(this)),f.on("emptyQuery",this._handleEmptyQuery.bind(this)),f.on("commandComplete",this._handleCommandComplete.bind(this)),f.on("parseComplete",this._handleParseComplete.bind(this)),f.on("copyInResponse",this._handleCopyInResponse.bind(this)),f.on("copyData",this._handleCopyData.bind(this)),f.on("notification",this._handleNotification.bind(this))}_checkPgPass(f){let v=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(w=>{if(w!==void 0){if(typeof w!="string"){v.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=w}else this.connectionParameters.password=this.password=null;f()}).catch(w=>{v.emit("error",w)}):this.password!==null?f():o(this.connectionParameters,w=>{w!==void 0&&(this.connectionParameters.password=this.password=w),f()})}_handleAuthCleartextPassword(f){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(f){this._checkPgPass(()=>{let v=s.postgresMd5PasswordHash(this.user,this.password,f.salt);this.connection.password(v)})}_handleAuthSASL(f){this._checkPgPass(()=>{this.saslSession=i.startSession(f.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(f){i.continueSession(this.saslSession,this.password,f.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(f){i.finalizeSession(this.saslSession,f.data),this.saslSession=null}_handleBackendKeyData(f){this.processID=f.processID,this.secretKey=f.secretKey}_handleReadyForQuery(f){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:v}=this;this.activeQuery=null,this.readyForQuery=!0,v&&v.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(f){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(f);this.emit("error",f)}}_handleErrorEvent(f){if(this._connecting)return this._handleErrorWhileConnecting(f);this._queryable=!1,this._errorAllQueries(f),this.emit("error",f)}_handleErrorMessage(f){if(this._connecting)return this._handleErrorWhileConnecting(f);let v=this.activeQuery;if(!v){this._handleErrorEvent(f);return}this.activeQuery=null,v.handleError(f,this.connection)}_handleRowDescription(f){this.activeQuery.handleRowDescription(f)}_handleDataRow(f){this.activeQuery.handleDataRow(f)}_handlePortalSuspended(f){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(f){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(f){this.activeQuery.handleCommandComplete(f,this.connection)}_handleParseComplete(f){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(f){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(f){this.activeQuery.handleCopyData(f,this.connection)}_handleNotification(f){this.emit("notification",f)}_handleNotice(f){this.emit("notice",f)}getStartupConf(){var f=this.connectionParameters,v={user:f.user,database:f.database},w=f.application_name||f.fallback_application_name;return w&&(v.application_name=w),f.replication&&(v.replication=""+f.replication),f.statement_timeout&&(v.statement_timeout=String(parseInt(f.statement_timeout,10))),f.lock_timeout&&(v.lock_timeout=String(parseInt(f.lock_timeout,10))),f.idle_in_transaction_session_timeout&&(v.idle_in_transaction_session_timeout=String(parseInt(f.idle_in_transaction_session_timeout,10))),f.options&&(v.options=f.options),v}cancel(f,v){if(f.activeQuery===v){var w=this.connection;this.host&&this.host.indexOf("/")===0?w.connect(this.host+"/.s.PGSQL."+this.port):w.connect(this.port,this.host),w.on("connect",function(){w.cancel(f.processID,f.secretKey)})}else f.queryQueue.indexOf(v)!==-1&&f.queryQueue.splice(f.queryQueue.indexOf(v),1)}setTypeParser(f,v,w){return this._types.setTypeParser(f,v,w)}getTypeParser(f,v){return this._types.getTypeParser(f,v)}escapeIdentifier(f){return'"'+f.replace(/"/g,'""')+'"'}escapeLiteral(f){for(var v=!1,w="'",_=0;_<f.length;_++){var E=f[_];E==="'"?w+=E+E:E==="\\"?(w+=E+E,v=!0):w+=E}return w+="'",v===!0&&(w=" E"+w),w}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let f=this.activeQuery.submit(this.connection);f&&he.nextTick(()=>{this.activeQuery.handleError(f,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(f,v,w){var _,E,R,L,S;if(f==null)throw new TypeError("Client was passed a null or undefined query");return typeof f.submit=="function"?(R=f.query_timeout||this.connectionParameters.query_timeout,E=_=f,typeof v=="function"&&(_.callback=_.callback||v)):(R=this.connectionParameters.query_timeout,_=new h(f,v,w),_.callback||(E=new this._Promise((O,I)=>{_.callback=(C,M)=>C?I(C):O(M)}))),R&&(S=_.callback,L=setTimeout(()=>{var O=new Error("Query read timeout");he.nextTick(()=>{_.handleError(O,this.connection)}),S(O),_.callback=()=>{};var I=this.queryQueue.indexOf(_);I>-1&&this.queryQueue.splice(I,1),this._pulseQueryQueue()},R),_.callback=(O,I)=>{clearTimeout(L),S(O,I)}),this.binary&&!_.binary&&(_.binary=!0),_._result&&!_._result._types&&(_._result._types=this._types),this._queryable?this._ending?(he.nextTick(()=>{_.handleError(new Error("Client was closed and is not queryable"),this.connection)}),E):(this.queryQueue.push(_),this._pulseQueryQueue(),E):(he.nextTick(()=>{_.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),E)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(f){if(this._ending=!0,!this.connection._connecting)if(f)f();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),f)this.connection.once("end",f);else return new this._Promise(v=>{this.connection.once("end",v)})}};b(g,"Client");var x=g;x.Query=h,e.exports=x}),Ly=de((r,e)=>{"use strict";te();var t=dr().EventEmitter,n=b(function(){},"NOOP"),s=b((m,f)=>{let v=m.findIndex(f);return v===-1?void 0:m.splice(v,1)[0]},"removeWhere"),i=class{constructor(f,v,w){this.client=f,this.idleListener=v,this.timeoutId=w}};b(i,"IdleItem");var o=i,a=class{constructor(f){this.callback=f}};b(a,"PendingItem");var u=a;function h(){throw new Error("Release called on client which has already been released to the pool.")}b(h,"throwOnDoubleRelease");function l(m,f){if(f)return{callback:f,result:void 0};let v,w,_=b(function(R,L){R?v(R):w(L)},"cb"),E=new m(function(R,L){w=R,v=L}).catch(R=>{throw Error.captureStackTrace(R),R});return{callback:_,result:E}}b(l,"promisify");function d(m,f){return b(function v(w){w.client=f,f.removeListener("error",v),f.on("error",()=>{m.log("additional client error after disconnection due to error",w)}),m._remove(f),m.emit("error",w,f)},"idleListener")}b(d,"makeIdleListener");var g=class extends t{constructor(f,v){super(),this.options=Object.assign({},f),f!=null&&"password"in f&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:f.password}),f!=null&&f.ssl&&f.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||v||Io().Client,this.Promise=this.options.Promise||Ps.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(v=>{this._remove(v.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let f=this._pendingQueue.shift();if(this._idle.length){let v=this._idle.pop();clearTimeout(v.timeoutId);let w=v.client;w.ref&&w.ref();let _=v.idleListener;return this._acquireClient(w,f,_,!1)}if(!this._isFull())return this.newClient(f);throw new Error("unexpected condition")}_remove(f){let v=s(this._idle,w=>w.client===f);v!==void 0&&clearTimeout(v.timeoutId),this._clients=this._clients.filter(w=>w!==f),f.end(),this.emit("remove",f)}connect(f){if(this.ending){let _=new Error("Cannot use a pool after calling end on the pool");return f?f(_):this.Promise.reject(_)}let v=l(this.Promise,f),w=v.result;if(this._isFull()||this._idle.length){if(this._idle.length&&he.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new u(v.callback)),w;let _=b((L,S,O)=>{clearTimeout(R),v.callback(L,S,O)},"queueCallback"),E=new u(_),R=setTimeout(()=>{s(this._pendingQueue,L=>L.callback===_),E.timedOut=!0,v.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(E),w}return this.newClient(new u(v.callback)),w}newClient(f){let v=new this.Client(this.options);this._clients.push(v);let w=d(this,v);this.log("checking client timeout");let _,E=!1;this.options.connectionTimeoutMillis&&(_=setTimeout(()=>{this.log("ending client due to timeout"),E=!0,v.connection?v.connection.stream.destroy():v.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),v.connect(R=>{if(_&&clearTimeout(_),v.on("error",w),R)this.log("client failed to connect",R),this._clients=this._clients.filter(L=>L!==v),E&&(R.message="Connection terminated due to connection timeout"),this._pulseQueue(),f.timedOut||f.callback(R,void 0,n);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let L=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(v),this._idle.findIndex(S=>S.client===v)!==-1&&this._acquireClient(v,new u((S,O,I)=>I()),w,!1)},this.options.maxLifetimeSeconds*1e3);L.unref(),v.once("end",()=>clearTimeout(L))}return this._acquireClient(v,f,w,!0)}})}_acquireClient(f,v,w,_){_&&this.emit("connect",f),this.emit("acquire",f),f.release=this._releaseOnce(f,w),f.removeListener("error",w),v.timedOut?_&&this.options.verify?this.options.verify(f,f.release):f.release():_&&this.options.verify?this.options.verify(f,E=>{if(E)return f.release(E),v.callback(E,void 0,n);v.callback(void 0,f,f.release)}):v.callback(void 0,f,f.release)}_releaseOnce(f,v){let w=!1;return _=>{w&&h(),w=!0,this._release(f,v,_)}}_release(f,v,w){if(f.on("error",v),f._poolUseCount=(f._poolUseCount||0)+1,this.emit("release",w,f),w||this.ending||!f._queryable||f._ending||f._poolUseCount>=this.options.maxUses){f._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(f),this._pulseQueue();return}if(this._expired.has(f)){this.log("remove expired client"),this._expired.delete(f),this._remove(f),this._pulseQueue();return}let _;this.options.idleTimeoutMillis&&(_=setTimeout(()=>{this.log("remove idle client"),this._remove(f)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&_.unref()),this.options.allowExitOnIdle&&f.unref(),this._idle.push(new o(f,v,_)),this._pulseQueue()}query(f,v,w){if(typeof f=="function"){let E=l(this.Promise,f);return vo(function(){return E.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),E.result}typeof v=="function"&&(w=v,v=void 0);let _=l(this.Promise,w);return w=_.callback,this.connect((E,R)=>{if(E)return w(E);let L=!1,S=b(O=>{L||(L=!0,R.release(O),w(O))},"onError");R.once("error",S),this.log("dispatching query");try{R.query(f,v,(O,I)=>{if(this.log("query dispatched"),R.removeListener("error",S),!L)return L=!0,R.release(O),O?w(O):w(void 0,I)})}catch(O){return R.release(O),w(O)}}),_.result}end(f){if(this.log("ending"),this.ending){let w=new Error("Called end on pool more than once");return f?f(w):this.Promise.reject(w)}this.ending=!0;let v=l(this.Promise,f);return this._endCallback=v.callback,this._pulseQueue(),v.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((f,v)=>f+(this._expired.has(v)?1:0),0)}get totalCount(){return this._clients.length}};b(g,"Pool");var x=g;e.exports=x}),Ol={};yt(Ol,{default:()=>Pl});var Pl,ky=Xe(()=>{"use strict";te(),Pl={}}),$y=de((r,e)=>{e.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),By=de((r,e)=>{"use strict";te();var t=dr().EventEmitter,n=(Rs(),qe(Pn)),s=$s(),i=e.exports=function(a,u,h){t.call(this),a=s.normalizeQueryConfig(a,u,h),this.text=a.text,this.values=a.values,this.name=a.name,this.callback=a.callback,this.state="new",this._arrayMode=a.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(l){l==="row"&&(this._emitRowEvents=!0)}.bind(this))};n.inherits(i,t);var o={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};i.prototype.handleError=function(a){var u=this.native.pq.resultErrorFields();if(u)for(var h in u){var l=o[h]||h;a[l]=u[h]}this.callback?this.callback(a):this.emit("error",a),this.state="error"},i.prototype.then=function(a,u){return this._getPromise().then(a,u)},i.prototype.catch=function(a){return this._getPromise().catch(a)},i.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(a,u){this._once("end",a),this._once("error",u)}.bind(this)),this._promise)},i.prototype.submit=function(a){this.state="running";var u=this;this.native=a.native,a.native.arrayMode=this._arrayMode;var h=b(function(g,x,m){if(a.native.arrayMode=!1,vo(function(){u.emit("_done")}),g)return u.handleError(g);u._emitRowEvents&&(m.length>1?x.forEach((f,v)=>{f.forEach(w=>{u.emit("row",w,m[v])})}):x.forEach(function(f){u.emit("row",f,m)})),u.state="end",u.emit("end",m),u.callback&&u.callback(null,m)},"after");if(he.domain&&(h=he.domain.bind(h)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var l=(this.values||[]).map(s.prepareValue);if(a.namedQueries[this.name]){if(this.text&&a.namedQueries[this.name]!==this.text){let g=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return h(g)}return a.native.execute(this.name,l,h)}return a.native.prepare(this.name,this.text,l.length,function(g){return g?h(g):(a.namedQueries[u.name]=u.text,u.native.execute(u.name,l,h))})}else if(this.values){if(!Array.isArray(this.values)){let g=new Error("Query values must be an array");return h(g)}var d=this.values.map(s.prepareValue);a.native.query(this.text,d,h)}else a.native.query(this.text,h)}}),My=de((r,e)=>{"use strict";te();var t=(ky(),qe(Ol)),n=To(),s=$y(),i=dr().EventEmitter,o=(Rs(),qe(Pn)),a=No(),u=By(),h=e.exports=function(l){i.call(this),l=l||{},this._Promise=l.Promise||Ps.Promise,this._types=new n(l.types),this.native=new t({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var d=this.connectionParameters=new a(l);this.user=d.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:d.password}),this.database=d.database,this.host=d.host,this.port=d.port,this.namedQueries={}};h.Query=u,o.inherits(h,i),h.prototype._errorAllQueries=function(l){let d=b(g=>{he.nextTick(()=>{g.native=this.native,g.handleError(l)})},"enqueueError");this._hasActiveQuery()&&(d(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(d),this._queryQueue.length=0},h.prototype._connect=function(l){var d=this;if(this._connecting){he.nextTick(()=>l(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(g,x){if(g)return l(g);d.native.connect(x,function(m){if(m)return d.native.end(),l(m);d._connected=!0,d.native.on("error",function(f){d._queryable=!1,d._errorAllQueries(f),d.emit("error",f)}),d.native.on("notification",function(f){d.emit("notification",{channel:f.relname,payload:f.extra})}),d.emit("connect"),d._pulseQueryQueue(!0),l()})})},h.prototype.connect=function(l){if(l){this._connect(l);return}return new this._Promise((d,g)=>{this._connect(x=>{x?g(x):d()})})},h.prototype.query=function(l,d,g){var x,m,f,v,w;if(l==null)throw new TypeError("Client was passed a null or undefined query");if(typeof l.submit=="function")f=l.query_timeout||this.connectionParameters.query_timeout,m=x=l,typeof d=="function"&&(l.callback=d);else if(f=this.connectionParameters.query_timeout,x=new u(l,d,g),!x.callback){let _,E;m=new this._Promise((R,L)=>{_=R,E=L}),x.callback=(R,L)=>R?E(R):_(L)}return f&&(w=x.callback,v=setTimeout(()=>{var _=new Error("Query read timeout");he.nextTick(()=>{x.handleError(_,this.connection)}),w(_),x.callback=()=>{};var E=this._queryQueue.indexOf(x);E>-1&&this._queryQueue.splice(E,1),this._pulseQueryQueue()},f),x.callback=(_,E)=>{clearTimeout(v),w(_,E)}),this._queryable?this._ending?(x.native=this.native,he.nextTick(()=>{x.handleError(new Error("Client was closed and is not queryable"))}),m):(this._queryQueue.push(x),this._pulseQueryQueue(),m):(x.native=this.native,he.nextTick(()=>{x.handleError(new Error("Client has encountered a connection error and is not queryable"))}),m)},h.prototype.end=function(l){var d=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,l));var g;return l||(g=new this._Promise(function(x,m){l=b(f=>f?m(f):x(),"cb")})),this.native.end(function(){d._errorAllQueries(new Error("Connection terminated")),he.nextTick(()=>{d.emit("end"),l&&l()})}),g},h.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},h.prototype._pulseQueryQueue=function(l){if(this._connected&&!this._hasActiveQuery()){var d=this._queryQueue.shift();if(!d){l||this.emit("drain");return}this._activeQuery=d,d.submit(this);var g=this;d.once("_done",function(){g._pulseQueryQueue()})}},h.prototype.cancel=function(l){this._activeQuery===l?this.native.cancel(function(){}):this._queryQueue.indexOf(l)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(l),1)},h.prototype.ref=function(){},h.prototype.unref=function(){},h.prototype.setTypeParser=function(l,d,g){return this._types.setTypeParser(l,d,g)},h.prototype.getTypeParser=function(l,d){return this._types.getTypeParser(l,d)}}),el=de((r,e)=>{"use strict";te(),e.exports=My()}),Io=de((r,e)=>{"use strict";te();var t=Ry(),n=ks(),s=Il(),i=Ly(),{DatabaseError:o}=Cl(),a=b(h=>{var l;return l=class extends i{constructor(d){super(d,h)}},b(l,"BoundPool"),l},"poolFactory"),u=b(function(h){this.defaults=n,this.Client=h,this.Query=this.Client.Query,this.Pool=a(this.Client),this._pools=[],this.Connection=s,this.types=Ls(),this.DatabaseError=o},"PG");typeof he.env.NODE_PG_FORCE_NATIVE<"u"?e.exports=new u(el()):(e.exports=new u(t),Object.defineProperty(e.exports,"native",{configurable:!0,enumerable:!1,get(){var h=null;try{h=new u(el())}catch(l){if(l.code!=="MODULE_NOT_FOUND")throw l}return Object.defineProperty(e.exports,"native",{value:h}),h}}))});te();var Rl=Wr(Io());Ao();te();Ao();_l();var qy=Wr($s()),Dy=Wr(To());function Ll(r){return r instanceof oe?"\\x"+r.toString("hex"):r}b(Ll,"encodeBuffersAsBytea");var kl=class $l extends Error{constructor(e){super(e),ae(this,"name","NeonDbError"),ae(this,"severity"),ae(this,"code"),ae(this,"detail"),ae(this,"hint"),ae(this,"position"),ae(this,"internalPosition"),ae(this,"internalQuery"),ae(this,"where"),ae(this,"schema"),ae(this,"table"),ae(this,"column"),ae(this,"dataType"),ae(this,"constraint"),ae(this,"file"),ae(this,"line"),ae(this,"routine"),ae(this,"sourceError"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,$l)}};b(kl,"NeonDbError");var Vr=kl,tl="transaction() expects an array of queries, or a function returning an array of queries",jy=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function Bl(r,{arrayMode:e,fullResults:t,fetchOptions:n,isolationLevel:s,readOnly:i,deferrable:o,queryCallback:a,resultCallback:u,authToken:h}={}){if(!r)throw new Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");let l;try{l=Co(r)}catch{throw new Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(r))}let{protocol:d,username:g,hostname:x,port:m,pathname:f}=l;if(d!=="postgres:"&&d!=="postgresql:"||!g||!x||!f)throw new Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function v(_,...E){let R,L;if(typeof _=="string")R=_,L=E[1],E=E[0]??[];else{R="";for(let O=0;O<_.length;O++)R+=_[O],O<E.length&&(R+="$"+(O+1))}E=E.map(O=>Ll((0,qy.prepareValue)(O)));let S={query:R,params:E};return a&&a(S),Ml(w,S,L)}b(v,"resolve"),v.transaction=async(_,E)=>{if(typeof _=="function"&&(_=_(v)),!Array.isArray(_))throw new Error(tl);_.forEach(S=>{if(S[Symbol.toStringTag]!=="NeonQueryPromise")throw new Error(tl)});let R=_.map(S=>S.parameterizedQuery),L=_.map(S=>S.opts??{});return w(R,L,E)};async function w(_,E,R){let{fetchEndpoint:L,fetchFunction:S}=Bt,O=Array.isArray(_)?{queries:_}:_,I=n??{},C=e??!1,M=t??!1,$=s,Z=i,X=o;R!==void 0&&(R.fetchOptions!==void 0&&(I={...I,...R.fetchOptions}),R.arrayMode!==void 0&&(C=R.arrayMode),R.fullResults!==void 0&&(M=R.fullResults),R.isolationLevel!==void 0&&($=R.isolationLevel),R.readOnly!==void 0&&(Z=R.readOnly),R.deferrable!==void 0&&(X=R.deferrable)),E!==void 0&&!Array.isArray(E)&&E.fetchOptions!==void 0&&(I={...I,...E.fetchOptions});let k=h;!Array.isArray(E)&&E?.authToken!==void 0&&(k=E.authToken);let Q=typeof L=="function"?L(x,m,{jwtAuth:k!==void 0}):L,ee={"Neon-Connection-String":r,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},ce=await ql(k);ce&&(ee.Authorization=`Bearer ${ce}`),Array.isArray(_)&&($!==void 0&&(ee["Neon-Batch-Isolation-Level"]=$),Z!==void 0&&(ee["Neon-Batch-Read-Only"]=String(Z)),X!==void 0&&(ee["Neon-Batch-Deferrable"]=String(X)));let ge;try{ge=await(S??fetch)(Q,{method:"POST",body:JSON.stringify(O),headers:ee,...I})}catch(be){let Be=new Vr(`Error connecting to database: ${be.message}`);throw Be.sourceError=be,Be}if(ge.ok){let be=await ge.json();if(Array.isArray(_)){let Be=be.results;if(!Array.isArray(Be))throw new Vr("Neon internal error: unexpected result format");return Be.map((we,Ae)=>{let lr=E[Ae]??{},Cn=lr.arrayMode??C,Nn=lr.fullResults??M;return xo(we,{arrayMode:Cn,fullResults:Nn,parameterizedQuery:_[Ae],resultCallback:u,types:lr.types})})}else{let Be=E??{},we=Be.arrayMode??C,Ae=Be.fullResults??M;return xo(be,{arrayMode:we,fullResults:Ae,parameterizedQuery:_,resultCallback:u,types:Be.types})}}else{let{status:be}=ge;if(be===400){let Be=await ge.json(),we=new Vr(Be.message);for(let Ae of jy)we[Ae]=Be[Ae]??void 0;throw we}else{let Be=await ge.text();throw new Vr(`Server error (HTTP status ${be}): ${Be}`)}}}return b(w,"execute"),v}b(Bl,"neon");function Ml(r,e,t){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:e,opts:t,then:b((n,s)=>r(e,t).then(n,s),"then"),catch:b(n=>r(e,t).catch(n),"catch"),finally:b(n=>r(e,t).finally(n),"finally")}}b(Ml,"createNeonQueryPromise");function xo(r,{arrayMode:e,fullResults:t,parameterizedQuery:n,resultCallback:s,types:i}){let o=new Dy.default(i),a=r.fields.map(l=>l.name),u=r.fields.map(l=>o.getTypeParser(l.dataTypeID)),h=e===!0?r.rows.map(l=>l.map((d,g)=>d===null?null:u[g](d))):r.rows.map(l=>Object.fromEntries(l.map((d,g)=>[a[g],d===null?null:u[g](d)])));return s&&s(n,r,h,{arrayMode:e,fullResults:t}),t?(r.viaNeonFetch=!0,r.rowAsArray=e,r.rows=h,r._parsers=u,r._types=o,r):h}b(xo,"processQueryResult");async function ql(r){if(typeof r=="string")return r;if(typeof r=="function")try{return await Promise.resolve(r())}catch(e){let t=new Vr("Error getting auth token.");throw e instanceof Error&&(t=new Vr(`Error getting auth token: ${e.message}`)),t}}b(ql,"getAuthToken");var Fy=Wr(No()),Gr=Wr(Io()),Dl=class extends Rl.Client{constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let n=this.config?.host!==void 0||this.config?.connectionString!==void 0||he.env.PGHOST!==void 0,s=he.env.USER??he.env.USERNAME;if(!n&&this.host==="localhost"&&this.user===s&&this.database===s&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${s}, db: ${s}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let i=super.connect(e),o=t.pipelineTLS&&this.ssl,a=t.pipelineConnect==="password";if(!o&&!t.pipelineConnect)return i;let u=this.connection;if(o&&u.on("connect",()=>u.stream.emit("data","S")),a){u.removeAllListeners("authenticationCleartextPassword"),u.removeAllListeners("readyForQuery"),u.once("readyForQuery",()=>u.on("readyForQuery",this._handleReadyForQuery.bind(this)));let h=this.ssl?"sslconnect":"connect";u.on(h,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return i}async _handleAuthSASLContinue(e){let t=this.saslSession,n=this.password,s=e.data;if(t.message!=="SASLInitialResponse"||typeof n!="string"||typeof s!="string")throw new Error("SASL: protocol error");let i=Object.fromEntries(s.split(",").map(ce=>{if(!/^.=/.test(ce))throw new Error("SASL: Invalid attribute pair entry");let ge=ce[0],be=ce.substring(2);return[ge,be]})),o=i.r,a=i.s,u=i.i;if(!o||!/^[!-+--~]+$/.test(o))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!a||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!u||!/^[1-9][0-9]*$/.test(u))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!o.startsWith(t.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(o.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let h=parseInt(u,10),l=oe.from(a,"base64"),d=new TextEncoder,g=d.encode(n),x=await Fe.subtle.importKey("raw",g,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),m=new Uint8Array(await Fe.subtle.sign("HMAC",x,oe.concat([l,oe.from([0,0,0,1])]))),f=m;for(var v=0;v<h-1;v++)m=new Uint8Array(await Fe.subtle.sign("HMAC",x,m)),f=oe.from(f.map((ce,ge)=>f[ge]^m[ge]));let w=f,_=await Fe.subtle.importKey("raw",w,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),E=new Uint8Array(await Fe.subtle.sign("HMAC",_,d.encode("Client Key"))),R=await Fe.subtle.digest("SHA-256",E),L="n=*,r="+t.clientNonce,S="r="+o+",s="+a+",i="+h,O="c=biws,r="+o,I=L+","+S+","+O,C=await Fe.subtle.importKey("raw",R,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var M=new Uint8Array(await Fe.subtle.sign("HMAC",C,d.encode(I))),$=oe.from(E.map((ce,ge)=>E[ge]^M[ge])),Z=$.toString("base64");let X=await Fe.subtle.importKey("raw",w,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),k=await Fe.subtle.sign("HMAC",X,d.encode("Server Key")),Q=await Fe.subtle.importKey("raw",k,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var ee=oe.from(await Fe.subtle.sign("HMAC",Q,d.encode(I)));t.message="SASLResponse",t.serverSignature=ee.toString("base64"),t.response=O+",p="+Z,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};b(Dl,"NeonClient");var Uy=Dl;function jl(r,e){if(e)return{callback:e,result:void 0};let t,n,s=b(function(o,a){o?t(o):n(a)},"cb"),i=new r(function(o,a){n=o,t=a});return{callback:s,result:i}}b(jl,"promisify");var Fl=class extends Rl.Pool{constructor(){super(...arguments),ae(this,"Client",Uy),ae(this,"hasFetchUnsupportedListeners",!1)}on(e,t){return e!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(e,t)}query(e,t,n){if(!Bt.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof e=="function")return super.query(e,t,n);typeof t=="function"&&(n=t,t=void 0);let s=jl(this.Promise,n);n=s.callback;try{let i=new Fy.default(this.options),o=encodeURIComponent,a=encodeURI,u=`postgresql://${o(i.user)}:${o(i.password)}@${o(i.host)}/${a(i.database)}`,h=typeof e=="string"?e:e.text,l=t??e.values??[];Bl(u,{fullResults:!0,arrayMode:e.rowMode==="array"})(h,l,{types:e.types??this.options?.types}).then(d=>n(void 0,d)).catch(d=>n(d))}catch(i){n(i)}return s.result}};b(Fl,"NeonPool");var Mt=Fl,HT=Gr.ClientBase,ZT=Gr.Connection,XT=Gr.DatabaseError,JT=Gr.Query,YT=Gr.defaults,bt=Gr.types;var T=Symbol.for("drizzle:entityKind"),n6=Symbol.for("drizzle:hasOwnEntityKind");function B(r,e){if(!r||typeof r!="object")return!1;if(r instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,T))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(r).constructor;if(t)for(;t;){if(T in t&&t[T]===e[T])return!0;t=Object.getPrototypeOf(t)}return!1}var Oo=class{static[T]="ConsoleLogWriter";write(e){console.log(e)}},Bs=class{static[T]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Oo}logQuery(e,t){let n=t.map(i=>{try{return JSON.stringify(i)}catch{return String(i)}}),s=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${s}`)}},Ms=class{static[T]="NoopLogger";logQuery(){}};var Ue=class{static[T]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};var ye=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[T]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}};var qs=class{static[T]="ColumnBuilder";config;constructor(e,t,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}};var xt=Symbol.for("drizzle:Name");var Ds=class{static[T]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:n,columns:s,foreignColumns:i}=e();return{name:n,columns:s,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Po(e,this)}},Po=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[T]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:n}=this.reference(),s=t.map(a=>a.name),i=n.map(a=>a.name),o=[this.table[xt],...s,n[0].table[xt],...i];return e??`${o.join("_")}_fk`}};function js(r,...e){return r(...e)}function ko(r,e){return`${r[xt]}_${e.join("_")}_unique`}var Ro=class{constructor(e,t){this.name=t,this.columns=e}static[T]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Lo(e,this.columns,this.nullsNotDistinctConfig,this.name)}},Ul=class{static[T]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new Ro(e,this.name)}},Lo=class{constructor(e,t,n,s){this.table=e,this.columns=t,this.name=s??ko(this.table,this.columns.map(i=>i.name)),this.nullsNotDistinct=n}static[T]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}};function Ql(r,e,t){for(let n=e;n<r.length;n++){let s=r[n];if(s==="\\"){n++;continue}if(s==='"')return[r.slice(e,n).replace(/\\/g,""),n+1];if(!t&&(s===","||s==="}"))return[r.slice(e,n).replace(/\\/g,""),n]}return[r.slice(e).replace(/\\/g,""),r.length]}function Vl(r,e=0){let t=[],n=e,s=!1;for(;n<r.length;){let i=r[n];if(i===","){(s||n===e)&&t.push(""),s=!0,n++;continue}if(s=!1,i==="\\"){n+=2;continue}if(i==='"'){let[u,h]=Ql(r,n+1,!0);t.push(u),n=h;continue}if(i==="}")return[t,n+1];if(i==="{"){let[u,h]=Vl(r,n+1);t.push(u),n=h;continue}let[o,a]=Ql(r,n,!1);t.push(o),n=a}return[t,n]}function zl(r){let[e]=Vl(r,1);return e}function $o(r){return`{${r.map(e=>Array.isArray(e)?$o(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var J=class extends qs{foreignKeyConfigs=[];static[T]="PgColumnBuilder";array(e){return new Mo(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:n,actions:s})=>js((i,o)=>{let a=new Ds(()=>{let u=i();return{columns:[e],foreignColumns:[u]}});return o.onUpdate&&a.onUpdate(o.onUpdate),o.onDelete&&a.onDelete(o.onDelete),a.build(t)},n,s))}buildExtraConfigColumn(e){return new Bo(e,this.config)}},U=class extends ye{constructor(e,t){t.uniqueName||(t.uniqueName=ko(e,[t.name])),super(e,t),this.table=e}static[T]="PgColumn"},Bo=class extends U{static[T]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},Kr=class{static[T]="IndexedColumn";constructor(e,t,n,s){this.name=e,this.keyAsName=t,this.type=n,this.indexConfig=s}name;keyAsName;type;indexConfig},Mo=class extends J{static[T]="PgArrayBuilder";constructor(e,t,n){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=n}build(e){let t=this.config.baseBuilder.build(e);return new qo(e,this.config,t)}},qo=class r extends U{constructor(e,t,n,s){super(e,t),this.baseColumn=n,this.range=s,this.size=t.size}size;static[T]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=zl(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let n=e.map(s=>s===null?null:B(this.baseColumn,r)?this.baseColumn.mapToDriverValue(s,!0):this.baseColumn.mapToDriverValue(s));return t?n:$o(n)}};var Wl=Symbol.for("drizzle:isPgEnum");function Kl(r){return!!r&&typeof r=="function"&&Wl in r&&r[Wl]===!0}var Gl=class extends J{static[T]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new Do(e,this.config)}},Do=class extends U{static[T]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};var Le=class{static[T]="Subquery";constructor(e,t,n,s=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:n,isWith:s}}},Hr=class extends Le{static[T]="WithSubquery"};var Hl="0.39.1";var jo,Fo,ke={startActiveSpan(r,e){return jo?(Fo||(Fo=jo.trace.getTracer("drizzle-orm",Hl)),js((t,n)=>n.startActiveSpan(r,s=>{try{return e(s)}catch(i){throw s.setStatus({code:t.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{s.end()}}),jo,Fo)):e()}};var ve=Symbol.for("drizzle:ViewBaseConfig");var Fs=Symbol.for("drizzle:Schema"),Us=Symbol.for("drizzle:Columns"),Zl=Symbol.for("drizzle:ExtraConfigColumns"),Uo=Symbol.for("drizzle:OriginalName"),Qo=Symbol.for("drizzle:BaseName"),Rn=Symbol.for("drizzle:IsAlias"),Xl=Symbol.for("drizzle:ExtraConfigBuilder"),Jl=Symbol.for("drizzle:IsDrizzleTable"),z=class{static[T]="Table";static Symbol={Name:xt,Schema:Fs,OriginalName:Uo,Columns:Us,ExtraConfigColumns:Zl,BaseName:Qo,IsAlias:Rn,ExtraConfigBuilder:Xl};[xt];[Uo];[Fs];[Us];[Zl];[Qo];[Rn]=!1;[Jl]=!0;[Xl]=void 0;constructor(e,t,n){this[xt]=this[Uo]=e,this[Fs]=t,this[Qo]=n}};function Vo(r){return typeof r=="object"&&r!==null&&Jl in r}function Je(r){return r[xt]}function pr(r){return`${r[Fs]??"public"}.${r[xt]}`}var Yl=class{static[T]="FakePrimitiveParam"};function zo(r){return r!=null&&typeof r.getSQL=="function"}function Qy(r){let e={sql:"",params:[]};for(let t of r)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}var $e=class{static[T]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new W([this])}},W=class r{constructor(e){this.queryChunks=e}static[T]="SQL";decoder=tf;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return ke.startActiveSpan("drizzle.buildSQL",t=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,t){let n=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:s,escapeName:i,escapeParam:o,prepareTyping:a,inlineParams:u,paramStartIndex:h}=n;return Qy(e.map(l=>{if(B(l,$e))return{sql:l.value.join(""),params:[]};if(B(l,Ln))return{sql:i(l.value),params:[]};if(l===void 0)return{sql:"",params:[]};if(Array.isArray(l)){let d=[new $e("(")];for(let[g,x]of l.entries())d.push(x),g<l.length-1&&d.push(new $e(", "));return d.push(new $e(")")),this.buildQueryFromSourceParams(d,n)}if(B(l,r))return this.buildQueryFromSourceParams(l.queryChunks,{...n,inlineParams:u||l.shouldInlineParams});if(B(l,z)){let d=l[z.Symbol.Schema],g=l[z.Symbol.Name];return{sql:d===void 0||l[Rn]?i(g):i(d)+"."+i(g),params:[]}}if(B(l,ye)){let d=s.getColumnCasing(l);if(t.invokeSource==="indexes")return{sql:i(d),params:[]};let g=l.table[z.Symbol.Schema];return{sql:l.table[Rn]||g===void 0?i(l.table[z.Symbol.Name])+"."+i(d):i(g)+"."+i(l.table[z.Symbol.Name])+"."+i(d),params:[]}}if(B(l,We)){let d=l[ve].schema,g=l[ve].name;return{sql:d===void 0||l[ve].isAlias?i(g):i(d)+"."+i(g),params:[]}}if(B(l,Ye)){if(B(l.value,qt))return{sql:o(h.value++,l),params:[l],typings:["none"]};let d=l.value===null?null:l.encoder.mapToDriverValue(l.value);if(B(d,r))return this.buildQueryFromSourceParams([d],n);if(u)return{sql:this.mapInlineParam(d,n),params:[]};let g=["none"];return a&&(g=[a(l.encoder)]),{sql:o(h.value++,d),params:[d],typings:g}}return B(l,qt)?{sql:o(h.value++,l),params:[l],typings:["none"]}:B(l,r.Aliased)&&l.fieldAlias!==void 0?{sql:i(l.fieldAlias),params:[]}:B(l,Le)?l._.isWith?{sql:i(l._.alias),params:[]}:this.buildQueryFromSourceParams([new $e("("),l._.sql,new $e(") "),new Ln(l._.alias)],n):Kl(l)?l.schema?{sql:i(l.schema)+"."+i(l.enumName),params:[]}:{sql:i(l.enumName),params:[]}:zo(l)?l.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([l.getSQL()],n):this.buildQueryFromSourceParams([new $e("("),l.getSQL(),new $e(")")],n):u?{sql:this.mapInlineParam(l,n),params:[]}:{sql:o(h.value++,l),params:[l],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let n=e.toString();return t(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new r.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Ln=class{constructor(e){this.value=e}static[T]="Name";brand;getSQL(){return new W([this])}};function ef(r){return typeof r=="object"&&r!==null&&"mapToDriverValue"in r&&typeof r.mapToDriverValue=="function"}var tf={mapFromDriverValue:r=>r},rf={mapToDriverValue:r=>r},Z6={...tf,...rf},Ye=class{constructor(e,t=rf){this.value=e,this.encoder=t}static[T]="Param";brand;getSQL(){return new W([this])}};function A(r,...e){let t=[];(e.length>0||r.length>0&&r[0]!=="")&&t.push(new $e(r[0]));for(let[n,s]of e.entries())t.push(s,new $e(r[n+1]));return new W(t)}(r=>{function e(){return new W([])}r.empty=e;function t(u){return new W(u)}r.fromList=t;function n(u){return new W([new $e(u)])}r.raw=n;function s(u,h){let l=[];for(let[d,g]of u.entries())d>0&&h!==void 0&&l.push(h),l.push(g);return new W(l)}r.join=s;function i(u){return new Ln(u)}r.identifier=i;function o(u){return new qt(u)}r.placeholder=o;function a(u,h){return new Ye(u,h)}r.param=a})(A||(A={}));(r=>{class e{constructor(n,s){this.sql=n,this.fieldAlias=s}static[T]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}r.Aliased=e})(W||(W={}));var qt=class{constructor(e){this.name=e}static[T]="Placeholder";getSQL(){return new W([this])}};function Qs(r,e){return r.map(t=>{if(B(t,qt)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(B(t,Ye)&&B(t.value,qt)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}var nf=Symbol.for("drizzle:IsDrizzleView"),We=class{static[T]="View";[ve];[nf]=!0;constructor({name:e,schema:t,selectedFields:n,query:s}){this[ve]={name:e,originalName:e,schema:t,selectedFields:n,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new W([this])}};function sf(r){return typeof r=="object"&&r!==null&&nf in r}ye.prototype.getSQL=function(){return new W([this])};z.prototype.getSQL=function(){return new W([this])};Le.prototype.getSQL=function(){return new W([this])};var mr=class{constructor(e){this.table=e}static[T]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},Zr=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[T]="TableAliasProxyHandler";get(e,t){if(t===z.Symbol.IsAlias)return!0;if(t===z.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===z.Symbol.OriginalName)return this.alias;if(t===ve)return{...e[ve],name:this.alias,isAlias:!0};if(t===z.Symbol.Columns){let s=e[z.Symbol.Columns];if(!s)return s;let i={};return Object.keys(s).map(o=>{i[o]=new Proxy(s[o],new mr(new Proxy(e,this)))}),i}let n=e[t];return B(n,ye)?new Proxy(n,new mr(new Proxy(e,this))):n}},of=class{constructor(e){this.alias=e}static[T]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?kn(e.sourceTable,this.alias):e[t]}};function kn(r,e){return new Proxy(r,new Zr(e,!1))}function Tt(r,e){return new Proxy(r,new mr(new Proxy(r.table,new Zr(e,!1))))}function Wo(r,e){return new W.Aliased($n(r.sql,e),r.fieldAlias)}function $n(r,e){return A.join(r.queryChunks.map(t=>B(t,ye)?Tt(t,e):B(t,W)?$n(t,e):B(t,W.Aliased)?Wo(t,e):t))}var Oe=class r{static[T]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===ve)return{...e[ve],selectedFields:new Proxy(e[ve].selectedFields,this)};if(typeof t=="symbol")return e[t];let s=(B(e,Le)?e._.selectedFields:B(e,We)?e[ve].selectedFields:e)[t];if(B(s,W.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!s.isSelectionField)return s.sql;let i=s.clone();return i.isSelectionField=!0,i}if(B(s,W)){if(this.config.sqlBehavior==="sql")return s;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return B(s,ye)?this.config.alias?new Proxy(s,new mr(new Proxy(s.table,new Zr(this.config.alias,this.config.replaceOriginalName??!1)))):s:typeof s!="object"||s===null?s:new Proxy(s,new r(this.config))}};function af(r,e,t){let n={},s=r.reduce((i,{path:o,field:a},u)=>{let h;B(a,ye)?h=a:B(a,W)?h=a.decoder:h=a.sql.decoder;let l=i;for(let[d,g]of o.entries())if(d<o.length-1)g in l||(l[g]={}),l=l[g];else{let x=e[u],m=l[g]=x===null?null:h.mapFromDriverValue(x);if(t&&B(a,ye)&&o.length===2){let f=o[0];f in n?typeof n[f]=="string"&&n[f]!==Je(a.table)&&(n[f]=!1):n[f]=m===null?Je(a.table):!1}}return i},{});if(t&&Object.keys(n).length>0)for(let[i,o]of Object.entries(n))typeof o=="string"&&!t[o]&&(s[i]=null);return s}function at(r,e){return Object.entries(r).reduce((t,[n,s])=>{if(typeof n!="string")return t;let i=e?[...e,n]:[n];return B(s,ye)||B(s,W)||B(s,W.Aliased)?t.push({path:i,field:s}):B(s,z)?t.push(...at(s[z.Symbol.Columns],i)):t.push(...at(s,i)),t},[])}function Bn(r,e){let t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(let[s,i]of t.entries())if(i!==n[s])return!1;return!0}function Vs(r,e){let t=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,s])=>B(s,W)||B(s,ye)?[n,s]:[n,new Ye(s,r[z.Symbol.Columns][n])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function cf(r,e){for(let t of e)for(let n of Object.getOwnPropertyNames(t.prototype))n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}function zs(r){return r[z.Symbol.Columns]}function uf(r){return r[ve].selectedFields}function Dt(r){return B(r,Le)?r._.alias:B(r,We)?r[ve].name:B(r,W)?void 0:r[z.Symbol.IsAlias]?r[z.Symbol.Name]:r[z.Symbol.BaseName]}function pe(r,e){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:e}}function lf(r){if(typeof r!="object"||r===null||r.constructor.name!=="Object")return!1;if("logger"in r){let e=typeof r.logger;return!(e!=="boolean"&&(e!=="object"||typeof r.logger.logQuery!="function")&&e!=="undefined")}if("schema"in r){let e=typeof r.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in r){let e=typeof r.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in r)return!(r.mode!=="default"||r.mode!=="planetscale"||r.mode!==void 0);if("connection"in r){let e=typeof r.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in r){let e=typeof r.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(r).length===0}var Mn=class extends Ue{constructor(e,t,n,s){super(),this.session=t,this.dialect=n,this.config={table:e,withList:s}}static[T]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[z.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=at(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return ke.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ke.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Oe({alias:Je(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};function Vy(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function zy(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,n,s)=>{let i=s===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return t+i},"")}function Wy(r){return r}var Ws=class{static[T]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?Vy:e==="camelCase"?zy:Wy}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[z.Symbol.Schema]??"public",n=e.table[z.Symbol.OriginalName],s=`${t}.${n}.${e.name}`;return this.cache[s]||this.cacheTable(e.table),this.cache[s]}cacheTable(e){let t=e[z.Symbol.Schema]??"public",n=e[z.Symbol.OriginalName],s=`${t}.${n}`;if(!this.cachedTables[s]){for(let i of Object.values(e[z.Symbol.Columns])){let o=`${s}.${i.name}`;this.cache[o]=this.convert(i.name)}this.cachedTables[s]=!0}}clearCache(){this.cache={},this.cachedTables={}}};var qn=class extends Error{static[T]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},Gs=class extends qn{static[T]="TransactionRollbackError";constructor(){super({message:"Rollback"})}};var jt=class extends J{static[T]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}};var Go=class extends jt{static[T]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Ko(e,this.config)}},Ko=class extends U{static[T]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Ho=class extends jt{static[T]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Zo(e,this.config)}},Zo=class extends U{static[T]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}};function ff(r,e){let{name:t,config:n}=pe(r,e);return n.mode==="number"?new Go(t):new Ho(t)}var Xo=class extends J{static[T]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Jo(e,this.config)}},Jo=class extends U{static[T]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Yo=class extends J{static[T]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new ea(e,this.config)}},ea=class extends U{static[T]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};function hf(r,e){let{name:t,config:n}=pe(r,e);return n.mode==="number"?new Xo(t):new Yo(t)}var ta=class extends J{static[T]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new ra(e,this.config)}},ra=class extends U{static[T]="PgBoolean";getSQLType(){return"boolean"}};function Jt(r){return new ta(r??"")}var na=class extends J{static[T]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new sa(e,this.config)}},sa=class extends U{static[T]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}};function df(r,e={}){let{name:t,config:n}=pe(r,e);return new na(t,n)}var ia=class extends J{static[T]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new oa(e,this.config)}},oa=class extends U{static[T]="PgCidr";getSQLType(){return"cidr"}};function pf(r){return new ia(r??"")}var aa=class extends J{static[T]="PgCustomColumnBuilder";constructor(e,t,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=n}build(e){return new ca(e,this.config)}},ca=class extends U{static[T]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}};function mf(r){return(e,t)=>{let{name:n,config:s}=pe(e,t);return new aa(n,s,r)}}var Ct=class extends J{static[T]="PgDateColumnBaseBuilder";defaultNow(){return this.default(A`now()`)}};var ua=class extends Ct{static[T]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Dn(e,this.config)}},Dn=class extends U{static[T]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},la=class extends Ct{static[T]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new jn(e,this.config)}},jn=class extends U{static[T]="PgDateString";getSQLType(){return"date"}};function gf(r,e){let{name:t,config:n}=pe(r,e);return n?.mode==="date"?new ua(t):new la(t)}var fa=class extends J{static[T]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new ha(e,this.config)}},ha=class extends U{static[T]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};function yf(r){return new fa(r??"")}var da=class extends J{static[T]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new pa(e,this.config)}},pa=class extends U{static[T]="PgInet";getSQLType(){return"inet"}};function bf(r){return new da(r??"")}var ma=class extends jt{static[T]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new ga(e,this.config)}},ga=class extends U{static[T]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};function Nt(r){return new ma(r??"")}var ya=class extends J{static[T]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new ba(e,this.config)}},ba=class extends U{static[T]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}};function xf(r,e={}){let{name:t,config:n}=pe(r,e);return new ya(t,n)}var xa=class extends J{static[T]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Fn(e,this.config)}},Fn=class extends U{static[T]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function vf(r){return new xa(r??"")}var va=class extends J{static[T]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new Un(e,this.config)}},Un=class extends U{static[T]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Ks(r){return new va(r??"")}var wa=class extends J{static[T]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new _a(e,this.config)}},_a=class extends U{static[T]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,n,s]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(n),Number.parseFloat(s)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Sa=class extends J{static[T]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new Ea(e,this.config)}},Ea=class extends U{static[T]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,n,s]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(n),c:Number.parseFloat(s)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}};function wf(r,e){let{name:t,config:n}=pe(r,e);return!n?.mode||n.mode==="tuple"?new wa(t):new Sa(t)}var Ta=class extends J{static[T]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Ca(e,this.config)}},Ca=class extends U{static[T]="PgMacaddr";getSQLType(){return"macaddr"}};function _f(r){return new Ta(r??"")}var Na=class extends J{static[T]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Aa(e,this.config)}},Aa=class extends U{static[T]="PgMacaddr8";getSQLType(){return"macaddr8"}};function Sf(r){return new Na(r??"")}var Ia=class extends J{static[T]="PgNumericBuilder";constructor(e,t,n){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=n}build(e){return new Qn(e,this.config)}},Qn=class extends U{static[T]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};function Ef(r,e){let{name:t,config:n}=pe(r,e);return new Ia(t,n?.precision,n?.scale)}var Oa=class extends J{static[T]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Pa(e,this.config)}},Pa=class extends U{static[T]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Ra=class extends J{static[T]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new La(e,this.config)}},La=class extends U{static[T]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}};function Tf(r,e){let{name:t,config:n}=pe(r,e);return!n?.mode||n.mode==="tuple"?new Oa(t):new Ra(t)}function Gy(r){let e=[];for(let t=0;t<r.length;t+=2)e.push(Number.parseInt(r.slice(t,t+2),16));return new Uint8Array(e)}function Cf(r,e){let t=new ArrayBuffer(8),n=new DataView(t);for(let s=0;s<8;s++)n.setUint8(s,r[e+s]);return n.getFloat64(0,!0)}function ka(r){let e=Gy(r),t=0,n=e[t];t+=1;let s=new DataView(e.buffer),i=s.getUint32(t,n===1);t+=4;let o;if(i&536870912&&(o=s.getUint32(t,n===1),t+=4),(i&65535)===1){let a=Cf(e,t);t+=8;let u=Cf(e,t);return t+=8,[a,u]}throw new Error("Unsupported geometry type")}var $a=class extends J{static[T]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Ba(e,this.config)}},Ba=class extends U{static[T]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return ka(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},Ma=class extends J{static[T]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new qa(e,this.config)}},qa=class extends U{static[T]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=ka(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}};function Nf(r,e){let{name:t,config:n}=pe(r,e);return!n?.mode||n.mode==="tuple"?new $a(t):new Ma(t)}var Da=class extends J{static[T]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new ja(e,this.config)}},ja=class extends U{static[T]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};function Af(r){return new Da(r??"")}var Fa=class extends J{static[T]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ua(e,this.config)}},Ua=class extends U{static[T]="PgSerial";getSQLType(){return"serial"}};function Ft(r){return new Fa(r??"")}var Qa=class extends jt{static[T]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new Va(e,this.config)}},Va=class extends U{static[T]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e};function If(r){return new Qa(r??"")}var za=class extends J{static[T]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Wa(e,this.config)}},Wa=class extends U{static[T]="PgSmallSerial";getSQLType(){return"smallserial"}};function Of(r){return new za(r??"")}var Ga=class extends J{static[T]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new Ka(e,this.config)}},Ka=class extends U{static[T]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}};function ne(r,e={}){let{name:t,config:n}=pe(r,e);return new Ga(t,n)}var Ha=class extends Ct{constructor(e,t,n){super(e,"string","PgTime"),this.withTimezone=t,this.precision=n,this.config.withTimezone=t,this.config.precision=n}static[T]="PgTimeBuilder";build(e){return new Vn(e,this.config)}},Vn=class extends U{static[T]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function Pf(r,e={}){let{name:t,config:n}=pe(r,e);return new Ha(t,n.withTimezone??!1,n.precision)}var Za=class extends Ct{static[T]="PgTimestampBuilder";constructor(e,t,n){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=n}build(e){return new zn(e,this.config)}},zn=class extends U{static[T]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},Xa=class extends Ct{static[T]="PgTimestampStringBuilder";constructor(e,t,n){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=n}build(e){return new Wn(e,this.config)}},Wn=class extends U{static[T]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function vt(r,e={}){let{name:t,config:n}=pe(r,e);return n?.mode==="string"?new Xa(t,n.withTimezone??!1,n.precision):new Za(t,n?.withTimezone??!1,n?.precision)}var Ja=class extends J{static[T]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(A`gen_random_uuid()`)}build(e){return new Gn(e,this.config)}},Gn=class extends U{static[T]="PgUUID";getSQLType(){return"uuid"}};function Rf(r){return new Ja(r??"")}var Ya=class extends J{static[T]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new ec(e,this.config)}},ec=class extends U{static[T]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};function Hs(r,e={}){let{name:t,config:n}=pe(r,e);return new Ya(t,n)}var tc=class extends J{static[T]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new rc(e,this.config)}},rc=class extends U{static[T]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}};function Lf(r,e){let{name:t,config:n}=pe(r,e);return new tc(t,n)}var nc=class extends J{static[T]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new sc(e,this.config)}},sc=class extends U{static[T]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function kf(r,e){let{name:t,config:n}=pe(r,e);return new nc(t,n)}var ic=class extends J{static[T]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new oc(e,this.config)}},oc=class extends U{static[T]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}};function $f(r,e){let{name:t,config:n}=pe(r,e);return new ic(t,n)}var ac=class extends J{static[T]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new cc(e,this.config)}},cc=class extends U{static[T]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function Bf(r,e){let{name:t,config:n}=pe(r,e);return new ac(t,n)}function Mf(){return{bigint:ff,bigserial:hf,boolean:Jt,char:df,cidr:pf,customType:mf,date:gf,doublePrecision:yf,inet:bf,integer:Nt,interval:xf,json:vf,jsonb:Ks,line:wf,macaddr:_f,macaddr8:Sf,numeric:Ef,point:Tf,geometry:Nf,real:Af,serial:Ft,smallint:If,smallserial:Of,text:ne,time:Pf,timestamp:vt,uuid:Rf,varchar:Hs,bit:Lf,halfvec:kf,sparsevec:$f,vector:Bf}}var uc=Symbol.for("drizzle:PgInlineForeignKeys"),qf=Symbol.for("drizzle:EnableRLS"),De=class extends z{static[T]="PgTable";static Symbol=Object.assign({},z.Symbol,{InlineForeignKeys:uc,EnableRLS:qf});[uc]=[];[qf]=!1;[z.Symbol.ExtraConfigBuilder]=void 0};function Ky(r,e,t,n,s=r){let i=new De(r,n,s),o=typeof e=="function"?e(Mf()):e,a=Object.fromEntries(Object.entries(o).map(([l,d])=>{let g=d;g.setName(l);let x=g.build(i);return i[uc].push(...g.buildForeignKeys(x,i)),[l,x]})),u=Object.fromEntries(Object.entries(o).map(([l,d])=>{let g=d;g.setName(l);let x=g.buildExtraConfigColumn(i);return[l,x]})),h=Object.assign(i,a);return h[z.Symbol.Columns]=a,h[z.Symbol.ExtraConfigColumns]=u,t&&(h[De.Symbol.ExtraConfigBuilder]=t),Object.assign(h,{enableRLS:()=>(h[De.Symbol.EnableRLS]=!0,h)})}var Yt=(r,e,t)=>Ky(r,e,t,void 0);var Zs=class{static[T]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new lc(e,this.columns,this.name)}},lc=class{constructor(e,t,n){this.table=e,this.columns=t,this.name=n}static[T]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[De.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};function et(r,e){return ef(e)&&!zo(r)&&!B(r,Ye)&&!B(r,qt)&&!B(r,ye)&&!B(r,z)&&!B(r,We)?new Ye(r,e):r}var ct=(r,e)=>A`${r} = ${et(e,r)}`,Df=(r,e)=>A`${r} <> ${et(e,r)}`;function Kn(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new W(e):new W([new $e("("),A.join(e,new $e(" and ")),new $e(")")])}function jf(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new W(e):new W([new $e("("),A.join(e,new $e(" or ")),new $e(")")])}function Ff(r){return A`not ${r}`}var Uf=(r,e)=>A`${r} > ${et(e,r)}`,Qf=(r,e)=>A`${r} >= ${et(e,r)}`,Vf=(r,e)=>A`${r} < ${et(e,r)}`,zf=(r,e)=>A`${r} <= ${et(e,r)}`;function Wf(r,e){return Array.isArray(e)?e.length===0?A`false`:A`${r} in ${e.map(t=>et(t,r))}`:A`${r} in ${et(e,r)}`}function Gf(r,e){return Array.isArray(e)?e.length===0?A`true`:A`${r} not in ${e.map(t=>et(t,r))}`:A`${r} not in ${et(e,r)}`}function Kf(r){return A`${r} is null`}function Hf(r){return A`${r} is not null`}function Zf(r){return A`exists ${r}`}function Xf(r){return A`not exists ${r}`}function Jf(r,e,t){return A`${r} between ${et(e,r)} and ${et(t,r)}`}function Yf(r,e,t){return A`${r} not between ${et(e,r)} and ${et(t,r)}`}function eh(r,e){return A`${r} like ${e}`}function th(r,e){return A`${r} not like ${e}`}function rh(r,e){return A`${r} ilike ${e}`}function nh(r,e){return A`${r} not ilike ${e}`}function sh(r){return A`${r} asc`}function ih(r){return A`${r} desc`}var Xs=class{constructor(e,t,n){this.sourceTable=e,this.referencedTable=t,this.relationName=n,this.referencedTableName=t[z.Symbol.Name]}static[T]="Relation";referencedTableName;fieldName},fc=class{constructor(e,t){this.table=e,this.config=t}static[T]="Relations"},er=class r extends Xs{constructor(e,t,n,s){super(e,t,n?.relationName),this.config=n,this.isNullable=s}static[T]="One";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},Hn=class r extends Xs{constructor(e,t,n){super(e,t,n?.relationName),this.config=n}static[T]="Many";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}};function oh(){return{and:Kn,between:Jf,eq:ct,exists:Zf,gt:Uf,gte:Qf,ilike:rh,inArray:Wf,isNull:Kf,isNotNull:Hf,like:eh,lt:Vf,lte:zf,ne:Df,not:Ff,notBetween:Yf,notExists:Xf,notLike:th,notIlike:nh,notInArray:Gf,or:jf,sql:A}}function ah(){return{sql:A,asc:sh,desc:ih}}function ch(r,e){Object.keys(r).length===1&&"default"in r&&!B(r.default,z)&&(r=r.default);let t={},n={},s={};for(let[i,o]of Object.entries(r))if(B(o,z)){let a=pr(o),u=n[a];t[a]=i,s[i]={tsName:i,dbName:o[z.Symbol.Name],schema:o[z.Symbol.Schema],columns:o[z.Symbol.Columns],relations:u?.relations??{},primaryKey:u?.primaryKey??[]};for(let l of Object.values(o[z.Symbol.Columns]))l.primary&&s[i].primaryKey.push(l);let h=o[z.Symbol.ExtraConfigBuilder]?.(o[z.Symbol.ExtraConfigColumns]);if(h)for(let l of Object.values(h))B(l,Zs)&&s[i].primaryKey.push(...l.columns)}else if(B(o,fc)){let a=pr(o.table),u=t[a],h=o.config(e(o.table)),l;for(let[d,g]of Object.entries(h))if(u){let x=s[u];x.relations[d]=g,l&&x.primaryKey.push(...l)}else a in n||(n[a]={relations:{},primaryKey:l}),n[a].relations[d]=g}return{tables:s,tableNamesMap:t}}function Hy(r){return function(t,n){return new er(r,t,n,n?.fields.reduce((s,i)=>s&&i.notNull,!0)??!1)}}function Zy(r){return function(t,n){return new Hn(r,t,n)}}function uh(r,e,t){if(B(t,er)&&t.config)return{fields:t.config.fields,references:t.config.references};let n=e[pr(t.referencedTable)];if(!n)throw new Error(`Table "${t.referencedTable[z.Symbol.Name]}" not found in schema`);let s=r[n];if(!s)throw new Error(`Table "${n}" not found in schema`);let i=t.sourceTable,o=e[pr(i)];if(!o)throw new Error(`Table "${i[z.Symbol.Name]}" not found in schema`);let a=[];for(let u of Object.values(s.relations))(t.relationName&&t!==u&&u.relationName===t.relationName||!t.relationName&&u.referencedTable===t.sourceTable)&&a.push(u);if(a.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${t.sourceTable[z.Symbol.Name]}". Please specify relation name`);if(a[0]&&B(a[0],er)&&a[0].config)return{fields:a[0].config.references,references:a[0].config.fields};throw new Error(`There is not enough information to infer relation "${o}.${t.fieldName}"`)}function lh(r){return{one:Hy(r),many:Zy(r)}}function Js(r,e,t,n,s=i=>i){let i={};for(let[o,a]of n.entries())if(a.isJson){let u=e.relations[a.tsKey],h=t[o],l=typeof h=="string"?JSON.parse(h):h;i[a.tsKey]=B(u,er)?l&&Js(r,r[a.relationTableTsKey],l,a.selection,s):l.map(d=>Js(r,r[a.relationTableTsKey],d,a.selection,s))}else{let u=s(t[o]),h=a.field,l;B(h,ye)?l=h:B(h,W)?l=h.decoder:l=h.sql.decoder,i[a.tsKey]=u===null?null:l.mapFromDriverValue(u)}return i}var Xr=class extends We{static[T]="PgViewBase"};var tr=class{static[T]="PgDialect";casing;constructor(e){this.casing=new Ws(e?.casing)}async migrate(e,t,n){let s=typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",i=typeof n=="string"?"drizzle":n.migrationsSchema??"drizzle",o=A`
			CREATE TABLE IF NOT EXISTS ${A.identifier(i)}.${A.identifier(s)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(A`CREATE SCHEMA IF NOT EXISTS ${A.identifier(i)}`),await t.execute(o);let u=(await t.all(A`select id, hash, created_at from ${A.identifier(i)}.${A.identifier(s)} order by created_at desc limit 1`))[0];await t.transaction(async h=>{for await(let l of e)if(!u||Number(u.created_at)<l.folderMillis){for(let d of l.sql)await h.execute(A.raw(d));await h.execute(A`insert into ${A.identifier(i)}.${A.identifier(s)} ("hash", "created_at") values(${l.hash}, ${l.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[A`with `];for(let[n,s]of e.entries())t.push(A`${A.identifier(s._.alias)} as (${s._.sql})`),n<e.length-1&&t.push(A`, `);return t.push(A` `),A.join(t)}buildDeleteQuery({table:e,where:t,returning:n,withList:s}){let i=this.buildWithCTE(s),o=n?A` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,a=t?A` where ${t}`:void 0;return A`${i}delete from ${e}${a}${o}`}buildUpdateSet(e,t){let n=e[z.Symbol.Columns],s=Object.keys(n).filter(o=>t[o]!==void 0||n[o]?.onUpdateFn!==void 0),i=s.length;return A.join(s.flatMap((o,a)=>{let u=n[o],h=t[o]??A.param(u.onUpdateFn(),u),l=A`${A.identifier(this.casing.getColumnCasing(u))} = ${h}`;return a<i-1?[l,A.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:t,where:n,returning:s,withList:i,from:o,joins:a}){let u=this.buildWithCTE(i),h=e[De.Symbol.Name],l=e[De.Symbol.Schema],d=e[De.Symbol.OriginalName],g=h===d?void 0:h,x=A`${l?A`${A.identifier(l)}.`:void 0}${A.identifier(d)}${g&&A` ${A.identifier(g)}`}`,m=this.buildUpdateSet(e,t),f=o&&A.join([A.raw(" from "),this.buildFromTable(o)]),v=this.buildJoins(a),w=s?A` returning ${this.buildSelection(s,{isSingleTable:!o})}`:void 0,_=n?A` where ${n}`:void 0;return A`${u}update ${x} set ${m}${f}${v}${_}${w}`}buildSelection(e,{isSingleTable:t=!1}={}){let n=e.length,s=e.flatMap(({field:i},o)=>{let a=[];if(B(i,W.Aliased)&&i.isSelectionField)a.push(A.identifier(i.fieldAlias));else if(B(i,W.Aliased)||B(i,W)){let u=B(i,W.Aliased)?i.sql:i;t?a.push(new W(u.queryChunks.map(h=>B(h,U)?A.identifier(this.casing.getColumnCasing(h)):h))):a.push(u),B(i,W.Aliased)&&a.push(A` as ${A.identifier(i.fieldAlias)}`)}else B(i,ye)&&(t?a.push(A.identifier(this.casing.getColumnCasing(i))):a.push(i));return o<n-1&&a.push(A`, `),a});return A.join(s)}buildJoins(e){if(!e||e.length===0)return;let t=[];for(let[n,s]of e.entries()){n===0&&t.push(A` `);let i=s.table,o=s.lateral?A` lateral`:void 0;if(B(i,De)){let a=i[De.Symbol.Name],u=i[De.Symbol.Schema],h=i[De.Symbol.OriginalName],l=a===h?void 0:s.alias;t.push(A`${A.raw(s.joinType)} join${o} ${u?A`${A.identifier(u)}.`:void 0}${A.identifier(h)}${l&&A` ${A.identifier(l)}`} on ${s.on}`)}else if(B(i,We)){let a=i[ve].name,u=i[ve].schema,h=i[ve].originalName,l=a===h?void 0:s.alias;t.push(A`${A.raw(s.joinType)} join${o} ${u?A`${A.identifier(u)}.`:void 0}${A.identifier(h)}${l&&A` ${A.identifier(l)}`} on ${s.on}`)}else t.push(A`${A.raw(s.joinType)} join${o} ${i} on ${s.on}`);n<e.length-1&&t.push(A` `)}return A.join(t)}buildFromTable(e){if(B(e,z)&&e[z.Symbol.OriginalName]!==e[z.Symbol.Name]){let t=A`${A.identifier(e[z.Symbol.OriginalName])}`;return e[z.Symbol.Schema]&&(t=A`${A.identifier(e[z.Symbol.Schema])}.${t}`),A`${t} ${A.identifier(e[z.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:n,where:s,having:i,table:o,joins:a,orderBy:u,groupBy:h,limit:l,offset:d,lockingClause:g,distinct:x,setOperators:m}){let f=n??at(t);for(let k of f)if(B(k.field,ye)&&Je(k.field.table)!==(B(o,Le)?o._.alias:B(o,Xr)?o[ve].name:B(o,W)?void 0:Je(o))&&!(Q=>a?.some(({alias:ee})=>ee===(Q[z.Symbol.IsAlias]?Je(Q):Q[z.Symbol.BaseName])))(k.field.table)){let Q=Je(k.field.table);throw new Error(`Your "${k.path.join("->")}" field references a column "${Q}"."${k.field.name}", but the table "${Q}" is not part of the query! Did you forget to join it?`)}let v=!a||a.length===0,w=this.buildWithCTE(e),_;x&&(_=x===!0?A` distinct`:A` distinct on (${A.join(x.on,A`, `)})`);let E=this.buildSelection(f,{isSingleTable:v}),R=this.buildFromTable(o),L=this.buildJoins(a),S=s?A` where ${s}`:void 0,O=i?A` having ${i}`:void 0,I;u&&u.length>0&&(I=A` order by ${A.join(u,A`, `)}`);let C;h&&h.length>0&&(C=A` group by ${A.join(h,A`, `)}`);let M=typeof l=="object"||typeof l=="number"&&l>=0?A` limit ${l}`:void 0,$=d?A` offset ${d}`:void 0,Z=A.empty();if(g){let k=A` for ${A.raw(g.strength)}`;g.config.of&&k.append(A` of ${A.join(Array.isArray(g.config.of)?g.config.of:[g.config.of],A`, `)}`),g.config.noWait?k.append(A` no wait`):g.config.skipLocked&&k.append(A` skip locked`),Z.append(k)}let X=A`${w}select${_} ${E} from ${R}${L}${S}${C}${O}${I}${M}${$}${Z}`;return m.length>0?this.buildSetOperations(X,m):X}buildSetOperations(e,t){let[n,...s]=t;if(!n)throw new Error("Cannot pass undefined values to any set operator");return s.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),s)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:n,rightSelect:s,limit:i,orderBy:o,offset:a}}){let u=A`(${e.getSQL()}) `,h=A`(${s.getSQL()})`,l;if(o&&o.length>0){let m=[];for(let f of o)if(B(f,U))m.push(A.identifier(f.name));else if(B(f,W)){for(let v=0;v<f.queryChunks.length;v++){let w=f.queryChunks[v];B(w,U)&&(f.queryChunks[v]=A.identifier(w.name))}m.push(A`${f}`)}else m.push(A`${f}`);l=A` order by ${A.join(m,A`, `)} `}let d=typeof i=="object"||typeof i=="number"&&i>=0?A` limit ${i}`:void 0,g=A.raw(`${t} ${n?"all ":""}`),x=a?A` offset ${a}`:void 0;return A`${u}${g}${h}${l}${d}${x}`}buildInsertQuery({table:e,values:t,onConflict:n,returning:s,withList:i,select:o,overridingSystemValue_:a}){let u=[],h=e[z.Symbol.Columns],l=Object.entries(h).filter(([w,_])=>!_.shouldDisableInsert()),d=l.map(([,w])=>A.identifier(this.casing.getColumnCasing(w)));if(o){let w=t;B(w,W)?u.push(w):u.push(w.getSQL())}else{let w=t;u.push(A.raw("values "));for(let[_,E]of w.entries()){let R=[];for(let[L,S]of l){let O=E[L];if(O===void 0||B(O,Ye)&&O.value===void 0)if(S.defaultFn!==void 0){let I=S.defaultFn(),C=B(I,W)?I:A.param(I,S);R.push(C)}else if(!S.default&&S.onUpdateFn!==void 0){let I=S.onUpdateFn(),C=B(I,W)?I:A.param(I,S);R.push(C)}else R.push(A`default`);else R.push(O)}u.push(R),_<w.length-1&&u.push(A`, `)}}let g=this.buildWithCTE(i),x=A.join(u),m=s?A` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,f=n?A` on conflict ${n}`:void 0,v=a===!0?A`overriding system value `:void 0;return A`${g}insert into ${e} ${d} ${v}${x}${f}${m}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:n}){let s=t?A` concurrently`:void 0,i=n?A` with no data`:void 0;return A`refresh materialized view${s} ${e}${i}`}prepareTyping(e){return B(e,Un)||B(e,Fn)?"json":B(e,Qn)?"decimal":B(e,Vn)?"time":B(e,zn)||B(e,Wn)?"timestamp":B(e,Dn)||B(e,jn)?"date":B(e,Gn)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:s,tableConfig:i,queryConfig:o,tableAlias:a,nestedQueryRelation:u,joinOn:h}){let l=[],d,g,x=[],m,f=[];if(o===!0)l=Object.entries(i.columns).map(([_,E])=>({dbKey:E.name,tsKey:_,field:Tt(E,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(i.columns).map(([O,I])=>[O,Tt(I,a)]));if(o.where){let O=typeof o.where=="function"?o.where(w,oh()):o.where;m=O&&$n(O,a)}let _=[],E=[];if(o.columns){let O=!1;for(let[I,C]of Object.entries(o.columns))C!==void 0&&I in i.columns&&(!O&&C===!0&&(O=!0),E.push(I));E.length>0&&(E=O?E.filter(I=>o.columns?.[I]===!0):Object.keys(i.columns).filter(I=>!E.includes(I)))}else E=Object.keys(i.columns);for(let O of E){let I=i.columns[O];_.push({tsKey:O,value:I})}let R=[];o.with&&(R=Object.entries(o.with).filter(O=>!!O[1]).map(([O,I])=>({tsKey:O,queryConfig:I,relation:i.relations[O]})));let L;if(o.extras){L=typeof o.extras=="function"?o.extras(w,{sql:A}):o.extras;for(let[O,I]of Object.entries(L))_.push({tsKey:O,value:Wo(I,a)})}for(let{tsKey:O,value:I}of _)l.push({dbKey:B(I,W.Aliased)?I.fieldAlias:i.columns[O].name,tsKey:O,field:B(I,ye)?Tt(I,a):I,relationTableTsKey:void 0,isJson:!1,selection:[]});let S=typeof o.orderBy=="function"?o.orderBy(w,ah()):o.orderBy??[];Array.isArray(S)||(S=[S]),x=S.map(O=>B(O,ye)?Tt(O,a):$n(O,a)),d=o.limit,g=o.offset;for(let{tsKey:O,queryConfig:I,relation:C}of R){let M=uh(t,n,C),$=pr(C.referencedTable),Z=n[$],X=`${a}_${O}`,k=Kn(...M.fields.map((ce,ge)=>ct(Tt(M.references[ge],X),Tt(ce,a)))),Q=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:e[Z],tableConfig:t[Z],queryConfig:B(C,er)?I===!0?{limit:1}:{...I,limit:1}:I,tableAlias:X,joinOn:k,nestedQueryRelation:C}),ee=A`${A.identifier(X)}.${A.identifier("data")}`.as(O);f.push({on:A`true`,table:new Le(Q.sql,{},X),alias:X,joinType:"left",lateral:!0}),l.push({dbKey:O,tsKey:O,field:ee,relationTableTsKey:Z,isJson:!0,selection:Q.selection})}}if(l.length===0)throw new qn({message:`No fields selected for table "${i.tsName}" ("${a}")`});let v;if(m=Kn(h,m),u){let w=A`json_build_array(${A.join(l.map(({field:R,tsKey:L,isJson:S})=>S?A`${A.identifier(`${a}_${L}`)}.${A.identifier("data")}`:B(R,W.Aliased)?R.sql:R),A`, `)})`;B(u,Hn)&&(w=A`coalesce(json_agg(${w}${x.length>0?A` order by ${A.join(x,A`, `)}`:void 0}), '[]'::json)`);let _=[{dbKey:"data",tsKey:"data",field:w.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:l}];d!==void 0||g!==void 0||x.length>0?(v=this.buildSelectQuery({table:kn(s,a),fields:{},fieldsFlat:[{path:[],field:A.raw("*")}],where:m,limit:d,offset:g,orderBy:x,setOperators:[]}),m=void 0,d=void 0,g=void 0,x=[]):v=kn(s,a),v=this.buildSelectQuery({table:B(v,De)?v:new Le(v,{},a),fields:{},fieldsFlat:_.map(({field:R})=>({path:[],field:B(R,ye)?Tt(R,a):R})),joins:f,where:m,limit:d,offset:g,orderBy:x,setOperators:[]})}else v=this.buildSelectQuery({table:kn(s,a),fields:{},fieldsFlat:l.map(({field:w})=>({path:[],field:B(w,ye)?Tt(w,a):w})),joins:f,where:m,limit:d,offset:g,orderBy:x,setOperators:[]});return{tableTsKey:i.tsName,sql:v,selection:l}}};var Ys=class{static[T]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var Qe=class{static[T]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let t=!!this.fields,n=e,s;return this.fields?s=this.fields:B(n,Le)?s=Object.fromEntries(Object.keys(n._.selectedFields).map(i=>[i,n[i]])):B(n,Xr)?s=n[ve].selectedFields:B(n,W)?s={}:s=zs(n),new ei({table:n,fields:s,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},hc=class extends Ys{static[T]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:n,session:s,dialect:i,withList:o,distinct:a}){super(),this.config={withList:o,table:e,fields:{...t},distinct:a,setOperators:[]},this.isPartialSelect=n,this.session=s,this.dialect=i,this._={selectedFields:t},this.tableName=Dt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(t,n)=>{let s=this.tableName,i=Dt(t);if(typeof i=="string"&&this.config.joins?.some(o=>o.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof s=="string"&&(this.config.fields={[s]:this.config.fields}),typeof i=="string"&&!B(t,W))){let o=B(t,Le)?t._.selectedFields:B(t,We)?t[ve].selectedFields:t[z.Symbol.Columns];this.config.fields[i]=o}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new Oe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:t,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return n=>{let s=typeof n=="function"?n(Xy()):n;if(!Bn(this.getSelectedFields(),s.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:s}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Oe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Oe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new Oe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new Oe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new Le(this.getSQL(),this.config.fields,e),new Oe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Oe({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},ei=class extends hc{static[T]="PgSelect";_prepare(e){let{session:t,config:n,dialect:s,joinsNotNullableMap:i,authToken:o}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ke.startActiveSpan("drizzle.prepareQuery",()=>{let a=at(n.fields),u=t.prepareQuery(s.sqlToQuery(this.getSQL()),a,e,!0);return u.joinsNotNullableMap=i,u.setToken(o)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ke.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};cf(ei,[Ue]);function Jr(r,e){return(t,n,...s)=>{let i=[n,...s].map(o=>({type:r,isAll:e,rightSelect:o}));for(let o of i)if(!Bn(t.getSelectedFields(),o.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(i)}}var Xy=()=>({union:Jy,unionAll:Yy,intersect:eb,intersectAll:tb,except:rb,exceptAll:nb}),Jy=Jr("union",!1),Yy=Jr("union",!0),eb=Jr("intersect",!1),tb=Jr("intersect",!0),rb=Jr("except",!1),nb=Jr("except",!0);var Yr=class{static[T]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=B(e,tr)?e:void 0,this.dialectConfig=B(e,tr)?void 0:e}$with=(e,t)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(n)),new Proxy(new Hr(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new Oe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;function n(o){return new Qe({fields:o??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function s(o){return new Qe({fields:o??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function i(o,a){return new Qe({fields:a??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:o}})}return{select:n,selectDistinct:s,selectDistinctOn:i}}select(e){return new Qe({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Qe({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new Qe({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new tr(this.dialectConfig)),this.dialect}};var Zn=class{constructor(e,t,n,s,i){this.table=e,this.session=t,this.dialect=n,this.withList=s,this.overridingSystemValue_=i}static[T]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let t=e.map(n=>{let s={},i=this.table[z.Symbol.Columns];for(let o of Object.keys(n)){let a=n[o];s[o]=B(a,W)?a:new Ye(a,i[o])}return s});return new ti(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let t=typeof e=="function"?e(new Yr):e;if(!B(t,W)&&!Bn(this.table[Us],t._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new ti(this.table,t,this.session,this.dialect,this.withList,!0)}},ti=class extends Ue{constructor(e,t,n,s,i,o,a){super(),this.session=n,this.dialect=s,this.config={table:e,values:t,withList:i,select:o,overridingSystemValue_:a}}static[T]="PgInsert";config;returning(e=this.config.table[z.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=at(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=A`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(s=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(s))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?A` where ${e.where}`:void 0;this.config.onConflict=A`(${A.raw(t)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?A` where ${e.where}`:void 0,n=e.targetWhere?A` where ${e.targetWhere}`:void 0,s=e.setWhere?A` where ${e.setWhere}`:void 0,i=this.dialect.buildUpdateSet(this.config.table,Vs(this.config.table,e.set)),o="";return o=Array.isArray(e.target)?e.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=A`(${A.raw(o)})${n} do update set ${i}${t}${s}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return ke.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ke.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Oe({alias:Je(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var ri=class extends Ue{constructor(e,t,n){super(),this.session=t,this.dialect=n,this.config={view:e}}static[T]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return ke.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>ke.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Xn=class{constructor(e,t,n,s){this.table=e,this.session=t,this.dialect=n,this.withList=s}static[T]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new dc(this.table,Vs(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},dc=class extends Ue{constructor(e,t,n,s,i){super(),this.session=n,this.dialect=s,this.config={set:t,table:e,withList:i,joins:[]},this.tableName=Dt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[T]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let t=e,n=Dt(t);return typeof n=="string"&&(this.joinsNotNullableMap[n]=!0),this.config.from=t,this}getTableLikeFields(e){return B(e,De)?e[z.Symbol.Columns]:B(e,Le)?e._.selectedFields:e[ve].selectedFields}createJoin(e){return(t,n)=>{let s=Dt(t);if(typeof s=="string"&&this.config.joins.some(i=>i.alias===s))throw new Error(`Alias "${s}" is already used in this query`);if(typeof n=="function"){let i=this.config.from&&!B(this.config.from,W)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[z.Symbol.Columns],new Oe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),i&&new Proxy(i,new Oe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:n,table:t,joinType:e,alias:s}),typeof s=="string")switch(e){case"left":{this.joinsNotNullableMap[s]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[s]=!0;break}case"inner":{this.joinsNotNullableMap[s]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[s]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[z.Symbol.Columns]),this.config.from)){let t=Dt(this.config.from);if(typeof t=="string"&&this.config.from&&!B(this.config.from,W)){let n=this.getTableLikeFields(this.config.from);e[t]=n}for(let n of this.config.joins){let s=Dt(n.table);if(typeof s=="string"&&!B(n.table,W)){let i=this.getTableLikeFields(n.table);e[s]=i}}}return this.config.returningFields=e,this.config.returning=at(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Oe({alias:Je(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var ni=class r extends W{constructor(e){super(r.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=r.buildCount(e.source,e.filters)}sql;token;static[T]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return A`(select count(*) from ${e}${A.raw(" where ").if(t)}${t})`}static buildCount(e,t){return A`select count(*) as count from ${e}${A.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}};var si=class{constructor(e,t,n,s,i,o,a){this.fullSchema=e,this.schema=t,this.tableNamesMap=n,this.table=s,this.tableConfig=i,this.dialect=o,this.session=a}static[T]="PgRelationalQueryBuilder";findMany(e){return new ii(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new ii(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},ii=class extends Ue{constructor(e,t,n,s,i,o,a,u,h){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=n,this.table=s,this.tableConfig=i,this.dialect=o,this.session=a,this.config=u,this.mode=h}static[T]="PgRelationalQuery";_prepare(e){return ke.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(s,i)=>{let o=s.map(a=>Js(this.schema,this.tableConfig,a,t.selection,i));return this.mode==="first"?o[0]:o})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ke.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var oi=class extends Ue{constructor(e,t,n,s){super(),this.execute=e,this.sql=t,this.query=n,this.mapBatchResult=s}static[T]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var en=class{constructor(e,t,n){if(this.dialect=e,this.session=t,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[s,i]of Object.entries(this._.schema))this.query[s]=new si(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[s],i,e,t)}static[T]="PgDatabase";query;$with=(e,t)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(new Yr(n.dialect))),new Proxy(new Hr(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new Oe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new ni({source:e,filters:t,session:this.session})}with(...e){let t=this;function n(h){return new Qe({fields:h??void 0,session:t.session,dialect:t.dialect,withList:e})}function s(h){return new Qe({fields:h??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}function i(h,l){return new Qe({fields:l??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:h}})}function o(h){return new Xn(h,t.session,t.dialect,e)}function a(h){return new Zn(h,t.session,t.dialect,e)}function u(h){return new Mn(h,t.session,t.dialect,e)}return{select:n,selectDistinct:s,selectDistinctOn:i,update:o,insert:a,delete:u}}select(e){return new Qe({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Qe({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new Qe({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Xn(e,this.session,this.dialect)}insert(e){return new Zn(e,this.session,this.dialect)}delete(e){return new Mn(e,this.session,this.dialect)}refreshMaterializedView(e){return new ri(e,this.session,this.dialect)}authToken;execute(e){let t=typeof e=="string"?A.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(t),s=this.session.prepareQuery(n,void 0,void 0,!1);return new oi(()=>s.execute(void 0,this.authToken),t,n,i=>s.mapResult(i,!0))}transaction(e,t){return this.session.transaction(e,t)}};var pc=class{constructor(e,t){this.unique=e,this.name=t}static[T]="PgIndexBuilderOn";on(...e){return new Jn(e.map(t=>{if(B(t,W))return t;t=t;let n=new Kr(t.name,!!t.keyAsName,t.columnType,t.indexConfig);return t.indexConfig=JSON.parse(JSON.stringify(t.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Jn(e.map(t=>{if(B(t,W))return t;t=t;let n=new Kr(t.name,!!t.keyAsName,t.columnType,t.indexConfig);return t.indexConfig=t.defaultConfig,n}),this.unique,!0,this.name)}using(e,...t){return new Jn(t.map(n=>{if(B(n,W))return n;n=n;let s=new Kr(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),s}),this.unique,!0,this.name,e)}},Jn=class{static[T]="PgIndexBuilder";config;constructor(e,t,n,s,i="btree"){this.config={name:s,columns:e,unique:t,only:n,method:i}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new mc(this.config,e)}},mc=class{static[T]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}};function fh(r){return new pc(!1,r)}var ai=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static[T]="PgPreparedQuery";joinsNotNullableMap},ci=class{constructor(e){this.dialect=e}static[T]="PgSession";execute(e,t){return ke.startActiveSpan("drizzle.operation",()=>ke.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){let n=await this.execute(e,t);return Number(n[0].count)}},ui=class extends en{constructor(e,t,n,s=0){super(e,t,n),this.schema=n,this.nestedIndex=s}static[T]="PgTransaction";rollback(){throw new Gs}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),typeof e.deferrable=="boolean"&&t.push(e.deferrable?"deferrable":"not deferrable"),A.raw(t.join(" "))}setTransaction(e){return this.session.execute(A`set transaction ${this.getTransactionConfigSQL(e)}`)}};var gc=class extends ai{constructor(e,t,n,s,i,o,a,u){super({sql:t,params:n}),this.client=e,this.params=n,this.logger=s,this.fields=i,this._isResponseInArrayMode=a,this.customResultMapper=u,this.rawQueryConfig={name:o,text:t,types:{getTypeParser:(h,l)=>h===bt.builtins.TIMESTAMPTZ?d=>d:h===bt.builtins.TIMESTAMP?d=>d:h===bt.builtins.DATE?d=>d:h===bt.builtins.INTERVAL?d=>d:bt.getTypeParser(h,l)}},this.queryConfig={name:o,text:t,rowMode:"array",types:{getTypeParser:(h,l)=>h===bt.builtins.TIMESTAMPTZ?d=>d:h===bt.builtins.TIMESTAMP?d=>d:h===bt.builtins.DATE?d=>d:h===bt.builtins.INTERVAL?d=>d:bt.getTypeParser(h,l)}}}static[T]="NeonPreparedQuery";rawQueryConfig;queryConfig;async execute(e={}){let t=Qs(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,t);let{fields:n,client:s,rawQueryConfig:i,queryConfig:o,joinsNotNullableMap:a,customResultMapper:u}=this;if(!n&&!u)return s.query(i,t);let h=await s.query(o,t);return u?u(h.rows):h.rows.map(l=>af(n,l,a))}all(e={}){let t=Qs(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),this.client.query(this.rawQueryConfig,t).then(n=>n.rows)}values(e={}){let t=Qs(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),this.client.query(this.queryConfig,t).then(n=>n.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}},li=class r extends ci{constructor(e,t,n,s={}){super(t),this.client=e,this.schema=n,this.options=s,this.logger=s.logger??new Ms}static[T]="NeonSession";logger;prepareQuery(e,t,n,s,i){return new gc(this.client,e.sql,e.params,this.logger,t,n,s,i)}async query(e,t){return this.logger.logQuery(e,t),await this.client.query({rowMode:"array",text:e,values:t})}async queryObjects(e,t){return this.client.query(e,t)}async count(e){let t=await this.execute(e);return Number(t.rows[0].count)}async transaction(e,t={}){let n=this.client instanceof Mt?new r(await this.client.connect(),this.dialect,this.schema,this.options):this,s=new yc(this.dialect,n,this.schema);await s.execute(A`begin ${s.getTransactionConfigSQL(t)}`);try{let i=await e(s);return await s.execute(A`commit`),i}catch(i){throw await s.execute(A`rollback`),i}finally{this.client instanceof Mt&&n.client.release()}}},yc=class r extends ui{static[T]="NeonTransaction";async transaction(e){let t=`sp${this.nestedIndex+1}`,n=new r(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(A.raw(`savepoint ${t}`));try{let s=await e(n);return await n.execute(A.raw(`release savepoint ${t}`)),s}catch(s){throw await n.execute(A.raw(`rollback to savepoint ${t}`)),s}}};var bc=class{constructor(e,t,n={}){this.client=e,this.dialect=t,this.options=n}static[T]="NeonDriver";createSession(e){return new li(this.client,this.dialect,e,{logger:this.options.logger})}},xc=class extends en{static[T]="NeonServerlessDatabase"};function Yn(r,e={}){let t=new tr({casing:e.casing}),n;e.logger===!0?n=new Bs:e.logger!==!1&&(n=e.logger);let s;if(e.schema){let u=ch(e.schema,lh);s={fullSchema:e.schema,schema:u.tables,tableNamesMap:u.tableNamesMap}}let o=new bc(r,t,{logger:n}).createSession(s),a=new xc(t,o,s);return a.$client=r,a}function fi(...r){if(typeof r[0]=="string"){let e=new Mt({connectionString:r[0]});return Yn(e,r[1])}if(lf(r[0])){let{connection:e,client:t,ws:n,...s}=r[0];if(n&&(Bt.webSocketConstructor=n),t)return Yn(t,s);let i=typeof e=="string"?new Mt({connectionString:e}):new Mt(e);return Yn(i,s)}return Yn(r[0],r[1])}(r=>{function e(t){return Yn({},t)}r.mock=e})(fi||(fi={}));var me;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{let i={};for(let o of s)i[o]=o;return i},r.getValidEnumValues=s=>{let i=r.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(let a of i)o[a]=s[a];return r.objectValues(o)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let i=[];for(let o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},r.find=(s,i)=>{for(let o of s)if(i(o))return o},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(me||(me={}));var wc;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(wc||(wc={}));var G=me.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Qt=r=>{switch(typeof r){case"undefined":return G.undefined;case"string":return G.string;case"number":return isNaN(r)?G.nan:G.number;case"boolean":return G.boolean;case"function":return G.function;case"bigint":return G.bigint;case"symbol":return G.symbol;case"object":return Array.isArray(r)?G.array:r===null?G.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?G.promise:typeof Map<"u"&&r instanceof Map?G.map:typeof Set<"u"&&r instanceof Set?G.set:typeof Date<"u"&&r instanceof Date?G.date:G.object;default:return G.unknown}},D=me.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),sb=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),nt=class r extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(let o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,u=0;for(;u<o.path.length;){let h=o.path[u];u===o.path.length-1?(a[h]=a[h]||{_errors:[]},a[h]._errors.push(t(o))):a[h]=a[h]||{_errors:[]},a=a[h],u++}}};return s(this),n}static assert(e){if(!(e instanceof r))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,me.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};nt.create=r=>new nt(r);var nn=(r,e)=>{let t;switch(r.code){case D.invalid_type:r.received===G.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case D.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,me.jsonStringifyReplacer)}`;break;case D.unrecognized_keys:t=`Unrecognized key(s) in object: ${me.joinValues(r.keys,", ")}`;break;case D.invalid_union:t="Invalid input";break;case D.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${me.joinValues(r.options)}`;break;case D.invalid_enum_value:t=`Invalid enum value. Expected ${me.joinValues(r.options)}, received '${r.received}'`;break;case D.invalid_arguments:t="Invalid function arguments";break;case D.invalid_return_type:t="Invalid function return type";break;case D.invalid_date:t="Invalid date";break;case D.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:me.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case D.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case D.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case D.custom:t="Invalid input";break;case D.invalid_intersection_types:t="Intersection results could not be merged";break;case D.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case D.not_finite:t="Number must be finite";break;default:t=e.defaultError,me.assertNever(r)}return{message:t}},mh=nn;function ib(r){mh=r}function hi(){return mh}var di=r=>{let{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let a="",u=n.filter(h=>!!h).slice().reverse();for(let h of u)a=h(o,{data:e,defaultError:a}).message;return{...s,path:i,message:a}},ob=[];function V(r,e){let t=hi(),n=di({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===nn?void 0:nn].filter(s=>!!s)});r.common.issues.push(n)}var Ve=class r{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let s of t){if(s.status==="aborted")return ie;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let s of t){let i=await s.key,o=await s.value;n.push({key:i,value:o})}return r.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let s of t){let{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return ie;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}},ie=Object.freeze({status:"aborted"}),rn=r=>({status:"dirty",value:r}),Ge=r=>({status:"valid",value:r}),_c=r=>r.status==="aborted",Sc=r=>r.status==="dirty",gr=r=>r.status==="valid",rs=r=>typeof Promise<"u"&&r instanceof Promise;function pi(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function gh(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t}var Y;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(Y||(Y={}));var es,ts,lt=class{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},hh=(r,e)=>{if(gr(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new nt(r.common.issues);return this._error=t,this._error}}};function le(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>{var u,h;let{message:l}=r;return o.code==="invalid_enum_value"?{message:l??a.defaultError}:typeof a.data>"u"?{message:(u=l??n)!==null&&u!==void 0?u:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(h=l??t)!==null&&h!==void 0?h:a.defaultError}},description:s}}var fe=class{get description(){return this._def.description}_getType(e){return Qt(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Qt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ve,ctx:{common:e.parent.common,data:e.data,parsedType:Qt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(rs(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;let s={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qt(e)},i=this._parseSync({data:e,path:s.path,parent:s});return hh(s,i)}"~validate"(e){var t,n;let s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qt(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:s});return gr(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(t=i?.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(i=>gr(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Qt(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(rs(s)?s:Promise.resolve(s));return hh(n,i)}refine(e,t){let n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{let o=e(s),a=()=>i.addIssue({code:D.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new st({schema:this,typeName:se.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ut.create(this,this._def)}nullable(){return It.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return zt.create(this)}promise(){return sr.create(this,this._def)}or(e){return Sr.create([this,e],this._def)}and(e){return Er.create(this,e,this._def)}transform(e){return new st({...le(this._def),schema:this,typeName:se.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Ir({...le(this._def),innerType:this,defaultValue:t,typeName:se.ZodDefault})}brand(){return new ns({typeName:se.ZodBranded,type:this,...le(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new Or({...le(this._def),innerType:this,catchValue:t,typeName:se.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ss.create(this,e)}readonly(){return Pr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},ab=/^c[^\s-]{8,}$/i,cb=/^[0-9a-z]+$/,ub=/^[0-9A-HJKMNP-TV-Z]{26}$/i,lb=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,fb=/^[a-z0-9_-]{21}$/i,hb=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,db=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,pb=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,mb="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",vc,gb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,yb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,bb=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,xb=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,vb=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wb=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,yh="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_b=new RegExp(`^${yh}$`);function bh(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Sb(r){return new RegExp(`^${bh(r)}$`)}function xh(r){let e=`${yh}T${bh(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Eb(r,e){return!!((e==="v4"||!e)&&gb.test(r)||(e==="v6"||!e)&&bb.test(r))}function Tb(r,e){if(!hb.test(r))return!1;try{let[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function Cb(r,e){return!!((e==="v4"||!e)&&yb.test(r)||(e==="v6"||!e)&&xb.test(r))}var rr=class r extends fe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==G.string){let i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_type,expected:G.string,received:i.parsedType}),ie}let n=new Ve,s;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:D.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:D.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?V(s,{code:D.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&V(s,{code:D.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")pb.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"email",code:D.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")vc||(vc=new RegExp(mb,"u")),vc.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"emoji",code:D.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")lb.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"uuid",code:D.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")fb.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"nanoid",code:D.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")ab.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid",code:D.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")cb.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid2",code:D.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")ub.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ulid",code:D.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),V(s,{validation:"url",code:D.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"regex",code:D.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),V(s,{code:D.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:D.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:D.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?xh(i).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:D.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?_b.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:D.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?Sb(i).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:D.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?db.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"duration",code:D.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?Eb(e.data,i.version)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ip",code:D.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Tb(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"jwt",code:D.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?Cb(e.data,i.version)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cidr",code:D.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?vb.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"base64",code:D.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?wb.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"base64url",code:D.invalid_string,message:i.message}),n.dirty()):me.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:D.invalid_string,...Y.errToObj(n)})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Y.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Y.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Y.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Y.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Y.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Y.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Y.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Y.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Y.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Y.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Y.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Y.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Y.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...Y.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...Y.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...Y.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Y.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...Y.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Y.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Y.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Y.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Y.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Y.errToObj(t)})}nonempty(e){return this.min(1,Y.errToObj(e))}trim(){return new r({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};rr.create=r=>{var e;return new rr({checks:[],typeName:se.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...le(r)})};function Nb(r,e){let t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}var yr=class r extends fe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==G.number){let i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_type,expected:G.number,received:i.parsedType}),ie}let n,s=new Ve;for(let i of this._def.checks)i.kind==="int"?me.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),V(n,{code:D.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:D.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:D.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Nb(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),V(n,{code:D.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),V(n,{code:D.not_finite,message:i.message}),s.dirty()):me.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Y.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Y.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Y.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Y.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Y.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Y.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Y.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Y.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Y.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Y.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Y.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&me.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};yr.create=r=>new yr({checks:[],typeName:se.ZodNumber,coerce:r?.coerce||!1,...le(r)});var br=class r extends fe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==G.bigint)return this._getInvalidInput(e);let n,s=new Ve;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:D.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:D.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),V(n,{code:D.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):me.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return V(t,{code:D.invalid_type,expected:G.bigint,received:t.parsedType}),ie}gte(e,t){return this.setLimit("min",e,!0,Y.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Y.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Y.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Y.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Y.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Y.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Y.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};br.create=r=>{var e;return new br({checks:[],typeName:se.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...le(r)})};var xr=class extends fe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==G.boolean){let n=this._getOrReturnCtx(e);return V(n,{code:D.invalid_type,expected:G.boolean,received:n.parsedType}),ie}return Ge(e.data)}};xr.create=r=>new xr({typeName:se.ZodBoolean,coerce:r?.coerce||!1,...le(r)});var vr=class r extends fe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==G.date){let i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_type,expected:G.date,received:i.parsedType}),ie}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_date}),ie}let n=new Ve,s;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:D.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:D.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):me.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Y.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Y.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};vr.create=r=>new vr({checks:[],coerce:r?.coerce||!1,typeName:se.ZodDate,...le(r)});var sn=class extends fe{_parse(e){if(this._getType(e)!==G.symbol){let n=this._getOrReturnCtx(e);return V(n,{code:D.invalid_type,expected:G.symbol,received:n.parsedType}),ie}return Ge(e.data)}};sn.create=r=>new sn({typeName:se.ZodSymbol,...le(r)});var wr=class extends fe{_parse(e){if(this._getType(e)!==G.undefined){let n=this._getOrReturnCtx(e);return V(n,{code:D.invalid_type,expected:G.undefined,received:n.parsedType}),ie}return Ge(e.data)}};wr.create=r=>new wr({typeName:se.ZodUndefined,...le(r)});var _r=class extends fe{_parse(e){if(this._getType(e)!==G.null){let n=this._getOrReturnCtx(e);return V(n,{code:D.invalid_type,expected:G.null,received:n.parsedType}),ie}return Ge(e.data)}};_r.create=r=>new _r({typeName:se.ZodNull,...le(r)});var nr=class extends fe{constructor(){super(...arguments),this._any=!0}_parse(e){return Ge(e.data)}};nr.create=r=>new nr({typeName:se.ZodAny,...le(r)});var Vt=class extends fe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ge(e.data)}};Vt.create=r=>new Vt({typeName:se.ZodUnknown,...le(r)});var wt=class extends fe{_parse(e){let t=this._getOrReturnCtx(e);return V(t,{code:D.invalid_type,expected:G.never,received:t.parsedType}),ie}};wt.create=r=>new wt({typeName:se.ZodNever,...le(r)});var on=class extends fe{_parse(e){if(this._getType(e)!==G.undefined){let n=this._getOrReturnCtx(e);return V(n,{code:D.invalid_type,expected:G.void,received:n.parsedType}),ie}return Ge(e.data)}};on.create=r=>new on({typeName:se.ZodVoid,...le(r)});var zt=class r extends fe{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==G.array)return V(t,{code:D.invalid_type,expected:G.array,received:t.parsedType}),ie;if(s.exactLength!==null){let o=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(o||a)&&(V(t,{code:o?D.too_big:D.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(V(t,{code:D.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(V(t,{code:D.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>s.type._parseAsync(new lt(t,o,t.path,a)))).then(o=>Ve.mergeArray(n,o));let i=[...t.data].map((o,a)=>s.type._parseSync(new lt(t,o,t.path,a)));return Ve.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new r({...this._def,minLength:{value:e,message:Y.toString(t)}})}max(e,t){return new r({...this._def,maxLength:{value:e,message:Y.toString(t)}})}length(e,t){return new r({...this._def,exactLength:{value:e,message:Y.toString(t)}})}nonempty(e){return this.min(1,e)}};zt.create=(r,e)=>new zt({type:r,minLength:null,maxLength:null,exactLength:null,typeName:se.ZodArray,...le(e)});function tn(r){if(r instanceof tt){let e={};for(let t in r.shape){let n=r.shape[t];e[t]=ut.create(tn(n))}return new tt({...r._def,shape:()=>e})}else return r instanceof zt?new zt({...r._def,type:tn(r.element)}):r instanceof ut?ut.create(tn(r.unwrap())):r instanceof It?It.create(tn(r.unwrap())):r instanceof At?At.create(r.items.map(e=>tn(e))):r}var tt=class r extends fe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=me.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==G.object){let h=this._getOrReturnCtx(e);return V(h,{code:D.invalid_type,expected:G.object,received:h.parsedType}),ie}let{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof wt&&this._def.unknownKeys==="strip"))for(let h in s.data)o.includes(h)||a.push(h);let u=[];for(let h of o){let l=i[h],d=s.data[h];u.push({key:{status:"valid",value:h},value:l._parse(new lt(s,d,s.path,h)),alwaysSet:h in s.data})}if(this._def.catchall instanceof wt){let h=this._def.unknownKeys;if(h==="passthrough")for(let l of a)u.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(h==="strict")a.length>0&&(V(s,{code:D.unrecognized_keys,keys:a}),n.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let h=this._def.catchall;for(let l of a){let d=s.data[l];u.push({key:{status:"valid",value:l},value:h._parse(new lt(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let h=[];for(let l of u){let d=await l.key,g=await l.value;h.push({key:d,value:g,alwaysSet:l.alwaysSet})}return h}).then(h=>Ve.mergeObjectSync(n,h)):Ve.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(e){return Y.errToObj,new r({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,o,a;let u=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=Y.errToObj(e).message)!==null&&a!==void 0?a:u}:{message:u}}}:{}})}strip(){return new r({...this._def,unknownKeys:"strip"})}passthrough(){return new r({...this._def,unknownKeys:"passthrough"})}extend(e){return new r({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new r({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:se.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new r({...this._def,catchall:e})}pick(e){let t={};return me.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new r({...this._def,shape:()=>t})}omit(e){let t={};return me.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new r({...this._def,shape:()=>t})}deepPartial(){return tn(this)}partial(e){let t={};return me.objectKeys(this.shape).forEach(n=>{let s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new r({...this._def,shape:()=>t})}required(e){let t={};return me.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof ut;)i=i._def.innerType;t[n]=i}}),new r({...this._def,shape:()=>t})}keyof(){return vh(me.objectKeys(this.shape))}};tt.create=(r,e)=>new tt({shape:()=>r,unknownKeys:"strip",catchall:wt.create(),typeName:se.ZodObject,...le(e)});tt.strictCreate=(r,e)=>new tt({shape:()=>r,unknownKeys:"strict",catchall:wt.create(),typeName:se.ZodObject,...le(e)});tt.lazycreate=(r,e)=>new tt({shape:r,unknownKeys:"strip",catchall:wt.create(),typeName:se.ZodObject,...le(e)});var Sr=class extends fe{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(let a of i)if(a.result.status==="valid")return a.result;for(let a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let o=i.map(a=>new nt(a.ctx.common.issues));return V(t,{code:D.invalid_union,unionErrors:o}),ie}if(t.common.async)return Promise.all(n.map(async i=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let i,o=[];for(let u of n){let h={...t,common:{...t.common,issues:[]},parent:null},l=u._parseSync({data:t.data,path:t.path,parent:h});if(l.status==="valid")return l;l.status==="dirty"&&!i&&(i={result:l,ctx:h}),h.common.issues.length&&o.push(h.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;let a=o.map(u=>new nt(u));return V(t,{code:D.invalid_union,unionErrors:a}),ie}}get options(){return this._def.options}};Sr.create=(r,e)=>new Sr({options:r,typeName:se.ZodUnion,...le(e)});var Ut=r=>r instanceof Tr?Ut(r.schema):r instanceof st?Ut(r.innerType()):r instanceof Cr?[r.value]:r instanceof Nr?r.options:r instanceof Ar?me.objectValues(r.enum):r instanceof Ir?Ut(r._def.innerType):r instanceof wr?[void 0]:r instanceof _r?[null]:r instanceof ut?[void 0,...Ut(r.unwrap())]:r instanceof It?[null,...Ut(r.unwrap())]:r instanceof ns||r instanceof Pr?Ut(r.unwrap()):r instanceof Or?Ut(r._def.innerType):[],mi=class r extends fe{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==G.object)return V(t,{code:D.invalid_type,expected:G.object,received:t.parsedType}),ie;let n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(V(t,{code:D.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),ie)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let s=new Map;for(let i of t){let o=Ut(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new r({typeName:se.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...le(n)})}};function Ec(r,e){let t=Qt(r),n=Qt(e);if(r===e)return{valid:!0,data:r};if(t===G.object&&n===G.object){let s=me.objectKeys(e),i=me.objectKeys(r).filter(a=>s.indexOf(a)!==-1),o={...r,...e};for(let a of i){let u=Ec(r[a],e[a]);if(!u.valid)return{valid:!1};o[a]=u.data}return{valid:!0,data:o}}else if(t===G.array&&n===G.array){if(r.length!==e.length)return{valid:!1};let s=[];for(let i=0;i<r.length;i++){let o=r[i],a=e[i],u=Ec(o,a);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return t===G.date&&n===G.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}var Er=class extends fe{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(_c(i)||_c(o))return ie;let a=Ec(i.value,o.value);return a.valid?((Sc(i)||Sc(o))&&t.dirty(),{status:t.value,value:a.data}):(V(n,{code:D.invalid_intersection_types}),ie)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};Er.create=(r,e,t)=>new Er({left:r,right:e,typeName:se.ZodIntersection,...le(t)});var At=class r extends fe{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==G.array)return V(n,{code:D.invalid_type,expected:G.array,received:n.parsedType}),ie;if(n.data.length<this._def.items.length)return V(n,{code:D.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ie;!this._def.rest&&n.data.length>this._def.items.length&&(V(n,{code:D.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...n.data].map((o,a)=>{let u=this._def.items[a]||this._def.rest;return u?u._parse(new lt(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Ve.mergeArray(t,o)):Ve.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new r({...this._def,rest:e})}};At.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new At({items:r,typeName:se.ZodTuple,rest:null,...le(e)})};var gi=class r extends fe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==G.object)return V(n,{code:D.invalid_type,expected:G.object,received:n.parsedType}),ie;let s=[],i=this._def.keyType,o=this._def.valueType;for(let a in n.data)s.push({key:i._parse(new lt(n,a,n.path,a)),value:o._parse(new lt(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?Ve.mergeObjectAsync(t,s):Ve.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof fe?new r({keyType:e,valueType:t,typeName:se.ZodRecord,...le(n)}):new r({keyType:rr.create(),valueType:e,typeName:se.ZodRecord,...le(t)})}},an=class extends fe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==G.map)return V(n,{code:D.invalid_type,expected:G.map,received:n.parsedType}),ie;let s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,u],h)=>({key:s._parse(new lt(n,a,n.path,[h,"key"])),value:i._parse(new lt(n,u,n.path,[h,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let u of o){let h=await u.key,l=await u.value;if(h.status==="aborted"||l.status==="aborted")return ie;(h.status==="dirty"||l.status==="dirty")&&t.dirty(),a.set(h.value,l.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let u of o){let h=u.key,l=u.value;if(h.status==="aborted"||l.status==="aborted")return ie;(h.status==="dirty"||l.status==="dirty")&&t.dirty(),a.set(h.value,l.value)}return{status:t.value,value:a}}}};an.create=(r,e,t)=>new an({valueType:e,keyType:r,typeName:se.ZodMap,...le(t)});var cn=class r extends fe{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==G.set)return V(n,{code:D.invalid_type,expected:G.set,received:n.parsedType}),ie;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(V(n,{code:D.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(V(n,{code:D.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());let i=this._def.valueType;function o(u){let h=new Set;for(let l of u){if(l.status==="aborted")return ie;l.status==="dirty"&&t.dirty(),h.add(l.value)}return{status:t.value,value:h}}let a=[...n.data.values()].map((u,h)=>i._parse(new lt(n,u,n.path,h)));return n.common.async?Promise.all(a).then(u=>o(u)):o(a)}min(e,t){return new r({...this._def,minSize:{value:e,message:Y.toString(t)}})}max(e,t){return new r({...this._def,maxSize:{value:e,message:Y.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};cn.create=(r,e)=>new cn({valueType:r,minSize:null,maxSize:null,typeName:se.ZodSet,...le(e)});var yi=class r extends fe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==G.function)return V(t,{code:D.invalid_type,expected:G.function,received:t.parsedType}),ie;function n(a,u){return di({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,hi(),nn].filter(h=>!!h),issueData:{code:D.invalid_arguments,argumentsError:u}})}function s(a,u){return di({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,hi(),nn].filter(h=>!!h),issueData:{code:D.invalid_return_type,returnTypeError:u}})}let i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof sr){let a=this;return Ge(async function(...u){let h=new nt([]),l=await a._def.args.parseAsync(u,i).catch(x=>{throw h.addIssue(n(u,x)),h}),d=await Reflect.apply(o,this,l);return await a._def.returns._def.type.parseAsync(d,i).catch(x=>{throw h.addIssue(s(d,x)),h})})}else{let a=this;return Ge(function(...u){let h=a._def.args.safeParse(u,i);if(!h.success)throw new nt([n(u,h.error)]);let l=Reflect.apply(o,this,h.data),d=a._def.returns.safeParse(l,i);if(!d.success)throw new nt([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new r({...this._def,args:At.create(e).rest(Vt.create())})}returns(e){return new r({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new r({args:e||At.create([]).rest(Vt.create()),returns:t||Vt.create(),typeName:se.ZodFunction,...le(n)})}},Tr=class extends fe{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Tr.create=(r,e)=>new Tr({getter:r,typeName:se.ZodLazy,...le(e)});var Cr=class extends fe{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return V(t,{received:t.data,code:D.invalid_literal,expected:this._def.value}),ie}return{status:"valid",value:e.data}}get value(){return this._def.value}};Cr.create=(r,e)=>new Cr({value:r,typeName:se.ZodLiteral,...le(e)});function vh(r,e){return new Nr({values:r,typeName:se.ZodEnum,...le(e)})}var Nr=class r extends fe{constructor(){super(...arguments),es.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return V(t,{expected:me.joinValues(n),received:t.parsedType,code:D.invalid_type}),ie}if(pi(this,es,"f")||gh(this,es,new Set(this._def.values),"f"),!pi(this,es,"f").has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return V(t,{received:t.data,code:D.invalid_enum_value,options:n}),ie}return Ge(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return r.create(e,{...this._def,...t})}exclude(e,t=this._def){return r.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};es=new WeakMap;Nr.create=vh;var Ar=class extends fe{constructor(){super(...arguments),ts.set(this,void 0)}_parse(e){let t=me.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==G.string&&n.parsedType!==G.number){let s=me.objectValues(t);return V(n,{expected:me.joinValues(s),received:n.parsedType,code:D.invalid_type}),ie}if(pi(this,ts,"f")||gh(this,ts,new Set(me.getValidEnumValues(this._def.values)),"f"),!pi(this,ts,"f").has(e.data)){let s=me.objectValues(t);return V(n,{received:n.data,code:D.invalid_enum_value,options:s}),ie}return Ge(e.data)}get enum(){return this._def.values}};ts=new WeakMap;Ar.create=(r,e)=>new Ar({values:r,typeName:se.ZodNativeEnum,...le(e)});var sr=class extends fe{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==G.promise&&t.common.async===!1)return V(t,{code:D.invalid_type,expected:G.promise,received:t.parsedType}),ie;let n=t.parsedType===G.promise?t.data:Promise.resolve(t.data);return Ge(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}};sr.create=(r,e)=>new sr({type:r,typeName:se.ZodPromise,...le(e)});var st=class extends fe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===se.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{V(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){let o=s.transform(n.data,i);if(n.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return ie;let u=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return u.status==="aborted"?ie:u.status==="dirty"||t.value==="dirty"?rn(u.value):u});{if(t.value==="aborted")return ie;let a=this._def.schema._parseSync({data:o,path:n.path,parent:n});return a.status==="aborted"?ie:a.status==="dirty"||t.value==="dirty"?rn(a.value):a}}if(s.type==="refinement"){let o=a=>{let u=s.refinement(a,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?ie:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?ie:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){let o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!gr(o))return o;let a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>gr(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);me.assertNever(s)}};st.create=(r,e,t)=>new st({schema:r,typeName:se.ZodEffects,effect:e,...le(t)});st.createWithPreprocess=(r,e,t)=>new st({schema:e,effect:{type:"preprocess",transform:r},typeName:se.ZodEffects,...le(t)});var ut=class extends fe{_parse(e){return this._getType(e)===G.undefined?Ge(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ut.create=(r,e)=>new ut({innerType:r,typeName:se.ZodOptional,...le(e)});var It=class extends fe{_parse(e){return this._getType(e)===G.null?Ge(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};It.create=(r,e)=>new It({innerType:r,typeName:se.ZodNullable,...le(e)});var Ir=class extends fe{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===G.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Ir.create=(r,e)=>new Ir({innerType:r,typeName:se.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...le(e)});var Or=class extends fe{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return rs(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new nt(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new nt(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};Or.create=(r,e)=>new Or({innerType:r,typeName:se.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...le(e)});var un=class extends fe{_parse(e){if(this._getType(e)!==G.nan){let n=this._getOrReturnCtx(e);return V(n,{code:D.invalid_type,expected:G.nan,received:n.parsedType}),ie}return{status:"valid",value:e.data}}};un.create=r=>new un({typeName:se.ZodNaN,...le(r)});var Ab=Symbol("zod_brand"),ns=class extends fe{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},ss=class r extends fe{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?ie:i.status==="dirty"?(t.dirty(),rn(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?ie:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new r({in:e,out:t,typeName:se.ZodPipeline})}},Pr=class extends fe{_parse(e){let t=this._def.innerType._parse(e),n=s=>(gr(s)&&(s.value=Object.freeze(s.value)),s);return rs(t)?t.then(s=>n(s)):n(t)}unwrap(){return this._def.innerType}};Pr.create=(r,e)=>new Pr({innerType:r,typeName:se.ZodReadonly,...le(e)});function dh(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function wh(r,e={},t){return r?nr.create().superRefine((n,s)=>{var i,o;let a=r(n);if(a instanceof Promise)return a.then(u=>{var h,l;if(!u){let d=dh(e,n),g=(l=(h=d.fatal)!==null&&h!==void 0?h:t)!==null&&l!==void 0?l:!0;s.addIssue({code:"custom",...d,fatal:g})}});if(!a){let u=dh(e,n),h=(o=(i=u.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0;s.addIssue({code:"custom",...u,fatal:h})}}):nr.create()}var Ib={object:tt.lazycreate},se;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(se||(se={}));var Ob=(r,e={message:`Input not instance of ${r.name}`})=>wh(t=>t instanceof r,e),_h=rr.create,Sh=yr.create,Pb=un.create,Rb=br.create,Eh=xr.create,Lb=vr.create,kb=sn.create,$b=wr.create,Bb=_r.create,Mb=nr.create,qb=Vt.create,Db=wt.create,jb=on.create,Fb=zt.create,Ub=tt.create,Qb=tt.strictCreate,Vb=Sr.create,zb=mi.create,Wb=Er.create,Gb=At.create,Kb=gi.create,Hb=an.create,Zb=cn.create,Xb=yi.create,Jb=Tr.create,Yb=Cr.create,ex=Nr.create,tx=Ar.create,rx=sr.create,ph=st.create,nx=ut.create,sx=It.create,ix=st.createWithPreprocess,ox=ss.create,ax=()=>_h().optional(),cx=()=>Sh().optional(),ux=()=>Eh().optional(),lx={string:r=>rr.create({...r,coerce:!0}),number:r=>yr.create({...r,coerce:!0}),boolean:r=>xr.create({...r,coerce:!0}),bigint:r=>br.create({...r,coerce:!0}),date:r=>vr.create({...r,coerce:!0})},fx=ie,xe=Object.freeze({__proto__:null,defaultErrorMap:nn,setErrorMap:ib,getErrorMap:hi,makeIssue:di,EMPTY_PATH:ob,addIssueToContext:V,ParseStatus:Ve,INVALID:ie,DIRTY:rn,OK:Ge,isAborted:_c,isDirty:Sc,isValid:gr,isAsync:rs,get util(){return me},get objectUtil(){return wc},ZodParsedType:G,getParsedType:Qt,ZodType:fe,datetimeRegex:xh,ZodString:rr,ZodNumber:yr,ZodBigInt:br,ZodBoolean:xr,ZodDate:vr,ZodSymbol:sn,ZodUndefined:wr,ZodNull:_r,ZodAny:nr,ZodUnknown:Vt,ZodNever:wt,ZodVoid:on,ZodArray:zt,ZodObject:tt,ZodUnion:Sr,ZodDiscriminatedUnion:mi,ZodIntersection:Er,ZodTuple:At,ZodRecord:gi,ZodMap:an,ZodSet:cn,ZodFunction:yi,ZodLazy:Tr,ZodLiteral:Cr,ZodEnum:Nr,ZodNativeEnum:Ar,ZodPromise:sr,ZodEffects:st,ZodTransformer:st,ZodOptional:ut,ZodNullable:It,ZodDefault:Ir,ZodCatch:Or,ZodNaN:un,BRAND:Ab,ZodBranded:ns,ZodPipeline:ss,ZodReadonly:Pr,custom:wh,Schema:fe,ZodSchema:fe,late:Ib,get ZodFirstPartyTypeKind(){return se},coerce:lx,any:Mb,array:Fb,bigint:Rb,boolean:Eh,date:Lb,discriminatedUnion:zb,effect:ph,enum:ex,function:Xb,instanceof:Ob,intersection:Wb,lazy:Jb,literal:Yb,map:Hb,nan:Pb,nativeEnum:tx,never:Db,null:Bb,nullable:sx,number:Sh,object:Ub,oboolean:ux,onumber:cx,optional:nx,ostring:ax,pipeline:ox,preprocess:ix,promise:rx,record:Kb,set:Zb,strictObject:Qb,string:_h,symbol:kb,transformer:ph,tuple:Gb,undefined:$b,union:Vb,unknown:qb,void:jb,NEVER:fx,ZodIssueCode:D,quotelessJson:sb,ZodError:nt});var Ie={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function Pe(r,e){return e.includes(r.columnType)}function hx(r){return"enumValues"in r&&Array.isArray(r.enumValues)&&r.enumValues.length>0}var dx=xe.union([xe.string(),xe.number(),xe.boolean(),xe.null()]),px=xe.union([dx,xe.record(xe.any()),xe.array(xe.any())]),mx=xe.custom(r=>r instanceof Buffer);function Th(r,e){let t=e?.zodInstance??xe,n=e?.coerce??{},s;return hx(r)&&(s=r.enumValues.length?t.enum(r.enumValues):t.string()),s||(Pe(r,["PgGeometry","PgPointTuple"])?s=t.tuple([t.number(),t.number()]):Pe(r,["PgGeometryObject","PgPointObject"])?s=t.object({x:t.number(),y:t.number()}):Pe(r,["PgHalfVector","PgVector"])?(s=t.array(t.number()),s=r.dimensions?s.length(r.dimensions):s):Pe(r,["PgLine"])?s=t.tuple([t.number(),t.number(),t.number()]):Pe(r,["PgLineABC"])?s=t.object({a:t.number(),b:t.number(),c:t.number()}):Pe(r,["PgArray"])?(s=t.array(Th(r.baseColumn,t)),s=r.size?s.length(r.size):s):r.dataType==="array"?s=t.array(t.any()):r.dataType==="number"?s=gx(r,t,n):r.dataType==="bigint"?s=yx(r,t,n):r.dataType==="boolean"?s=n===!0||n.boolean?t.coerce.boolean():t.boolean():r.dataType==="date"?s=n===!0||n.date?t.coerce.date():t.date():r.dataType==="string"?s=bx(r,t,n):r.dataType==="json"?s=px:r.dataType==="custom"?s=t.any():r.dataType==="buffer"&&(s=mx)),s||(s=t.any()),s}function gx(r,e,t){let n=r.getSQLType().includes("unsigned"),s,i,o=!1;Pe(r,["MySqlTinyInt","SingleStoreTinyInt"])?(s=n?0:Ie.INT8_MIN,i=n?Ie.INT8_UNSIGNED_MAX:Ie.INT8_MAX,o=!0):Pe(r,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(s=n?0:Ie.INT16_MIN,i=n?Ie.INT16_UNSIGNED_MAX:Ie.INT16_MAX,o=!0):Pe(r,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(s=n?0:Ie.INT24_MIN,i=n?Ie.INT24_UNSIGNED_MAX:Ie.INT24_MAX,o=Pe(r,["MySqlMediumInt","SingleStoreMediumInt"])):Pe(r,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(s=n?0:Ie.INT32_MIN,i=n?Ie.INT32_UNSIGNED_MAX:Ie.INT32_MAX,o=!0):Pe(r,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(s=n?0:Ie.INT48_MIN,i=n?Ie.INT48_UNSIGNED_MAX:Ie.INT48_MAX):Pe(r,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(n=n||Pe(r,["MySqlSerial","SingleStoreSerial"]),s=n?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=!0):Pe(r,["MySqlYear","SingleStoreYear"])?(s=1901,i=2155,o=!0):(s=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let a=t===!0||t?.number?e.coerce.number():e.number();return a=a.min(s).max(i),o?a.int():a}function yx(r,e,t){let n=r.getSQLType().includes("unsigned"),s=n?0n:Ie.INT64_MIN,i=n?Ie.INT64_UNSIGNED_MAX:Ie.INT64_MAX;return(t===!0||t?.bigint?e.coerce.bigint():e.bigint()).min(s).max(i)}function bx(r,e,t){if(Pe(r,["PgUUID"]))return e.string().uuid();let n,s,i=!1;Pe(r,["PgVarchar","SQLiteText"])?n=r.length:Pe(r,["MySqlVarChar","SingleStoreVarChar"])?n=r.length??Ie.INT16_UNSIGNED_MAX:Pe(r,["MySqlText","SingleStoreText"])&&(r.textType==="longtext"?n=Ie.INT32_UNSIGNED_MAX:r.textType==="mediumtext"?n=Ie.INT24_UNSIGNED_MAX:r.textType==="text"?n=Ie.INT16_UNSIGNED_MAX:n=Ie.INT8_UNSIGNED_MAX),Pe(r,["PgChar","MySqlChar","SingleStoreChar"])&&(n=r.length,i=!0),Pe(r,["PgBinaryVector"])&&(s=/^[01]+$/,n=r.dimensions);let o=t===!0||t?.string?e.coerce.string():e.string();return o=s?o.regex(s):o,n&&i?o.length(n):n?o.max(n):o}function Ch(r){return Vo(r)?zs(r):uf(r)}function Nh(r,e,t,n){let s={};for(let[i,o]of Object.entries(r)){if(!B(o,ye)&&!B(o,W)&&!B(o,W.Aliased)&&typeof o=="object"){let d=Vo(o)||sf(o)?Ch(o):o;s[i]=Nh(d,e[i]??{},t,n);continue}let a=e[i];if(a!==void 0&&typeof a!="function"){s[i]=a;continue}let u=B(o,ye)?o:void 0,h=u?Th(u,n):xe.any(),l=typeof a=="function"?a(h):h;t.never(u)||(s[i]=l,u&&(t.nullable(u)&&(s[i]=s[i].nullable()),t.optional(u)&&(s[i]=s[i].optional())))}return xe.object(s)}var xx={never:r=>r?.generated?.type==="always"||r?.generatedIdentity?.type==="always",optional:r=>!r.notNull||r.notNull&&r.hasDefault,nullable:r=>!r.notNull};var Rr=(r,e)=>{let t=Ch(r);return Nh(t,e??{},xx)};var Ke=Yt("users",{id:Ft("id").primaryKey(),email:ne("email").notNull().unique(),password:ne("password").notNull(),firstName:ne("first_name"),lastName:ne("last_name"),role:ne("role").notNull().default("user"),isActive:Jt("is_active").default(!0),createdAt:vt("created_at").defaultNow()}),Lr=Yt("password_reset_tokens",{id:Ft("id").primaryKey(),email:ne("email").notNull(),token:ne("token").notNull().unique(),expiresAt:vt("expires_at").notNull(),used:Jt("used").default(!1),createdAt:vt("created_at").defaultNow()}),vx=Yt("franchises",{id:Ft("id").primaryKey(),name:ne("name").notNull(),description:ne("description"),category:ne("category").notNull(),country:ne("country").notNull(),state:ne("state"),investmentRange:ne("investment_range"),imageUrl:ne("image_url"),contactEmail:ne("contact_email"),investmentMin:Nt("investment_min"),investmentMax:Nt("investment_max"),isActive:Jt("is_active").default(!0),createdAt:vt("created_at").defaultNow()}),wx=Yt("businesses",{id:Ft("id").primaryKey(),userId:Nt("user_id").references(()=>Ke.id),name:ne("name").notNull(),description:ne("description"),category:ne("category").notNull(),country:ne("country").notNull(),state:ne("state"),price:Nt("price"),imageUrl:ne("image_url"),contactEmail:ne("contact_email"),package:ne("package"),yearEstablished:ne("year_established"),employees:ne("employees"),revenue:ne("revenue"),reason:ne("reason"),assets:ne("assets"),status:ne("status").default("pending"),paymentStatus:ne("payment_status").default("unpaid"),isActive:Jt("is_active").default(!1),createdAt:vt("created_at").defaultNow()}),_x=Yt("advertisements",{id:Ft("id").primaryKey(),userId:Nt("user_id").references(()=>Ke.id),title:ne("title").notNull(),description:ne("description"),imageUrl:ne("image_url").notNull(),targetUrl:ne("target_url"),package:ne("package"),company:ne("company"),contactEmail:ne("contact_email"),contactPhone:ne("contact_phone"),budget:ne("budget"),status:ne("status").default("pending"),paymentStatus:ne("payment_status").default("unpaid"),isActive:Jt("is_active").default(!1),createdAt:vt("created_at").defaultNow()}),Sx=Yt("inquiries",{id:Ft("id").primaryKey(),name:ne("name").notNull(),email:ne("email").notNull(),phone:ne("phone"),subject:ne("subject").notNull(),message:ne("message").notNull(),franchiseId:Nt("franchise_id"),businessId:Nt("business_id"),status:ne("status").default("pending"),createdAt:vt("created_at").defaultNow()}),cA=Yt("sessions",{sid:Hs("sid").primaryKey(),sess:Ks("sess").notNull(),expire:vt("expire").notNull()},r=>[fh("IDX_session_expire").on(r.expire)]),uA=Rr(Ke).pick({email:!0,password:!0,firstName:!0,lastName:!0}),lA=xe.object({email:xe.string().email(),password:xe.string().min(6)}),fA=xe.object({email:xe.string().email(),password:xe.string().min(6),firstName:xe.string().min(1),lastName:xe.string().min(1)}),hA=xe.object({email:xe.string().email()}),dA=xe.object({token:xe.string(),password:xe.string().min(6)}),pA=Rr(Lr).pick({email:!0,token:!0,expiresAt:!0}),mA=Rr(vx).omit({id:!0,createdAt:!0}),gA=Rr(wx).omit({id:!0,createdAt:!0}),yA=Rr(_x).omit({id:!0,createdAt:!0}),bA=Rr(Sx).omit({id:!0,createdAt:!0});var Rh=hr(require("crypto"),1),Tc=null;function Ex(r){try{return crypto.getRandomValues(new Uint8Array(r))}catch{}try{return Rh.default.randomBytes(r)}catch{}if(!Tc)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return Tc(r)}function Tx(r){Tc=r}function Nc(r,e){if(r=r||Ac,typeof r!="number")throw Error("Illegal arguments: "+typeof r+", "+typeof e);r<4?r=4:r>31&&(r=31);var t=[];return t.push("$2b$"),r<10&&t.push("0"),t.push(r.toString()),t.push("$"),t.push(bi(Ex(is),is)),t.join("")}function Lh(r,e,t){if(typeof e=="function"&&(t=e,e=void 0),typeof r=="function"&&(t=r,r=void 0),typeof r>"u")r=Ac;else if(typeof r!="number")throw Error("illegal arguments: "+typeof r);function n(s){_t(function(){try{s(null,Nc(r))}catch(i){s(i)}})}if(t){if(typeof t!="function")throw Error("Illegal callback: "+typeof t);n(t)}else return new Promise(function(s,i){n(function(o,a){if(o){i(o);return}s(a)})})}function kh(r,e){if(typeof e>"u"&&(e=Ac),typeof e=="number"&&(e=Nc(e)),typeof r!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof r+", "+typeof e);return Cc(r,e)}function $h(r,e,t,n){function s(i){typeof r=="string"&&typeof e=="number"?Lh(e,function(o,a){Cc(r,a,i,n)}):typeof r=="string"&&typeof e=="string"?Cc(r,e,i,n):_t(i.bind(this,Error("Illegal arguments: "+typeof r+", "+typeof e)))}if(t){if(typeof t!="function")throw Error("Illegal callback: "+typeof t);s(t)}else return new Promise(function(i,o){s(function(a,u){if(a){o(a);return}i(u)})})}function Bh(r,e){for(var t=r.length^e.length,n=0;n<r.length;++n)t|=r.charCodeAt(n)^e.charCodeAt(n);return t===0}function Cx(r,e){if(typeof r!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof r+", "+typeof e);return e.length!==60?!1:Bh(kh(r,e.substring(0,e.length-31)),e)}function Nx(r,e,t,n){function s(i){if(typeof r!="string"||typeof e!="string"){_t(i.bind(this,Error("Illegal arguments: "+typeof r+", "+typeof e)));return}if(e.length!==60){_t(i.bind(this,null,!1));return}$h(r,e.substring(0,29),function(o,a){o?i(o):i(null,Bh(a,e))},n)}if(t){if(typeof t!="function")throw Error("Illegal callback: "+typeof t);s(t)}else return new Promise(function(i,o){s(function(a,u){if(a){o(a);return}i(u)})})}function Ax(r){if(typeof r!="string")throw Error("Illegal arguments: "+typeof r);return parseInt(r.split("$")[2],10)}function Ix(r){if(typeof r!="string")throw Error("Illegal arguments: "+typeof r);if(r.length!==60)throw Error("Illegal hash length: "+r.length+" != 60");return r.substring(0,29)}function Ox(r){if(typeof r!="string")throw Error("Illegal arguments: "+typeof r);return Mh(r)>72}var _t=typeof process<"u"&&process&&typeof process.nextTick=="function"?typeof setImmediate=="function"?setImmediate:process.nextTick:setTimeout;function Mh(r){for(var e=0,t=0,n=0;n<r.length;++n)t=r.charCodeAt(n),t<128?e+=1:t<2048?e+=2:(t&64512)===55296&&(r.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function Px(r){for(var e=0,t,n,s=new Array(Mh(r)),i=0,o=r.length;i<o;++i)t=r.charCodeAt(i),t<128?s[e++]=t:t<2048?(s[e++]=t>>6|192,s[e++]=t&63|128):(t&64512)===55296&&((n=r.charCodeAt(i+1))&64512)===56320?(t=65536+((t&1023)<<10)+(n&1023),++i,s[e++]=t>>18|240,s[e++]=t>>12&63|128,s[e++]=t>>6&63|128,s[e++]=t&63|128):(s[e++]=t>>12|224,s[e++]=t>>6&63|128,s[e++]=t&63|128);return s}var ln="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),ir=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function bi(r,e){var t=0,n=[],s,i;if(e<=0||e>r.length)throw Error("Illegal len: "+e);for(;t<e;){if(s=r[t++]&255,n.push(ln[s>>2&63]),s=(s&3)<<4,t>=e){n.push(ln[s&63]);break}if(i=r[t++]&255,s|=i>>4&15,n.push(ln[s&63]),s=(i&15)<<2,t>=e){n.push(ln[s&63]);break}i=r[t++]&255,s|=i>>6&3,n.push(ln[s&63]),n.push(ln[i&63])}return n.join("")}function qh(r,e){var t=0,n=r.length,s=0,i=[],o,a,u,h,l,d;if(e<=0)throw Error("Illegal len: "+e);for(;t<n-1&&s<e&&(d=r.charCodeAt(t++),o=d<ir.length?ir[d]:-1,d=r.charCodeAt(t++),a=d<ir.length?ir[d]:-1,!(o==-1||a==-1||(l=o<<2>>>0,l|=(a&48)>>4,i.push(String.fromCharCode(l)),++s>=e||t>=n)||(d=r.charCodeAt(t++),u=d<ir.length?ir[d]:-1,u==-1)||(l=(a&15)<<4>>>0,l|=(u&60)>>2,i.push(String.fromCharCode(l)),++s>=e||t>=n)));)d=r.charCodeAt(t++),h=d<ir.length?ir[d]:-1,l=(u&3)<<6>>>0,l|=h,i.push(String.fromCharCode(l)),++s;var g=[];for(t=0;t<s;t++)g.push(i[t].charCodeAt(0));return g}var is=16,Ac=10,Rx=16,Lx=100,Ah=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],Ih=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],Dh=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function os(r,e,t,n){var s,i=r[e],o=r[e+1];return i^=t[0],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[1],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[2],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[3],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[4],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[5],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[6],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[7],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[8],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[9],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[10],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[11],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[12],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[13],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[14],s=n[i>>>24],s+=n[256|i>>16&255],s^=n[512|i>>8&255],s+=n[768|i&255],o^=s^t[15],s=n[o>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s+=n[768|o&255],i^=s^t[16],r[e]=o^t[Rx+1],r[e+1]=i,r}function fn(r,e){for(var t=0,n=0;t<4;++t)n=n<<8|r[e]&255,e=(e+1)%r.length;return{key:n,offp:e}}function Oh(r,e,t){for(var n=0,s=[0,0],i=e.length,o=t.length,a,u=0;u<i;u++)a=fn(r,n),n=a.offp,e[u]=e[u]^a.key;for(u=0;u<i;u+=2)s=os(s,0,e,t),e[u]=s[0],e[u+1]=s[1];for(u=0;u<o;u+=2)s=os(s,0,e,t),t[u]=s[0],t[u+1]=s[1]}function kx(r,e,t,n){for(var s=0,i=[0,0],o=t.length,a=n.length,u,h=0;h<o;h++)u=fn(e,s),s=u.offp,t[h]=t[h]^u.key;for(s=0,h=0;h<o;h+=2)u=fn(r,s),s=u.offp,i[0]^=u.key,u=fn(r,s),s=u.offp,i[1]^=u.key,i=os(i,0,t,n),t[h]=i[0],t[h+1]=i[1];for(h=0;h<a;h+=2)u=fn(r,s),s=u.offp,i[0]^=u.key,u=fn(r,s),s=u.offp,i[1]^=u.key,i=os(i,0,t,n),n[h]=i[0],n[h+1]=i[1]}function Ph(r,e,t,n,s){var i=Dh.slice(),o=i.length,a;if(t<4||t>31)if(a=Error("Illegal number of rounds (4-31): "+t),n){_t(n.bind(this,a));return}else throw a;if(e.length!==is)if(a=Error("Illegal salt length: "+e.length+" != "+is),n){_t(n.bind(this,a));return}else throw a;t=1<<t>>>0;var u,h,l=0,d;typeof Int32Array=="function"?(u=new Int32Array(Ah),h=new Int32Array(Ih)):(u=Ah.slice(),h=Ih.slice()),kx(e,r,u,h);function g(){if(s&&s(l/t),l<t)for(var m=Date.now();l<t&&(l=l+1,Oh(r,u,h),Oh(e,u,h),!(Date.now()-m>Lx)););else{for(l=0;l<64;l++)for(d=0;d<o>>1;d++)os(i,d<<1,u,h);var f=[];for(l=0;l<o;l++)f.push((i[l]>>24&255)>>>0),f.push((i[l]>>16&255)>>>0),f.push((i[l]>>8&255)>>>0),f.push((i[l]&255)>>>0);if(n){n(null,f);return}else return f}n&&_t(g)}if(typeof n<"u")g();else for(var x;;)if(typeof(x=g())<"u")return x||[]}function Cc(r,e,t,n){var s;if(typeof r!="string"||typeof e!="string")if(s=Error("Invalid string / salt: Not a string"),t){_t(t.bind(this,s));return}else throw s;var i,o;if(e.charAt(0)!=="$"||e.charAt(1)!=="2")if(s=Error("Invalid salt version: "+e.substring(0,2)),t){_t(t.bind(this,s));return}else throw s;if(e.charAt(2)==="$")i="\0",o=3;else{if(i=e.charAt(2),i!=="a"&&i!=="b"&&i!=="y"||e.charAt(3)!=="$")if(s=Error("Invalid salt revision: "+e.substring(2,4)),t){_t(t.bind(this,s));return}else throw s;o=4}if(e.charAt(o+2)>"$")if(s=Error("Missing salt rounds"),t){_t(t.bind(this,s));return}else throw s;var a=parseInt(e.substring(o,o+1),10)*10,u=parseInt(e.substring(o+1,o+2),10),h=a+u,l=e.substring(o+3,o+25);r+=i>="a"?"\0":"";var d=Px(r),g=qh(l,is);function x(m){var f=[];return f.push("$2"),i>="a"&&f.push(i),f.push("$"),h<10&&f.push("0"),f.push(h.toString()),f.push("$"),f.push(bi(g,g.length)),f.push(bi(m,Dh.length*4-1)),f.join("")}if(typeof t>"u")return x(Ph(d,g,h));Ph(d,g,h,function(m,f){m?t(m,null):t(null,x(f))},n)}function $x(r,e){return bi(r,e)}function Bx(r,e){return qh(r,e)}var xi={setRandomFallback:Tx,genSaltSync:Nc,genSalt:Lh,hashSync:kh,hash:$h,compareSync:Cx,compare:Nx,getRounds:Ax,getSalt:Ix,truncates:Ox,encodeBase64:$x,decodeBase64:Bx};var uo=hr(m0(),1),Ug=require("crypto");var dT=hr(x0(),1),pT=hr(ku(),1),mT=hr(Mu(),1),jg=hr(Vu(),1),gT=hr(Dg(),1);var Fg=jg.default;Bt.fetchConnectionCache=!0;Bt.webSocketConstructor=Fg;var yT=new Mt({connectionString:process.env.DATABASE_URL,max:1}),Xt=fi(yT),Wu=process.env.JWT_SECRET||"your-default-secret-key",bT=async r=>{let e={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Content-Type","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Content-Type":"application/json"};if(r.httpMethod==="OPTIONS")return{statusCode:200,headers:e};let t=r.path.replace("/.netlify/functions/auth","");try{if(r.httpMethod==="POST"){let n=JSON.parse(r.body||"{}");if(t==="/login"){let{email:s,password:i}=n,[o]=await Xt.select().from(Ke).where(ct(Ke.email,s));if(!o||!await xi.compare(i,o.password))return{statusCode:401,headers:e,body:JSON.stringify({error:"Invalid credentials"})};let a=uo.default.sign({userId:o.id},Wu,{expiresIn:"7d"});return{statusCode:200,headers:e,body:JSON.stringify({token:a,user:{id:o.id,email:o.email,firstName:o.firstName,lastName:o.lastName}})}}if(t==="/register"){let{email:s,password:i,firstName:o,lastName:a}=n,[u]=await Xt.select().from(Ke).where(ct(Ke.email,s));if(u)return{statusCode:409,headers:e,body:JSON.stringify({error:"User already exists"})};let h=await xi.hash(i,10),[l]=await Xt.insert(Ke).values({email:s,password:h,firstName:o,lastName:a}).returning(),d=uo.default.sign({userId:l.id},Wu,{expiresIn:"7d"});return{statusCode:201,headers:e,body:JSON.stringify({token:d,user:{id:l.id,email:l.email,firstName:l.firstName,lastName:l.lastName}})}}if(t==="/forgot-password"){let{email:s}=n,[i]=await Xt.select().from(Ke).where(ct(Ke.email,s));if(!i)return{statusCode:404,headers:e,body:JSON.stringify({error:"User not found"})};let o=(0,Ug.randomBytes)(32).toString("hex"),a=new Date(Date.now()+36e5);return await Xt.insert(Lr).values({email:s,token:o,expiresAt:a}),{statusCode:200,headers:e,body:JSON.stringify({message:"Reset token generated",token:o})}}if(t==="/reset-password"){let{token:s,password:i}=n,[o]=await Xt.select().from(Lr).where(ct(Lr.token,s));if(!o||o.used||o.expiresAt<new Date)return{statusCode:400,headers:e,body:JSON.stringify({error:"Invalid or expired token"})};let a=await xi.hash(i,10);return await Xt.update(Ke).set({password:a}).where(ct(Ke.email,o.email)),await Xt.update(Lr).set({used:!0}).where(ct(Lr.token,s)),{statusCode:200,headers:e,body:JSON.stringify({message:"Password reset successful"})}}}if(r.httpMethod==="GET"&&t==="/verify"){let n=r.headers.authorization;if(!n||!n.startsWith("Bearer "))return{statusCode:401,headers:e,body:JSON.stringify({error:"No token provided"})};let s=n.substring(7);try{let i=uo.default.verify(s,Wu),[o]=await Xt.select().from(Ke).where(ct(Ke.id,i.userId));return o?{statusCode:200,headers:e,body:JSON.stringify({user:{id:o.id,email:o.email,firstName:o.firstName,lastName:o.lastName}})}:{statusCode:401,headers:e,body:JSON.stringify({error:"Invalid token"})}}catch{return{statusCode:401,headers:e,body:JSON.stringify({error:"Invalid token"})}}}return{statusCode:404,headers:e,body:JSON.stringify({error:"Not found"})}}catch(n){return console.error("Error:",n),{statusCode:500,headers:e,body:JSON.stringify({error:"Internal server error"})}}};0&&(module.exports={handler});
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@neondatabase/serverless/index.mjs:
  (*! Bundled license information:
  
  ieee754/index.js:
    (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  
  buffer/index.js:
    (*!
     * The buffer module from node.js, for the browser.
     *
     * @author   Feross Aboukhadijeh <https://feross.org>
     * @license  MIT
     *)
  *)
*/
